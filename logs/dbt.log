

============================== 2024-07-13 16:35:56.974767 | 29601fdf-7e75-4610-9d01-f30fe39be29c ==============================
[0m16:35:56.974990 [info ] [MainThread]: Running with dbt=1.2.0
[0m16:35:56.976439 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m16:35:56.976750 [debug] [MainThread]: Tracking: tracking
[0m16:35:56.993947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb44faf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb44f8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb44f8b0>]}
[0m16:35:56.995726 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:35:56.996173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb44f8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb44f8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb44fb50>]}


============================== 2024-07-13 16:36:00.308923 | 05666e75-eb84-4899-83b4-bc4e9ceb2096 ==============================
[0m16:36:00.309249 [info ] [MainThread]: Running with dbt=1.2.0
[0m16:36:00.310954 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m16:36:00.311348 [debug] [MainThread]: Tracking: tracking
[0m16:36:00.325757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c6f940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c6f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c6f8b0>]}
[0m16:36:00.338247 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m16:36:00.338622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '05666e75-eb84-4899-83b4-bc4e9ceb2096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c6d0f0>]}
[0m16:36:00.359859 [debug] [MainThread]: Parsing macros/catalog.sql
[0m16:36:00.363915 [debug] [MainThread]: Parsing macros/adapters.sql
[0m16:36:00.385903 [debug] [MainThread]: Parsing macros/relations.sql
[0m16:36:00.387261 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m16:36:00.388687 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m16:36:00.389241 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m16:36:00.394768 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m16:36:00.396259 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m16:36:00.397313 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m16:36:00.398467 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m16:36:00.399101 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m16:36:00.401067 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m16:36:00.404402 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m16:36:00.406163 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m16:36:00.420592 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m16:36:00.428352 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m16:36:00.441355 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m16:36:00.445030 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m16:36:00.447346 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m16:36:00.451963 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m16:36:00.454774 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m16:36:00.461269 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m16:36:00.462395 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m16:36:00.464182 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m16:36:00.474957 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m16:36:00.487690 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m16:36:00.489045 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m16:36:00.498981 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m16:36:00.504410 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m16:36:00.518906 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m16:36:00.520382 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m16:36:00.521805 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m16:36:00.525260 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m16:36:00.526061 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m16:36:00.527223 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m16:36:00.527958 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m16:36:00.528599 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m16:36:00.529335 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m16:36:00.530155 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m16:36:00.531053 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m16:36:00.532099 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m16:36:00.533433 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m16:36:00.534479 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m16:36:00.535410 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m16:36:00.536162 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m16:36:00.538089 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m16:36:00.539780 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m16:36:00.540601 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m16:36:00.541528 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m16:36:00.542331 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m16:36:00.543296 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m16:36:00.548503 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m16:36:00.549991 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m16:36:00.550794 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m16:36:00.551688 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m16:36:00.552601 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m16:36:00.553655 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m16:36:00.554602 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m16:36:00.557966 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m16:36:00.565468 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m16:36:00.567712 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m16:36:00.579734 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m16:36:00.585770 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m16:36:00.587666 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m16:36:00.589965 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m16:36:00.601869 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m16:36:00.604158 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m16:36:00.605455 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m16:36:00.606657 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m16:36:00.613472 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m16:36:00.617366 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m16:36:00.828022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05666e75-eb84-4899-83b4-bc4e9ceb2096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae06d0>]}
[0m16:36:00.840855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05666e75-eb84-4899-83b4-bc4e9ceb2096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b5a980>]}
[0m16:36:00.841296 [info ] [MainThread]: Found 0 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m16:36:00.841661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05666e75-eb84-4899-83b4-bc4e9ceb2096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b8c880>]}
[0m16:36:00.843517 [info ] [MainThread]: 
[0m16:36:00.844149 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:36:00.846977 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m16:36:00.856529 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:36:00.856936 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:36:00.857182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:00.915586 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.06 seconds
[0m16:36:00.917535 [debug] [ThreadPool]: On list_postgres: Close
[0m16:36:00.919926 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m16:36:00.924814 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:36:00.925069 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:36:00.925281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:00.936315 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m16:36:00.936655 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:36:00.936874 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:36:00.940968 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:36:00.942097 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:36:00.942439 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:36:00.946153 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:00.946458 [debug] [MainThread]: On master: BEGIN
[0m16:36:00.946667 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:36:00.953390 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m16:36:00.953772 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:00.954016 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:36:00.956960 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:36:00.958037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05666e75-eb84-4899-83b4-bc4e9ceb2096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b5ac20>]}
[0m16:36:00.958466 [debug] [MainThread]: On master: ROLLBACK
[0m16:36:00.958794 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:00.959018 [debug] [MainThread]: On master: BEGIN
[0m16:36:00.959384 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:36:00.959637 [debug] [MainThread]: On master: COMMIT
[0m16:36:00.959855 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:00.960109 [debug] [MainThread]: On master: COMMIT
[0m16:36:00.960374 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:36:00.960597 [debug] [MainThread]: On master: Close
[0m16:36:00.960999 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:36:00.961297 [info ] [MainThread]: 
[0m16:36:00.976920 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.rugs_usa_category_map
[0m16:36:00.977068 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.rugs_usa_color_map
[0m16:36:00.977454 [info ] [Thread-1 (]: 1 of 6 START seed file public.rugs_usa_category_map ............................ [RUN]
[0m16:36:00.977812 [info ] [Thread-2 (]: 2 of 6 START seed file public.rugs_usa_color_map ............................... [RUN]
[0m16:36:00.978291 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m16:36:00.978782 [debug] [Thread-2 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m16:36:00.979240 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.rugs_usa_category_map
[0m16:36:00.979496 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.rugs_usa_color_map
[0m16:36:00.979763 [debug] [Thread-1 (]: finished collecting timing info
[0m16:36:00.980001 [debug] [Thread-2 (]: finished collecting timing info
[0m16:36:00.980244 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.rugs_usa_category_map
[0m16:36:00.980478 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.rugs_usa_color_map
[0m16:36:01.347271 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m16:36:01.360349 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: BEGIN
[0m16:36:01.374322 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:36:01.418021 [debug] [Thread-2 (]: SQL status: BEGIN in 0.04 seconds
[0m16:36:01.432289 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m16:36:01.443246 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_color_map"} */

    create table "postgres"."public"."rugs_usa_color_map" ("pid" text,"color_id" text,"color_value" text,"dw_insert_timestamp" text)
  
[0m16:36:01.448027 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m16:36:01.448582 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: BEGIN
[0m16:36:01.448830 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:01.452400 [debug] [Thread-2 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m16:36:01.469321 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m16:36:01.483296 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m16:36:01.497308 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_category_map"} */

    create table "postgres"."public"."rugs_usa_category_map" ("pid" text,"category_id" text,"category_value" text,"dw_insert_timestamp" text)
  
[0m16:36:01.521352 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.01 seconds
[0m16:36:10.457826 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m16:36:10.481368 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m16:36:10.562037 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.07 seconds
[0m16:36:10.719806 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m16:36:10.738262 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: 
          insert into "postgres"."public"."rugs_usa_color_map" ("pid", "color_id", "color_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s...
[0m16:36:10.807808 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.06 seconds
[0m16:36:17.547501 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m16:36:17.563452 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: 
          insert into "postgres"."public"."rugs_usa_color_map" ("pid", "color_id", "color_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s...
[0m16:36:17.628103 [debug] [Thread-2 (]: SQL status: INSERT 0 7232 in 0.04 seconds
[0m16:36:17.656110 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_color_map"
[0m16:36:17.792187 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: COMMIT
[0m16:36:17.806307 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m16:36:17.819333 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: COMMIT
[0m16:36:17.841360 [debug] [Thread-2 (]: SQL status: COMMIT in 0.01 seconds
[0m16:36:17.869656 [debug] [Thread-2 (]: finished collecting timing info
[0m16:36:17.882448 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: Close
[0m16:36:17.908635 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05666e75-eb84-4899-83b4-bc4e9ceb2096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99e4be0>]}
[0m16:36:17.927034 [info ] [Thread-2 (]: 2 of 6 OK loaded seed file public.rugs_usa_color_map ........................... [[32mINSERT 17232[0m in 16.93s]
[0m16:36:17.947323 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.rugs_usa_color_map
[0m16:36:17.965353 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.rugs_usa_links
[0m16:36:17.979128 [info ] [Thread-2 (]: 3 of 6 START seed file public.rugs_usa_links ................................... [RUN]
[0m16:36:17.991722 [debug] [Thread-2 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m16:36:18.006279 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.rugs_usa_links
[0m16:36:18.019815 [debug] [Thread-2 (]: finished collecting timing info
[0m16:36:18.034289 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.rugs_usa_links
[0m16:36:18.171772 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m16:36:18.193287 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: BEGIN
[0m16:36:18.214261 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:36:18.248058 [debug] [Thread-2 (]: SQL status: BEGIN in 0.03 seconds
[0m16:36:18.260162 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m16:36:18.280279 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_links"} */

    create table "postgres"."public"."rugs_usa_links" ("base_url" text,"page_links" text,"card_links" text,"request_time_stamp" text,"dw_insert_timestamp" text)
  
[0m16:36:18.303290 [debug] [Thread-2 (]: SQL status: CREATE TABLE in 0.01 seconds
[0m16:36:19.141607 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m16:36:19.163310 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m16:36:19.257964 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.08 seconds
[0m16:36:25.945530 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m16:36:25.976024 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: 
          insert into "postgres"."public"."rugs_usa_links" ("base_url", "page_links", "card_links", "request_time_stamp", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s...
[0m16:36:26.068348 [debug] [Thread-2 (]: SQL status: INSERT 0 5565 in 0.07 seconds
[0m16:36:26.090895 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_links"
[0m16:36:26.158847 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: COMMIT
[0m16:36:26.178942 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m16:36:26.192251 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: COMMIT
[0m16:36:26.229702 [debug] [Thread-2 (]: SQL status: COMMIT in 0.02 seconds
[0m16:36:26.251482 [debug] [Thread-2 (]: finished collecting timing info
[0m16:36:26.272139 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: Close
[0m16:36:26.310781 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05666e75-eb84-4899-83b4-bc4e9ceb2096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99de710>]}
[0m16:36:26.327657 [info ] [Thread-2 (]: 3 of 6 OK loaded seed file public.rugs_usa_links ............................... [[32mINSERT 5565[0m in 8.32s]
[0m16:36:26.355742 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.rugs_usa_links
[0m16:36:26.367969 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.rugs_usa_pads_upsell
[0m16:36:26.410809 [info ] [Thread-2 (]: 4 of 6 START seed file public.rugs_usa_pads_upsell ............................. [RUN]
[0m16:36:26.433507 [debug] [Thread-2 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m16:36:26.454960 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.rugs_usa_pads_upsell
[0m16:36:26.476038 [debug] [Thread-2 (]: finished collecting timing info
[0m16:36:26.496912 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.rugs_usa_pads_upsell
[0m16:36:29.815731 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m16:36:29.839212 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m16:36:30.131444 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.28 seconds
[0m16:36:36.170611 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m16:36:36.187093 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: BEGIN
[0m16:36:36.200971 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:36:36.236898 [debug] [Thread-2 (]: SQL status: BEGIN in 0.04 seconds
[0m16:36:36.250942 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m16:36:36.271936 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_pads_upsell"} */

    create table "postgres"."public"."rugs_usa_pads_upsell" ("size" text,"shape" text,"price" float8,"width" float8,"sqft" float8,"type" text,"stock" integer,"height" float8,"variant" text,"p_id" text,"pad_id" text,"dw_insert_timestamp" text)
  
[0m16:36:36.297982 [debug] [Thread-2 (]: SQL status: CREATE TABLE in 0.01 seconds
[0m16:36:40.029565 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m16:36:40.043995 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m16:36:40.123006 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.06 seconds
[0m16:36:49.368265 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m16:36:49.382733 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m16:36:49.465570 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.06 seconds
[0m16:36:50.751460 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m16:36:50.765899 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m16:36:50.803209 [debug] [Thread-1 (]: SQL status: INSERT 0 1265 in 0.02 seconds
[0m16:36:50.826367 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_category_map"
[0m16:36:50.881215 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: COMMIT
[0m16:36:50.900926 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m16:36:50.921942 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: COMMIT
[0m16:36:50.952134 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:36:50.968010 [debug] [Thread-1 (]: finished collecting timing info
[0m16:36:50.988656 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: Close
[0m16:36:51.016849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05666e75-eb84-4899-83b4-bc4e9ceb2096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a02c80>]}
[0m16:36:51.031805 [info ] [Thread-1 (]: 1 of 6 OK loaded seed file public.rugs_usa_category_map ........................ [[32mINSERT 51265[0m in 50.04s]
[0m16:36:51.059402 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.rugs_usa_category_map
[0m16:36:51.080219 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.rugs_usa_parent
[0m16:36:51.095342 [info ] [Thread-1 (]: 5 of 6 START seed file public.rugs_usa_parent .................................. [RUN]
[0m16:36:51.110393 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m16:36:51.125029 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.rugs_usa_parent
[0m16:36:51.138982 [debug] [Thread-1 (]: finished collecting timing info
[0m16:36:51.153029 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.rugs_usa_parent
[0m16:36:51.871342 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m16:36:51.885367 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: BEGIN
[0m16:36:51.900012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:51.938613 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m16:36:51.952921 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m16:36:51.966869 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_parent"} */

    create table "postgres"."public"."rugs_usa_parent" ("pid" text,"product_type_id" text,"name" text,"url" text,"origin" text,"thickness" text,"material" text,"weave" integer,"weave_feature" text,"color" text,"brand" text,"imageName" text,"imageType" text,"internalName" text,"category" text,"min_price" integer,"max_price" integer,"availability" text,"aggregate" boolean,"clearance" text,"long_description" text,"shopbyroom" text,"dw_insert_timestamp" text)
  
[0m16:36:51.998984 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.01 seconds
[0m16:37:03.616773 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m16:37:03.640450 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m16:37:04.054970 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.4 seconds
[0m16:37:21.932198 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m16:37:21.955629 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: 
          insert into "postgres"."public"."rugs_usa_parent" ("pid", "product_type_id", "name", "url", "origin", "thickness", "material", "weave", "weave_feature", "color", "brand", "imageName", "imageType", "internalName", "category", "min_price", "max_price", "availability", "aggregate", "clearance", "long_description", "shopbyroom", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s...
[0m16:37:22.284447 [debug] [Thread-1 (]: SQL status: INSERT 0 5562 in 0.31 seconds
[0m16:37:22.301370 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_parent"
[0m16:37:22.357498 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: COMMIT
[0m16:37:22.384497 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m16:37:22.398492 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: COMMIT
[0m16:37:22.430655 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:37:22.445746 [debug] [Thread-1 (]: finished collecting timing info
[0m16:37:22.459059 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: Close
[0m16:37:22.487081 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05666e75-eb84-4899-83b4-bc4e9ceb2096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffe0dc3e20>]}
[0m16:37:22.500982 [info ] [Thread-1 (]: 5 of 6 OK loaded seed file public.rugs_usa_parent .............................. [[32mINSERT 5562[0m in 31.38s]
[0m16:37:22.528711 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.rugs_usa_parent
[0m16:37:22.549686 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.rugs_usa_variant
[0m16:37:22.563809 [info ] [Thread-1 (]: 6 of 6 START seed file public.rugs_usa_variant ................................. [RUN]
[0m16:37:22.577772 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m16:37:22.591564 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.rugs_usa_variant
[0m16:37:22.612522 [debug] [Thread-1 (]: finished collecting timing info
[0m16:37:22.632429 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.rugs_usa_variant
[0m16:37:28.596983 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m16:37:28.613045 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: BEGIN
[0m16:37:28.627114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:28.689886 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m16:37:28.710985 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m16:37:28.738671 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_variant"} */

    create table "postgres"."public"."rugs_usa_variant" ("pid" text,"variant" text,"actual_size" text,"weave_feature" text,"weave_cat" text,"size_grp" text,"shipping_size" text,"shape" text,"weight" float8,"price" float8,"msrp" float8,"stock_level" integer,"depletion_level" integer,"low_stock" boolean,"estimated_delivery_date" text,"this_isd_range" text,"status" text,"origin" text,"new_arrival" text,"stockMsg" text,"stockEddMsg" text,"other_stock_core" integer,"other_stock_compass" integer,"dw_insert_timestamp" text)
  
[0m16:37:28.776669 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.02 seconds
[0m16:37:32.861308 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m16:37:32.878935 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m16:37:33.234569 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.34 seconds
[0m16:38:04.158584 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m16:38:04.172972 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m16:38:04.435526 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.25 seconds
[0m16:38:26.440271 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m16:38:26.455376 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: 
          insert into "postgres"."public"."rugs_usa_variant" ("pid", "variant", "actual_size", "weave_feature", "weave_cat", "size_grp", "shipping_size", "shape", "weight", "price", "msrp", "stock_level", "depletion_level", "low_stock", "estimated_delivery_date", "this_isd_range", "status", "origin", "new_arrival", "stockMsg", "stockEddMsg", "other_stock_core", "other_stock_compass", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m16:38:26.983012 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.51 seconds
[0m16:38:32.381996 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m16:38:32.397309 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m16:38:32.642260 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.23 seconds
[0m16:39:00.313724 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m16:39:00.330133 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m16:39:00.631894 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.28 seconds
[0m16:39:21.560842 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m16:39:21.587371 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: 
          insert into "postgres"."public"."rugs_usa_variant" ("pid", "variant", "actual_size", "weave_feature", "weave_cat", "size_grp", "shipping_size", "shape", "weight", "price", "msrp", "stock_level", "depletion_level", "low_stock", "estimated_delivery_date", "this_isd_range", "status", "origin", "new_arrival", "stockMsg", "stockEddMsg", "other_stock_core", "other_stock_compass", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m16:39:22.006209 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.4 seconds
[0m16:39:27.988942 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m16:39:28.004713 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m16:39:28.234113 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.21 seconds
[0m16:39:57.280481 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m16:39:57.296839 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m16:39:57.580188 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.27 seconds
[0m16:40:22.141537 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m16:40:22.167070 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: 
          insert into "postgres"."public"."rugs_usa_variant" ("pid", "variant", "actual_size", "weave_feature", "weave_cat", "size_grp", "shipping_size", "shape", "weight", "price", "msrp", "stock_level", "depletion_level", "low_stock", "estimated_delivery_date", "this_isd_range", "status", "origin", "new_arrival", "stockMsg", "stockEddMsg", "other_stock_core", "other_stock_compass", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m16:40:22.676829 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.5 seconds
[0m16:40:30.866382 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m16:40:30.884303 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m16:40:31.188893 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.28 seconds
[0m16:41:01.045362 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m16:41:01.080474 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m16:41:01.351072 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.26 seconds
[0m16:41:14.788955 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m16:41:14.805341 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: 
          insert into "postgres"."public"."rugs_usa_variant" ("pid", "variant", "actual_size", "weave_feature", "weave_cat", "size_grp", "shipping_size", "shape", "weight", "price", "msrp", "stock_level", "depletion_level", "low_stock", "estimated_delivery_date", "this_isd_range", "status", "origin", "new_arrival", "stockMsg", "stockEddMsg", "other_stock_core", "other_stock_compass", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m16:41:15.176232 [debug] [Thread-1 (]: SQL status: INSERT 0 8800 in 0.36 seconds
[0m16:41:15.194701 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_variant"
[0m16:41:15.265895 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: COMMIT
[0m16:41:15.285264 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m16:41:15.299230 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: COMMIT
[0m16:41:15.323319 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:41:15.344230 [debug] [Thread-1 (]: finished collecting timing info
[0m16:41:15.365197 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: Close
[0m16:41:15.386085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05666e75-eb84-4899-83b4-bc4e9ceb2096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a70af0>]}
[0m16:41:15.406445 [info ] [Thread-1 (]: 6 of 6 OK loaded seed file public.rugs_usa_variant ............................. [[32mINSERT 38800[0m in 232.81s]
[0m16:41:15.425962 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.rugs_usa_variant
[0m16:41:18.328544 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m16:41:18.330772 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m16:41:18.509671 [debug] [Thread-2 (]: SQL status: INSERT 0 7154 in 0.18 seconds
[0m16:41:18.514536 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m16:41:18.521973 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: COMMIT
[0m16:41:18.522310 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m16:41:18.522545 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: COMMIT
[0m16:41:18.525786 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:41:18.531542 [debug] [Thread-2 (]: finished collecting timing info
[0m16:41:18.532303 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: Close
[0m16:41:18.535125 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05666e75-eb84-4899-83b4-bc4e9ceb2096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b16860>]}
[0m16:41:18.537630 [info ] [Thread-2 (]: 4 of 6 OK loaded seed file public.rugs_usa_pads_upsell ......................... [[32mINSERT 97154[0m in 292.10s]
[0m16:41:18.538869 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.rugs_usa_pads_upsell
[0m16:41:18.552040 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:41:18.553566 [debug] [MainThread]: Using postgres connection "master"
[0m16:41:18.553861 [debug] [MainThread]: On master: BEGIN
[0m16:41:18.554242 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:41:18.565118 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m16:41:18.565889 [debug] [MainThread]: On master: COMMIT
[0m16:41:18.566341 [debug] [MainThread]: Using postgres connection "master"
[0m16:41:18.566626 [debug] [MainThread]: On master: COMMIT
[0m16:41:18.567061 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:41:18.567315 [debug] [MainThread]: On master: Close
[0m16:41:18.568408 [info ] [MainThread]: 
[0m16:41:18.568898 [info ] [MainThread]: Finished running 6 seeds in 0 hours 5 minutes and 17.72 seconds (317.72s).
[0m16:41:18.569360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:41:18.569597 [debug] [MainThread]: Connection 'seed.jaffle_shop.rugs_usa_pads_upsell' was properly closed.
[0m16:41:18.569825 [debug] [MainThread]: Connection 'seed.jaffle_shop.rugs_usa_variant' was properly closed.
[0m16:41:18.580419 [info ] [MainThread]: 
[0m16:41:18.580856 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:41:18.581355 [info ] [MainThread]: 
[0m16:41:18.581738 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:41:18.583944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b79960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd96f4790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd96f4190>]}


============================== 2024-07-13 18:20:47.870694 | e412cf29-8636-4a6e-a9bc-a6796d42c9ca ==============================
[0m18:20:47.871020 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:20:47.874577 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m18:20:47.874947 [debug] [MainThread]: Tracking: tracking
[0m18:20:47.889905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2afb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b250>]}
[0m18:20:47.945416 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:20:47.945770 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:20:47.951973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e412cf29-8636-4a6e-a9bc-a6796d42c9ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b880d0>]}
[0m18:20:47.963371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e412cf29-8636-4a6e-a9bc-a6796d42c9ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9add690>]}
[0m18:20:47.963810 [info ] [MainThread]: Found 0 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:20:47.964171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e412cf29-8636-4a6e-a9bc-a6796d42c9ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9add9f0>]}
[0m18:20:47.966054 [info ] [MainThread]: 
[0m18:20:47.966753 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:20:47.969178 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m18:20:47.982980 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:20:47.983538 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:20:47.983861 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:20:48.045565 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.06 seconds
[0m18:20:48.047531 [debug] [ThreadPool]: On list_postgres: Close
[0m18:20:48.049693 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m18:20:48.054485 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:20:48.054762 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:20:48.054993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:20:48.066954 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:20:48.067408 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:20:48.067698 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:20:48.078596 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m18:20:48.080154 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:20:48.080600 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:20:48.084516 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:48.084805 [debug] [MainThread]: On master: BEGIN
[0m18:20:48.085017 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:20:48.096820 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:20:48.097314 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:48.097565 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:20:48.105262 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m18:20:48.106639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e412cf29-8636-4a6e-a9bc-a6796d42c9ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9add6c0>]}
[0m18:20:48.107057 [debug] [MainThread]: On master: ROLLBACK
[0m18:20:48.107411 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:48.107634 [debug] [MainThread]: On master: BEGIN
[0m18:20:48.108009 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:20:48.108346 [debug] [MainThread]: On master: COMMIT
[0m18:20:48.108572 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:48.108773 [debug] [MainThread]: On master: COMMIT
[0m18:20:48.109046 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:20:48.109261 [debug] [MainThread]: On master: Close
[0m18:20:48.109684 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:20:48.110180 [info ] [MainThread]: 
[0m18:20:48.114340 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.rugs_usa_category_map
[0m18:20:48.114474 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.rugs_usa_color_map
[0m18:20:48.114800 [info ] [Thread-1 (]: 1 of 6 START seed file public.rugs_usa_category_map ............................ [RUN]
[0m18:20:48.115131 [info ] [Thread-2 (]: 2 of 6 START seed file public.rugs_usa_color_map ............................... [RUN]
[0m18:20:48.115676 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m18:20:48.116144 [debug] [Thread-2 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m18:20:48.116594 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.rugs_usa_category_map
[0m18:20:48.116878 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.rugs_usa_color_map
[0m18:20:48.117129 [debug] [Thread-1 (]: finished collecting timing info
[0m18:20:48.117355 [debug] [Thread-2 (]: finished collecting timing info
[0m18:20:48.117598 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.rugs_usa_category_map
[0m18:20:48.117816 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.rugs_usa_color_map
[0m18:20:48.464562 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m18:20:48.478845 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: BEGIN
[0m18:20:48.492872 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:20:48.563930 [debug] [Thread-2 (]: SQL status: BEGIN in 0.07 seconds
[0m18:20:48.577847 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m18:20:48.598816 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_color_map"} */
truncate table "postgres"."public"."rugs_usa_color_map"
[0m18:20:48.627850 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.02 seconds
[0m18:20:48.640420 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m18:20:48.668871 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: BEGIN
[0m18:20:48.696824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:20:48.739825 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m18:20:48.760786 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m18:20:48.774795 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_category_map"} */
truncate table "postgres"."public"."rugs_usa_category_map"
[0m18:20:48.798929 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.01 seconds
[0m18:20:57.875417 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m18:20:57.889839 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: 
          insert into "postgres"."public"."rugs_usa_color_map" ("pid", "color_id", "color_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s...
[0m18:20:57.990406 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.09 seconds
[0m18:20:58.123797 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m18:20:58.137783 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m18:20:58.225179 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.07 seconds
[0m18:21:04.669108 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m18:21:04.683760 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: 
          insert into "postgres"."public"."rugs_usa_color_map" ("pid", "color_id", "color_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s...
[0m18:21:04.738167 [debug] [Thread-2 (]: SQL status: INSERT 0 7232 in 0.04 seconds
[0m18:21:04.768954 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_color_map"
[0m18:21:04.849358 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: COMMIT
[0m18:21:04.863780 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m18:21:04.877798 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: COMMIT
[0m18:21:04.905720 [debug] [Thread-2 (]: SQL status: COMMIT in 0.01 seconds
[0m18:21:04.924907 [debug] [Thread-2 (]: finished collecting timing info
[0m18:21:04.937859 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: Close
[0m18:21:04.966325 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e412cf29-8636-4a6e-a9bc-a6796d42c9ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99d8b50>]}
[0m18:21:04.986469 [info ] [Thread-2 (]: 2 of 6 OK loaded seed file public.rugs_usa_color_map ........................... [[32mINSERT 17232[0m in 16.85s]
[0m18:21:05.007445 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.rugs_usa_color_map
[0m18:21:05.028930 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.rugs_usa_links
[0m18:21:05.049022 [info ] [Thread-2 (]: 3 of 6 START seed file public.rugs_usa_links ................................... [RUN]
[0m18:21:05.067005 [debug] [Thread-2 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m18:21:05.084030 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.rugs_usa_links
[0m18:21:05.097806 [debug] [Thread-2 (]: finished collecting timing info
[0m18:21:05.118810 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.rugs_usa_links
[0m18:21:05.327872 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m18:21:05.341790 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: BEGIN
[0m18:21:05.355765 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:21:05.391692 [debug] [Thread-2 (]: SQL status: BEGIN in 0.04 seconds
[0m18:21:05.405792 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m18:21:05.419917 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_links"} */
truncate table "postgres"."public"."rugs_usa_links"
[0m18:21:05.444822 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.01 seconds
[0m18:21:07.143808 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m18:21:07.158854 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m18:21:07.279601 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.11 seconds
[0m18:21:12.191845 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m18:21:12.206946 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: 
          insert into "postgres"."public"."rugs_usa_links" ("base_url", "page_links", "card_links", "request_time_stamp", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s...
[0m18:21:12.308815 [debug] [Thread-2 (]: SQL status: INSERT 0 5565 in 0.09 seconds
[0m18:21:12.338154 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_links"
[0m18:21:12.397620 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: COMMIT
[0m18:21:12.416870 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m18:21:12.430796 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: COMMIT
[0m18:21:12.466818 [debug] [Thread-2 (]: SQL status: COMMIT in 0.02 seconds
[0m18:21:12.491695 [debug] [Thread-2 (]: finished collecting timing info
[0m18:21:12.512911 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: Close
[0m18:21:12.541797 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e412cf29-8636-4a6e-a9bc-a6796d42c9ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffe9872ce0>]}
[0m18:21:12.556402 [info ] [Thread-2 (]: 3 of 6 OK loaded seed file public.rugs_usa_links ............................... [[32mINSERT 5565[0m in 7.47s]
[0m18:21:12.585275 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.rugs_usa_links
[0m18:21:12.599953 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.rugs_usa_pads_upsell
[0m18:21:12.613928 [info ] [Thread-2 (]: 4 of 6 START seed file public.rugs_usa_pads_upsell ............................. [RUN]
[0m18:21:12.635038 [debug] [Thread-2 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m18:21:12.648893 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.rugs_usa_pads_upsell
[0m18:21:12.662832 [debug] [Thread-2 (]: finished collecting timing info
[0m18:21:12.676815 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.rugs_usa_pads_upsell
[0m18:21:16.865120 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m18:21:16.881812 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m18:21:16.998345 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.1 seconds
[0m18:21:21.158608 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m18:21:21.181732 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: BEGIN
[0m18:21:21.202630 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:21:21.256634 [debug] [Thread-2 (]: SQL status: BEGIN in 0.05 seconds
[0m18:21:21.270601 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m18:21:21.290536 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_pads_upsell"} */
truncate table "postgres"."public"."rugs_usa_pads_upsell"
[0m18:21:21.338740 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.03 seconds
[0m18:21:27.344347 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m18:21:27.358567 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m18:21:27.522423 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.15 seconds
[0m18:21:37.629889 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m18:21:37.647869 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m18:21:37.751417 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.09 seconds
[0m18:21:39.251836 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m18:21:39.265437 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m18:21:39.296566 [debug] [Thread-1 (]: SQL status: INSERT 0 1265 in 0.02 seconds
[0m18:21:39.313106 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_category_map"
[0m18:21:39.369750 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: COMMIT
[0m18:21:39.389323 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m18:21:39.403574 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: COMMIT
[0m18:21:39.431630 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m18:21:39.446891 [debug] [Thread-1 (]: finished collecting timing info
[0m18:21:39.466666 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: Close
[0m18:21:39.487334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e412cf29-8636-4a6e-a9bc-a6796d42c9ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99d9de0>]}
[0m18:21:39.510156 [info ] [Thread-1 (]: 1 of 6 OK loaded seed file public.rugs_usa_category_map ........................ [[32mINSERT 51265[0m in 51.37s]
[0m18:21:39.539323 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.rugs_usa_category_map
[0m18:21:39.563006 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.rugs_usa_parent
[0m18:21:39.579490 [info ] [Thread-1 (]: 5 of 6 START seed file public.rugs_usa_parent .................................. [RUN]
[0m18:21:39.608598 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m18:21:39.636577 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.rugs_usa_parent
[0m18:21:39.650653 [debug] [Thread-1 (]: finished collecting timing info
[0m18:21:39.664642 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.rugs_usa_parent
[0m18:21:40.279262 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m18:21:40.293631 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: BEGIN
[0m18:21:40.307673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:21:40.352609 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m18:21:40.372762 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m18:21:40.393635 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_parent"} */
truncate table "postgres"."public"."rugs_usa_parent"
[0m18:21:40.417655 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.01 seconds
[0m18:21:50.967675 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m18:21:50.984264 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m18:21:51.309590 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.3 seconds
[0m18:22:12.700174 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m18:22:12.722057 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: 
          insert into "postgres"."public"."rugs_usa_parent" ("pid", "product_type_id", "name", "url", "origin", "thickness", "material", "weave", "weave_feature", "color", "brand", "imageName", "imageType", "internalName", "category", "min_price", "max_price", "availability", "aggregate", "clearance", "long_description", "shopbyroom", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s...
[0m18:22:12.998361 [debug] [Thread-1 (]: SQL status: INSERT 0 5562 in 0.26 seconds
[0m18:22:13.015734 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_parent"
[0m18:22:13.083895 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: COMMIT
[0m18:22:13.098212 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m18:22:13.112103 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: COMMIT
[0m18:22:13.157209 [debug] [Thread-1 (]: SQL status: COMMIT in 0.03 seconds
[0m18:22:13.171773 [debug] [Thread-1 (]: finished collecting timing info
[0m18:22:13.185145 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: Close
[0m18:22:13.206698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e412cf29-8636-4a6e-a9bc-a6796d42c9ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a23a00>]}
[0m18:22:13.221399 [info ] [Thread-1 (]: 5 of 6 OK loaded seed file public.rugs_usa_parent .............................. [[32mINSERT 5562[0m in 33.60s]
[0m18:22:13.241259 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.rugs_usa_parent
[0m18:22:13.255261 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.rugs_usa_variant
[0m18:22:13.269257 [info ] [Thread-1 (]: 6 of 6 START seed file public.rugs_usa_variant ................................. [RUN]
[0m18:22:13.283171 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m18:22:13.304208 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.rugs_usa_variant
[0m18:22:13.318156 [debug] [Thread-1 (]: finished collecting timing info
[0m18:22:13.346130 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.rugs_usa_variant
[0m18:22:17.996931 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m18:22:18.011515 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: BEGIN
[0m18:22:18.032535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:22:18.077461 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m18:22:18.091540 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m18:22:18.105548 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_variant"} */
truncate table "postgres"."public"."rugs_usa_variant"
[0m18:22:18.140736 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.02 seconds
[0m18:22:20.970831 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m18:22:20.985594 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m18:22:21.280666 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.28 seconds
[0m18:22:50.850938 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m18:22:50.874421 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m18:22:51.155051 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.27 seconds
[0m18:23:17.921069 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m18:23:17.936273 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: 
          insert into "postgres"."public"."rugs_usa_variant" ("pid", "variant", "actual_size", "weave_feature", "weave_cat", "size_grp", "shipping_size", "shape", "weight", "price", "msrp", "stock_level", "depletion_level", "low_stock", "estimated_delivery_date", "this_isd_range", "status", "origin", "new_arrival", "stockMsg", "stockEddMsg", "other_stock_core", "other_stock_compass", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m18:23:18.356182 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.41 seconds
[0m18:23:21.724944 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m18:23:21.740458 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m18:23:21.959768 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.21 seconds
[0m18:23:53.423325 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m18:23:53.454438 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m18:23:53.813436 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.34 seconds
[0m18:24:22.196664 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m18:24:22.218452 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: 
          insert into "postgres"."public"."rugs_usa_variant" ("pid", "variant", "actual_size", "weave_feature", "weave_cat", "size_grp", "shipping_size", "shape", "weight", "price", "msrp", "stock_level", "depletion_level", "low_stock", "estimated_delivery_date", "this_isd_range", "status", "origin", "new_arrival", "stockMsg", "stockEddMsg", "other_stock_core", "other_stock_compass", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m18:24:22.749679 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.52 seconds
[0m18:24:26.389718 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m18:24:26.404224 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m18:24:26.623601 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.21 seconds
[0m18:24:56.285607 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m18:24:56.302119 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m18:24:56.591729 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.27 seconds
[0m18:25:20.740700 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m18:25:20.755324 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: 
          insert into "postgres"."public"."rugs_usa_variant" ("pid", "variant", "actual_size", "weave_feature", "weave_cat", "size_grp", "shipping_size", "shape", "weight", "price", "msrp", "stock_level", "depletion_level", "low_stock", "estimated_delivery_date", "this_isd_range", "status", "origin", "new_arrival", "stockMsg", "stockEddMsg", "other_stock_core", "other_stock_compass", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m18:25:21.190479 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.41 seconds
[0m18:25:25.876577 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m18:25:25.892943 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m18:25:26.206903 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.29 seconds


============================== 2024-07-13 18:25:28.862173 | bc1f2458-a850-46a6-b0ab-b58a371a4fef ==============================
[0m18:25:28.862491 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:25:28.864226 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m18:25:28.864739 [debug] [MainThread]: Tracking: tracking
[0m18:25:28.879414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2afb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b250>]}
[0m18:25:28.920549 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:25:28.921124 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/below_depletion_level.sql
[0m18:25:28.956231 [debug] [MainThread]: 1699: static parser successfully parsed below_depletion_level.sql
[0m18:25:28.977915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc1f2458-a850-46a6-b0ab-b58a371a4fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89d7ee0>]}
[0m18:25:28.987136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc1f2458-a850-46a6-b0ab-b58a371a4fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b57220>]}
[0m18:25:28.987561 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:25:28.987924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc1f2458-a850-46a6-b0ab-b58a371a4fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b573d0>]}
[0m18:25:28.989716 [info ] [MainThread]: 
[0m18:25:28.990338 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:25:28.992565 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m18:25:29.001563 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:25:29.002141 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:25:29.002464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:29.050004 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.05 seconds
[0m18:25:29.051901 [debug] [ThreadPool]: On list_postgres: Close
[0m18:25:29.054632 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m18:25:29.059978 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:25:29.060327 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:25:29.060587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:29.067945 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:25:29.068324 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:25:29.068574 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:25:29.071687 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:25:29.072978 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:25:29.073387 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:25:29.077300 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:29.077643 [debug] [MainThread]: On master: BEGIN
[0m18:25:29.077908 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:25:29.084712 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:25:29.085192 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:29.085446 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:25:29.092189 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m18:25:29.093645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc1f2458-a850-46a6-b0ab-b58a371a4fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b5c730>]}
[0m18:25:29.094109 [debug] [MainThread]: On master: ROLLBACK
[0m18:25:29.094520 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:29.094765 [debug] [MainThread]: On master: BEGIN
[0m18:25:29.095285 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:25:29.095715 [debug] [MainThread]: On master: COMMIT
[0m18:25:29.095954 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:29.096214 [debug] [MainThread]: On master: COMMIT
[0m18:25:29.096522 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:25:29.096755 [debug] [MainThread]: On master: Close
[0m18:25:29.097210 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:25:29.097630 [info ] [MainThread]: 
[0m18:25:29.101626 [debug] [Thread-1 (]: Began running node model.jaffle_shop.below_depletion_level
[0m18:25:29.101770 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.rugs_usa_category_map
[0m18:25:29.102160 [info ] [Thread-1 (]: 1 of 7 START view model public.below_depletion_level ........................... [RUN]
[0m18:25:29.102515 [info ] [Thread-2 (]: 2 of 7 START seed file public.rugs_usa_category_map ............................ [RUN]
[0m18:25:29.103027 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.below_depletion_level"
[0m18:25:29.103588 [debug] [Thread-2 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m18:25:29.104065 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.below_depletion_level
[0m18:25:29.104326 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.rugs_usa_category_map
[0m18:25:29.104583 [debug] [Thread-1 (]: Compiling model.jaffle_shop.below_depletion_level
[0m18:25:29.104834 [debug] [Thread-2 (]: finished collecting timing info
[0m18:25:29.106536 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.below_depletion_level"
[0m18:25:29.106963 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.rugs_usa_category_map
[0m18:25:29.134179 [debug] [Thread-1 (]: finished collecting timing info
[0m18:25:29.135827 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.below_depletion_level
[0m18:25:29.194461 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.below_depletion_level"
[0m18:25:29.291472 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m18:25:29.312149 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: BEGIN
[0m18:25:29.331152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:29.368032 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m18:25:29.379966 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m18:25:29.392253 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */

  create view "postgres"."public"."below_depletion_level__dbt_tmp" as (
    select distinct name, ruv.variant
from rugs_usa_variant ruv 
join rugs_usa_parent on rugs_usa_parent.pid = ruv.pid
where status = 'Back_ordered' and stock_level < depletion_level
  );
[0m18:25:29.506881 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m18:25:29.507364 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_category_map: BEGIN
[0m18:25:29.507638 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:25:29.515883 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:25:29.516336 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m18:25:29.516597 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_category_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_category_map"} */
truncate table "postgres"."public"."rugs_usa_category_map"
[0m18:25:29.519680 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m18:25:34.808328 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m18:25:34.811013 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m18:25:34.879397 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.07 seconds
[0m18:25:39.882785 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m18:25:39.885126 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m18:25:39.959524 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.07 seconds
[0m18:25:45.039104 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m18:25:45.041890 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m18:25:45.099673 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.06 seconds
[0m18:25:50.502842 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m18:25:50.505215 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m18:25:50.569960 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.06 seconds
[0m18:25:55.758434 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m18:25:55.759088 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m18:25:55.809160 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.05 seconds
[0m18:25:56.491946 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m18:25:56.493241 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m18:25:56.512213 [debug] [Thread-2 (]: SQL status: INSERT 0 1265 in 0.02 seconds
[0m18:25:56.521252 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_category_map"
[0m18:25:56.541111 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_category_map: COMMIT
[0m18:25:56.541603 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m18:25:56.541844 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_category_map: COMMIT
[0m18:25:56.548817 [debug] [Thread-2 (]: SQL status: COMMIT in 0.01 seconds
[0m18:25:56.549831 [debug] [Thread-2 (]: finished collecting timing info
[0m18:25:56.550179 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_category_map: Close
[0m18:25:56.551903 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc1f2458-a850-46a6-b0ab-b58a371a4fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a04130>]}
[0m18:25:56.555924 [info ] [Thread-2 (]: 2 of 7 OK loaded seed file public.rugs_usa_category_map ........................ [[32mINSERT 51265[0m in 27.45s]
[0m18:25:56.563153 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.rugs_usa_category_map
[0m18:25:56.564827 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.rugs_usa_color_map
[0m18:25:56.565540 [info ] [Thread-2 (]: 3 of 7 START seed file public.rugs_usa_color_map ............................... [RUN]
[0m18:25:56.566466 [debug] [Thread-2 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m18:25:56.567383 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.rugs_usa_color_map
[0m18:25:56.567919 [debug] [Thread-2 (]: finished collecting timing info
[0m18:25:56.568260 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.rugs_usa_color_map
[0m18:25:56.682289 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m18:25:56.682707 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: BEGIN
[0m18:25:56.682949 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:25:56.694726 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:25:56.695332 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m18:25:56.695592 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_color_map"} */
truncate table "postgres"."public"."rugs_usa_color_map"
[0m18:25:56.700483 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m18:25:58.313684 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m18:25:58.338083 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m18:25:58.835973 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.48 seconds
[0m18:26:02.987881 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m18:26:02.990293 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: 
          insert into "postgres"."public"."rugs_usa_color_map" ("pid", "color_id", "color_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s...
[0m18:26:03.087202 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.1 seconds
[0m18:26:07.213431 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m18:26:07.215602 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: 
          insert into "postgres"."public"."rugs_usa_color_map" ("pid", "color_id", "color_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s...
[0m18:26:07.280926 [debug] [Thread-2 (]: SQL status: INSERT 0 7232 in 0.06 seconds
[0m18:26:07.285054 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_color_map"
[0m18:26:07.294087 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: COMMIT
[0m18:26:07.294572 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m18:26:07.294816 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: COMMIT
[0m18:26:07.299773 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:26:07.302120 [debug] [Thread-2 (]: finished collecting timing info
[0m18:26:07.302968 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: Close
[0m18:26:07.304847 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc1f2458-a850-46a6-b0ab-b58a371a4fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a04c40>]}
[0m18:26:07.305846 [info ] [Thread-2 (]: 3 of 7 OK loaded seed file public.rugs_usa_color_map ........................... [[32mINSERT 17232[0m in 10.74s]
[0m18:26:07.307231 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.rugs_usa_color_map
[0m18:26:07.307909 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.rugs_usa_links
[0m18:26:07.308738 [info ] [Thread-2 (]: 4 of 7 START seed file public.rugs_usa_links ................................... [RUN]
[0m18:26:07.309237 [debug] [Thread-2 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m18:26:07.309563 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.rugs_usa_links
[0m18:26:07.309814 [debug] [Thread-2 (]: finished collecting timing info
[0m18:26:07.310049 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.rugs_usa_links
[0m18:26:07.370286 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m18:26:07.374761 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: BEGIN
[0m18:26:07.375294 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:26:07.386967 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:26:07.388214 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m18:26:07.388861 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_links"} */
truncate table "postgres"."public"."rugs_usa_links"
[0m18:26:07.393261 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m18:26:11.216255 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m18:26:11.218214 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: 
          insert into "postgres"."public"."rugs_usa_links" ("base_url", "page_links", "card_links", "request_time_stamp", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s...
[0m18:26:11.300058 [debug] [Thread-2 (]: SQL status: INSERT 0 5565 in 0.08 seconds
[0m18:26:11.302399 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_links"
[0m18:26:11.311544 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: COMMIT
[0m18:26:11.312250 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m18:26:11.312678 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: COMMIT
[0m18:26:11.326500 [debug] [Thread-2 (]: SQL status: COMMIT in 0.01 seconds
[0m18:26:11.328207 [debug] [Thread-2 (]: finished collecting timing info
[0m18:26:11.328610 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: Close
[0m18:26:11.329925 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc1f2458-a850-46a6-b0ab-b58a371a4fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a06140>]}
[0m18:26:11.330791 [info ] [Thread-2 (]: 4 of 7 OK loaded seed file public.rugs_usa_links ............................... [[32mINSERT 5565[0m in 4.02s]
[0m18:26:11.332150 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.rugs_usa_links
[0m18:26:11.333004 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.rugs_usa_pads_upsell
[0m18:26:11.334093 [info ] [Thread-2 (]: 5 of 7 START seed file public.rugs_usa_pads_upsell ............................. [RUN]
[0m18:26:11.334716 [debug] [Thread-2 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m18:26:11.335036 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.rugs_usa_pads_upsell
[0m18:26:11.335321 [debug] [Thread-2 (]: finished collecting timing info
[0m18:26:11.335585 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.rugs_usa_pads_upsell
[0m18:26:15.673361 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m18:26:15.675116 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: BEGIN
[0m18:26:15.675417 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:26:15.686414 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:26:15.686992 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m18:26:15.690999 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_pads_upsell"} */
truncate table "postgres"."public"."rugs_usa_pads_upsell"
[0m18:26:18.837798 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m18:26:18.854367 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: 
          insert into "postgres"."public"."rugs_usa_variant" ("pid", "variant", "actual_size", "weave_feature", "weave_cat", "size_grp", "shipping_size", "shape", "weight", "price", "msrp", "stock_level", "depletion_level", "low_stock", "estimated_delivery_date", "this_isd_range", "status", "origin", "new_arrival", "stockMsg", "stockEddMsg", "other_stock_core", "other_stock_compass", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m18:26:19.238366 [debug] [Thread-1 (]: SQL status: INSERT 0 8800 in 0.37 seconds
[0m18:26:19.276937 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_variant"
[0m18:26:19.339644 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: COMMIT
[0m18:26:19.358943 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m18:26:19.380069 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: COMMIT
[0m18:26:19.415078 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 50.01 seconds
[0m18:26:19.417211 [debug] [Thread-1 (]: SQL status: COMMIT in 0.02 seconds
[0m18:26:19.457149 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m18:26:19.457635 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level__dbt_tmp" rename to "below_depletion_level"
[0m18:26:19.459583 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:26:19.442109 [debug] [Thread-1 (]: finished collecting timing info
[0m18:26:19.462142 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m18:26:19.462832 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m18:26:19.463527 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m18:26:19.465225 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:26:19.473810 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m18:26:19.474790 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
drop view if exists "postgres"."public"."below_depletion_level__dbt_backup" cascade
[0m18:26:19.477316 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:26:19.468928 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: Close
[0m18:26:19.485828 [debug] [Thread-1 (]: finished collecting timing info
[0m18:26:19.487728 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: Close
[0m18:26:19.494810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc1f2458-a850-46a6-b0ab-b58a371a4fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a07520>]}
[0m18:26:19.499262 [info ] [Thread-1 (]: 1 of 7 OK created view model public.below_depletion_level ...................... [[32mCREATE VIEW[0m in 50.39s]
[0m18:26:19.501327 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.below_depletion_level
[0m18:26:19.503282 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.rugs_usa_parent
[0m18:26:19.504916 [info ] [Thread-1 (]: 6 of 7 START seed file public.rugs_usa_parent .................................. [RUN]
[0m18:26:19.506036 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m18:26:19.506715 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.rugs_usa_parent
[0m18:26:19.507396 [debug] [Thread-1 (]: finished collecting timing info
[0m18:26:19.508021 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.rugs_usa_parent
[0m18:26:19.497676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e412cf29-8636-4a6e-a9bc-a6796d42c9ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1f850>]}
[0m18:26:19.517076 [info ] [Thread-1 (]: 6 of 6 OK loaded seed file public.rugs_usa_variant ............................. [[32mINSERT 38800[0m in 246.21s]
[0m18:26:19.562503 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.rugs_usa_variant
[0m18:26:20.076906 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m18:26:20.077859 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: BEGIN
[0m18:26:20.078148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:26:20.087517 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:26:20.088056 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m18:26:20.088353 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_parent"} */
truncate table "postgres"."public"."rugs_usa_parent"
[0m18:26:20.092597 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m18:26:21.895499 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m18:26:21.898230 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m18:26:22.113759 [debug] [Thread-2 (]: SQL status: INSERT 0 7154 in 0.22 seconds
[0m18:26:22.119254 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m18:26:22.126529 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: COMMIT
[0m18:26:22.126875 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m18:26:22.127110 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: COMMIT
[0m18:26:22.138784 [debug] [Thread-2 (]: SQL status: COMMIT in 0.01 seconds
[0m18:26:22.140754 [debug] [Thread-2 (]: finished collecting timing info
[0m18:26:22.141179 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: Close
[0m18:26:22.143178 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e412cf29-8636-4a6e-a9bc-a6796d42c9ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffe93522f0>]}
[0m18:26:22.148202 [info ] [Thread-2 (]: 4 of 6 OK loaded seed file public.rugs_usa_pads_upsell ......................... [[32mINSERT 97154[0m in 309.51s]
[0m18:26:22.138575 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 6.45 seconds
[0m18:26:22.152152 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.rugs_usa_pads_upsell
[0m18:26:22.165811 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:26:22.168363 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:22.168686 [debug] [MainThread]: On master: BEGIN
[0m18:26:22.168967 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:26:22.186063 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m18:26:22.187048 [debug] [MainThread]: On master: COMMIT
[0m18:26:22.187455 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:22.187857 [debug] [MainThread]: On master: COMMIT
[0m18:26:22.188305 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:26:22.188593 [debug] [MainThread]: On master: Close
[0m18:26:22.190140 [info ] [MainThread]: 
[0m18:26:22.191053 [info ] [MainThread]: Finished running 6 seeds in 0 hours 5 minutes and 34.22 seconds (334.22s).
[0m18:26:22.191516 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:26:22.191812 [debug] [MainThread]: Connection 'seed.jaffle_shop.rugs_usa_pads_upsell' was properly closed.
[0m18:26:22.192074 [debug] [MainThread]: Connection 'seed.jaffle_shop.rugs_usa_variant' was properly closed.
[0m18:26:22.210193 [info ] [MainThread]: 
[0m18:26:22.210914 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:26:22.212207 [info ] [MainThread]: 
[0m18:26:22.212812 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:26:22.214332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a0aa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9add4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffe93ddf60>]}
[0m18:26:50.903506 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m18:26:50.920176 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: 
          insert into "postgres"."public"."rugs_usa_parent" ("pid", "product_type_id", "name", "url", "origin", "thickness", "material", "weave", "weave_feature", "color", "brand", "imageName", "imageType", "internalName", "category", "min_price", "max_price", "availability", "aggregate", "clearance", "long_description", "shopbyroom", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s...
[0m18:26:51.249997 [debug] [Thread-1 (]: SQL status: INSERT 0 5562 in 0.32 seconds
[0m18:26:51.266269 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_parent"
[0m18:26:51.319816 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: COMMIT
[0m18:26:51.339086 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m18:26:51.353069 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: COMMIT
[0m18:26:51.399567 [debug] [Thread-1 (]: SQL status: COMMIT in 0.03 seconds
[0m18:26:51.415076 [debug] [Thread-1 (]: finished collecting timing info
[0m18:26:51.429075 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: Close
[0m18:26:51.450797 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc1f2458-a850-46a6-b0ab-b58a371a4fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a04d30>]}
[0m18:26:51.465527 [info ] [Thread-1 (]: 6 of 7 OK loaded seed file public.rugs_usa_parent .............................. [[32mINSERT 5562[0m in 31.94s]
[0m18:26:51.480758 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.rugs_usa_parent
[0m18:26:51.495316 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.rugs_usa_variant
[0m18:26:51.529388 [info ] [Thread-1 (]: 7 of 7 START seed file public.rugs_usa_variant ................................. [RUN]
[0m18:26:51.557665 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m18:26:51.572141 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.rugs_usa_variant
[0m18:26:51.593162 [debug] [Thread-1 (]: finished collecting timing info
[0m18:26:51.614084 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.rugs_usa_variant
[0m18:26:51.977187 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m18:26:52.157082 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m18:26:52.428104 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.25 seconds
[0m18:26:56.415781 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m18:26:56.432486 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: BEGIN
[0m18:26:56.453825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:26:56.493080 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m18:26:56.514081 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m18:26:56.534125 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_variant"} */
truncate table "postgres"."public"."rugs_usa_variant"
[0m18:26:56.562578 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.01 seconds
[0m18:27:22.112112 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m18:27:22.128568 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m18:27:22.409144 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.27 seconds
[0m18:27:51.831920 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m18:27:51.848538 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m18:27:52.123785 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.26 seconds
[0m18:27:55.684407 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m18:27:55.709398 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: 
          insert into "postgres"."public"."rugs_usa_variant" ("pid", "variant", "actual_size", "weave_feature", "weave_cat", "size_grp", "shipping_size", "shape", "weight", "price", "msrp", "stock_level", "depletion_level", "low_stock", "estimated_delivery_date", "this_isd_range", "status", "origin", "new_arrival", "stockMsg", "stockEddMsg", "other_stock_core", "other_stock_compass", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m18:27:56.128292 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.4 seconds
[0m18:28:21.635368 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m18:28:21.650660 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m18:28:21.922594 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.26 seconds
[0m18:28:50.753376 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m18:28:50.774926 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m18:28:51.052583 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.26 seconds
[0m18:28:54.782409 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m18:28:54.798049 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: 
          insert into "postgres"."public"."rugs_usa_variant" ("pid", "variant", "actual_size", "weave_feature", "weave_cat", "size_grp", "shipping_size", "shape", "weight", "price", "msrp", "stock_level", "depletion_level", "low_stock", "estimated_delivery_date", "this_isd_range", "status", "origin", "new_arrival", "stockMsg", "stockEddMsg", "other_stock_core", "other_stock_compass", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m18:28:55.253607 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.43 seconds
[0m18:29:20.542279 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m18:29:20.558971 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m18:29:20.856467 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.28 seconds
[0m18:29:50.496040 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m18:29:50.526059 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m18:29:50.804221 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.26 seconds
[0m18:29:53.936763 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m18:29:53.955053 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: 
          insert into "postgres"."public"."rugs_usa_variant" ("pid", "variant", "actual_size", "weave_feature", "weave_cat", "size_grp", "shipping_size", "shape", "weight", "price", "msrp", "stock_level", "depletion_level", "low_stock", "estimated_delivery_date", "this_isd_range", "status", "origin", "new_arrival", "stockMsg", "stockEddMsg", "other_stock_core", "other_stock_compass", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m18:29:54.314995 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.35 seconds
[0m18:30:19.298198 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m18:30:19.322924 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m18:30:19.568274 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.23 seconds
[0m18:30:44.976649 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m18:30:44.992462 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: 
          insert into "postgres"."public"."rugs_usa_variant" ("pid", "variant", "actual_size", "weave_feature", "weave_cat", "size_grp", "shipping_size", "shape", "weight", "price", "msrp", "stock_level", "depletion_level", "low_stock", "estimated_delivery_date", "this_isd_range", "status", "origin", "new_arrival", "stockMsg", "stockEddMsg", "other_stock_core", "other_stock_compass", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m18:30:45.370284 [debug] [Thread-1 (]: SQL status: INSERT 0 8800 in 0.36 seconds
[0m18:30:45.388423 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_variant"
[0m18:30:45.446945 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: COMMIT
[0m18:30:45.461437 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m18:30:45.475381 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: COMMIT
[0m18:30:45.509406 [debug] [Thread-1 (]: SQL status: COMMIT in 0.02 seconds
[0m18:30:45.524563 [debug] [Thread-1 (]: finished collecting timing info
[0m18:30:45.538613 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: Close
[0m18:30:45.559221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc1f2458-a850-46a6-b0ab-b58a371a4fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c0e770>]}
[0m18:30:45.573983 [info ] [Thread-1 (]: 7 of 7 OK loaded seed file public.rugs_usa_variant ............................. [[32mINSERT 38800[0m in 234.00s]
[0m18:30:45.601756 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.rugs_usa_variant
[0m18:30:46.877669 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m18:30:46.878222 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m18:30:47.077114 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.2 seconds
[0m18:30:57.278117 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m18:30:57.279681 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m18:30:57.443490 [debug] [Thread-2 (]: SQL status: INSERT 0 7154 in 0.16 seconds
[0m18:30:57.445964 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m18:30:57.449909 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: COMMIT
[0m18:30:57.450170 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m18:30:57.450394 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: COMMIT
[0m18:30:57.462211 [debug] [Thread-2 (]: SQL status: COMMIT in 0.01 seconds
[0m18:30:57.462922 [debug] [Thread-2 (]: finished collecting timing info
[0m18:30:57.463211 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: Close
[0m18:30:57.463915 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc1f2458-a850-46a6-b0ab-b58a371a4fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffb1366020>]}
[0m18:30:57.464396 [info ] [Thread-2 (]: 5 of 7 OK loaded seed file public.rugs_usa_pads_upsell ......................... [[32mINSERT 97154[0m in 286.13s]
[0m18:30:57.465037 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.rugs_usa_pads_upsell
[0m18:30:57.469191 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:30:57.469575 [debug] [MainThread]: Using postgres connection "master"
[0m18:30:57.469829 [debug] [MainThread]: On master: BEGIN
[0m18:30:57.470081 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:30:57.479640 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:30:57.480089 [debug] [MainThread]: On master: COMMIT
[0m18:30:57.480313 [debug] [MainThread]: Using postgres connection "master"
[0m18:30:57.480531 [debug] [MainThread]: On master: COMMIT
[0m18:30:57.480791 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:30:57.481001 [debug] [MainThread]: On master: Close
[0m18:30:57.482813 [info ] [MainThread]: 
[0m18:30:57.483193 [info ] [MainThread]: Finished running 6 seeds, 1 view model in 0 hours 5 minutes and 28.49 seconds (328.49s).
[0m18:30:57.483552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:30:57.483790 [debug] [MainThread]: Connection 'seed.jaffle_shop.rugs_usa_pads_upsell' was properly closed.
[0m18:30:57.484013 [debug] [MainThread]: Connection 'seed.jaffle_shop.rugs_usa_variant' was properly closed.
[0m18:30:57.494441 [info ] [MainThread]: 
[0m18:30:57.495036 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:30:57.495463 [info ] [MainThread]: 
[0m18:30:57.495753 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m18:30:57.496978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd12095d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd1209780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd120a080>]}


============================== 2024-07-13 20:39:15.721335 | b07524bb-205e-4cad-ba28-2ffd5ffbfee7 ==============================
[0m20:39:15.721672 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:39:15.725577 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m20:39:15.725987 [debug] [MainThread]: Tracking: tracking
[0m20:39:15.742676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c17760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c17370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c174c0>]}
[0m20:39:15.803815 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:39:15.804510 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/below_depletion_level.sql
[0m20:39:15.837544 [debug] [MainThread]: 1699: static parser successfully parsed below_depletion_level.sql
[0m20:39:15.857241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b07524bb-205e-4cad-ba28-2ffd5ffbfee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89cccd0>]}
[0m20:39:15.870504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b07524bb-205e-4cad-ba28-2ffd5ffbfee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b57640>]}
[0m20:39:15.870852 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:39:15.871092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b07524bb-205e-4cad-ba28-2ffd5ffbfee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b576d0>]}
[0m20:39:15.872731 [info ] [MainThread]: 
[0m20:39:15.873294 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m20:39:15.875329 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m20:39:15.883670 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:39:15.883969 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:39:15.884200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:15.946276 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.06 seconds
[0m20:39:15.948078 [debug] [ThreadPool]: On list_postgres: Close
[0m20:39:15.950763 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m20:39:15.955509 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:39:15.955797 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:39:15.956027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:15.963864 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m20:39:15.964198 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:39:15.964425 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:39:15.969861 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m20:39:15.971052 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:39:15.971419 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:39:15.975180 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:15.975408 [debug] [MainThread]: On master: BEGIN
[0m20:39:15.975554 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:39:15.982300 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m20:39:15.982662 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:15.982850 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:39:15.991075 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m20:39:15.992086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b07524bb-205e-4cad-ba28-2ffd5ffbfee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bbe3e0>]}
[0m20:39:15.992368 [debug] [MainThread]: On master: ROLLBACK
[0m20:39:15.992618 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:15.992760 [debug] [MainThread]: On master: BEGIN
[0m20:39:15.993018 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:39:15.993254 [debug] [MainThread]: On master: COMMIT
[0m20:39:15.993416 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:15.993545 [debug] [MainThread]: On master: COMMIT
[0m20:39:15.993758 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:39:15.993922 [debug] [MainThread]: On master: Close
[0m20:39:15.994252 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:39:15.994480 [info ] [MainThread]: 
[0m20:39:15.998156 [debug] [Thread-1 (]: Began running node model.jaffle_shop.below_depletion_level
[0m20:39:15.998272 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.rugs_usa_category_map
[0m20:39:15.998600 [info ] [Thread-1 (]: 1 of 7 START view model public.below_depletion_level ........................... [RUN]
[0m20:39:15.998944 [info ] [Thread-2 (]: 2 of 7 START seed file public.rugs_usa_category_map ............................ [RUN]
[0m20:39:15.999364 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.below_depletion_level"
[0m20:39:15.999753 [debug] [Thread-2 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m20:39:16.000065 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.below_depletion_level
[0m20:39:16.000275 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.rugs_usa_category_map
[0m20:39:16.000484 [debug] [Thread-1 (]: Compiling model.jaffle_shop.below_depletion_level
[0m20:39:16.000813 [debug] [Thread-2 (]: finished collecting timing info
[0m20:39:16.002170 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.below_depletion_level"
[0m20:39:16.002406 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.rugs_usa_category_map
[0m20:39:16.017673 [debug] [Thread-1 (]: finished collecting timing info
[0m20:39:16.018023 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.below_depletion_level
[0m20:39:16.116116 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.below_depletion_level"
[0m20:39:16.170036 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m20:39:16.189015 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: BEGIN
[0m20:39:16.209989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:16.278074 [debug] [Thread-1 (]: SQL status: BEGIN in 0.07 seconds
[0m20:39:16.291812 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m20:39:16.305501 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */

  create view "postgres"."public"."below_depletion_level__dbt_tmp" as (
    select distinct name, ruv.variant
from rugs_usa_variant ruv 
join rugs_usa_parent on rugs_usa_parent.pid = ruv.pid
where stock_level < depletion_level
  );
[0m20:39:16.335254 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.02 seconds
[0m20:39:16.364669 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m20:39:16.385858 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level__dbt_tmp" rename to "below_depletion_level"
[0m20:39:16.413127 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m20:39:16.453657 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m20:39:16.467814 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m20:39:16.481792 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m20:39:16.546358 [debug] [Thread-1 (]: SQL status: COMMIT in 0.04 seconds
[0m20:39:16.578661 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m20:39:16.590453 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
drop view if exists "postgres"."public"."below_depletion_level__dbt_backup" cascade
[0m20:39:16.595739 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m20:39:16.596323 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_category_map: BEGIN
[0m20:39:16.596585 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:39:16.596712 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:39:16.598302 [debug] [Thread-1 (]: finished collecting timing info
[0m20:39:16.598591 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: Close
[0m20:39:16.599262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b07524bb-205e-4cad-ba28-2ffd5ffbfee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb42a020>]}
[0m20:39:16.599707 [info ] [Thread-1 (]: 1 of 7 OK created view model public.below_depletion_level ...................... [[32mCREATE VIEW[0m in 0.60s]
[0m20:39:16.600321 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.below_depletion_level
[0m20:39:16.600678 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.rugs_usa_color_map
[0m20:39:16.601095 [info ] [Thread-1 (]: 3 of 7 START seed file public.rugs_usa_color_map ............................... [RUN]
[0m20:39:16.601532 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m20:39:16.601798 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.rugs_usa_color_map
[0m20:39:16.602001 [debug] [Thread-1 (]: finished collecting timing info
[0m20:39:16.602193 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.rugs_usa_color_map
[0m20:39:16.604818 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m20:39:16.605280 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m20:39:16.605614 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_category_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_category_map"} */
truncate table "postgres"."public"."rugs_usa_category_map"
[0m20:39:16.616674 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.01 seconds
[0m20:39:16.785058 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m20:39:16.806960 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_color_map: BEGIN
[0m20:39:16.820949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:16.862869 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m20:39:16.883909 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m20:39:16.897921 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_color_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_color_map"} */
truncate table "postgres"."public"."rugs_usa_color_map"
[0m20:39:16.921477 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.01 seconds
[0m20:39:26.145379 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m20:39:26.161127 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m20:39:26.298065 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.12 seconds
[0m20:39:26.558608 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m20:39:26.575862 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_color_map: 
          insert into "postgres"."public"."rugs_usa_color_map" ("pid", "color_id", "color_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s...
[0m20:39:26.673413 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.08 seconds
[0m20:39:33.781810 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m20:39:33.795990 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_color_map: 
          insert into "postgres"."public"."rugs_usa_color_map" ("pid", "color_id", "color_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s...
[0m20:39:33.878585 [debug] [Thread-1 (]: SQL status: INSERT 0 7232 in 0.06 seconds
[0m20:39:33.899661 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_color_map"
[0m20:39:33.951323 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_color_map: COMMIT
[0m20:39:33.964997 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m20:39:33.978946 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_color_map: COMMIT
[0m20:39:34.010340 [debug] [Thread-1 (]: SQL status: COMMIT in 0.02 seconds
[0m20:39:34.025243 [debug] [Thread-1 (]: finished collecting timing info
[0m20:39:34.038693 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_color_map: Close
[0m20:39:34.067269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b07524bb-205e-4cad-ba28-2ffd5ffbfee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd16bfa90>]}
[0m20:39:34.080735 [info ] [Thread-1 (]: 3 of 7 OK loaded seed file public.rugs_usa_color_map ........................... [[32mINSERT 17232[0m in 17.47s]
[0m20:39:34.098911 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.rugs_usa_color_map
[0m20:39:34.119999 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.rugs_usa_links
[0m20:39:34.133978 [info ] [Thread-1 (]: 4 of 7 START seed file public.rugs_usa_links ................................... [RUN]
[0m20:39:34.148203 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m20:39:34.162017 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.rugs_usa_links
[0m20:39:34.176009 [debug] [Thread-1 (]: finished collecting timing info
[0m20:39:34.188988 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.rugs_usa_links
[0m20:39:34.353210 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m20:39:34.366582 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_links: BEGIN
[0m20:39:34.380900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:34.434564 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m20:39:34.454744 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m20:39:34.469135 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_links: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_links"} */
truncate table "postgres"."public"."rugs_usa_links"
[0m20:39:34.491980 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.01 seconds
[0m20:39:35.441977 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m20:39:35.463934 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m20:39:35.588686 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.11 seconds
[0m20:39:41.382864 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m20:39:41.398918 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_links: 
          insert into "postgres"."public"."rugs_usa_links" ("base_url", "page_links", "card_links", "request_time_stamp", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s...
[0m20:39:41.524543 [debug] [Thread-1 (]: SQL status: INSERT 0 5565 in 0.11 seconds
[0m20:39:41.547927 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_links"
[0m20:39:41.600814 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_links: COMMIT
[0m20:39:41.621972 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m20:39:41.642905 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_links: COMMIT
[0m20:39:41.668902 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m20:39:41.683977 [debug] [Thread-1 (]: finished collecting timing info
[0m20:39:41.703984 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_links: Close
[0m20:39:41.724608 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b07524bb-205e-4cad-ba28-2ffd5ffbfee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8aa3f70>]}
[0m20:39:41.738509 [info ] [Thread-1 (]: 4 of 7 OK loaded seed file public.rugs_usa_links ............................... [[32mINSERT 5565[0m in 7.58s]
[0m20:39:41.770507 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.rugs_usa_links
[0m20:39:41.799166 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.rugs_usa_pads_upsell
[0m20:39:41.815795 [info ] [Thread-1 (]: 5 of 7 START seed file public.rugs_usa_pads_upsell ............................. [RUN]
[0m20:39:41.837851 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:39:41.850985 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.rugs_usa_pads_upsell
[0m20:39:41.878030 [debug] [Thread-1 (]: finished collecting timing info
[0m20:39:41.898239 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.rugs_usa_pads_upsell
[0m20:39:45.988937 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m20:39:46.004294 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m20:39:46.132727 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.11 seconds
[0m20:39:51.526327 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:39:51.539858 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: BEGIN
[0m20:39:51.553917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:51.597568 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m20:39:51.611910 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:39:51.632923 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_pads_upsell"} */
truncate table "postgres"."public"."rugs_usa_pads_upsell"
[0m20:39:51.665035 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.02 seconds
[0m20:39:56.311409 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m20:39:56.327010 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m20:39:56.445867 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.1 seconds
[0m20:40:06.213149 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m20:40:06.229452 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m20:40:06.337605 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.1 seconds
[0m20:40:07.729983 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m20:40:07.744001 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m20:40:07.773543 [debug] [Thread-2 (]: SQL status: INSERT 0 1265 in 0.02 seconds
[0m20:40:07.790074 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_category_map"
[0m20:40:07.842493 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_category_map: COMMIT
[0m20:40:07.857093 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m20:40:07.871084 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_category_map: COMMIT
[0m20:40:07.898897 [debug] [Thread-2 (]: SQL status: COMMIT in 0.01 seconds
[0m20:40:07.921095 [debug] [Thread-2 (]: finished collecting timing info
[0m20:40:07.934188 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_category_map: Close
[0m20:40:07.964126 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b07524bb-205e-4cad-ba28-2ffd5ffbfee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a042b0>]}
[0m20:40:07.984075 [info ] [Thread-2 (]: 2 of 7 OK loaded seed file public.rugs_usa_category_map ........................ [[32mINSERT 51265[0m in 51.96s]
[0m20:40:08.005322 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.rugs_usa_category_map
[0m20:40:08.019127 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.rugs_usa_parent
[0m20:40:08.033082 [info ] [Thread-2 (]: 6 of 7 START seed file public.rugs_usa_parent .................................. [RUN]
[0m20:40:08.047191 [debug] [Thread-2 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m20:40:08.066636 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.rugs_usa_parent
[0m20:40:08.087965 [debug] [Thread-2 (]: finished collecting timing info
[0m20:40:08.102179 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.rugs_usa_parent
[0m20:40:08.838121 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m20:40:08.852874 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_parent: BEGIN
[0m20:40:08.866911 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:40:08.913353 [debug] [Thread-2 (]: SQL status: BEGIN in 0.04 seconds
[0m20:40:08.927918 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m20:40:08.948161 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_parent: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_parent"} */
truncate table "postgres"."public"."rugs_usa_parent"
[0m20:40:08.978714 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.01 seconds
[0m20:40:20.386275 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:40:20.418945 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m20:40:20.788609 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.35 seconds
[0m20:40:39.382986 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m20:40:39.404810 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_parent: 
          insert into "postgres"."public"."rugs_usa_parent" ("pid", "product_type_id", "name", "url", "origin", "thickness", "material", "weave", "weave_feature", "color", "brand", "imageName", "imageType", "internalName", "category", "min_price", "max_price", "availability", "aggregate", "clearance", "long_description", "shopbyroom", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s...
[0m20:40:39.704276 [debug] [Thread-2 (]: SQL status: INSERT 0 5562 in 0.28 seconds
[0m20:40:39.727461 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_parent"
[0m20:40:39.782088 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_parent: COMMIT
[0m20:40:39.795842 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m20:40:39.809819 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_parent: COMMIT
[0m20:40:39.851809 [debug] [Thread-2 (]: SQL status: COMMIT in 0.02 seconds
[0m20:40:39.873409 [debug] [Thread-2 (]: finished collecting timing info
[0m20:40:39.886850 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_parent: Close
[0m20:40:39.908603 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b07524bb-205e-4cad-ba28-2ffd5ffbfee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89ce470>]}
[0m20:40:39.923216 [info ] [Thread-2 (]: 6 of 7 OK loaded seed file public.rugs_usa_parent .............................. [[32mINSERT 5562[0m in 31.86s]
[0m20:40:39.950950 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.rugs_usa_parent
[0m20:40:39.970809 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.rugs_usa_variant
[0m20:40:39.995466 [info ] [Thread-2 (]: 7 of 7 START seed file public.rugs_usa_variant ................................. [RUN]
[0m20:40:40.014019 [debug] [Thread-2 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m20:40:40.027912 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.rugs_usa_variant
[0m20:40:40.041875 [debug] [Thread-2 (]: finished collecting timing info
[0m20:40:40.055852 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.rugs_usa_variant
[0m20:40:45.248616 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m20:40:45.264218 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_variant: BEGIN
[0m20:40:45.285217 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:40:45.333718 [debug] [Thread-2 (]: SQL status: BEGIN in 0.05 seconds
[0m20:40:45.347151 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m20:40:45.361132 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_variant: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_variant"} */
truncate table "postgres"."public"."rugs_usa_variant"
[0m20:40:45.398242 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.02 seconds
[0m20:40:49.890571 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:40:49.905271 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m20:40:50.269132 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.34 seconds
[0m20:41:20.288288 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:41:20.304800 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m20:41:20.623383 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.3 seconds
[0m20:41:45.734765 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m20:41:45.751062 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_variant: 
          insert into "postgres"."public"."rugs_usa_variant" ("pid", "variant", "actual_size", "weave_feature", "weave_cat", "size_grp", "shipping_size", "shape", "weight", "price", "msrp", "stock_level", "depletion_level", "low_stock", "estimated_delivery_date", "this_isd_range", "status", "origin", "new_arrival", "stockMsg", "stockEddMsg", "other_stock_core", "other_stock_compass", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m20:41:46.347588 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.58 seconds
[0m20:41:50.955074 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:41:50.969005 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m20:41:51.263630 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.28 seconds
[0m20:42:20.666858 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:42:20.683230 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m20:42:21.002909 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.31 seconds
[0m20:42:44.779164 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m20:42:44.801675 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_variant: 
          insert into "postgres"."public"."rugs_usa_variant" ("pid", "variant", "actual_size", "weave_feature", "weave_cat", "size_grp", "shipping_size", "shape", "weight", "price", "msrp", "stock_level", "depletion_level", "low_stock", "estimated_delivery_date", "this_isd_range", "status", "origin", "new_arrival", "stockMsg", "stockEddMsg", "other_stock_core", "other_stock_compass", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m20:42:45.253917 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.44 seconds
[0m20:42:49.915645 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:42:49.935484 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m20:42:50.173984 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.22 seconds
[0m20:43:19.491729 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:43:19.516688 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m20:43:19.825775 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.3 seconds
[0m20:43:42.787106 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m20:43:42.801673 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_variant: 
          insert into "postgres"."public"."rugs_usa_variant" ("pid", "variant", "actual_size", "weave_feature", "weave_cat", "size_grp", "shipping_size", "shape", "weight", "price", "msrp", "stock_level", "depletion_level", "low_stock", "estimated_delivery_date", "this_isd_range", "status", "origin", "new_arrival", "stockMsg", "stockEddMsg", "other_stock_core", "other_stock_compass", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m20:43:43.291390 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.47 seconds
[0m20:43:49.248236 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:43:49.271178 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m20:43:49.519076 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.23 seconds
[0m20:44:19.463260 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:44:19.480275 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m20:44:19.790964 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.3 seconds
[0m20:44:36.015837 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m20:44:36.041423 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_variant: 
          insert into "postgres"."public"."rugs_usa_variant" ("pid", "variant", "actual_size", "weave_feature", "weave_cat", "size_grp", "shipping_size", "shape", "weight", "price", "msrp", "stock_level", "depletion_level", "low_stock", "estimated_delivery_date", "this_isd_range", "status", "origin", "new_arrival", "stockMsg", "stockEddMsg", "other_stock_core", "other_stock_compass", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m20:44:36.456493 [debug] [Thread-2 (]: SQL status: INSERT 0 8800 in 0.4 seconds
[0m20:44:36.483335 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_variant"
[0m20:44:36.547288 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_variant: COMMIT
[0m20:44:36.558919 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m20:44:36.573040 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_variant: COMMIT
[0m20:44:36.620549 [debug] [Thread-2 (]: SQL status: COMMIT in 0.03 seconds
[0m20:44:36.642914 [debug] [Thread-2 (]: finished collecting timing info
[0m20:44:36.656311 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_variant: Close
[0m20:44:36.693512 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b07524bb-205e-4cad-ba28-2ffd5ffbfee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffc38c59f0>]}
[0m20:44:36.715923 [info ] [Thread-2 (]: 7 of 7 OK loaded seed file public.rugs_usa_variant ............................. [[32mINSERT 38800[0m in 236.67s]
[0m20:44:36.744501 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.rugs_usa_variant
[0m20:44:39.297104 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:44:39.299306 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m20:44:39.511718 [debug] [Thread-1 (]: SQL status: INSERT 0 7154 in 0.21 seconds
[0m20:44:39.516991 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:44:39.527098 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: COMMIT
[0m20:44:39.527419 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:44:39.527665 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: COMMIT
[0m20:44:39.549018 [debug] [Thread-1 (]: SQL status: COMMIT in 0.02 seconds
[0m20:44:39.550892 [debug] [Thread-1 (]: finished collecting timing info
[0m20:44:39.551229 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: Close
[0m20:44:39.552663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b07524bb-205e-4cad-ba28-2ffd5ffbfee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd123fac0>]}
[0m20:44:39.553288 [info ] [Thread-1 (]: 5 of 7 OK loaded seed file public.rugs_usa_pads_upsell ......................... [[32mINSERT 97154[0m in 297.71s]
[0m20:44:39.554253 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.rugs_usa_pads_upsell
[0m20:44:39.568417 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m20:44:39.569201 [debug] [MainThread]: Using postgres connection "master"
[0m20:44:39.569712 [debug] [MainThread]: On master: BEGIN
[0m20:44:39.570024 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:44:39.583402 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m20:44:39.584663 [debug] [MainThread]: On master: COMMIT
[0m20:44:39.585013 [debug] [MainThread]: Using postgres connection "master"
[0m20:44:39.585357 [debug] [MainThread]: On master: COMMIT
[0m20:44:39.585860 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:44:39.586143 [debug] [MainThread]: On master: Close
[0m20:44:39.590158 [info ] [MainThread]: 
[0m20:44:39.590817 [info ] [MainThread]: Finished running 1 view model, 6 seeds in 0 hours 5 minutes and 23.71 seconds (323.71s).
[0m20:44:39.591206 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:44:39.591498 [debug] [MainThread]: Connection 'seed.jaffle_shop.rugs_usa_variant' was properly closed.
[0m20:44:39.591747 [debug] [MainThread]: Connection 'seed.jaffle_shop.rugs_usa_pads_upsell' was properly closed.
[0m20:44:39.614605 [info ] [MainThread]: 
[0m20:44:39.615118 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:44:39.615819 [info ] [MainThread]: 
[0m20:44:39.616306 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m20:44:39.617365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89f0ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b57280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffb99cf1c0>]}


============================== 2024-07-13 20:51:04.148758 | fd95bc75-f906-4e39-8ab8-5a43cc59aa43 ==============================
[0m20:51:04.149069 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:51:04.154617 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m20:51:04.154931 [debug] [MainThread]: Tracking: tracking
[0m20:51:04.170644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2af50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b220>]}
[0m20:51:04.218805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m20:51:04.219327 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/priority_order.sql
[0m20:51:04.219661 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/below_depletion_level.sql
[0m20:51:04.259654 [debug] [MainThread]: 1699: static parser successfully parsed priority_order.sql
[0m20:51:04.271827 [debug] [MainThread]: 1699: static parser successfully parsed below_depletion_level.sql
[0m20:51:04.283823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd95bc75-f906-4e39-8ab8-5a43cc59aa43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89cd0f0>]}
[0m20:51:04.294234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd95bc75-f906-4e39-8ab8-5a43cc59aa43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b5f700>]}
[0m20:51:04.294647 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:51:04.295002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd95bc75-f906-4e39-8ab8-5a43cc59aa43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b5f7f0>]}
[0m20:51:04.296713 [info ] [MainThread]: 
[0m20:51:04.297306 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m20:51:04.299217 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m20:51:04.307622 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:51:04.307959 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:51:04.308201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:04.358288 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.05 seconds
[0m20:51:04.360088 [debug] [ThreadPool]: On list_postgres: Close
[0m20:51:04.363175 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m20:51:04.368203 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:51:04.368488 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:51:04.368709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:04.375831 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m20:51:04.376177 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:51:04.376417 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:51:04.379888 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m20:51:04.381152 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:51:04.381500 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:51:04.385357 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:04.385660 [debug] [MainThread]: On master: BEGIN
[0m20:51:04.385871 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:51:04.394711 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m20:51:04.395034 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:04.395257 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:51:04.399545 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m20:51:04.400672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd95bc75-f906-4e39-8ab8-5a43cc59aa43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bbe800>]}
[0m20:51:04.401038 [debug] [MainThread]: On master: ROLLBACK
[0m20:51:04.401319 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:04.401520 [debug] [MainThread]: On master: BEGIN
[0m20:51:04.401849 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:51:04.402109 [debug] [MainThread]: On master: COMMIT
[0m20:51:04.402306 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:04.402497 [debug] [MainThread]: On master: COMMIT
[0m20:51:04.402742 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:51:04.402957 [debug] [MainThread]: On master: Close
[0m20:51:04.403371 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:51:04.403683 [info ] [MainThread]: 
[0m20:51:04.407156 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.rugs_usa_category_map
[0m20:51:04.407277 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.rugs_usa_color_map
[0m20:51:04.407597 [info ] [Thread-1 (]: 1 of 8 START seed file public.rugs_usa_category_map ............................ [RUN]
[0m20:51:04.407925 [info ] [Thread-2 (]: 2 of 8 START seed file public.rugs_usa_color_map ............................... [RUN]
[0m20:51:04.408365 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m20:51:04.408734 [debug] [Thread-2 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m20:51:04.409044 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.rugs_usa_category_map
[0m20:51:04.409269 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.rugs_usa_color_map
[0m20:51:04.409584 [debug] [Thread-1 (]: finished collecting timing info
[0m20:51:04.409826 [debug] [Thread-2 (]: finished collecting timing info
[0m20:51:04.410089 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.rugs_usa_category_map
[0m20:51:04.410372 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.rugs_usa_color_map
[0m20:51:04.744270 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m20:51:04.758541 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: BEGIN
[0m20:51:04.772367 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:51:04.838475 [debug] [Thread-2 (]: SQL status: BEGIN in 0.07 seconds
[0m20:51:04.852369 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m20:51:04.866574 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_color_map"} */
truncate table "postgres"."public"."rugs_usa_color_map"
[0m20:51:04.892464 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.01 seconds
[0m20:51:04.986256 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m20:51:05.000371 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: BEGIN
[0m20:51:05.013332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:05.053350 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m20:51:05.072328 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m20:51:05.093668 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_category_map"} */
truncate table "postgres"."public"."rugs_usa_category_map"
[0m20:51:05.133389 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.01 seconds
[0m20:51:14.374680 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m20:51:14.395173 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: 
          insert into "postgres"."public"."rugs_usa_color_map" ("pid", "color_id", "color_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s...
[0m20:51:14.477567 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.07 seconds
[0m20:51:14.718235 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m20:51:14.736143 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m20:51:14.810774 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.06 seconds
[0m20:51:21.704843 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m20:51:21.721317 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: 
          insert into "postgres"."public"."rugs_usa_color_map" ("pid", "color_id", "color_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s...
[0m20:51:21.786383 [debug] [Thread-2 (]: SQL status: INSERT 0 7232 in 0.05 seconds
[0m20:51:21.825338 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_color_map"
[0m20:51:21.912623 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: COMMIT
[0m20:51:21.934222 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m20:51:21.948358 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: COMMIT
[0m20:51:21.974413 [debug] [Thread-2 (]: SQL status: COMMIT in 0.01 seconds
[0m20:51:21.989524 [debug] [Thread-2 (]: finished collecting timing info
[0m20:51:22.011140 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: Close
[0m20:51:22.033103 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd95bc75-f906-4e39-8ab8-5a43cc59aa43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a0c310>]}
[0m20:51:22.056345 [info ] [Thread-2 (]: 2 of 8 OK loaded seed file public.rugs_usa_color_map ........................... [[32mINSERT 17232[0m in 17.62s]
[0m20:51:22.085835 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.rugs_usa_color_map
[0m20:51:22.106901 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.rugs_usa_links
[0m20:51:22.293514 [info ] [Thread-2 (]: 3 of 8 START seed file public.rugs_usa_links ................................... [RUN]
[0m20:51:22.335694 [debug] [Thread-2 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m20:51:22.379818 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.rugs_usa_links
[0m20:51:22.400637 [debug] [Thread-2 (]: finished collecting timing info
[0m20:51:22.420175 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.rugs_usa_links
[0m20:51:22.689590 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m20:51:22.704182 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: BEGIN
[0m20:51:22.725202 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:51:22.779800 [debug] [Thread-2 (]: SQL status: BEGIN in 0.05 seconds
[0m20:51:22.801189 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m20:51:22.815196 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_links"} */
truncate table "postgres"."public"."rugs_usa_links"
[0m20:51:22.851168 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.01 seconds
[0m20:51:24.830971 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m20:51:24.845090 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m20:51:24.946662 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.09 seconds
[0m20:51:29.909114 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m20:51:29.925348 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: 
          insert into "postgres"."public"."rugs_usa_links" ("base_url", "page_links", "card_links", "request_time_stamp", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s...
[0m20:51:30.009005 [debug] [Thread-2 (]: SQL status: INSERT 0 5565 in 0.07 seconds
[0m20:51:30.024185 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_links"
[0m20:51:30.101885 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: COMMIT
[0m20:51:30.116338 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m20:51:30.130210 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: COMMIT
[0m20:51:30.157279 [debug] [Thread-2 (]: SQL status: COMMIT in 0.01 seconds
[0m20:51:30.172284 [debug] [Thread-2 (]: finished collecting timing info
[0m20:51:30.186301 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: Close
[0m20:51:30.214824 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd95bc75-f906-4e39-8ab8-5a43cc59aa43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd036f610>]}
[0m20:51:30.228874 [info ] [Thread-2 (]: 3 of 8 OK loaded seed file public.rugs_usa_links ............................... [[32mINSERT 5565[0m in 7.88s]
[0m20:51:30.248741 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.rugs_usa_links
[0m20:51:30.268427 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.rugs_usa_pads_upsell
[0m20:51:30.282937 [info ] [Thread-2 (]: 4 of 8 START seed file public.rugs_usa_pads_upsell ............................. [RUN]
[0m20:51:30.297461 [debug] [Thread-2 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:51:30.311357 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.rugs_usa_pads_upsell
[0m20:51:30.332435 [debug] [Thread-2 (]: finished collecting timing info
[0m20:51:30.353341 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.rugs_usa_pads_upsell
[0m20:51:34.660145 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m20:51:34.675195 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m20:51:34.769640 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.07 seconds
[0m20:51:37.516713 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:51:37.539227 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: BEGIN
[0m20:51:37.553379 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:51:37.596103 [debug] [Thread-2 (]: SQL status: BEGIN in 0.04 seconds
[0m20:51:37.609761 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:51:37.629912 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_pads_upsell"} */
truncate table "postgres"."public"."rugs_usa_pads_upsell"
[0m20:51:37.653355 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.01 seconds
[0m20:51:44.453594 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m20:51:44.467402 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m20:51:44.553272 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.07 seconds
[0m20:51:54.179421 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m20:51:54.195529 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m20:51:54.283171 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.07 seconds
[0m20:51:55.818212 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m20:51:55.833480 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m20:51:55.868617 [debug] [Thread-1 (]: SQL status: INSERT 0 1265 in 0.02 seconds
[0m20:51:55.884096 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_category_map"
[0m20:51:55.942725 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: COMMIT
[0m20:51:55.957365 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m20:51:55.978436 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: COMMIT
[0m20:51:56.016132 [debug] [Thread-1 (]: SQL status: COMMIT in 0.02 seconds
[0m20:51:56.031489 [debug] [Thread-1 (]: finished collecting timing info
[0m20:51:56.045114 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: Close
[0m20:51:56.068759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd95bc75-f906-4e39-8ab8-5a43cc59aa43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a3bf70>]}
[0m20:51:56.082824 [info ] [Thread-1 (]: 1 of 8 OK loaded seed file public.rugs_usa_category_map ........................ [[32mINSERT 51265[0m in 51.66s]
[0m20:51:56.104644 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.rugs_usa_category_map
[0m20:51:56.118711 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.rugs_usa_parent
[0m20:51:56.132775 [info ] [Thread-1 (]: 5 of 8 START seed file public.rugs_usa_parent .................................. [RUN]
[0m20:51:56.146812 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m20:51:56.167556 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.rugs_usa_parent
[0m20:51:56.181483 [debug] [Thread-1 (]: finished collecting timing info
[0m20:51:56.202469 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.rugs_usa_parent
[0m20:51:56.809659 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m20:51:56.823462 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: BEGIN
[0m20:51:56.844416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:56.886800 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m20:51:56.901412 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m20:51:56.914944 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_parent"} */
truncate table "postgres"."public"."rugs_usa_parent"
[0m20:51:56.938594 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.01 seconds
[0m20:52:08.884251 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:52:08.907652 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m20:52:09.748189 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.83 seconds
[0m20:52:30.949720 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m20:52:30.972140 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: 
          insert into "postgres"."public"."rugs_usa_parent" ("pid", "product_type_id", "name", "url", "origin", "thickness", "material", "weave", "weave_feature", "color", "brand", "imageName", "imageType", "internalName", "category", "min_price", "max_price", "availability", "aggregate", "clearance", "long_description", "shopbyroom", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s...
[0m20:52:31.358176 [debug] [Thread-1 (]: SQL status: INSERT 0 5562 in 0.37 seconds
[0m20:52:31.374339 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_parent"
[0m20:52:31.437029 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: COMMIT
[0m20:52:31.456046 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m20:52:31.484099 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: COMMIT
[0m20:52:31.518076 [debug] [Thread-1 (]: SQL status: COMMIT in 0.02 seconds
[0m20:52:31.532853 [debug] [Thread-1 (]: finished collecting timing info
[0m20:52:31.553822 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: Close
[0m20:52:31.582614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd95bc75-f906-4e39-8ab8-5a43cc59aa43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffef1ff70>]}
[0m20:52:31.597412 [info ] [Thread-1 (]: 5 of 8 OK loaded seed file public.rugs_usa_parent .............................. [[32mINSERT 5562[0m in 35.44s]
[0m20:52:31.618214 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.rugs_usa_parent
[0m20:52:31.632123 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.rugs_usa_variant
[0m20:52:31.646134 [info ] [Thread-1 (]: 6 of 8 START seed file public.rugs_usa_variant ................................. [RUN]
[0m20:52:31.659107 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m20:52:31.673082 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.rugs_usa_variant
[0m20:52:31.685968 [debug] [Thread-1 (]: finished collecting timing info
[0m20:52:31.699249 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.rugs_usa_variant
[0m20:52:36.578933 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m20:52:36.595010 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: BEGIN
[0m20:52:36.607759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:36.646969 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m20:52:36.661014 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m20:52:36.682000 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_variant"} */
truncate table "postgres"."public"."rugs_usa_variant"
[0m20:52:36.710005 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.01 seconds
[0m20:52:38.938132 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:52:38.959137 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m20:52:39.282112 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.31 seconds
[0m20:53:08.237874 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:53:08.260370 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m20:53:08.647698 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.37 seconds
[0m20:53:33.937777 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m20:53:33.953581 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: 
          insert into "postgres"."public"."rugs_usa_variant" ("pid", "variant", "actual_size", "weave_feature", "weave_cat", "size_grp", "shipping_size", "shape", "weight", "price", "msrp", "stock_level", "depletion_level", "low_stock", "estimated_delivery_date", "this_isd_range", "status", "origin", "new_arrival", "stockMsg", "stockEddMsg", "other_stock_core", "other_stock_compass", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m20:53:34.477014 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.51 seconds
[0m20:53:37.295598 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:53:37.309385 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m20:53:37.527828 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.2 seconds
[0m20:54:07.685325 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:54:07.701662 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m20:54:07.955105 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.24 seconds
[0m20:54:36.709101 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m20:54:36.734181 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: 
          insert into "postgres"."public"."rugs_usa_variant" ("pid", "variant", "actual_size", "weave_feature", "weave_cat", "size_grp", "shipping_size", "shape", "weight", "price", "msrp", "stock_level", "depletion_level", "low_stock", "estimated_delivery_date", "this_isd_range", "status", "origin", "new_arrival", "stockMsg", "stockEddMsg", "other_stock_core", "other_stock_compass", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m20:54:37.273359 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.52 seconds
[0m20:54:40.820644 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:54:40.843998 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m20:54:41.126230 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.27 seconds
[0m20:55:11.982216 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:55:12.005980 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m20:55:12.329383 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.3 seconds
[0m20:55:40.596645 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m20:55:40.612525 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: 
          insert into "postgres"."public"."rugs_usa_variant" ("pid", "variant", "actual_size", "weave_feature", "weave_cat", "size_grp", "shipping_size", "shape", "weight", "price", "msrp", "stock_level", "depletion_level", "low_stock", "estimated_delivery_date", "this_isd_range", "status", "origin", "new_arrival", "stockMsg", "stockEddMsg", "other_stock_core", "other_stock_compass", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m20:55:41.105830 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.48 seconds
[0m20:55:43.941051 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:55:43.955843 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m20:55:44.201095 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.23 seconds
[0m20:56:17.903408 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:56:17.926372 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m20:56:18.205434 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.27 seconds
[0m20:56:38.353884 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m20:56:38.387123 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: 
          insert into "postgres"."public"."rugs_usa_variant" ("pid", "variant", "actual_size", "weave_feature", "weave_cat", "size_grp", "shipping_size", "shape", "weight", "price", "msrp", "stock_level", "depletion_level", "low_stock", "estimated_delivery_date", "this_isd_range", "status", "origin", "new_arrival", "stockMsg", "stockEddMsg", "other_stock_core", "other_stock_compass", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m20:56:38.781965 [debug] [Thread-1 (]: SQL status: INSERT 0 8800 in 0.38 seconds
[0m20:56:38.800833 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_variant"
[0m20:56:38.867540 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: COMMIT
[0m20:56:38.882344 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m20:56:38.896392 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: COMMIT
[0m20:56:38.945236 [debug] [Thread-1 (]: SQL status: COMMIT in 0.03 seconds
[0m20:56:38.966926 [debug] [Thread-1 (]: finished collecting timing info
[0m20:56:38.988510 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: Close
[0m20:56:39.010300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd95bc75-f906-4e39-8ab8-5a43cc59aa43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffc0689720>]}
[0m20:56:39.031885 [info ] [Thread-1 (]: 6 of 8 OK loaded seed file public.rugs_usa_variant ............................. [[32mINSERT 38800[0m in 247.35s]
[0m20:56:39.062840 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.rugs_usa_variant
[0m20:56:39.097834 [debug] [Thread-1 (]: Began running node model.jaffle_shop.below_depletion_level
[0m20:56:39.126859 [info ] [Thread-1 (]: 7 of 8 START view model public.below_depletion_level ........................... [RUN]
[0m20:56:39.162588 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.below_depletion_level"
[0m20:56:39.182708 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.below_depletion_level
[0m20:56:39.205045 [debug] [Thread-1 (]: Compiling model.jaffle_shop.below_depletion_level
[0m20:56:39.232818 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.below_depletion_level"
[0m20:56:39.284267 [debug] [Thread-1 (]: finished collecting timing info
[0m20:56:39.306613 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.below_depletion_level
[0m20:56:39.377690 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.below_depletion_level"
[0m20:56:39.431340 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m20:56:39.451374 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: BEGIN
[0m20:56:39.472362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:39.520413 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m20:56:39.534393 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m20:56:39.554319 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */

  create view "postgres"."public"."below_depletion_level__dbt_tmp" as (
    select distinct name, ruv.variant
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where stock_level < depletion_level
  );
[0m20:56:39.584997 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.02 seconds
[0m20:56:39.612057 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m20:56:39.633366 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level" rename to "below_depletion_level__dbt_backup"
[0m20:56:39.655429 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m20:56:39.678177 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m20:56:39.698428 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level__dbt_tmp" rename to "below_depletion_level"
[0m20:56:39.718254 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m20:56:39.742871 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m20:56:39.756277 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m20:56:39.774091 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m20:56:39.800281 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m20:56:39.818850 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m20:56:39.833224 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
drop view if exists "postgres"."public"."below_depletion_level__dbt_backup" cascade
[0m20:56:39.857101 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m20:56:39.878044 [debug] [Thread-1 (]: finished collecting timing info
[0m20:56:39.899428 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: Close
[0m20:56:39.920327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd95bc75-f906-4e39-8ab8-5a43cc59aa43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bf4700>]}
[0m20:56:39.932577 [info ] [Thread-1 (]: 7 of 8 OK created view model public.below_depletion_level ...................... [[32mCREATE VIEW[0m in 0.76s]
[0m20:56:39.951934 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.below_depletion_level
[0m20:56:39.962134 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:56:39.962580 [debug] [Thread-1 (]: Began running node model.jaffle_shop.priority_order
[0m20:56:39.962826 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m20:56:39.963125 [info ] [Thread-1 (]: 8 of 8 START view model public.priority_order .................................. [RUN]
[0m20:56:40.054987 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.priority_order"
[0m20:56:40.056043 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.priority_order
[0m20:56:40.056491 [debug] [Thread-1 (]: Compiling model.jaffle_shop.priority_order
[0m20:56:40.061803 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.priority_order"
[0m20:56:40.063105 [debug] [Thread-1 (]: finished collecting timing info
[0m20:56:40.063381 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.priority_order
[0m20:56:40.067846 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.priority_order"
[0m20:56:40.068976 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m20:56:40.069143 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: BEGIN
[0m20:56:40.069291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:40.088474 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m20:56:40.089311 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m20:56:40.089583 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */

  create view "postgres"."public"."priority_order__dbt_tmp" as (
    select rup.name as product_name, ruv.variant as variant, (msrp - price) as profit 
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
join "postgres"."public"."below_depletion_level" bdl on bdl.name = rup.name and bdl.variant = ruv.variant
order by profit desc;
  );
[0m20:56:40.091846 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 8: order by profit desc;
                            ^

[0m20:56:40.092255 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: ROLLBACK
[0m20:56:40.092830 [debug] [Thread-1 (]: finished collecting timing info
[0m20:56:40.093101 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: Close
[0m20:56:40.093708 [debug] [Thread-1 (]: Database Error in model priority_order (models/priority_order.sql)
  syntax error at or near ";"
  LINE 8: order by profit desc;
                              ^
  compiled SQL at target/run/jaffle_shop/models/priority_order.sql
[0m20:56:40.094361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd95bc75-f906-4e39-8ab8-5a43cc59aa43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd0e5f880>]}
[0m20:56:40.095086 [error] [Thread-1 (]: 8 of 8 ERROR creating view model public.priority_order ......................... [[31mERROR[0m in 0.04s]
[0m20:56:40.095870 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.priority_order
[0m20:56:40.184885 [debug] [Thread-2 (]: SQL status: INSERT 0 7154 in 0.22 seconds
[0m20:56:40.188682 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:56:40.197830 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: COMMIT
[0m20:56:40.198383 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:56:40.198674 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: COMMIT
[0m20:56:40.216738 [debug] [Thread-2 (]: SQL status: COMMIT in 0.02 seconds
[0m20:56:40.218033 [debug] [Thread-2 (]: finished collecting timing info
[0m20:56:40.218488 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: Close
[0m20:56:40.219458 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd95bc75-f906-4e39-8ab8-5a43cc59aa43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c36380>]}
[0m20:56:40.220089 [info ] [Thread-2 (]: 4 of 8 OK loaded seed file public.rugs_usa_pads_upsell ......................... [[32mINSERT 97154[0m in 309.92s]
[0m20:56:40.221191 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.rugs_usa_pads_upsell
[0m20:56:40.238780 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m20:56:40.243509 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:40.245214 [debug] [MainThread]: On master: BEGIN
[0m20:56:40.246710 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:56:40.267791 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m20:56:40.268917 [debug] [MainThread]: On master: COMMIT
[0m20:56:40.271341 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:40.274621 [debug] [MainThread]: On master: COMMIT
[0m20:56:40.276718 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:56:40.278092 [debug] [MainThread]: On master: Close
[0m20:56:40.281112 [info ] [MainThread]: 
[0m20:56:40.282004 [info ] [MainThread]: Finished running 6 seeds, 2 view models in 0 hours 5 minutes and 35.98 seconds (335.98s).
[0m20:56:40.282543 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:56:40.284442 [debug] [MainThread]: Connection 'seed.jaffle_shop.rugs_usa_pads_upsell' was properly closed.
[0m20:56:40.284965 [debug] [MainThread]: Connection 'model.jaffle_shop.priority_order' was properly closed.
[0m20:56:40.315791 [info ] [MainThread]: 
[0m20:56:40.329246 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:56:40.330731 [info ] [MainThread]: 
[0m20:56:40.335812 [error] [MainThread]: [33mDatabase Error in model priority_order (models/priority_order.sql)[0m
[0m20:56:40.336254 [error] [MainThread]:   syntax error at or near ";"
[0m20:56:40.336545 [error] [MainThread]:   LINE 8: order by profit desc;
[0m20:56:40.336842 [error] [MainThread]:                               ^
[0m20:56:40.337147 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/priority_order.sql
[0m20:56:40.337537 [info ] [MainThread]: 
[0m20:56:40.337892 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m20:56:40.338584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd0b0cf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b5f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae67a0>]}


============================== 2024-07-13 20:57:59.728229 | 0a0662ca-4e3d-4d35-a5e4-7116f0d12c78 ==============================
[0m20:57:59.728598 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:57:59.734187 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:57:59.734736 [debug] [MainThread]: Tracking: tracking
[0m20:57:59.750686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b280>]}
[0m20:57:59.795470 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:57:59.796175 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/priority_order.sql
[0m20:57:59.833316 [debug] [MainThread]: 1699: static parser successfully parsed priority_order.sql
[0m20:57:59.852542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a0662ca-4e3d-4d35-a5e4-7116f0d12c78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89c9000>]}
[0m20:57:59.862655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a0662ca-4e3d-4d35-a5e4-7116f0d12c78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b60f10>]}
[0m20:57:59.863145 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:57:59.863460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a0662ca-4e3d-4d35-a5e4-7116f0d12c78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b63a00>]}
[0m20:57:59.864928 [info ] [MainThread]: 
[0m20:57:59.865538 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m20:57:59.867217 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m20:57:59.875674 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:57:59.876000 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:57:59.876231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:59.922517 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.05 seconds
[0m20:57:59.924249 [debug] [ThreadPool]: On list_postgres: Close
[0m20:57:59.926785 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m20:57:59.931575 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:57:59.931876 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:57:59.932116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:59.939005 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m20:57:59.939339 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:57:59.939578 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:57:59.942515 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m20:57:59.943765 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:57:59.944153 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:57:59.948002 [debug] [MainThread]: Using postgres connection "master"
[0m20:57:59.948333 [debug] [MainThread]: On master: BEGIN
[0m20:57:59.948560 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:57:59.954645 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m20:57:59.955011 [debug] [MainThread]: Using postgres connection "master"
[0m20:57:59.955262 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:57:59.959318 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m20:57:59.960438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a0662ca-4e3d-4d35-a5e4-7116f0d12c78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89ca5f0>]}
[0m20:57:59.960798 [debug] [MainThread]: On master: ROLLBACK
[0m20:57:59.961127 [debug] [MainThread]: Using postgres connection "master"
[0m20:57:59.961356 [debug] [MainThread]: On master: BEGIN
[0m20:57:59.961701 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:57:59.961942 [debug] [MainThread]: On master: COMMIT
[0m20:57:59.962149 [debug] [MainThread]: Using postgres connection "master"
[0m20:57:59.962354 [debug] [MainThread]: On master: COMMIT
[0m20:57:59.962609 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:57:59.962811 [debug] [MainThread]: On master: Close
[0m20:57:59.963183 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:57:59.963481 [info ] [MainThread]: 
[0m20:57:59.966691 [debug] [Thread-1 (]: Began running node model.jaffle_shop.below_depletion_level
[0m20:57:59.967051 [info ] [Thread-1 (]: 1 of 2 START view model public.below_depletion_level ........................... [RUN]
[0m20:57:59.967564 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.below_depletion_level"
[0m20:57:59.967952 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.below_depletion_level
[0m20:57:59.968198 [debug] [Thread-1 (]: Compiling model.jaffle_shop.below_depletion_level
[0m20:57:59.970541 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.below_depletion_level"
[0m20:57:59.972482 [debug] [Thread-1 (]: finished collecting timing info
[0m20:57:59.972724 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.below_depletion_level
[0m20:58:00.003286 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.below_depletion_level"
[0m20:58:00.005242 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m20:58:00.005480 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: BEGIN
[0m20:58:00.005703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:00.012154 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:58:00.012475 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m20:58:00.012690 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */

  create view "postgres"."public"."below_depletion_level__dbt_tmp" as (
    select distinct name, ruv.variant
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where stock_level < depletion_level
  );
[0m20:58:00.016823 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:58:00.025040 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m20:58:00.026547 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level" rename to "below_depletion_level__dbt_backup"
[0m20:58:00.029378 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:58:00.038962 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m20:58:00.040086 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level__dbt_tmp" rename to "below_depletion_level"
[0m20:58:00.041957 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:58:00.080419 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m20:58:00.081038 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m20:58:00.081315 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m20:58:00.083290 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:58:00.087814 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m20:58:00.088279 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
drop view if exists "postgres"."public"."below_depletion_level__dbt_backup" cascade
[0m20:58:00.090243 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:58:00.091566 [debug] [Thread-1 (]: finished collecting timing info
[0m20:58:00.091857 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: Close
[0m20:58:00.092554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a0662ca-4e3d-4d35-a5e4-7116f0d12c78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a5e020>]}
[0m20:58:00.093074 [info ] [Thread-1 (]: 1 of 2 OK created view model public.below_depletion_level ...................... [[32mCREATE VIEW[0m in 0.12s]
[0m20:58:00.093930 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.below_depletion_level
[0m20:58:00.095718 [debug] [Thread-2 (]: Began running node model.jaffle_shop.priority_order
[0m20:58:00.096129 [info ] [Thread-2 (]: 2 of 2 START view model public.priority_order .................................. [RUN]
[0m20:58:00.096662 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.priority_order"
[0m20:58:00.096947 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.priority_order
[0m20:58:00.097185 [debug] [Thread-2 (]: Compiling model.jaffle_shop.priority_order
[0m20:58:00.101166 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.priority_order"
[0m20:58:00.103473 [debug] [Thread-2 (]: finished collecting timing info
[0m20:58:00.103819 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.priority_order
[0m20:58:00.106998 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.priority_order"
[0m20:58:00.108002 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m20:58:00.108222 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: BEGIN
[0m20:58:00.108422 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:58:00.114917 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m20:58:00.115480 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m20:58:00.115758 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */

  create view "postgres"."public"."priority_order__dbt_tmp" as (
    select rup.name as product_name, ruv.variant as variant, (msrp - price) as profit 
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
join "postgres"."public"."below_depletion_level" bdl on bdl.name = rup.name and bdl.variant = ruv.variant
order by profit desc
  );
[0m20:58:00.119126 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:58:00.121150 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m20:58:00.121383 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
alter table "postgres"."public"."priority_order__dbt_tmp" rename to "priority_order"
[0m20:58:00.121897 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:58:00.123055 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: COMMIT
[0m20:58:00.123279 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m20:58:00.123482 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: COMMIT
[0m20:58:00.123991 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m20:58:00.125289 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m20:58:00.125488 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
drop view if exists "postgres"."public"."priority_order__dbt_backup" cascade
[0m20:58:00.125804 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:58:00.126640 [debug] [Thread-2 (]: finished collecting timing info
[0m20:58:00.126866 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: Close
[0m20:58:00.127292 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a0662ca-4e3d-4d35-a5e4-7116f0d12c78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a4e5c0>]}
[0m20:58:00.127676 [info ] [Thread-2 (]: 2 of 2 OK created view model public.priority_order ............................. [[32mCREATE VIEW[0m in 0.03s]
[0m20:58:00.128071 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.priority_order
[0m20:58:00.129178 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m20:58:00.129450 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:00.129668 [debug] [MainThread]: On master: BEGIN
[0m20:58:00.129873 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:58:00.136362 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m20:58:00.136737 [debug] [MainThread]: On master: COMMIT
[0m20:58:00.136960 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:00.137173 [debug] [MainThread]: On master: COMMIT
[0m20:58:00.137441 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:58:00.137656 [debug] [MainThread]: On master: Close
[0m20:58:00.138273 [info ] [MainThread]: 
[0m20:58:00.138571 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m20:58:00.138856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:58:00.139238 [debug] [MainThread]: Connection 'model.jaffle_shop.priority_order' was properly closed.
[0m20:58:00.139496 [debug] [MainThread]: Connection 'model.jaffle_shop.below_depletion_level' was properly closed.
[0m20:58:00.145552 [info ] [MainThread]: 
[0m20:58:00.145880 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:58:00.146233 [info ] [MainThread]: 
[0m20:58:00.146525 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:58:00.146879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a7f8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a99660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a99d20>]}


============================== 2024-07-13 20:58:56.025072 | 80f8c57f-54de-4529-9527-c6d8bfa6c66c ==============================
[0m20:58:56.025649 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:58:56.033741 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:58:56.034171 [debug] [MainThread]: Tracking: tracking
[0m20:58:56.053875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b280>]}
[0m20:58:56.097585 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:58:56.098250 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/priority_order.sql
[0m20:58:56.135589 [debug] [MainThread]: 1699: static parser successfully parsed priority_order.sql
[0m20:58:56.155102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80f8c57f-54de-4529-9527-c6d8bfa6c66c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89c9000>]}
[0m20:58:56.164372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80f8c57f-54de-4529-9527-c6d8bfa6c66c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b60f10>]}
[0m20:58:56.164773 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:58:56.165103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80f8c57f-54de-4529-9527-c6d8bfa6c66c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b63a00>]}
[0m20:58:56.166557 [info ] [MainThread]: 
[0m20:58:56.167149 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m20:58:56.168883 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m20:58:56.177417 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:58:56.177739 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:58:56.177960 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:56.223164 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.05 seconds
[0m20:58:56.224910 [debug] [ThreadPool]: On list_postgres: Close
[0m20:58:56.227364 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m20:58:56.232138 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:58:56.232436 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:58:56.232675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:56.239898 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m20:58:56.240219 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:58:56.240528 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:58:56.243455 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m20:58:56.244687 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:58:56.245064 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:58:56.248902 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:56.249214 [debug] [MainThread]: On master: BEGIN
[0m20:58:56.249440 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:58:56.255699 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m20:58:56.256009 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:56.256266 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:58:56.260073 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m20:58:56.261307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80f8c57f-54de-4529-9527-c6d8bfa6c66c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89ca5f0>]}
[0m20:58:56.261689 [debug] [MainThread]: On master: ROLLBACK
[0m20:58:56.262006 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:56.262236 [debug] [MainThread]: On master: BEGIN
[0m20:58:56.262706 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:58:56.262977 [debug] [MainThread]: On master: COMMIT
[0m20:58:56.263203 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:56.263419 [debug] [MainThread]: On master: COMMIT
[0m20:58:56.263714 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:58:56.263938 [debug] [MainThread]: On master: Close
[0m20:58:56.264331 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:58:56.264655 [info ] [MainThread]: 
[0m20:58:56.268031 [debug] [Thread-1 (]: Began running node model.jaffle_shop.below_depletion_level
[0m20:58:56.268421 [info ] [Thread-1 (]: 1 of 2 START view model public.below_depletion_level ........................... [RUN]
[0m20:58:56.268924 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.below_depletion_level"
[0m20:58:56.269281 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.below_depletion_level
[0m20:58:56.269556 [debug] [Thread-1 (]: Compiling model.jaffle_shop.below_depletion_level
[0m20:58:56.272094 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.below_depletion_level"
[0m20:58:56.274559 [debug] [Thread-1 (]: finished collecting timing info
[0m20:58:56.274815 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.below_depletion_level
[0m20:58:56.307089 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.below_depletion_level"
[0m20:58:56.309165 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m20:58:56.309446 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: BEGIN
[0m20:58:56.309665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:56.316132 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:58:56.316598 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m20:58:56.316830 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */

  create view "postgres"."public"."below_depletion_level__dbt_tmp" as (
    select distinct name, ruv.variant
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where stock_level < depletion_level
  );
[0m20:58:56.320018 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:58:56.325231 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m20:58:56.325544 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level" rename to "below_depletion_level__dbt_backup"
[0m20:58:56.326288 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:58:56.328129 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m20:58:56.328375 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level__dbt_tmp" rename to "below_depletion_level"
[0m20:58:56.328917 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:58:56.343175 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m20:58:56.343453 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m20:58:56.343703 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m20:58:56.345265 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:58:56.348888 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m20:58:56.349193 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
drop view if exists "postgres"."public"."below_depletion_level__dbt_backup" cascade
[0m20:58:56.351122 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:58:56.352135 [debug] [Thread-1 (]: finished collecting timing info
[0m20:58:56.352416 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: Close
[0m20:58:56.353013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80f8c57f-54de-4529-9527-c6d8bfa6c66c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a5e2f0>]}
[0m20:58:56.353502 [info ] [Thread-1 (]: 1 of 2 OK created view model public.below_depletion_level ...................... [[32mCREATE VIEW[0m in 0.08s]
[0m20:58:56.354206 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.below_depletion_level
[0m20:58:56.355834 [debug] [Thread-2 (]: Began running node model.jaffle_shop.priority_order
[0m20:58:56.356159 [info ] [Thread-2 (]: 2 of 2 START view model public.priority_order .................................. [RUN]
[0m20:58:56.356626 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.priority_order"
[0m20:58:56.356839 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.priority_order
[0m20:58:56.357060 [debug] [Thread-2 (]: Compiling model.jaffle_shop.priority_order
[0m20:58:56.360482 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.priority_order"
[0m20:58:56.361759 [debug] [Thread-2 (]: finished collecting timing info
[0m20:58:56.361991 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.priority_order
[0m20:58:56.364831 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.priority_order"
[0m20:58:56.365832 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m20:58:56.366039 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: BEGIN
[0m20:58:56.366235 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:58:56.372523 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m20:58:56.372867 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m20:58:56.373146 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */

  create view "postgres"."public"."priority_order__dbt_tmp" as (
    select distinct rup.name as product_name, ruv.variant as variant, (msrp - price) as profit 
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
join "postgres"."public"."below_depletion_level" bdl on bdl.name = rup.name and bdl.variant = ruv.variant
order by profit desc
  );
[0m20:58:56.376506 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:58:56.378763 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m20:58:56.379009 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
alter table "postgres"."public"."priority_order__dbt_tmp" rename to "priority_order"
[0m20:58:56.379596 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:58:56.381552 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: COMMIT
[0m20:58:56.381803 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m20:58:56.382025 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: COMMIT
[0m20:58:56.383146 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m20:58:56.384646 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m20:58:56.384960 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
drop view if exists "postgres"."public"."priority_order__dbt_backup" cascade
[0m20:58:56.385333 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:58:56.386229 [debug] [Thread-2 (]: finished collecting timing info
[0m20:58:56.386480 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: Close
[0m20:58:56.386948 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80f8c57f-54de-4529-9527-c6d8bfa6c66c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a7f670>]}
[0m20:58:56.387334 [info ] [Thread-2 (]: 2 of 2 OK created view model public.priority_order ............................. [[32mCREATE VIEW[0m in 0.03s]
[0m20:58:56.387744 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.priority_order
[0m20:58:56.388871 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m20:58:56.389148 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:56.389365 [debug] [MainThread]: On master: BEGIN
[0m20:58:56.389570 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:58:56.395916 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m20:58:56.396309 [debug] [MainThread]: On master: COMMIT
[0m20:58:56.396572 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:56.396788 [debug] [MainThread]: On master: COMMIT
[0m20:58:56.397099 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:58:56.397344 [debug] [MainThread]: On master: Close
[0m20:58:56.397992 [info ] [MainThread]: 
[0m20:58:56.398310 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m20:58:56.398617 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:58:56.398864 [debug] [MainThread]: Connection 'model.jaffle_shop.priority_order' was properly closed.
[0m20:58:56.399077 [debug] [MainThread]: Connection 'model.jaffle_shop.below_depletion_level' was properly closed.
[0m20:58:56.404962 [info ] [MainThread]: 
[0m20:58:56.405266 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:58:56.405602 [info ] [MainThread]: 
[0m20:58:56.405900 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:58:56.406238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a7c700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a7e530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a99f00>]}


============================== 2024-07-13 21:14:10.207902 | 1cd47f04-3d79-4077-94f2-980d4b74cd19 ==============================
[0m21:14:10.208231 [info ] [MainThread]: Running with dbt=1.2.0
[0m21:14:10.211652 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:14:10.212054 [debug] [MainThread]: Tracking: tracking
[0m21:14:10.229160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c122c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c133a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c10190>]}
[0m21:14:10.281467 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:14:10.282271 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/below_depletion_level.sql
[0m21:14:10.318356 [debug] [MainThread]: 1699: static parser successfully parsed below_depletion_level.sql
[0m21:14:10.340282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cd47f04-3d79-4077-94f2-980d4b74cd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89ccfd0>]}
[0m21:14:10.351411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cd47f04-3d79-4077-94f2-980d4b74cd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b5cdf0>]}
[0m21:14:10.351853 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m21:14:10.352217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cd47f04-3d79-4077-94f2-980d4b74cd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b5f9d0>]}
[0m21:14:10.353784 [info ] [MainThread]: 
[0m21:14:10.354414 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m21:14:10.356079 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m21:14:10.364401 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m21:14:10.364707 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m21:14:10.364939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:14:10.422038 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.06 seconds
[0m21:14:10.423883 [debug] [ThreadPool]: On list_postgres: Close
[0m21:14:10.439748 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m21:14:10.445732 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m21:14:10.450714 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m21:14:10.451071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:14:10.470207 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m21:14:10.470640 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m21:14:10.470875 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m21:14:10.477648 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
[0m21:14:10.478972 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m21:14:10.479365 [debug] [ThreadPool]: On list_postgres_public: Close
[0m21:14:10.483777 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:10.484143 [debug] [MainThread]: On master: BEGIN
[0m21:14:10.484369 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:14:10.495380 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m21:14:10.495751 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:10.495995 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:14:10.508257 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
[0m21:14:10.509628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cd47f04-3d79-4077-94f2-980d4b74cd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89ce5f0>]}
[0m21:14:10.509989 [debug] [MainThread]: On master: ROLLBACK
[0m21:14:10.510305 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:10.510511 [debug] [MainThread]: On master: BEGIN
[0m21:14:10.510847 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:14:10.511112 [debug] [MainThread]: On master: COMMIT
[0m21:14:10.511344 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:10.511529 [debug] [MainThread]: On master: COMMIT
[0m21:14:10.511782 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:14:10.511988 [debug] [MainThread]: On master: Close
[0m21:14:10.512363 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m21:14:10.512670 [info ] [MainThread]: 
[0m21:14:10.516401 [debug] [Thread-1 (]: Began running node model.jaffle_shop.below_depletion_level
[0m21:14:10.516793 [info ] [Thread-1 (]: 1 of 2 START view model public.below_depletion_level ........................... [RUN]
[0m21:14:10.517349 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.below_depletion_level"
[0m21:14:10.517780 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.below_depletion_level
[0m21:14:10.518031 [debug] [Thread-1 (]: Compiling model.jaffle_shop.below_depletion_level
[0m21:14:10.520907 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.below_depletion_level"
[0m21:14:10.522530 [debug] [Thread-1 (]: finished collecting timing info
[0m21:14:10.522795 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.below_depletion_level
[0m21:14:10.554328 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.below_depletion_level"
[0m21:14:10.555756 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m21:14:10.556042 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: BEGIN
[0m21:14:10.556286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:14:10.571496 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m21:14:10.571990 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m21:14:10.572293 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */

  create view "postgres"."public"."below_depletion_level__dbt_tmp" as (
    select distinct name, ruv.variant
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where stock_level < coalesce(depletion_level, 0)
  );
[0m21:14:10.578315 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m21:14:10.583677 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m21:14:10.600572 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level" rename to "below_depletion_level__dbt_backup"
[0m21:14:10.603008 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:14:10.605241 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m21:14:10.605510 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level__dbt_tmp" rename to "below_depletion_level"
[0m21:14:10.606148 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:14:10.622863 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m21:14:10.623252 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m21:14:10.623489 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m21:14:10.624379 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:14:10.628222 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m21:14:10.631894 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
drop view if exists "postgres"."public"."below_depletion_level__dbt_backup" cascade
[0m21:14:10.635036 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:14:10.636150 [debug] [Thread-1 (]: finished collecting timing info
[0m21:14:10.636621 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: Close
[0m21:14:10.637299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cd47f04-3d79-4077-94f2-980d4b74cd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a5a2c0>]}
[0m21:14:10.642994 [info ] [Thread-1 (]: 1 of 2 OK created view model public.below_depletion_level ...................... [[32mCREATE VIEW[0m in 0.12s]
[0m21:14:10.644259 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.below_depletion_level
[0m21:14:10.646623 [debug] [Thread-2 (]: Began running node model.jaffle_shop.priority_order
[0m21:14:10.653157 [info ] [Thread-2 (]: 2 of 2 START view model public.priority_order .................................. [RUN]
[0m21:14:10.656930 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.priority_order"
[0m21:14:10.657855 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.priority_order
[0m21:14:10.658113 [debug] [Thread-2 (]: Compiling model.jaffle_shop.priority_order
[0m21:14:10.662018 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.priority_order"
[0m21:14:10.664266 [debug] [Thread-2 (]: finished collecting timing info
[0m21:14:10.664903 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.priority_order
[0m21:14:10.668390 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.priority_order"
[0m21:14:10.669320 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m21:14:10.669545 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: BEGIN
[0m21:14:10.669768 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:14:10.676886 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m21:14:10.677663 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m21:14:10.677920 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */

  create view "postgres"."public"."priority_order__dbt_tmp" as (
    select distinct rup.name as product_name, ruv.variant as variant, (msrp - price) as profit 
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
join "postgres"."public"."below_depletion_level" bdl on bdl.name = rup.name and bdl.variant = ruv.variant
order by profit desc
  );
[0m21:14:10.682616 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:14:10.684821 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m21:14:10.685076 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
alter table "postgres"."public"."priority_order__dbt_tmp" rename to "priority_order"
[0m21:14:10.686399 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:14:10.687696 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: COMMIT
[0m21:14:10.687927 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m21:14:10.688159 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: COMMIT
[0m21:14:10.689775 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m21:14:10.691488 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m21:14:10.691719 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
drop view if exists "postgres"."public"."priority_order__dbt_backup" cascade
[0m21:14:10.692072 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:14:10.693096 [debug] [Thread-2 (]: finished collecting timing info
[0m21:14:10.693374 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: Close
[0m21:14:10.693891 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cd47f04-3d79-4077-94f2-980d4b74cd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a7e5c0>]}
[0m21:14:10.694518 [info ] [Thread-2 (]: 2 of 2 OK created view model public.priority_order ............................. [[32mCREATE VIEW[0m in 0.04s]
[0m21:14:10.695365 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.priority_order
[0m21:14:10.696852 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m21:14:10.697149 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:10.697355 [debug] [MainThread]: On master: BEGIN
[0m21:14:10.697553 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:14:10.703922 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m21:14:10.704240 [debug] [MainThread]: On master: COMMIT
[0m21:14:10.704450 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:10.704665 [debug] [MainThread]: On master: COMMIT
[0m21:14:10.704938 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:14:10.705173 [debug] [MainThread]: On master: Close
[0m21:14:10.705912 [info ] [MainThread]: 
[0m21:14:10.706243 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m21:14:10.706554 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:14:10.706781 [debug] [MainThread]: Connection 'model.jaffle_shop.priority_order' was properly closed.
[0m21:14:10.706976 [debug] [MainThread]: Connection 'model.jaffle_shop.below_depletion_level' was properly closed.
[0m21:14:10.712969 [info ] [MainThread]: 
[0m21:14:10.713296 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:14:10.713668 [info ] [MainThread]: 
[0m21:14:10.714007 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:14:10.714432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a7c6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a7fbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a996f0>]}


============================== 2024-07-13 22:36:02.590337 | b308752d-f737-496d-a58a-e3a88858b3f5 ==============================
[0m22:36:02.590892 [info ] [MainThread]: Running with dbt=1.2.0
[0m22:36:02.599479 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:36:02.599962 [debug] [MainThread]: Tracking: tracking
[0m22:36:02.618249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2afb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2bfd0>]}
[0m22:36:02.674922 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:36:02.675593 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/below_depletion_level.sql
[0m22:36:02.675914 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/priority_order.sql
[0m22:36:02.708641 [debug] [MainThread]: 1699: static parser successfully parsed below_depletion_level.sql
[0m22:36:02.720988 [debug] [MainThread]: 1699: static parser successfully parsed priority_order.sql
[0m22:36:02.731991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b308752d-f737-496d-a58a-e3a88858b3f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89cd330>]}
[0m22:36:02.744462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b308752d-f737-496d-a58a-e3a88858b3f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b5cf40>]}
[0m22:36:02.744885 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m22:36:02.745240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b308752d-f737-496d-a58a-e3a88858b3f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b5ce80>]}
[0m22:36:02.746707 [info ] [MainThread]: 
[0m22:36:02.747333 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m22:36:02.749122 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m22:36:02.758733 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m22:36:02.759083 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m22:36:02.759376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:36:02.822065 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.06 seconds
[0m22:36:02.824342 [debug] [ThreadPool]: On list_postgres: Close
[0m22:36:02.827104 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m22:36:02.832234 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m22:36:02.832524 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m22:36:02.832744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:36:02.839717 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m22:36:02.840799 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m22:36:02.841047 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:36:02.848891 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
[0m22:36:02.850167 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m22:36:02.850696 [debug] [ThreadPool]: On list_postgres_public: Close
[0m22:36:02.854805 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:02.855094 [debug] [MainThread]: On master: BEGIN
[0m22:36:02.855303 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:36:02.865612 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m22:36:02.866069 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:02.866299 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:36:02.877877 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
[0m22:36:02.879438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b308752d-f737-496d-a58a-e3a88858b3f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89cd240>]}
[0m22:36:02.879947 [debug] [MainThread]: On master: ROLLBACK
[0m22:36:02.880261 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:02.880470 [debug] [MainThread]: On master: BEGIN
[0m22:36:02.880812 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:36:02.881061 [debug] [MainThread]: On master: COMMIT
[0m22:36:02.881258 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:02.881457 [debug] [MainThread]: On master: COMMIT
[0m22:36:02.881715 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:36:02.881935 [debug] [MainThread]: On master: Close
[0m22:36:02.882430 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m22:36:02.882775 [info ] [MainThread]: 
[0m22:36:02.888197 [debug] [Thread-1 (]: Began running node model.jaffle_shop.below_depletion_level
[0m22:36:02.888723 [info ] [Thread-1 (]: 1 of 2 START view model public.below_depletion_level ........................... [RUN]
[0m22:36:02.889393 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.below_depletion_level"
[0m22:36:02.890229 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.below_depletion_level
[0m22:36:02.890644 [debug] [Thread-1 (]: Compiling model.jaffle_shop.below_depletion_level
[0m22:36:02.896226 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.below_depletion_level"
[0m22:36:02.899416 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:02.899825 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.below_depletion_level
[0m22:36:02.935964 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.below_depletion_level"
[0m22:36:02.938580 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m22:36:02.938823 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: BEGIN
[0m22:36:02.939049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:02.956906 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m22:36:02.957622 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m22:36:02.957961 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */

  create view "postgres"."public"."below_depletion_level__dbt_tmp" as (
    select distinct name, ruv.variant, ruv.actual_size, ruv.weave_cat
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where stock_level < coalesce(depletion_level, 0)
  );
[0m22:36:02.984039 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m22:36:02.992285 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m22:36:02.992703 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level" rename to "below_depletion_level__dbt_backup"
[0m22:36:02.994715 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:36:02.997113 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m22:36:02.997487 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level__dbt_tmp" rename to "below_depletion_level"
[0m22:36:02.998185 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:36:03.025059 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m22:36:03.025655 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m22:36:03.025888 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m22:36:03.028747 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:36:03.033422 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m22:36:03.033832 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
drop view if exists "postgres"."public"."below_depletion_level__dbt_backup" cascade
[0m22:36:03.041501 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m22:36:03.043062 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:03.043393 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: Close
[0m22:36:03.044334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b308752d-f737-496d-a58a-e3a88858b3f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a4e770>]}
[0m22:36:03.045010 [info ] [Thread-1 (]: 1 of 2 OK created view model public.below_depletion_level ...................... [[32mCREATE VIEW[0m in 0.15s]
[0m22:36:03.045853 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.below_depletion_level
[0m22:36:03.047781 [debug] [Thread-2 (]: Began running node model.jaffle_shop.priority_order
[0m22:36:03.048241 [info ] [Thread-2 (]: 2 of 2 START view model public.priority_order .................................. [RUN]
[0m22:36:03.048853 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.priority_order"
[0m22:36:03.049147 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.priority_order
[0m22:36:03.049427 [debug] [Thread-2 (]: Compiling model.jaffle_shop.priority_order
[0m22:36:03.053468 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.priority_order"
[0m22:36:03.055019 [debug] [Thread-2 (]: finished collecting timing info
[0m22:36:03.055272 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.priority_order
[0m22:36:03.058437 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.priority_order"
[0m22:36:03.059874 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m22:36:03.060095 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: BEGIN
[0m22:36:03.060305 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:36:03.068899 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m22:36:03.069475 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m22:36:03.069691 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */

  create view "postgres"."public"."priority_order__dbt_tmp" as (
    select distinct rup.name as product_name, ruv.variant as variant, ruv.actual_size, ruv.weave_cat, (msrp - price) as profit 
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
join "postgres"."public"."below_depletion_level" bdl on bdl.name = rup.name and bdl.variant = ruv.variant
order by profit desc
  );
[0m22:36:03.077519 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m22:36:03.079743 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m22:36:03.080052 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
alter table "postgres"."public"."priority_order__dbt_tmp" rename to "priority_order"
[0m22:36:03.080621 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:36:03.081866 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: COMMIT
[0m22:36:03.082103 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m22:36:03.082312 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: COMMIT
[0m22:36:03.083190 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:36:03.084651 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m22:36:03.084889 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
drop view if exists "postgres"."public"."priority_order__dbt_backup" cascade
[0m22:36:03.085277 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:36:03.086175 [debug] [Thread-2 (]: finished collecting timing info
[0m22:36:03.086416 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: Close
[0m22:36:03.086896 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b308752d-f737-496d-a58a-e3a88858b3f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a9fca0>]}
[0m22:36:03.087381 [info ] [Thread-2 (]: 2 of 2 OK created view model public.priority_order ............................. [[32mCREATE VIEW[0m in 0.04s]
[0m22:36:03.087918 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.priority_order
[0m22:36:03.089236 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m22:36:03.089496 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:03.089707 [debug] [MainThread]: On master: BEGIN
[0m22:36:03.089901 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:36:03.096403 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m22:36:03.097184 [debug] [MainThread]: On master: COMMIT
[0m22:36:03.097407 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:03.097618 [debug] [MainThread]: On master: COMMIT
[0m22:36:03.097940 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:36:03.098163 [debug] [MainThread]: On master: Close
[0m22:36:03.098897 [info ] [MainThread]: 
[0m22:36:03.099260 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m22:36:03.099602 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:36:03.099866 [debug] [MainThread]: Connection 'model.jaffle_shop.below_depletion_level' was properly closed.
[0m22:36:03.100134 [debug] [MainThread]: Connection 'model.jaffle_shop.priority_order' was properly closed.
[0m22:36:03.106505 [info ] [MainThread]: 
[0m22:36:03.106799 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:36:03.107152 [info ] [MainThread]: 
[0m22:36:03.107466 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:36:03.107898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a4d690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a9fac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a5e3e0>]}


============================== 2024-07-13 22:59:50.747268 | bf9545c4-4ed2-4847-8df7-aa235bb1966d ==============================
[0m22:59:50.747575 [info ] [MainThread]: Running with dbt=1.2.0
[0m22:59:50.754612 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:59:50.755042 [debug] [MainThread]: Tracking: tracking
[0m22:59:50.770718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c0e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c0f5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c0c520>]}
[0m22:59:50.825353 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:59:50.825956 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/hot_upsell.sql
[0m22:59:50.861094 [debug] [MainThread]: 1699: static parser successfully parsed hot_upsell.sql
[0m22:59:50.880310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf9545c4-4ed2-4847-8df7-aa235bb1966d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89cd090>]}
[0m22:59:50.891885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf9545c4-4ed2-4847-8df7-aa235bb1966d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b5f9d0>]}
[0m22:59:50.892315 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m22:59:50.892622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf9545c4-4ed2-4847-8df7-aa235bb1966d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b5fa00>]}
[0m22:59:50.894130 [info ] [MainThread]: 
[0m22:59:50.894718 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m22:59:50.896455 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m22:59:50.904836 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m22:59:50.905181 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m22:59:50.905416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:59:50.971892 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.07 seconds
[0m22:59:50.973855 [debug] [ThreadPool]: On list_postgres: Close
[0m22:59:50.977508 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m22:59:50.984446 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m22:59:50.984895 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m22:59:50.985141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:59:50.993453 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m22:59:50.993897 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m22:59:50.994148 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:59:51.006455 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
[0m22:59:51.007985 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m22:59:51.008383 [debug] [ThreadPool]: On list_postgres_public: Close
[0m22:59:51.012880 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:51.013285 [debug] [MainThread]: On master: BEGIN
[0m22:59:51.013526 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:59:51.034115 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m22:59:51.034744 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:51.035005 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:59:51.050319 [debug] [MainThread]: SQL status: SELECT 5 in 0.02 seconds
[0m22:59:51.051874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf9545c4-4ed2-4847-8df7-aa235bb1966d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89ccf10>]}
[0m22:59:51.052227 [debug] [MainThread]: On master: ROLLBACK
[0m22:59:51.052548 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:51.052759 [debug] [MainThread]: On master: BEGIN
[0m22:59:51.053103 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:59:51.053406 [debug] [MainThread]: On master: COMMIT
[0m22:59:51.053616 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:51.053825 [debug] [MainThread]: On master: COMMIT
[0m22:59:51.054085 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:59:51.054297 [debug] [MainThread]: On master: Close
[0m22:59:51.054727 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m22:59:51.055099 [info ] [MainThread]: 
[0m22:59:51.062207 [debug] [Thread-1 (]: Began running node model.jaffle_shop.below_depletion_level
[0m22:59:51.062407 [debug] [Thread-2 (]: Began running node model.jaffle_shop.hot_upsell
[0m22:59:51.062783 [info ] [Thread-1 (]: 1 of 3 START view model public.below_depletion_level ........................... [RUN]
[0m22:59:51.063190 [info ] [Thread-2 (]: 2 of 3 START view model public.hot_upsell ...................................... [RUN]
[0m22:59:51.063724 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.below_depletion_level"
[0m22:59:51.064209 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.hot_upsell"
[0m22:59:51.064531 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.below_depletion_level
[0m22:59:51.064758 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.hot_upsell
[0m22:59:51.065006 [debug] [Thread-1 (]: Compiling model.jaffle_shop.below_depletion_level
[0m22:59:51.065233 [debug] [Thread-2 (]: Compiling model.jaffle_shop.hot_upsell
[0m22:59:51.067923 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.below_depletion_level"
[0m22:59:51.070228 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.hot_upsell"
[0m22:59:51.071785 [debug] [Thread-2 (]: finished collecting timing info
[0m22:59:51.071997 [debug] [Thread-1 (]: finished collecting timing info
[0m22:59:51.072105 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.hot_upsell
[0m22:59:51.072339 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.below_depletion_level
[0m22:59:51.117286 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.below_depletion_level"
[0m22:59:51.117558 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.hot_upsell"
[0m22:59:51.119731 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m22:59:51.120038 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: BEGIN
[0m22:59:51.120295 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m22:59:51.120383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:59:51.120622 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: BEGIN
[0m22:59:51.121515 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:59:51.128613 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m22:59:51.128926 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m22:59:51.129218 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m22:59:51.129466 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m22:59:51.129677 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */

  create view "postgres"."public"."hot_upsell__dbt_tmp" as (
    select distinct rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, (ruv.msrp - rupu.price) as profit_margin
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_parent" rupu on rupu.p_id = ruv.pid and rupu.variant = ruv.variant 
join rugs_usa_parent rup on rup.pid = ruv.pid
where new_arrival = 'Y' and stock_level < coalesce(depletion_level, 0)
order by profit_margin desc;
  );
[0m22:59:51.129873 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */

  create view "postgres"."public"."below_depletion_level__dbt_tmp" as (
    select distinct name, ruv.variant, ruv.actual_size, ruv.weave_cat
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where stock_level < coalesce(depletion_level, 0)
  );
[0m22:59:51.130749 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 9: order by profit_margin desc;
                                   ^

[0m22:59:51.131075 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: ROLLBACK
[0m22:59:51.131518 [debug] [Thread-2 (]: finished collecting timing info
[0m22:59:51.131757 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: Close
[0m22:59:51.132276 [debug] [Thread-2 (]: Database Error in model hot_upsell (models/hot_upsell.sql)
  syntax error at or near ";"
  LINE 9: order by profit_margin desc;
                                     ^
  compiled SQL at target/run/jaffle_shop/models/hot_upsell.sql
[0m22:59:51.133234 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf9545c4-4ed2-4847-8df7-aa235bb1966d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8ab4cd0>]}
[0m22:59:51.133692 [error] [Thread-2 (]: 2 of 3 ERROR creating view model public.hot_upsell ............................. [[31mERROR[0m in 0.07s]
[0m22:59:51.134312 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.hot_upsell
[0m22:59:51.145009 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m22:59:51.152643 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m22:59:51.153155 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level" rename to "below_depletion_level__dbt_backup"
[0m22:59:51.154554 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:59:51.156644 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m22:59:51.156878 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level__dbt_tmp" rename to "below_depletion_level"
[0m22:59:51.157399 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:59:51.172398 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m22:59:51.172731 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m22:59:51.172983 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m22:59:51.174012 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:59:51.177848 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m22:59:51.178087 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
drop view if exists "postgres"."public"."below_depletion_level__dbt_backup" cascade
[0m22:59:51.181055 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:59:51.182435 [debug] [Thread-1 (]: finished collecting timing info
[0m22:59:51.182722 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: Close
[0m22:59:51.183252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf9545c4-4ed2-4847-8df7-aa235bb1966d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a107c0>]}
[0m22:59:51.183772 [info ] [Thread-1 (]: 1 of 3 OK created view model public.below_depletion_level ...................... [[32mCREATE VIEW[0m in 0.12s]
[0m22:59:51.184492 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.below_depletion_level
[0m22:59:51.186571 [debug] [Thread-2 (]: Began running node model.jaffle_shop.priority_order
[0m22:59:51.186887 [info ] [Thread-2 (]: 3 of 3 START view model public.priority_order .................................. [RUN]
[0m22:59:51.187346 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.priority_order"
[0m22:59:51.187564 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.priority_order
[0m22:59:51.187784 [debug] [Thread-2 (]: Compiling model.jaffle_shop.priority_order
[0m22:59:51.190392 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.priority_order"
[0m22:59:51.191403 [debug] [Thread-2 (]: finished collecting timing info
[0m22:59:51.191630 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.priority_order
[0m22:59:51.194496 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.priority_order"
[0m22:59:51.195455 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m22:59:51.195656 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: BEGIN
[0m22:59:51.195858 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:59:51.202784 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m22:59:51.203210 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m22:59:51.203442 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */

  create view "postgres"."public"."priority_order__dbt_tmp" as (
    select distinct rup.name as product_name, ruv.variant as variant, ruv.actual_size, ruv.weave_cat, (msrp - price) as profit 
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
join "postgres"."public"."below_depletion_level" bdl on bdl.name = rup.name and bdl.variant = ruv.variant
order by profit desc
  );
[0m22:59:51.208210 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:59:51.210292 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m22:59:51.210519 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
alter table "postgres"."public"."priority_order__dbt_tmp" rename to "priority_order"
[0m22:59:51.211059 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:59:51.212202 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: COMMIT
[0m22:59:51.212415 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m22:59:51.212611 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: COMMIT
[0m22:59:51.213399 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:59:51.214961 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m22:59:51.215251 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
drop view if exists "postgres"."public"."priority_order__dbt_backup" cascade
[0m22:59:51.215731 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:59:51.216737 [debug] [Thread-2 (]: finished collecting timing info
[0m22:59:51.216999 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: Close
[0m22:59:51.217497 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf9545c4-4ed2-4847-8df7-aa235bb1966d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a94d30>]}
[0m22:59:51.218398 [info ] [Thread-2 (]: 3 of 3 OK created view model public.priority_order ............................. [[32mCREATE VIEW[0m in 0.03s]
[0m22:59:51.218784 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.priority_order
[0m22:59:51.220236 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m22:59:51.220673 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:51.220947 [debug] [MainThread]: On master: BEGIN
[0m22:59:51.221188 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:59:51.228716 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m22:59:51.229620 [debug] [MainThread]: On master: COMMIT
[0m22:59:51.229972 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:51.230410 [debug] [MainThread]: On master: COMMIT
[0m22:59:51.231020 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:59:51.231704 [debug] [MainThread]: On master: Close
[0m22:59:51.233096 [info ] [MainThread]: 
[0m22:59:51.233642 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m22:59:51.234156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:59:51.234653 [debug] [MainThread]: Connection 'model.jaffle_shop.priority_order' was properly closed.
[0m22:59:51.234870 [debug] [MainThread]: Connection 'model.jaffle_shop.below_depletion_level' was properly closed.
[0m22:59:51.240972 [info ] [MainThread]: 
[0m22:59:51.241360 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:59:51.241904 [info ] [MainThread]: 
[0m22:59:51.242385 [error] [MainThread]: [33mDatabase Error in model hot_upsell (models/hot_upsell.sql)[0m
[0m22:59:51.242688 [error] [MainThread]:   syntax error at or near ";"
[0m22:59:51.242992 [error] [MainThread]:   LINE 9: order by profit_margin desc;
[0m22:59:51.243428 [error] [MainThread]:                                      ^
[0m22:59:51.243804 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/hot_upsell.sql
[0m22:59:51.244273 [info ] [MainThread]: 
[0m22:59:51.244606 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m22:59:51.245115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b5f640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a51f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a10f70>]}


============================== 2024-07-13 23:00:05.161296 | 5c1ddef3-e00f-4804-9a31-f816c05ad261 ==============================
[0m23:00:05.161603 [info ] [MainThread]: Running with dbt=1.2.0
[0m23:00:05.164313 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:00:05.165096 [debug] [MainThread]: Tracking: tracking
[0m23:00:05.179189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c17760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c17370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c174c0>]}
[0m23:00:05.219658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:00:05.220359 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/hot_upsell.sql
[0m23:00:05.261909 [debug] [MainThread]: 1699: static parser successfully parsed hot_upsell.sql
[0m23:00:05.281121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c1ddef3-e00f-4804-9a31-f816c05ad261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89cd390>]}
[0m23:00:05.289682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c1ddef3-e00f-4804-9a31-f816c05ad261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b611b0>]}
[0m23:00:05.290130 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m23:00:05.290475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c1ddef3-e00f-4804-9a31-f816c05ad261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b63d90>]}
[0m23:00:05.292461 [info ] [MainThread]: 
[0m23:00:05.293086 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m23:00:05.295380 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m23:00:05.304069 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:00:05.304411 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:00:05.304635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:05.361101 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.06 seconds
[0m23:00:05.363088 [debug] [ThreadPool]: On list_postgres: Close
[0m23:00:05.365945 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m23:00:05.370779 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m23:00:05.371071 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m23:00:05.371306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:05.379210 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m23:00:05.379555 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m23:00:05.379817 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:00:05.382728 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m23:00:05.383999 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m23:00:05.384406 [debug] [ThreadPool]: On list_postgres_public: Close
[0m23:00:05.388490 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:05.388827 [debug] [MainThread]: On master: BEGIN
[0m23:00:05.389037 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:00:05.397433 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m23:00:05.397913 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:05.398182 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:00:05.403244 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m23:00:05.404532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c1ddef3-e00f-4804-9a31-f816c05ad261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89cd180>]}
[0m23:00:05.404911 [debug] [MainThread]: On master: ROLLBACK
[0m23:00:05.405200 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:05.405409 [debug] [MainThread]: On master: BEGIN
[0m23:00:05.405775 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:00:05.406072 [debug] [MainThread]: On master: COMMIT
[0m23:00:05.406291 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:05.406505 [debug] [MainThread]: On master: COMMIT
[0m23:00:05.406830 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:00:05.407050 [debug] [MainThread]: On master: Close
[0m23:00:05.407465 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m23:00:05.407803 [info ] [MainThread]: 
[0m23:00:05.411473 [debug] [Thread-1 (]: Began running node model.jaffle_shop.below_depletion_level
[0m23:00:05.411598 [debug] [Thread-2 (]: Began running node model.jaffle_shop.hot_upsell
[0m23:00:05.411955 [info ] [Thread-1 (]: 1 of 3 START view model public.below_depletion_level ........................... [RUN]
[0m23:00:05.412296 [info ] [Thread-2 (]: 2 of 3 START view model public.hot_upsell ...................................... [RUN]
[0m23:00:05.412750 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.below_depletion_level"
[0m23:00:05.413126 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.hot_upsell"
[0m23:00:05.413446 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.below_depletion_level
[0m23:00:05.413684 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.hot_upsell
[0m23:00:05.413929 [debug] [Thread-1 (]: Compiling model.jaffle_shop.below_depletion_level
[0m23:00:05.414138 [debug] [Thread-2 (]: Compiling model.jaffle_shop.hot_upsell
[0m23:00:05.416712 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.below_depletion_level"
[0m23:00:05.418848 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.hot_upsell"
[0m23:00:05.420088 [debug] [Thread-1 (]: finished collecting timing info
[0m23:00:05.420187 [debug] [Thread-2 (]: finished collecting timing info
[0m23:00:05.420415 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.below_depletion_level
[0m23:00:05.420660 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.hot_upsell
[0m23:00:05.467056 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.below_depletion_level"
[0m23:00:05.467247 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.hot_upsell"
[0m23:00:05.469023 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m23:00:05.469147 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m23:00:05.469349 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: BEGIN
[0m23:00:05.469564 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: BEGIN
[0m23:00:05.469776 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:00:05.469975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:00:05.476939 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m23:00:05.477101 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m23:00:05.477365 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m23:00:05.477585 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m23:00:05.477791 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */

  create view "postgres"."public"."below_depletion_level__dbt_tmp" as (
    select distinct name, ruv.variant, ruv.actual_size, ruv.weave_cat
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where stock_level < coalesce(depletion_level, 0)
  );
[0m23:00:05.478035 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */

  create view "postgres"."public"."hot_upsell__dbt_tmp" as (
    select distinct rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, (ruv.msrp - rupu.price) as profit_margin
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_parent" rupu on rupu.p_id = ruv.pid and rupu.variant = ruv.variant 
join rugs_usa_parent rup on rup.pid = ruv.pid
where new_arrival = 'Y' and stock_level < coalesce(depletion_level, 0)
order by profit_margin desc
  );
[0m23:00:05.479790 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column rupu.p_id does not exist
LINE 6: ...oin "postgres"."public"."rugs_usa_parent" rupu on rupu.p_id ...
                                                             ^
HINT:  Perhaps you meant to reference the column "rupu.pid".

[0m23:00:05.480127 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: ROLLBACK
[0m23:00:05.480577 [debug] [Thread-2 (]: finished collecting timing info
[0m23:00:05.480976 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: Close
[0m23:00:05.481521 [debug] [Thread-2 (]: Database Error in model hot_upsell (models/hot_upsell.sql)
  column rupu.p_id does not exist
  LINE 6: ...oin "postgres"."public"."rugs_usa_parent" rupu on rupu.p_id ...
                                                               ^
  HINT:  Perhaps you meant to reference the column "rupu.pid".
  compiled SQL at target/run/jaffle_shop/models/hot_upsell.sql
[0m23:00:05.482122 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c1ddef3-e00f-4804-9a31-f816c05ad261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8aa0580>]}
[0m23:00:05.482581 [error] [Thread-2 (]: 2 of 3 ERROR creating view model public.hot_upsell ............................. [[31mERROR[0m in 0.07s]
[0m23:00:05.483180 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.hot_upsell
[0m23:00:05.483352 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m23:00:05.489585 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m23:00:05.489890 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level" rename to "below_depletion_level__dbt_backup"
[0m23:00:05.490602 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:00:05.492430 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m23:00:05.492676 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level__dbt_tmp" rename to "below_depletion_level"
[0m23:00:05.493250 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:00:05.507852 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m23:00:05.508256 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m23:00:05.508495 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m23:00:05.510920 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:00:05.516151 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m23:00:05.516639 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
drop view if exists "postgres"."public"."below_depletion_level__dbt_backup" cascade
[0m23:00:05.522730 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m23:00:05.524657 [debug] [Thread-1 (]: finished collecting timing info
[0m23:00:05.525034 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: Close
[0m23:00:05.525815 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c1ddef3-e00f-4804-9a31-f816c05ad261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a9f280>]}
[0m23:00:05.527284 [info ] [Thread-1 (]: 1 of 3 OK created view model public.below_depletion_level ...................... [[32mCREATE VIEW[0m in 0.11s]
[0m23:00:05.527939 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.below_depletion_level
[0m23:00:05.530134 [debug] [Thread-2 (]: Began running node model.jaffle_shop.priority_order
[0m23:00:05.530530 [info ] [Thread-2 (]: 3 of 3 START view model public.priority_order .................................. [RUN]
[0m23:00:05.531620 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.priority_order"
[0m23:00:05.532061 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.priority_order
[0m23:00:05.532378 [debug] [Thread-2 (]: Compiling model.jaffle_shop.priority_order
[0m23:00:05.536255 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.priority_order"
[0m23:00:05.538124 [debug] [Thread-2 (]: finished collecting timing info
[0m23:00:05.538378 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.priority_order
[0m23:00:05.541441 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.priority_order"
[0m23:00:05.542617 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m23:00:05.542901 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: BEGIN
[0m23:00:05.543116 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:00:05.550480 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m23:00:05.550911 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m23:00:05.551423 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */

  create view "postgres"."public"."priority_order__dbt_tmp" as (
    select distinct rup.name as product_name, ruv.variant as variant, ruv.actual_size, ruv.weave_cat, (msrp - price) as profit 
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
join "postgres"."public"."below_depletion_level" bdl on bdl.name = rup.name and bdl.variant = ruv.variant
order by profit desc
  );
[0m23:00:05.554635 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:00:05.556830 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m23:00:05.557055 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
alter table "postgres"."public"."priority_order__dbt_tmp" rename to "priority_order"
[0m23:00:05.557629 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:00:05.558804 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: COMMIT
[0m23:00:05.559044 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m23:00:05.559283 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: COMMIT
[0m23:00:05.560314 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:00:05.561638 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m23:00:05.561868 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
drop view if exists "postgres"."public"."priority_order__dbt_backup" cascade
[0m23:00:05.562204 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:00:05.563079 [debug] [Thread-2 (]: finished collecting timing info
[0m23:00:05.563320 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: Close
[0m23:00:05.563778 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c1ddef3-e00f-4804-9a31-f816c05ad261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a18b50>]}
[0m23:00:05.564162 [info ] [Thread-2 (]: 3 of 3 OK created view model public.priority_order ............................. [[32mCREATE VIEW[0m in 0.03s]
[0m23:00:05.564570 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.priority_order
[0m23:00:05.565967 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m23:00:05.566301 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:05.566529 [debug] [MainThread]: On master: BEGIN
[0m23:00:05.566718 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:00:05.573552 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m23:00:05.573928 [debug] [MainThread]: On master: COMMIT
[0m23:00:05.574157 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:05.574378 [debug] [MainThread]: On master: COMMIT
[0m23:00:05.574697 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:00:05.574940 [debug] [MainThread]: On master: Close
[0m23:00:05.575697 [info ] [MainThread]: 
[0m23:00:05.576110 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m23:00:05.576486 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:00:05.576800 [debug] [MainThread]: Connection 'model.jaffle_shop.priority_order' was properly closed.
[0m23:00:05.577016 [debug] [MainThread]: Connection 'model.jaffle_shop.below_depletion_level' was properly closed.
[0m23:00:05.582861 [info ] [MainThread]: 
[0m23:00:05.583217 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:00:05.583622 [info ] [MainThread]: 
[0m23:00:05.583998 [error] [MainThread]: [33mDatabase Error in model hot_upsell (models/hot_upsell.sql)[0m
[0m23:00:05.584343 [error] [MainThread]:   column rupu.p_id does not exist
[0m23:00:05.584631 [error] [MainThread]:   LINE 6: ...oin "postgres"."public"."rugs_usa_parent" rupu on rupu.p_id ...
[0m23:00:05.584947 [error] [MainThread]:                                                                ^
[0m23:00:05.585228 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "rupu.pid".
[0m23:00:05.585515 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/hot_upsell.sql
[0m23:00:05.585817 [info ] [MainThread]: 
[0m23:00:05.586125 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:00:05.586563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b63970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a635e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a18dc0>]}


============================== 2024-07-13 23:00:45.211962 | a8802625-ce3c-4470-a89c-256f00151eac ==============================
[0m23:00:45.212298 [info ] [MainThread]: Running with dbt=1.2.0
[0m23:00:45.222321 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:00:45.222855 [debug] [MainThread]: Tracking: tracking
[0m23:00:45.246208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c15d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c14c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c17d30>]}
[0m23:00:45.295091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:00:45.295833 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/hot_upsell.sql
[0m23:00:45.338501 [debug] [MainThread]: 1699: static parser successfully parsed hot_upsell.sql
[0m23:00:45.360223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8802625-ce3c-4470-a89c-256f00151eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89cd2d0>]}
[0m23:00:45.371914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8802625-ce3c-4470-a89c-256f00151eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b610f0>]}
[0m23:00:45.372377 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m23:00:45.372720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8802625-ce3c-4470-a89c-256f00151eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b63cd0>]}
[0m23:00:45.374378 [info ] [MainThread]: 
[0m23:00:45.375010 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m23:00:45.376830 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m23:00:45.386017 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:00:45.386443 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:00:45.386739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:45.435356 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.05 seconds
[0m23:00:45.437170 [debug] [ThreadPool]: On list_postgres: Close
[0m23:00:45.440180 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m23:00:45.444927 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m23:00:45.445203 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m23:00:45.445446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:45.453882 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m23:00:45.454320 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m23:00:45.454608 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:00:45.459640 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m23:00:45.460895 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m23:00:45.461280 [debug] [ThreadPool]: On list_postgres_public: Close
[0m23:00:45.465313 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:45.465628 [debug] [MainThread]: On master: BEGIN
[0m23:00:45.465859 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:00:45.472178 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m23:00:45.472553 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:45.472791 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:00:45.476787 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m23:00:45.478306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8802625-ce3c-4470-a89c-256f00151eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89cd180>]}
[0m23:00:45.478705 [debug] [MainThread]: On master: ROLLBACK
[0m23:00:45.479069 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:45.479294 [debug] [MainThread]: On master: BEGIN
[0m23:00:45.479689 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:00:45.480109 [debug] [MainThread]: On master: COMMIT
[0m23:00:45.480341 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:45.480582 [debug] [MainThread]: On master: COMMIT
[0m23:00:45.480905 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:00:45.481136 [debug] [MainThread]: On master: Close
[0m23:00:45.481848 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m23:00:45.482271 [info ] [MainThread]: 
[0m23:00:45.486421 [debug] [Thread-1 (]: Began running node model.jaffle_shop.below_depletion_level
[0m23:00:45.486629 [debug] [Thread-2 (]: Began running node model.jaffle_shop.hot_upsell
[0m23:00:45.487108 [info ] [Thread-1 (]: 1 of 3 START view model public.below_depletion_level ........................... [RUN]
[0m23:00:45.487527 [info ] [Thread-2 (]: 2 of 3 START view model public.hot_upsell ...................................... [RUN]
[0m23:00:45.488080 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.below_depletion_level"
[0m23:00:45.488637 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.hot_upsell"
[0m23:00:45.489146 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.below_depletion_level
[0m23:00:45.489409 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.hot_upsell
[0m23:00:45.489686 [debug] [Thread-1 (]: Compiling model.jaffle_shop.below_depletion_level
[0m23:00:45.489928 [debug] [Thread-2 (]: Compiling model.jaffle_shop.hot_upsell
[0m23:00:45.492834 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.below_depletion_level"
[0m23:00:45.495760 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.hot_upsell"
[0m23:00:45.498386 [debug] [Thread-2 (]: finished collecting timing info
[0m23:00:45.498597 [debug] [Thread-1 (]: finished collecting timing info
[0m23:00:45.498868 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.hot_upsell
[0m23:00:45.499113 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.below_depletion_level
[0m23:00:45.530734 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.hot_upsell"
[0m23:00:45.533482 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.below_depletion_level"
[0m23:00:45.535262 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m23:00:45.535498 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m23:00:45.535720 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: BEGIN
[0m23:00:45.536010 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: BEGIN
[0m23:00:45.536262 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:00:45.536503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:00:45.543690 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m23:00:45.544109 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m23:00:45.544273 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m23:00:45.544728 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m23:00:45.545019 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */

  create view "postgres"."public"."hot_upsell__dbt_tmp" as (
    select distinct rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, (ruv.msrp - rupu.price) as profit_margin
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_parent" rupu on rupu.p_id = ruv.pid and rupu.variant = ruv.variant 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where new_arrival = 'Y' and stock_level < coalesce(depletion_level, 0)
order by profit_margin desc
  );
[0m23:00:45.545277 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */

  create view "postgres"."public"."below_depletion_level__dbt_tmp" as (
    select distinct name, ruv.variant, ruv.actual_size, ruv.weave_cat
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where stock_level < coalesce(depletion_level, 0)
  );
[0m23:00:45.548086 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column rupu.p_id does not exist
LINE 6: ...oin "postgres"."public"."rugs_usa_parent" rupu on rupu.p_id ...
                                                             ^
HINT:  Perhaps you meant to reference the column "rupu.pid".

[0m23:00:45.548902 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: ROLLBACK
[0m23:00:45.549564 [debug] [Thread-2 (]: finished collecting timing info
[0m23:00:45.549839 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: Close
[0m23:00:45.550781 [debug] [Thread-2 (]: Database Error in model hot_upsell (models/hot_upsell.sql)
  column rupu.p_id does not exist
  LINE 6: ...oin "postgres"."public"."rugs_usa_parent" rupu on rupu.p_id ...
                                                               ^
  HINT:  Perhaps you meant to reference the column "rupu.pid".
  compiled SQL at target/run/jaffle_shop/models/hot_upsell.sql
[0m23:00:45.551585 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8802625-ce3c-4470-a89c-256f00151eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a62770>]}
[0m23:00:45.552439 [error] [Thread-2 (]: 2 of 3 ERROR creating view model public.hot_upsell ............................. [[31mERROR[0m in 0.06s]
[0m23:00:45.553250 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.hot_upsell
[0m23:00:45.556441 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m23:00:45.562496 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m23:00:45.562939 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level" rename to "below_depletion_level__dbt_backup"
[0m23:00:45.564176 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:00:45.567385 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m23:00:45.567761 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level__dbt_tmp" rename to "below_depletion_level"
[0m23:00:45.568444 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:00:45.583038 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m23:00:45.583347 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m23:00:45.583590 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m23:00:45.585045 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:00:45.589163 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m23:00:45.589457 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
drop view if exists "postgres"."public"."below_depletion_level__dbt_backup" cascade
[0m23:00:45.591465 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:00:45.592487 [debug] [Thread-1 (]: finished collecting timing info
[0m23:00:45.592739 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: Close
[0m23:00:45.593189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8802625-ce3c-4470-a89c-256f00151eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a70d30>]}
[0m23:00:45.593601 [info ] [Thread-1 (]: 1 of 3 OK created view model public.below_depletion_level ...................... [[32mCREATE VIEW[0m in 0.11s]
[0m23:00:45.594043 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.below_depletion_level
[0m23:00:45.595469 [debug] [Thread-2 (]: Began running node model.jaffle_shop.priority_order
[0m23:00:45.595771 [info ] [Thread-2 (]: 3 of 3 START view model public.priority_order .................................. [RUN]
[0m23:00:45.596215 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.priority_order"
[0m23:00:45.596442 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.priority_order
[0m23:00:45.596656 [debug] [Thread-2 (]: Compiling model.jaffle_shop.priority_order
[0m23:00:45.599183 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.priority_order"
[0m23:00:45.600057 [debug] [Thread-2 (]: finished collecting timing info
[0m23:00:45.600286 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.priority_order
[0m23:00:45.603246 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.priority_order"
[0m23:00:45.604874 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m23:00:45.605068 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: BEGIN
[0m23:00:45.605267 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:00:45.611864 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m23:00:45.612285 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m23:00:45.612505 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */

  create view "postgres"."public"."priority_order__dbt_tmp" as (
    select distinct rup.name as product_name, ruv.variant as variant, ruv.actual_size, ruv.weave_cat, (msrp - price) as profit 
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
join "postgres"."public"."below_depletion_level" bdl on bdl.name = rup.name and bdl.variant = ruv.variant
order by profit desc
  );
[0m23:00:45.616688 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:00:45.618838 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m23:00:45.619088 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
alter table "postgres"."public"."priority_order__dbt_tmp" rename to "priority_order"
[0m23:00:45.619617 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:00:45.620751 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: COMMIT
[0m23:00:45.620966 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m23:00:45.621167 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: COMMIT
[0m23:00:45.621822 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:00:45.623138 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m23:00:45.623340 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
drop view if exists "postgres"."public"."priority_order__dbt_backup" cascade
[0m23:00:45.623680 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:00:45.624570 [debug] [Thread-2 (]: finished collecting timing info
[0m23:00:45.624786 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: Close
[0m23:00:45.625194 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8802625-ce3c-4470-a89c-256f00151eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a03eb0>]}
[0m23:00:45.625579 [info ] [Thread-2 (]: 3 of 3 OK created view model public.priority_order ............................. [[32mCREATE VIEW[0m in 0.03s]
[0m23:00:45.625975 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.priority_order
[0m23:00:45.627119 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m23:00:45.627537 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:45.627742 [debug] [MainThread]: On master: BEGIN
[0m23:00:45.627949 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:00:45.634403 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m23:00:45.634739 [debug] [MainThread]: On master: COMMIT
[0m23:00:45.635235 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:45.635438 [debug] [MainThread]: On master: COMMIT
[0m23:00:45.635699 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:00:45.635906 [debug] [MainThread]: On master: Close
[0m23:00:45.636500 [info ] [MainThread]: 
[0m23:00:45.636820 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m23:00:45.637124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:00:45.637341 [debug] [MainThread]: Connection 'model.jaffle_shop.priority_order' was properly closed.
[0m23:00:45.637530 [debug] [MainThread]: Connection 'model.jaffle_shop.below_depletion_level' was properly closed.
[0m23:00:45.643508 [info ] [MainThread]: 
[0m23:00:45.643889 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:00:45.644211 [info ] [MainThread]: 
[0m23:00:45.644576 [error] [MainThread]: [33mDatabase Error in model hot_upsell (models/hot_upsell.sql)[0m
[0m23:00:45.644909 [error] [MainThread]:   column rupu.p_id does not exist
[0m23:00:45.645296 [error] [MainThread]:   LINE 6: ...oin "postgres"."public"."rugs_usa_parent" rupu on rupu.p_id ...
[0m23:00:45.645547 [error] [MainThread]:                                                                ^
[0m23:00:45.645860 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "rupu.pid".
[0m23:00:45.646145 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/hot_upsell.sql
[0m23:00:45.646423 [info ] [MainThread]: 
[0m23:00:45.646813 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:00:45.647298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b638b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a708b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a10eb0>]}


============================== 2024-07-13 23:01:17.222308 | 70a21c96-e6a5-40f4-8449-0d859877dd95 ==============================
[0m23:01:17.223200 [info ] [MainThread]: Running with dbt=1.2.0
[0m23:01:17.234328 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:01:17.234710 [debug] [MainThread]: Tracking: tracking
[0m23:01:17.249074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c262c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c273a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c24190>]}
[0m23:01:17.292436 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:01:17.293120 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/hot_upsell.sql
[0m23:01:17.330289 [debug] [MainThread]: 1699: static parser successfully parsed hot_upsell.sql
[0m23:01:17.349284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70a21c96-e6a5-40f4-8449-0d859877dd95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89cd330>]}
[0m23:01:17.358071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70a21c96-e6a5-40f4-8449-0d859877dd95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b61150>]}
[0m23:01:17.358495 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m23:01:17.358808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70a21c96-e6a5-40f4-8449-0d859877dd95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b63d30>]}
[0m23:01:17.360339 [info ] [MainThread]: 
[0m23:01:17.360972 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m23:01:17.362665 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m23:01:17.371246 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:01:17.371565 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:01:17.371810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:01:17.422101 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.05 seconds
[0m23:01:17.424446 [debug] [ThreadPool]: On list_postgres: Close
[0m23:01:17.426972 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m23:01:17.431710 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m23:01:17.431995 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m23:01:17.432244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:01:17.439688 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m23:01:17.440029 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m23:01:17.440283 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:01:17.443532 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m23:01:17.444754 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m23:01:17.445156 [debug] [ThreadPool]: On list_postgres_public: Close
[0m23:01:17.449190 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:17.449500 [debug] [MainThread]: On master: BEGIN
[0m23:01:17.449727 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:01:17.455939 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m23:01:17.456247 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:17.456468 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:01:17.460617 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m23:01:17.461836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70a21c96-e6a5-40f4-8449-0d859877dd95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89cd180>]}
[0m23:01:17.462197 [debug] [MainThread]: On master: ROLLBACK
[0m23:01:17.462492 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:17.462700 [debug] [MainThread]: On master: BEGIN
[0m23:01:17.463029 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:01:17.463299 [debug] [MainThread]: On master: COMMIT
[0m23:01:17.463507 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:17.463699 [debug] [MainThread]: On master: COMMIT
[0m23:01:17.463949 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:01:17.464154 [debug] [MainThread]: On master: Close
[0m23:01:17.464522 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m23:01:17.464811 [info ] [MainThread]: 
[0m23:01:17.468566 [debug] [Thread-1 (]: Began running node model.jaffle_shop.below_depletion_level
[0m23:01:17.468688 [debug] [Thread-2 (]: Began running node model.jaffle_shop.hot_upsell
[0m23:01:17.469029 [info ] [Thread-1 (]: 1 of 3 START view model public.below_depletion_level ........................... [RUN]
[0m23:01:17.469388 [info ] [Thread-2 (]: 2 of 3 START view model public.hot_upsell ...................................... [RUN]
[0m23:01:17.469829 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.below_depletion_level"
[0m23:01:17.470236 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.hot_upsell"
[0m23:01:17.470547 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.below_depletion_level
[0m23:01:17.470756 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.hot_upsell
[0m23:01:17.470985 [debug] [Thread-1 (]: Compiling model.jaffle_shop.below_depletion_level
[0m23:01:17.471205 [debug] [Thread-2 (]: Compiling model.jaffle_shop.hot_upsell
[0m23:01:17.473622 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.below_depletion_level"
[0m23:01:17.475839 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.hot_upsell"
[0m23:01:17.477662 [debug] [Thread-2 (]: finished collecting timing info
[0m23:01:17.477746 [debug] [Thread-1 (]: finished collecting timing info
[0m23:01:17.477953 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.hot_upsell
[0m23:01:17.478178 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.below_depletion_level
[0m23:01:17.512212 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.hot_upsell"
[0m23:01:17.512363 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.below_depletion_level"
[0m23:01:17.514507 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m23:01:17.514623 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m23:01:17.514827 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: BEGIN
[0m23:01:17.515065 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: BEGIN
[0m23:01:17.515307 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:01:17.515543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:01:17.522055 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m23:01:17.522205 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m23:01:17.522466 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m23:01:17.522689 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m23:01:17.522894 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */

  create view "postgres"."public"."hot_upsell__dbt_tmp" as (
    select distinct rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, (ruv.msrp - rupu.price) as profit_margin
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_pads_upsell" rupu on rupu.p_id = ruv.pid and rupu.variant = ruv.variant 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where new_arrival = 'Y' and stock_level < coalesce(depletion_level, 0)
order by profit_margin desc
  );
[0m23:01:17.523105 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */

  create view "postgres"."public"."below_depletion_level__dbt_tmp" as (
    select distinct name, ruv.variant, ruv.actual_size, ruv.weave_cat
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where stock_level < coalesce(depletion_level, 0)
  );
[0m23:01:17.528266 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:01:17.533889 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m23:01:17.534046 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m23:01:17.534290 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
alter table "postgres"."public"."hot_upsell__dbt_tmp" rename to "hot_upsell"
[0m23:01:17.536874 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m23:01:17.537348 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level" rename to "below_depletion_level__dbt_backup"
[0m23:01:17.537590 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:01:17.544396 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m23:01:17.550213 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: COMMIT
[0m23:01:17.552077 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m23:01:17.552356 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m23:01:17.552622 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level__dbt_tmp" rename to "below_depletion_level"
[0m23:01:17.552863 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: COMMIT
[0m23:01:17.553512 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:01:17.556650 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m23:01:17.556759 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:01:17.556972 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m23:01:17.560515 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m23:01:17.560764 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m23:01:17.560974 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
drop view if exists "postgres"."public"."hot_upsell__dbt_backup" cascade
[0m23:01:17.561541 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:01:17.561630 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:01:17.562967 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m23:01:17.563979 [debug] [Thread-2 (]: finished collecting timing info
[0m23:01:17.564227 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
drop view if exists "postgres"."public"."below_depletion_level__dbt_backup" cascade
[0m23:01:17.564448 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: Close
[0m23:01:17.567379 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70a21c96-e6a5-40f4-8449-0d859877dd95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a9b220>]}
[0m23:01:17.567485 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:01:17.567889 [info ] [Thread-2 (]: 2 of 3 OK created view model public.hot_upsell ................................. [[32mCREATE VIEW[0m in 0.10s]
[0m23:01:17.568961 [debug] [Thread-1 (]: finished collecting timing info
[0m23:01:17.569360 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.hot_upsell
[0m23:01:17.569591 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: Close
[0m23:01:17.570331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70a21c96-e6a5-40f4-8449-0d859877dd95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a107c0>]}
[0m23:01:17.570734 [info ] [Thread-1 (]: 1 of 3 OK created view model public.below_depletion_level ...................... [[32mCREATE VIEW[0m in 0.10s]
[0m23:01:17.571115 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.below_depletion_level
[0m23:01:17.572338 [debug] [Thread-2 (]: Began running node model.jaffle_shop.priority_order
[0m23:01:17.572609 [info ] [Thread-2 (]: 3 of 3 START view model public.priority_order .................................. [RUN]
[0m23:01:17.573043 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.priority_order"
[0m23:01:17.573268 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.priority_order
[0m23:01:17.573484 [debug] [Thread-2 (]: Compiling model.jaffle_shop.priority_order
[0m23:01:17.575980 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.priority_order"
[0m23:01:17.576814 [debug] [Thread-2 (]: finished collecting timing info
[0m23:01:17.577035 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.priority_order
[0m23:01:17.580437 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.priority_order"
[0m23:01:17.581422 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m23:01:17.581660 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: BEGIN
[0m23:01:17.581852 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:01:17.599567 [debug] [Thread-2 (]: SQL status: BEGIN in 0.02 seconds
[0m23:01:17.599964 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m23:01:17.600211 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */

  create view "postgres"."public"."priority_order__dbt_tmp" as (
    select distinct rup.name as product_name, ruv.variant as variant, ruv.actual_size, ruv.weave_cat, (msrp - price) as profit 
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
join "postgres"."public"."below_depletion_level" bdl on bdl.name = rup.name and bdl.variant = ruv.variant
order by profit desc
  );
[0m23:01:17.608437 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m23:01:17.611411 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m23:01:17.611657 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
alter table "postgres"."public"."priority_order__dbt_tmp" rename to "priority_order"
[0m23:01:17.612219 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:01:17.613564 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: COMMIT
[0m23:01:17.613788 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m23:01:17.613990 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: COMMIT
[0m23:01:17.614580 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:01:17.616347 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m23:01:17.616744 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
drop view if exists "postgres"."public"."priority_order__dbt_backup" cascade
[0m23:01:17.617233 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:01:17.618496 [debug] [Thread-2 (]: finished collecting timing info
[0m23:01:17.618726 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: Close
[0m23:01:17.619171 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70a21c96-e6a5-40f4-8449-0d859877dd95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b8c040>]}
[0m23:01:17.619565 [info ] [Thread-2 (]: 3 of 3 OK created view model public.priority_order ............................. [[32mCREATE VIEW[0m in 0.05s]
[0m23:01:17.619974 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.priority_order
[0m23:01:17.621063 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m23:01:17.621328 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:17.621557 [debug] [MainThread]: On master: BEGIN
[0m23:01:17.621768 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:01:17.628102 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m23:01:17.628564 [debug] [MainThread]: On master: COMMIT
[0m23:01:17.628866 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:17.629070 [debug] [MainThread]: On master: COMMIT
[0m23:01:17.629350 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:01:17.629559 [debug] [MainThread]: On master: Close
[0m23:01:17.630203 [info ] [MainThread]: 
[0m23:01:17.630495 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m23:01:17.630788 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:01:17.631014 [debug] [MainThread]: Connection 'model.jaffle_shop.priority_order' was properly closed.
[0m23:01:17.631499 [debug] [MainThread]: Connection 'model.jaffle_shop.below_depletion_level' was properly closed.
[0m23:01:17.646031 [info ] [MainThread]: 
[0m23:01:17.646370 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:01:17.646725 [info ] [MainThread]: 
[0m23:01:17.647009 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:01:17.647390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b638e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b63910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a11540>]}


============================== 2024-07-13 23:02:13.611580 | 4c85f4a3-0a80-4ec9-be4f-686199449c45 ==============================
[0m23:02:13.612609 [info ] [MainThread]: Running with dbt=1.2.0
[0m23:02:13.621969 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:02:13.622467 [debug] [MainThread]: Tracking: tracking
[0m23:02:13.638228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c15d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c14c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c15930>]}
[0m23:02:13.684011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:02:13.684920 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/hot_upsell.sql
[0m23:02:13.729370 [debug] [MainThread]: 1699: static parser successfully parsed hot_upsell.sql
[0m23:02:13.755300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c85f4a3-0a80-4ec9-be4f-686199449c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89cd300>]}
[0m23:02:13.765610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c85f4a3-0a80-4ec9-be4f-686199449c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b61120>]}
[0m23:02:13.766078 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m23:02:13.766443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c85f4a3-0a80-4ec9-be4f-686199449c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b63d00>]}
[0m23:02:13.768158 [info ] [MainThread]: 
[0m23:02:13.769368 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m23:02:13.771392 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m23:02:13.780707 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:02:13.781082 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:02:13.781318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:13.832113 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.05 seconds
[0m23:02:13.833969 [debug] [ThreadPool]: On list_postgres: Close
[0m23:02:13.837078 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m23:02:13.842345 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m23:02:13.842747 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m23:02:13.842980 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:13.850494 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m23:02:13.850971 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m23:02:13.851233 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:02:13.854653 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m23:02:13.856086 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m23:02:13.856515 [debug] [ThreadPool]: On list_postgres_public: Close
[0m23:02:13.860598 [debug] [MainThread]: Using postgres connection "master"
[0m23:02:13.860968 [debug] [MainThread]: On master: BEGIN
[0m23:02:13.861222 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:02:13.868033 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m23:02:13.868724 [debug] [MainThread]: Using postgres connection "master"
[0m23:02:13.868997 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:02:13.874830 [debug] [MainThread]: SQL status: SELECT 8 in 0.01 seconds
[0m23:02:13.876289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c85f4a3-0a80-4ec9-be4f-686199449c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89cd180>]}
[0m23:02:13.876714 [debug] [MainThread]: On master: ROLLBACK
[0m23:02:13.877028 [debug] [MainThread]: Using postgres connection "master"
[0m23:02:13.877256 [debug] [MainThread]: On master: BEGIN
[0m23:02:13.877589 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:02:13.877881 [debug] [MainThread]: On master: COMMIT
[0m23:02:13.878087 [debug] [MainThread]: Using postgres connection "master"
[0m23:02:13.878300 [debug] [MainThread]: On master: COMMIT
[0m23:02:13.878553 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:02:13.878765 [debug] [MainThread]: On master: Close
[0m23:02:13.879177 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m23:02:13.879474 [info ] [MainThread]: 
[0m23:02:13.882846 [debug] [Thread-1 (]: Began running node model.jaffle_shop.below_depletion_level
[0m23:02:13.882987 [debug] [Thread-2 (]: Began running node model.jaffle_shop.hot_upsell
[0m23:02:13.883355 [info ] [Thread-1 (]: 1 of 3 START view model public.below_depletion_level ........................... [RUN]
[0m23:02:13.883757 [info ] [Thread-2 (]: 2 of 3 START view model public.hot_upsell ...................................... [RUN]
[0m23:02:13.884277 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.below_depletion_level"
[0m23:02:13.884883 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.hot_upsell"
[0m23:02:13.885387 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.below_depletion_level
[0m23:02:13.885642 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.hot_upsell
[0m23:02:13.885940 [debug] [Thread-1 (]: Compiling model.jaffle_shop.below_depletion_level
[0m23:02:13.886207 [debug] [Thread-2 (]: Compiling model.jaffle_shop.hot_upsell
[0m23:02:13.888861 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.below_depletion_level"
[0m23:02:13.891217 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.hot_upsell"
[0m23:02:13.893369 [debug] [Thread-2 (]: finished collecting timing info
[0m23:02:13.893495 [debug] [Thread-1 (]: finished collecting timing info
[0m23:02:13.893751 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.hot_upsell
[0m23:02:13.893990 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.below_depletion_level
[0m23:02:13.932327 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.hot_upsell"
[0m23:02:13.933830 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.below_depletion_level"
[0m23:02:13.936780 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m23:02:13.936991 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m23:02:13.937244 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: BEGIN
[0m23:02:13.937490 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: BEGIN
[0m23:02:13.937734 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:02:13.937972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:02:13.944629 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m23:02:13.944868 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m23:02:13.945198 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m23:02:13.945450 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m23:02:13.945671 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */

  create view "postgres"."public"."below_depletion_level__dbt_tmp" as (
    select distinct name, ruv.variant, ruv.actual_size, ruv.weave_cat
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where stock_level < coalesce(depletion_level, 0)
  );
[0m23:02:13.945894 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */

  create view "postgres"."public"."hot_upsell__dbt_tmp" as (
    select distinct rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, (ruv.msrp - rupu.price) as profit_margin
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_pads_upsell" rupu on rupu.p_id = ruv.pid and rupu.variant = ruv.variant 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where new_arrival = 'Y' and stock_level < coalesce(depletion_level, 0) and rupu.stock_level is not null
order by profit_margin desc
  );
[0m23:02:13.948266 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column rupu.stock_level does not exist
LINE 8: ...nd stock_level < coalesce(depletion_level, 0) and rupu.stock...
                                                             ^
HINT:  Perhaps you meant to reference the column "ruv.stock_level".

[0m23:02:13.948670 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: ROLLBACK
[0m23:02:13.949161 [debug] [Thread-2 (]: finished collecting timing info
[0m23:02:13.949435 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: Close
[0m23:02:13.950210 [debug] [Thread-2 (]: Database Error in model hot_upsell (models/hot_upsell.sql)
  column rupu.stock_level does not exist
  LINE 8: ...nd stock_level < coalesce(depletion_level, 0) and rupu.stock...
                                                               ^
  HINT:  Perhaps you meant to reference the column "ruv.stock_level".
  compiled SQL at target/run/jaffle_shop/models/hot_upsell.sql
[0m23:02:13.951014 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c85f4a3-0a80-4ec9-be4f-686199449c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a76a70>]}
[0m23:02:13.951574 [error] [Thread-2 (]: 2 of 3 ERROR creating view model public.hot_upsell ............................. [[31mERROR[0m in 0.07s]
[0m23:02:13.951918 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m23:02:13.952394 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.hot_upsell
[0m23:02:13.957897 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m23:02:13.958541 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level" rename to "below_depletion_level__dbt_backup"
[0m23:02:13.959249 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:02:13.962086 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m23:02:13.962400 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level__dbt_tmp" rename to "below_depletion_level"
[0m23:02:13.963002 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:02:13.978384 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m23:02:13.978819 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m23:02:13.979089 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m23:02:13.982610 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:02:13.987102 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m23:02:13.987581 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
drop view if exists "postgres"."public"."below_depletion_level__dbt_backup" cascade
[0m23:02:13.991445 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:02:13.992566 [debug] [Thread-1 (]: finished collecting timing info
[0m23:02:13.992862 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: Close
[0m23:02:13.993341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c85f4a3-0a80-4ec9-be4f-686199449c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a98610>]}
[0m23:02:13.993790 [info ] [Thread-1 (]: 1 of 3 OK created view model public.below_depletion_level ...................... [[32mCREATE VIEW[0m in 0.11s]
[0m23:02:13.994260 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.below_depletion_level
[0m23:02:13.995643 [debug] [Thread-2 (]: Began running node model.jaffle_shop.priority_order
[0m23:02:13.995985 [info ] [Thread-2 (]: 3 of 3 START view model public.priority_order .................................. [RUN]
[0m23:02:13.996402 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.priority_order"
[0m23:02:13.996652 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.priority_order
[0m23:02:13.996892 [debug] [Thread-2 (]: Compiling model.jaffle_shop.priority_order
[0m23:02:13.999499 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.priority_order"
[0m23:02:14.000730 [debug] [Thread-2 (]: finished collecting timing info
[0m23:02:14.001041 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.priority_order
[0m23:02:14.004379 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.priority_order"
[0m23:02:14.005733 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m23:02:14.005967 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: BEGIN
[0m23:02:14.006166 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:02:14.012752 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m23:02:14.013112 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m23:02:14.013337 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */

  create view "postgres"."public"."priority_order__dbt_tmp" as (
    select distinct rup.name as product_name, ruv.variant as variant, ruv.actual_size, ruv.weave_cat, (msrp - price) as profit 
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
join "postgres"."public"."below_depletion_level" bdl on bdl.name = rup.name and bdl.variant = ruv.variant
order by profit desc
  );
[0m23:02:14.015973 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:02:14.018256 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m23:02:14.018756 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
alter table "postgres"."public"."priority_order__dbt_tmp" rename to "priority_order"
[0m23:02:14.019486 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:02:14.020890 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: COMMIT
[0m23:02:14.021144 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m23:02:14.021349 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: COMMIT
[0m23:02:14.022301 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:02:14.023691 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m23:02:14.023949 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
drop view if exists "postgres"."public"."priority_order__dbt_backup" cascade
[0m23:02:14.024430 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:02:14.025506 [debug] [Thread-2 (]: finished collecting timing info
[0m23:02:14.025773 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: Close
[0m23:02:14.026214 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c85f4a3-0a80-4ec9-be4f-686199449c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b86e30>]}
[0m23:02:14.026605 [info ] [Thread-2 (]: 3 of 3 OK created view model public.priority_order ............................. [[32mCREATE VIEW[0m in 0.03s]
[0m23:02:14.027009 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.priority_order
[0m23:02:14.028059 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m23:02:14.028317 [debug] [MainThread]: Using postgres connection "master"
[0m23:02:14.028530 [debug] [MainThread]: On master: BEGIN
[0m23:02:14.028734 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:02:14.035770 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m23:02:14.036251 [debug] [MainThread]: On master: COMMIT
[0m23:02:14.036488 [debug] [MainThread]: Using postgres connection "master"
[0m23:02:14.036709 [debug] [MainThread]: On master: COMMIT
[0m23:02:14.036983 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:02:14.037211 [debug] [MainThread]: On master: Close
[0m23:02:14.037924 [info ] [MainThread]: 
[0m23:02:14.038277 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m23:02:14.038624 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:02:14.038888 [debug] [MainThread]: Connection 'model.jaffle_shop.priority_order' was properly closed.
[0m23:02:14.039110 [debug] [MainThread]: Connection 'model.jaffle_shop.below_depletion_level' was properly closed.
[0m23:02:14.047810 [info ] [MainThread]: 
[0m23:02:14.048206 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:02:14.048588 [info ] [MainThread]: 
[0m23:02:14.048869 [error] [MainThread]: [33mDatabase Error in model hot_upsell (models/hot_upsell.sql)[0m
[0m23:02:14.049139 [error] [MainThread]:   column rupu.stock_level does not exist
[0m23:02:14.049391 [error] [MainThread]:   LINE 8: ...nd stock_level < coalesce(depletion_level, 0) and rupu.stock...
[0m23:02:14.049698 [error] [MainThread]:                                                                ^
[0m23:02:14.050146 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "ruv.stock_level".
[0m23:02:14.050549 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/hot_upsell.sql
[0m23:02:14.050913 [info ] [MainThread]: 
[0m23:02:14.051335 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:02:14.051958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b638e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a19030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a18fa0>]}


============================== 2024-07-14 03:25:45.361721 | 01ab9dc2-7973-4520-8058-f37e1c9561ce ==============================
[0m03:25:45.362086 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:25:45.372079 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:25:45.372449 [debug] [MainThread]: Tracking: tracking
[0m03:25:45.388071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1a500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1b5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c185b0>]}
[0m03:25:45.449082 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m03:25:45.449901 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/underselling_product_specs.sql
[0m03:25:45.493940 [debug] [MainThread]: 1699: static parser successfully parsed underselling_product_specs.sql
[0m03:25:45.547460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01ab9dc2-7973-4520-8058-f37e1c9561ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89d5420>]}
[0m03:25:45.558959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01ab9dc2-7973-4520-8058-f37e1c9561ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b63d60>]}
[0m03:25:45.559380 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m03:25:45.559743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01ab9dc2-7973-4520-8058-f37e1c9561ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b63d90>]}
[0m03:25:45.561691 [info ] [MainThread]: 
[0m03:25:45.562556 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:25:45.565448 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m03:25:45.575636 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m03:25:45.575998 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m03:25:45.576245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:25:45.650612 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.07 seconds
[0m03:25:45.654133 [debug] [ThreadPool]: On list_postgres: Close
[0m03:25:45.657292 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m03:25:45.662697 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m03:25:45.663000 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m03:25:45.663250 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:25:45.674121 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m03:25:45.674569 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m03:25:45.674893 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:25:45.683083 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.01 seconds
[0m03:25:45.684380 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m03:25:45.684765 [debug] [ThreadPool]: On list_postgres_public: Close
[0m03:25:45.688778 [debug] [MainThread]: Using postgres connection "master"
[0m03:25:45.689097 [debug] [MainThread]: On master: BEGIN
[0m03:25:45.689310 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:25:45.696110 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m03:25:45.696435 [debug] [MainThread]: Using postgres connection "master"
[0m03:25:45.696665 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:25:45.702980 [debug] [MainThread]: SQL status: SELECT 8 in 0.01 seconds
[0m03:25:45.704300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01ab9dc2-7973-4520-8058-f37e1c9561ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89d4f40>]}
[0m03:25:45.704695 [debug] [MainThread]: On master: ROLLBACK
[0m03:25:45.705005 [debug] [MainThread]: Using postgres connection "master"
[0m03:25:45.705211 [debug] [MainThread]: On master: BEGIN
[0m03:25:45.705555 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:25:45.705834 [debug] [MainThread]: On master: COMMIT
[0m03:25:45.706039 [debug] [MainThread]: Using postgres connection "master"
[0m03:25:45.706236 [debug] [MainThread]: On master: COMMIT
[0m03:25:45.706485 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:25:45.706696 [debug] [MainThread]: On master: Close
[0m03:25:45.707100 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m03:25:45.707452 [info ] [MainThread]: 
[0m03:25:45.712183 [debug] [Thread-1 (]: Began running node model.jaffle_shop.below_depletion_level
[0m03:25:45.712302 [debug] [Thread-2 (]: Began running node model.jaffle_shop.hot_upsell
[0m03:25:45.712647 [info ] [Thread-1 (]: 1 of 4 START view model public.below_depletion_level ........................... [RUN]
[0m03:25:45.713016 [info ] [Thread-2 (]: 2 of 4 START view model public.hot_upsell ...................................... [RUN]
[0m03:25:45.713471 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.below_depletion_level"
[0m03:25:45.714088 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.hot_upsell"
[0m03:25:45.714299 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.below_depletion_level
[0m03:25:45.714557 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.hot_upsell
[0m03:25:45.714796 [debug] [Thread-1 (]: Compiling model.jaffle_shop.below_depletion_level
[0m03:25:45.715007 [debug] [Thread-2 (]: Compiling model.jaffle_shop.hot_upsell
[0m03:25:45.717567 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.below_depletion_level"
[0m03:25:45.719959 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.hot_upsell"
[0m03:25:45.721757 [debug] [Thread-1 (]: finished collecting timing info
[0m03:25:45.721858 [debug] [Thread-2 (]: finished collecting timing info
[0m03:25:45.722081 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.below_depletion_level
[0m03:25:45.722308 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.hot_upsell
[0m03:25:45.766035 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.below_depletion_level"
[0m03:25:45.766384 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.hot_upsell"
[0m03:25:45.769760 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m03:25:45.769938 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m03:25:45.770167 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: BEGIN
[0m03:25:45.770395 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: BEGIN
[0m03:25:45.770631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:25:45.770893 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m03:25:45.778500 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m03:25:45.779074 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m03:25:45.779275 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m03:25:45.779659 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */

  create view "postgres"."public"."below_depletion_level__dbt_tmp" as (
    select distinct name, ruv.variant, ruv.actual_size, ruv.weave_cat
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where stock_level < coalesce(depletion_level, 0)
  );
[0m03:25:45.780007 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m03:25:45.780497 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */

  create view "postgres"."public"."hot_upsell__dbt_tmp" as (
    select distinct rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, (ruv.msrp - rupu.price) as profit_margin
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_pads_upsell" rupu on rupu.p_id = ruv.pid and rupu.variant = ruv.variant 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where new_arrival = 'Y' and stock_level < coalesce(depletion_level, 0) and rupu.stock_level is not null
order by profit_margin desc
  );
[0m03:25:45.782138 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column rupu.stock_level does not exist
LINE 8: ...nd stock_level < coalesce(depletion_level, 0) and rupu.stock...
                                                             ^
HINT:  Perhaps you meant to reference the column "ruv.stock_level".

[0m03:25:45.782545 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: ROLLBACK
[0m03:25:45.783076 [debug] [Thread-2 (]: finished collecting timing info
[0m03:25:45.783341 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: Close
[0m03:25:45.783881 [debug] [Thread-2 (]: Database Error in model hot_upsell (models/hot_upsell.sql)
  column rupu.stock_level does not exist
  LINE 8: ...nd stock_level < coalesce(depletion_level, 0) and rupu.stock...
                                                               ^
  HINT:  Perhaps you meant to reference the column "ruv.stock_level".
  compiled SQL at target/run/jaffle_shop/models/hot_upsell.sql
[0m03:25:45.784637 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01ab9dc2-7973-4520-8058-f37e1c9561ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a94f70>]}
[0m03:25:45.785202 [error] [Thread-2 (]: 2 of 4 ERROR creating view model public.hot_upsell ............................. [[31mERROR[0m in 0.07s]
[0m03:25:45.785850 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.hot_upsell
[0m03:25:45.786336 [debug] [Thread-2 (]: Began running node model.jaffle_shop.underselling_product_specs
[0m03:25:45.786835 [info ] [Thread-2 (]: 3 of 4 START view model public.underselling_product_specs ...................... [RUN]
[0m03:25:45.787378 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.underselling_product_specs"
[0m03:25:45.787763 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.underselling_product_specs
[0m03:25:45.788043 [debug] [Thread-2 (]: Compiling model.jaffle_shop.underselling_product_specs
[0m03:25:45.791403 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.underselling_product_specs"
[0m03:25:45.791594 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m03:25:45.798010 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m03:25:45.798323 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level" rename to "below_depletion_level__dbt_backup"
[0m03:25:45.798551 [debug] [Thread-2 (]: finished collecting timing info
[0m03:25:45.798842 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.underselling_product_specs
[0m03:25:45.801702 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.underselling_product_specs"
[0m03:25:45.801859 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:25:45.804014 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m03:25:45.804281 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level__dbt_tmp" rename to "below_depletion_level"
[0m03:25:45.804502 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m03:25:45.804876 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: BEGIN
[0m03:25:45.805079 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:25:45.805505 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:25:45.832421 [debug] [Thread-2 (]: SQL status: BEGIN in 0.03 seconds
[0m03:25:45.844042 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m03:25:45.844477 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m03:25:45.844781 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m03:25:45.845019 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */

  create view "postgres"."public"."underselling_product_specs__dbt_tmp" as (
    select distinct rup.name, rucm.color_value, ruv.actual_size, ruv.weave_cat, ruv.size_grp, ruv.shape, ruv.shape, (ruv.stock_level - ruv.depletion_level) as stock_depletion_ratio
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_color_map" rucm on rucm.color_id = ruv.pid 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
where stock_level > coalesce(depletion_level, 0) and depletion_level <> 0 and stock_level is not null and stock_level <> 0 and new_arrival = 'N' and status = 'In_stock'
order by stock_depletion_ratio desc limit 10
  );
[0m03:25:45.845265 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m03:25:45.847244 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:25:45.847667 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "shape" specified more than once

[0m03:25:45.852360 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m03:25:45.852891 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: ROLLBACK
[0m03:25:45.853190 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
drop view if exists "postgres"."public"."below_depletion_level__dbt_backup" cascade
[0m03:25:45.853733 [debug] [Thread-2 (]: finished collecting timing info
[0m03:25:45.853975 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: Close
[0m03:25:45.854538 [debug] [Thread-2 (]: Database Error in model underselling_product_specs (models/underselling_product_specs.sql)
  column "shape" specified more than once
  compiled SQL at target/run/jaffle_shop/models/underselling_product_specs.sql
[0m03:25:45.855957 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01ab9dc2-7973-4520-8058-f37e1c9561ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff80b5030>]}
[0m03:25:45.856604 [error] [Thread-2 (]: 3 of 4 ERROR creating view model public.underselling_product_specs ............. [[31mERROR[0m in 0.07s]
[0m03:25:45.857129 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.underselling_product_specs
[0m03:25:45.859801 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m03:25:45.860975 [debug] [Thread-1 (]: finished collecting timing info
[0m03:25:45.861235 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: Close
[0m03:25:45.861751 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01ab9dc2-7973-4520-8058-f37e1c9561ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a62380>]}
[0m03:25:45.862165 [info ] [Thread-1 (]: 1 of 4 OK created view model public.below_depletion_level ...................... [[32mCREATE VIEW[0m in 0.15s]
[0m03:25:45.862768 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.below_depletion_level
[0m03:25:45.864322 [debug] [Thread-2 (]: Began running node model.jaffle_shop.priority_order
[0m03:25:45.864647 [info ] [Thread-2 (]: 4 of 4 START view model public.priority_order .................................. [RUN]
[0m03:25:45.865093 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.priority_order"
[0m03:25:45.865324 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.priority_order
[0m03:25:45.865577 [debug] [Thread-2 (]: Compiling model.jaffle_shop.priority_order
[0m03:25:45.868616 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.priority_order"
[0m03:25:45.869699 [debug] [Thread-2 (]: finished collecting timing info
[0m03:25:45.870117 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.priority_order
[0m03:25:45.873338 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.priority_order"
[0m03:25:45.874853 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m03:25:45.875122 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: BEGIN
[0m03:25:45.875408 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:25:45.882501 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m03:25:45.882908 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m03:25:45.883139 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */

  create view "postgres"."public"."priority_order__dbt_tmp" as (
    select distinct rup.name as product_name, ruv.variant as variant, ruv.actual_size, ruv.weave_cat, (msrp - price) as profit 
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
join "postgres"."public"."below_depletion_level" bdl on bdl.name = rup.name and bdl.variant = ruv.variant
order by profit desc
  );
[0m03:25:45.886168 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m03:25:45.888473 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m03:25:45.888758 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
alter table "postgres"."public"."priority_order__dbt_tmp" rename to "priority_order"
[0m03:25:45.889397 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:25:45.890584 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: COMMIT
[0m03:25:45.890813 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m03:25:45.891024 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: COMMIT
[0m03:25:45.892461 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m03:25:45.893813 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m03:25:45.894034 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
drop view if exists "postgres"."public"."priority_order__dbt_backup" cascade
[0m03:25:45.894397 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m03:25:45.895338 [debug] [Thread-2 (]: finished collecting timing info
[0m03:25:45.895613 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: Close
[0m03:25:45.896076 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01ab9dc2-7973-4520-8058-f37e1c9561ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a96230>]}
[0m03:25:45.896482 [info ] [Thread-2 (]: 4 of 4 OK created view model public.priority_order ............................. [[32mCREATE VIEW[0m in 0.03s]
[0m03:25:45.896903 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.priority_order
[0m03:25:45.898086 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:25:45.898339 [debug] [MainThread]: Using postgres connection "master"
[0m03:25:45.898568 [debug] [MainThread]: On master: BEGIN
[0m03:25:45.898779 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:25:45.905414 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m03:25:45.905963 [debug] [MainThread]: On master: COMMIT
[0m03:25:45.906226 [debug] [MainThread]: Using postgres connection "master"
[0m03:25:45.906472 [debug] [MainThread]: On master: COMMIT
[0m03:25:45.906813 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:25:45.907058 [debug] [MainThread]: On master: Close
[0m03:25:45.907771 [info ] [MainThread]: 
[0m03:25:45.908169 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m03:25:45.908562 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:25:45.908816 [debug] [MainThread]: Connection 'model.jaffle_shop.below_depletion_level' was properly closed.
[0m03:25:45.909031 [debug] [MainThread]: Connection 'model.jaffle_shop.priority_order' was properly closed.
[0m03:25:45.915960 [info ] [MainThread]: 
[0m03:25:45.916333 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m03:25:45.916686 [info ] [MainThread]: 
[0m03:25:45.916989 [error] [MainThread]: [33mDatabase Error in model hot_upsell (models/hot_upsell.sql)[0m
[0m03:25:45.917357 [error] [MainThread]:   column rupu.stock_level does not exist
[0m03:25:45.917659 [error] [MainThread]:   LINE 8: ...nd stock_level < coalesce(depletion_level, 0) and rupu.stock...
[0m03:25:45.917921 [error] [MainThread]:                                                                ^
[0m03:25:45.918189 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "ruv.stock_level".
[0m03:25:45.918478 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/hot_upsell.sql
[0m03:25:45.918788 [info ] [MainThread]: 
[0m03:25:45.919117 [error] [MainThread]: [33mDatabase Error in model underselling_product_specs (models/underselling_product_specs.sql)[0m
[0m03:25:45.919383 [error] [MainThread]:   column "shape" specified more than once
[0m03:25:45.919648 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/underselling_product_specs.sql
[0m03:25:45.919945 [info ] [MainThread]: 
[0m03:25:45.920224 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m03:25:45.920645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a9b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b89510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b88b80>]}


============================== 2024-07-14 03:26:07.171967 | aaea4c08-26f8-447c-8aec-589b3b1ad441 ==============================
[0m03:26:07.172279 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:26:07.175162 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:26:07.175553 [debug] [MainThread]: Tracking: tracking
[0m03:26:07.190177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2afb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2bfd0>]}
[0m03:26:07.231800 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:26:07.232474 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/underselling_product_specs.sql
[0m03:26:07.271661 [debug] [MainThread]: 1699: static parser successfully parsed underselling_product_specs.sql
[0m03:26:07.293939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aaea4c08-26f8-447c-8aec-589b3b1ad441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89d16f0>]}
[0m03:26:07.302792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aaea4c08-26f8-447c-8aec-589b3b1ad441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b61420>]}
[0m03:26:07.303211 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m03:26:07.303532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aaea4c08-26f8-447c-8aec-589b3b1ad441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b63fd0>]}
[0m03:26:07.305127 [info ] [MainThread]: 
[0m03:26:07.305752 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:26:07.307596 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m03:26:07.315909 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m03:26:07.316226 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m03:26:07.316436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:26:07.361141 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.04 seconds
[0m03:26:07.362902 [debug] [ThreadPool]: On list_postgres: Close
[0m03:26:07.364918 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m03:26:07.369594 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m03:26:07.369871 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m03:26:07.370097 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:26:07.377672 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m03:26:07.378128 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m03:26:07.378379 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:26:07.381210 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m03:26:07.382451 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m03:26:07.382880 [debug] [ThreadPool]: On list_postgres_public: Close
[0m03:26:07.386919 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:07.387226 [debug] [MainThread]: On master: BEGIN
[0m03:26:07.387487 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:26:07.394114 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m03:26:07.394495 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:07.394747 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:26:07.401538 [debug] [MainThread]: SQL status: SELECT 8 in 0.01 seconds
[0m03:26:07.402871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aaea4c08-26f8-447c-8aec-589b3b1ad441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89d11b0>]}
[0m03:26:07.403270 [debug] [MainThread]: On master: ROLLBACK
[0m03:26:07.403603 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:07.403836 [debug] [MainThread]: On master: BEGIN
[0m03:26:07.404210 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:26:07.404572 [debug] [MainThread]: On master: COMMIT
[0m03:26:07.404829 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:07.405047 [debug] [MainThread]: On master: COMMIT
[0m03:26:07.405356 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:26:07.405598 [debug] [MainThread]: On master: Close
[0m03:26:07.406025 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m03:26:07.406341 [info ] [MainThread]: 
[0m03:26:07.416499 [debug] [Thread-1 (]: Began running node model.jaffle_shop.below_depletion_level
[0m03:26:07.416643 [debug] [Thread-2 (]: Began running node model.jaffle_shop.hot_upsell
[0m03:26:07.416989 [info ] [Thread-1 (]: 1 of 4 START view model public.below_depletion_level ........................... [RUN]
[0m03:26:07.417327 [info ] [Thread-2 (]: 2 of 4 START view model public.hot_upsell ...................................... [RUN]
[0m03:26:07.417786 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.below_depletion_level"
[0m03:26:07.418175 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.hot_upsell"
[0m03:26:07.418391 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.below_depletion_level
[0m03:26:07.418608 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.hot_upsell
[0m03:26:07.418832 [debug] [Thread-1 (]: Compiling model.jaffle_shop.below_depletion_level
[0m03:26:07.419038 [debug] [Thread-2 (]: Compiling model.jaffle_shop.hot_upsell
[0m03:26:07.421536 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.below_depletion_level"
[0m03:26:07.423908 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.hot_upsell"
[0m03:26:07.425515 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:07.425639 [debug] [Thread-2 (]: finished collecting timing info
[0m03:26:07.425890 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.below_depletion_level
[0m03:26:07.426159 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.hot_upsell
[0m03:26:07.462914 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.hot_upsell"
[0m03:26:07.463833 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.below_depletion_level"
[0m03:26:07.465276 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m03:26:07.465397 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m03:26:07.465609 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: BEGIN
[0m03:26:07.465854 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: BEGIN
[0m03:26:07.466105 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m03:26:07.466346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:26:07.473386 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m03:26:07.473590 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m03:26:07.473855 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m03:26:07.474084 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m03:26:07.474287 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */

  create view "postgres"."public"."hot_upsell__dbt_tmp" as (
    select distinct rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, (ruv.msrp - rupu.price) as profit_margin
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_pads_upsell" rupu on rupu.p_id = ruv.pid and rupu.variant = ruv.variant 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where new_arrival = 'Y' and stock_level < coalesce(depletion_level, 0) and rupu.stock_level is not null
order by profit_margin desc
  );
[0m03:26:07.474481 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */

  create view "postgres"."public"."below_depletion_level__dbt_tmp" as (
    select distinct name, ruv.variant, ruv.actual_size, ruv.weave_cat
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where stock_level < coalesce(depletion_level, 0)
  );
[0m03:26:07.476032 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column rupu.stock_level does not exist
LINE 8: ...nd stock_level < coalesce(depletion_level, 0) and rupu.stock...
                                                             ^
HINT:  Perhaps you meant to reference the column "ruv.stock_level".

[0m03:26:07.476552 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: ROLLBACK
[0m03:26:07.477159 [debug] [Thread-2 (]: finished collecting timing info
[0m03:26:07.477407 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: Close
[0m03:26:07.477914 [debug] [Thread-2 (]: Database Error in model hot_upsell (models/hot_upsell.sql)
  column rupu.stock_level does not exist
  LINE 8: ...nd stock_level < coalesce(depletion_level, 0) and rupu.stock...
                                                               ^
  HINT:  Perhaps you meant to reference the column "ruv.stock_level".
  compiled SQL at target/run/jaffle_shop/models/hot_upsell.sql
[0m03:26:07.478450 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaea4c08-26f8-447c-8aec-589b3b1ad441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff80b2f50>]}
[0m03:26:07.478651 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m03:26:07.478921 [error] [Thread-2 (]: 2 of 4 ERROR creating view model public.hot_upsell ............................. [[31mERROR[0m in 0.06s]
[0m03:26:07.484142 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m03:26:07.484629 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.hot_upsell
[0m03:26:07.484836 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level" rename to "below_depletion_level__dbt_backup"
[0m03:26:07.485100 [debug] [Thread-2 (]: Began running node model.jaffle_shop.underselling_product_specs
[0m03:26:07.486485 [info ] [Thread-2 (]: 3 of 4 START view model public.underselling_product_specs ...................... [RUN]
[0m03:26:07.486693 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:07.486994 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.underselling_product_specs"
[0m03:26:07.488766 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m03:26:07.489098 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.underselling_product_specs
[0m03:26:07.489345 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level__dbt_tmp" rename to "below_depletion_level"
[0m03:26:07.489595 [debug] [Thread-2 (]: Compiling model.jaffle_shop.underselling_product_specs
[0m03:26:07.492055 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.underselling_product_specs"
[0m03:26:07.492172 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:07.507079 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m03:26:07.507381 [debug] [Thread-2 (]: finished collecting timing info
[0m03:26:07.507476 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m03:26:07.507769 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.underselling_product_specs
[0m03:26:07.508043 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m03:26:07.511013 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.underselling_product_specs"
[0m03:26:07.512208 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m03:26:07.512307 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:26:07.512503 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: BEGIN
[0m03:26:07.516131 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m03:26:07.516401 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:26:07.516635 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
drop view if exists "postgres"."public"."below_depletion_level__dbt_backup" cascade
[0m03:26:07.520100 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m03:26:07.521320 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:07.521580 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: Close
[0m03:26:07.522031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaea4c08-26f8-447c-8aec-589b3b1ad441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a623e0>]}
[0m03:26:07.522448 [info ] [Thread-1 (]: 1 of 4 OK created view model public.below_depletion_level ...................... [[32mCREATE VIEW[0m in 0.10s]
[0m03:26:07.522911 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.below_depletion_level
[0m03:26:07.523683 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m03:26:07.523849 [debug] [Thread-1 (]: Began running node model.jaffle_shop.priority_order
[0m03:26:07.524087 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m03:26:07.524466 [info ] [Thread-1 (]: 4 of 4 START view model public.priority_order .................................. [RUN]
[0m03:26:07.524738 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */

  create view "postgres"."public"."underselling_product_specs__dbt_tmp" as (
    select distinct rup.name, rucm.color_value, ruv.actual_size, ruv.weave_cat, ruv.size_grp, ruv.shape, (ruv.stock_level - ruv.depletion_level) as stock_depletion_ratio
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_color_map" rucm on rucm.color_id = ruv.pid 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
where stock_level > coalesce(depletion_level, 0) and depletion_level <> 0 and stock_level is not null and stock_level <> 0 and new_arrival = 'N' and status = 'In_stock'
order by stock_depletion_ratio desc limit 10
  );
[0m03:26:07.525200 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.priority_order"
[0m03:26:07.525650 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.priority_order
[0m03:26:07.525887 [debug] [Thread-1 (]: Compiling model.jaffle_shop.priority_order
[0m03:26:07.528867 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.priority_order"
[0m03:26:07.528989 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m03:26:07.531246 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m03:26:07.531520 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
alter table "postgres"."public"."underselling_product_specs__dbt_tmp" rename to "underselling_product_specs"
[0m03:26:07.531759 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:07.532016 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.priority_order
[0m03:26:07.532188 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:07.534829 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.priority_order"
[0m03:26:07.536006 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: COMMIT
[0m03:26:07.536531 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m03:26:07.536736 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: COMMIT
[0m03:26:07.536926 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m03:26:07.537248 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: BEGIN
[0m03:26:07.537440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:26:07.538907 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m03:26:07.540457 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m03:26:07.540759 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
drop view if exists "postgres"."public"."underselling_product_specs__dbt_backup" cascade
[0m03:26:07.541191 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m03:26:07.542230 [debug] [Thread-2 (]: finished collecting timing info
[0m03:26:07.542473 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: Close
[0m03:26:07.542919 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaea4c08-26f8-447c-8aec-589b3b1ad441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff80a6b30>]}
[0m03:26:07.543297 [info ] [Thread-2 (]: 3 of 4 OK created view model public.underselling_product_specs ................. [[32mCREATE VIEW[0m in 0.06s]
[0m03:26:07.543710 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.underselling_product_specs
[0m03:26:07.547470 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m03:26:07.547759 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m03:26:07.547969 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */

  create view "postgres"."public"."priority_order__dbt_tmp" as (
    select distinct rup.name as product_name, ruv.variant as variant, ruv.actual_size, ruv.weave_cat, (msrp - price) as profit 
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
join "postgres"."public"."below_depletion_level" bdl on bdl.name = rup.name and bdl.variant = ruv.variant
order by profit desc
  );
[0m03:26:07.553273 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m03:26:07.555322 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m03:26:07.555556 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
alter table "postgres"."public"."priority_order__dbt_tmp" rename to "priority_order"
[0m03:26:07.556083 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:07.557231 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: COMMIT
[0m03:26:07.557449 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m03:26:07.557651 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: COMMIT
[0m03:26:07.558540 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:26:07.560762 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m03:26:07.560974 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
drop view if exists "postgres"."public"."priority_order__dbt_backup" cascade
[0m03:26:07.561347 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m03:26:07.562214 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:07.562445 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: Close
[0m03:26:07.562868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaea4c08-26f8-447c-8aec-589b3b1ad441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8122410>]}
[0m03:26:07.563243 [info ] [Thread-1 (]: 4 of 4 OK created view model public.priority_order ............................. [[32mCREATE VIEW[0m in 0.04s]
[0m03:26:07.563644 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.priority_order
[0m03:26:07.565314 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:26:07.565575 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:07.565795 [debug] [MainThread]: On master: BEGIN
[0m03:26:07.565996 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:26:07.572098 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m03:26:07.572437 [debug] [MainThread]: On master: COMMIT
[0m03:26:07.572730 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:07.572965 [debug] [MainThread]: On master: COMMIT
[0m03:26:07.573251 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:26:07.573491 [debug] [MainThread]: On master: Close
[0m03:26:07.574198 [info ] [MainThread]: 
[0m03:26:07.574660 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m03:26:07.575144 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:26:07.575390 [debug] [MainThread]: Connection 'model.jaffle_shop.priority_order' was properly closed.
[0m03:26:07.575649 [debug] [MainThread]: Connection 'model.jaffle_shop.underselling_product_specs' was properly closed.
[0m03:26:07.582902 [info ] [MainThread]: 
[0m03:26:07.583221 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:26:07.583542 [info ] [MainThread]: 
[0m03:26:07.583853 [error] [MainThread]: [33mDatabase Error in model hot_upsell (models/hot_upsell.sql)[0m
[0m03:26:07.584125 [error] [MainThread]:   column rupu.stock_level does not exist
[0m03:26:07.584395 [error] [MainThread]:   LINE 8: ...nd stock_level < coalesce(depletion_level, 0) and rupu.stock...
[0m03:26:07.584899 [error] [MainThread]:                                                                ^
[0m03:26:07.585242 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "ruv.stock_level".
[0m03:26:07.585585 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/hot_upsell.sql
[0m03:26:07.585860 [info ] [MainThread]: 
[0m03:26:07.586193 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m03:26:07.586554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8121540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff81215a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8120fd0>]}


============================== 2024-07-14 03:47:18.117330 | ca8c2a34-1b98-49fb-aa29-38609e87a37f ==============================
[0m03:47:18.117653 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:47:18.127218 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:47:18.127666 [debug] [MainThread]: Tracking: tracking
[0m03:47:18.142797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2afb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2bfd0>]}
[0m03:47:18.189391 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:47:18.190075 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/underselling_product_specs.sql
[0m03:47:18.227665 [debug] [MainThread]: 1699: static parser successfully parsed underselling_product_specs.sql
[0m03:47:18.248102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca8c2a34-1b98-49fb-aa29-38609e87a37f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89d16f0>]}
[0m03:47:18.258546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca8c2a34-1b98-49fb-aa29-38609e87a37f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b61420>]}
[0m03:47:18.258906 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m03:47:18.259231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca8c2a34-1b98-49fb-aa29-38609e87a37f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b63fd0>]}
[0m03:47:18.260735 [info ] [MainThread]: 
[0m03:47:18.261298 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:47:18.263417 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m03:47:18.272134 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m03:47:18.272755 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m03:47:18.273022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:47:18.324115 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.05 seconds
[0m03:47:18.325858 [debug] [ThreadPool]: On list_postgres: Close
[0m03:47:18.327880 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m03:47:18.332850 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m03:47:18.333055 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m03:47:18.333228 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:47:18.341280 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m03:47:18.341604 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m03:47:18.341785 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:47:18.346287 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m03:47:18.347473 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m03:47:18.347763 [debug] [ThreadPool]: On list_postgres_public: Close
[0m03:47:18.351577 [debug] [MainThread]: Using postgres connection "master"
[0m03:47:18.351868 [debug] [MainThread]: On master: BEGIN
[0m03:47:18.352067 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:47:18.359721 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m03:47:18.360057 [debug] [MainThread]: Using postgres connection "master"
[0m03:47:18.360305 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:47:18.369727 [debug] [MainThread]: SQL status: SELECT 11 in 0.01 seconds
[0m03:47:18.371302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca8c2a34-1b98-49fb-aa29-38609e87a37f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89d11b0>]}
[0m03:47:18.371720 [debug] [MainThread]: On master: ROLLBACK
[0m03:47:18.372017 [debug] [MainThread]: Using postgres connection "master"
[0m03:47:18.372230 [debug] [MainThread]: On master: BEGIN
[0m03:47:18.372620 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:47:18.372922 [debug] [MainThread]: On master: COMMIT
[0m03:47:18.373130 [debug] [MainThread]: Using postgres connection "master"
[0m03:47:18.373333 [debug] [MainThread]: On master: COMMIT
[0m03:47:18.373608 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:47:18.373819 [debug] [MainThread]: On master: Close
[0m03:47:18.374240 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m03:47:18.374558 [info ] [MainThread]: 
[0m03:47:18.378980 [debug] [Thread-1 (]: Began running node model.jaffle_shop.below_depletion_level
[0m03:47:18.379109 [debug] [Thread-2 (]: Began running node model.jaffle_shop.hot_upsell
[0m03:47:18.379452 [info ] [Thread-1 (]: 1 of 4 START view model public.below_depletion_level ........................... [RUN]
[0m03:47:18.379793 [info ] [Thread-2 (]: 2 of 4 START view model public.hot_upsell ...................................... [RUN]
[0m03:47:18.380337 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.below_depletion_level"
[0m03:47:18.380776 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.hot_upsell"
[0m03:47:18.380989 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.below_depletion_level
[0m03:47:18.381197 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.hot_upsell
[0m03:47:18.381456 [debug] [Thread-1 (]: Compiling model.jaffle_shop.below_depletion_level
[0m03:47:18.381674 [debug] [Thread-2 (]: Compiling model.jaffle_shop.hot_upsell
[0m03:47:18.384244 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.below_depletion_level"
[0m03:47:18.387063 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.hot_upsell"
[0m03:47:18.390621 [debug] [Thread-2 (]: finished collecting timing info
[0m03:47:18.390908 [debug] [Thread-1 (]: finished collecting timing info
[0m03:47:18.391162 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.hot_upsell
[0m03:47:18.391752 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.below_depletion_level
[0m03:47:18.428446 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.hot_upsell"
[0m03:47:18.429268 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.below_depletion_level"
[0m03:47:18.431869 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m03:47:18.432012 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m03:47:18.432227 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: BEGIN
[0m03:47:18.432490 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: BEGIN
[0m03:47:18.432742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:47:18.432987 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m03:47:18.440078 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m03:47:18.440465 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m03:47:18.440710 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */

  create view "postgres"."public"."hot_upsell__dbt_tmp" as (
    select distinct rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, (ruv.msrp - rupu.price) as profit_margin
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_pads_upsell" rupu on rupu.p_id = ruv.pid and rupu.variant = ruv.variant 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where new_arrival = 'Y' and stock_level < coalesce(depletion_level, 0) and rupu.stock_level is not null
order by profit_margin desc
  );
[0m03:47:18.441430 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m03:47:18.441673 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m03:47:18.441894 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */

  create view "postgres"."public"."below_depletion_level__dbt_tmp" as (
    select distinct name, ruv.variant, ruv.actual_size, ruv.weave_cat
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where stock_level < coalesce(depletion_level, 0)
  );
[0m03:47:18.443250 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column rupu.stock_level does not exist
LINE 8: ...nd stock_level < coalesce(depletion_level, 0) and rupu.stock...
                                                             ^
HINT:  Perhaps you meant to reference the column "ruv.stock_level".

[0m03:47:18.443697 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: ROLLBACK
[0m03:47:18.444169 [debug] [Thread-2 (]: finished collecting timing info
[0m03:47:18.444414 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: Close
[0m03:47:18.444866 [debug] [Thread-2 (]: Database Error in model hot_upsell (models/hot_upsell.sql)
  column rupu.stock_level does not exist
  LINE 8: ...nd stock_level < coalesce(depletion_level, 0) and rupu.stock...
                                                               ^
  HINT:  Perhaps you meant to reference the column "ruv.stock_level".
  compiled SQL at target/run/jaffle_shop/models/hot_upsell.sql
[0m03:47:18.445352 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca8c2a34-1b98-49fb-aa29-38609e87a37f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a66fe0>]}
[0m03:47:18.445785 [error] [Thread-2 (]: 2 of 4 ERROR creating view model public.hot_upsell ............................. [[31mERROR[0m in 0.06s]
[0m03:47:18.446334 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.hot_upsell
[0m03:47:18.446632 [debug] [Thread-2 (]: Began running node model.jaffle_shop.underselling_product_specs
[0m03:47:18.446989 [info ] [Thread-2 (]: 3 of 4 START view model public.underselling_product_specs ...................... [RUN]
[0m03:47:18.447441 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.underselling_product_specs"
[0m03:47:18.447564 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m03:47:18.447793 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.underselling_product_specs
[0m03:47:18.453577 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m03:47:18.453824 [debug] [Thread-2 (]: Compiling model.jaffle_shop.underselling_product_specs
[0m03:47:18.454041 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level" rename to "below_depletion_level__dbt_backup"
[0m03:47:18.456305 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.underselling_product_specs"
[0m03:47:18.457027 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:47:18.459071 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m03:47:18.459416 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level__dbt_tmp" rename to "below_depletion_level"
[0m03:47:18.459512 [debug] [Thread-2 (]: finished collecting timing info
[0m03:47:18.459882 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.underselling_product_specs
[0m03:47:18.460028 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:47:18.462710 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.underselling_product_specs"
[0m03:47:18.479261 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m03:47:18.480236 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m03:47:18.480461 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m03:47:18.480667 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m03:47:18.480930 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: BEGIN
[0m03:47:18.481135 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:47:18.487823 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m03:47:18.488434 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m03:47:18.488714 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */

  create view "postgres"."public"."underselling_product_specs__dbt_tmp" as (
    select distinct rup.name, rucm.color_value, ruv.actual_size, ruv.weave_cat, ruv.size_grp, ruv.shape, (ruv.stock_level - ruv.depletion_level) as stock_depletion_ratio
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_color_map" rucm on rucm.color_id = ruv.pid 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
where stock_level > coalesce(depletion_level, 0) and depletion_level <> 0 
and stock_level is not null and stock_level <> 0 and new_arrival = 'N' and status = 'In_stock'
order by stock_depletion_ratio desc limit 10
  );
[0m03:47:18.489557 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m03:47:18.494499 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m03:47:18.494956 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
drop view if exists "postgres"."public"."below_depletion_level__dbt_backup" cascade
[0m03:47:18.497525 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m03:47:18.500062 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m03:47:18.500176 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m03:47:18.500406 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
alter table "postgres"."public"."underselling_product_specs" rename to "underselling_product_specs__dbt_backup"
[0m03:47:18.501339 [debug] [Thread-1 (]: finished collecting timing info
[0m03:47:18.501771 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: Close
[0m03:47:18.501984 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:47:18.502414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca8c2a34-1b98-49fb-aa29-38609e87a37f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a91ea0>]}
[0m03:47:18.504362 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m03:47:18.504801 [info ] [Thread-1 (]: 1 of 4 OK created view model public.below_depletion_level ...................... [[32mCREATE VIEW[0m in 0.12s]
[0m03:47:18.505104 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
alter table "postgres"."public"."underselling_product_specs__dbt_tmp" rename to "underselling_product_specs"
[0m03:47:18.505546 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.below_depletion_level
[0m03:47:18.506231 [debug] [Thread-1 (]: Began running node model.jaffle_shop.priority_order
[0m03:47:18.506621 [info ] [Thread-1 (]: 4 of 4 START view model public.priority_order .................................. [RUN]
[0m03:47:18.506731 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:47:18.507193 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.priority_order"
[0m03:47:18.508606 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: COMMIT
[0m03:47:18.508882 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.priority_order
[0m03:47:18.509086 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m03:47:18.509289 [debug] [Thread-1 (]: Compiling model.jaffle_shop.priority_order
[0m03:47:18.509511 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: COMMIT
[0m03:47:18.512356 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.priority_order"
[0m03:47:18.513362 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m03:47:18.514814 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m03:47:18.514919 [debug] [Thread-1 (]: finished collecting timing info
[0m03:47:18.515121 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
drop view if exists "postgres"."public"."underselling_product_specs__dbt_backup" cascade
[0m03:47:18.515356 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.priority_order
[0m03:47:18.519478 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.priority_order"
[0m03:47:18.519579 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m03:47:18.521211 [debug] [Thread-2 (]: finished collecting timing info
[0m03:47:18.521472 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: Close
[0m03:47:18.521650 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m03:47:18.522079 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca8c2a34-1b98-49fb-aa29-38609e87a37f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89efd60>]}
[0m03:47:18.522271 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: BEGIN
[0m03:47:18.522655 [info ] [Thread-2 (]: 3 of 4 OK created view model public.underselling_product_specs ................. [[32mCREATE VIEW[0m in 0.07s]
[0m03:47:18.522882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:47:18.523234 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.underselling_product_specs
[0m03:47:18.529795 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m03:47:18.530191 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m03:47:18.530441 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */

  create view "postgres"."public"."priority_order__dbt_tmp" as (
    select distinct rup.name as product_name, ruv.variant as variant, ruv.actual_size, ruv.weave_cat, (msrp - price) as profit 
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
join "postgres"."public"."below_depletion_level" bdl on bdl.name = rup.name and bdl.variant = ruv.variant
order by profit desc
  );
[0m03:47:18.534081 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m03:47:18.536108 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m03:47:18.536398 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
alter table "postgres"."public"."priority_order__dbt_tmp" rename to "priority_order"
[0m03:47:18.536934 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:47:18.538040 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: COMMIT
[0m03:47:18.538242 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m03:47:18.538426 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: COMMIT
[0m03:47:18.539214 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:47:18.540480 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m03:47:18.540663 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
drop view if exists "postgres"."public"."priority_order__dbt_backup" cascade
[0m03:47:18.541003 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m03:47:18.541821 [debug] [Thread-1 (]: finished collecting timing info
[0m03:47:18.542044 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: Close
[0m03:47:18.542469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca8c2a34-1b98-49fb-aa29-38609e87a37f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8119e40>]}
[0m03:47:18.542847 [info ] [Thread-1 (]: 4 of 4 OK created view model public.priority_order ............................. [[32mCREATE VIEW[0m in 0.04s]
[0m03:47:18.543266 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.priority_order
[0m03:47:18.545032 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:47:18.545277 [debug] [MainThread]: Using postgres connection "master"
[0m03:47:18.545510 [debug] [MainThread]: On master: BEGIN
[0m03:47:18.545704 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:47:18.551644 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m03:47:18.551949 [debug] [MainThread]: On master: COMMIT
[0m03:47:18.552176 [debug] [MainThread]: Using postgres connection "master"
[0m03:47:18.552440 [debug] [MainThread]: On master: COMMIT
[0m03:47:18.552751 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:47:18.552986 [debug] [MainThread]: On master: Close
[0m03:47:18.553586 [info ] [MainThread]: 
[0m03:47:18.553904 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m03:47:18.554260 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:47:18.554511 [debug] [MainThread]: Connection 'model.jaffle_shop.priority_order' was properly closed.
[0m03:47:18.554730 [debug] [MainThread]: Connection 'model.jaffle_shop.underselling_product_specs' was properly closed.
[0m03:47:18.561634 [info ] [MainThread]: 
[0m03:47:18.561931 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:47:18.562233 [info ] [MainThread]: 
[0m03:47:18.562533 [error] [MainThread]: [33mDatabase Error in model hot_upsell (models/hot_upsell.sql)[0m
[0m03:47:18.562815 [error] [MainThread]:   column rupu.stock_level does not exist
[0m03:47:18.563054 [error] [MainThread]:   LINE 8: ...nd stock_level < coalesce(depletion_level, 0) and rupu.stock...
[0m03:47:18.563312 [error] [MainThread]:                                                                ^
[0m03:47:18.563576 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "ruv.stock_level".
[0m03:47:18.563839 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/hot_upsell.sql
[0m03:47:18.564106 [info ] [MainThread]: 
[0m03:47:18.564377 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m03:47:18.564733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b63bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8119e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff80dd180>]}


============================== 2024-07-14 03:48:14.922848 | 5e4dff10-a9d0-4b8f-b591-0a1b95b4b6db ==============================
[0m03:48:14.923163 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:48:14.932349 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:48:14.932736 [debug] [MainThread]: Tracking: tracking
[0m03:48:14.947026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2af50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b220>]}
[0m03:48:14.988616 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:48:14.989288 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/hot_upsell.sql
[0m03:48:15.028161 [debug] [MainThread]: 1699: static parser successfully parsed hot_upsell.sql
[0m03:48:15.047966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e4dff10-a9d0-4b8f-b591-0a1b95b4b6db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89d1720>]}
[0m03:48:15.056977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e4dff10-a9d0-4b8f-b591-0a1b95b4b6db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b61360>]}
[0m03:48:15.057444 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m03:48:15.057813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e4dff10-a9d0-4b8f-b591-0a1b95b4b6db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b63fa0>]}
[0m03:48:15.059375 [info ] [MainThread]: 
[0m03:48:15.059954 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:48:15.061659 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m03:48:15.069948 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m03:48:15.070258 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m03:48:15.070497 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:48:15.114940 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.04 seconds
[0m03:48:15.116689 [debug] [ThreadPool]: On list_postgres: Close
[0m03:48:15.118711 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m03:48:15.123411 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m03:48:15.123684 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m03:48:15.123922 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:48:15.131995 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m03:48:15.132332 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m03:48:15.132552 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:48:15.135956 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m03:48:15.137214 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m03:48:15.137563 [debug] [ThreadPool]: On list_postgres_public: Close
[0m03:48:15.141531 [debug] [MainThread]: Using postgres connection "master"
[0m03:48:15.141836 [debug] [MainThread]: On master: BEGIN
[0m03:48:15.142043 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:48:15.148352 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m03:48:15.148645 [debug] [MainThread]: Using postgres connection "master"
[0m03:48:15.148865 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:48:15.153691 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m03:48:15.154995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e4dff10-a9d0-4b8f-b591-0a1b95b4b6db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89d11b0>]}
[0m03:48:15.155349 [debug] [MainThread]: On master: ROLLBACK
[0m03:48:15.155618 [debug] [MainThread]: Using postgres connection "master"
[0m03:48:15.155812 [debug] [MainThread]: On master: BEGIN
[0m03:48:15.156153 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:48:15.156411 [debug] [MainThread]: On master: COMMIT
[0m03:48:15.156607 [debug] [MainThread]: Using postgres connection "master"
[0m03:48:15.156845 [debug] [MainThread]: On master: COMMIT
[0m03:48:15.157096 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:48:15.157299 [debug] [MainThread]: On master: Close
[0m03:48:15.157668 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m03:48:15.157966 [info ] [MainThread]: 
[0m03:48:15.161918 [debug] [Thread-1 (]: Began running node model.jaffle_shop.below_depletion_level
[0m03:48:15.162035 [debug] [Thread-2 (]: Began running node model.jaffle_shop.hot_upsell
[0m03:48:15.162379 [info ] [Thread-1 (]: 1 of 4 START view model public.below_depletion_level ........................... [RUN]
[0m03:48:15.162739 [info ] [Thread-2 (]: 2 of 4 START view model public.hot_upsell ...................................... [RUN]
[0m03:48:15.163208 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.below_depletion_level"
[0m03:48:15.163654 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.hot_upsell"
[0m03:48:15.163937 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.below_depletion_level
[0m03:48:15.164182 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.hot_upsell
[0m03:48:15.164451 [debug] [Thread-1 (]: Compiling model.jaffle_shop.below_depletion_level
[0m03:48:15.164692 [debug] [Thread-2 (]: Compiling model.jaffle_shop.hot_upsell
[0m03:48:15.167090 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.below_depletion_level"
[0m03:48:15.169350 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.hot_upsell"
[0m03:48:15.170717 [debug] [Thread-1 (]: finished collecting timing info
[0m03:48:15.170817 [debug] [Thread-2 (]: finished collecting timing info
[0m03:48:15.171038 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.below_depletion_level
[0m03:48:15.171295 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.hot_upsell
[0m03:48:15.206756 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.below_depletion_level"
[0m03:48:15.207547 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.hot_upsell"
[0m03:48:15.209107 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m03:48:15.209364 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m03:48:15.209456 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: BEGIN
[0m03:48:15.209697 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: BEGIN
[0m03:48:15.209944 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m03:48:15.210197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:48:15.217188 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m03:48:15.217707 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m03:48:15.217818 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m03:48:15.218034 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */

  create view "postgres"."public"."hot_upsell__dbt_tmp" as (
    select distinct rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, (ruv.msrp - rupu.price) as profit_margin
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_pads_upsell" rupu on rupu.p_id = ruv.pid and rupu.variant = ruv.variant 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where new_arrival = 'Y' and stock_level < coalesce(depletion_level, 0) and rupu.stock is not null
order by profit_margin desc
  );
[0m03:48:15.218275 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m03:48:15.218679 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */

  create view "postgres"."public"."below_depletion_level__dbt_tmp" as (
    select distinct name, ruv.variant, ruv.actual_size, ruv.weave_cat
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where stock_level < coalesce(depletion_level, 0)
  );
[0m03:48:15.221882 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m03:48:15.227828 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m03:48:15.227962 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m03:48:15.228198 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level" rename to "below_depletion_level__dbt_backup"
[0m03:48:15.230056 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m03:48:15.230511 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
alter table "postgres"."public"."hot_upsell" rename to "hot_upsell__dbt_backup"
[0m03:48:15.230786 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:48:15.232541 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m03:48:15.232632 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:48:15.232836 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level__dbt_tmp" rename to "below_depletion_level"
[0m03:48:15.234569 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m03:48:15.234981 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
alter table "postgres"."public"."hot_upsell__dbt_tmp" rename to "hot_upsell"
[0m03:48:15.235126 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:48:15.241889 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m03:48:15.250114 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m03:48:15.251368 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: COMMIT
[0m03:48:15.251663 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m03:48:15.251903 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m03:48:15.252164 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m03:48:15.252415 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: COMMIT
[0m03:48:15.255044 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:48:15.255236 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m03:48:15.258953 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m03:48:15.260340 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m03:48:15.260572 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
drop view if exists "postgres"."public"."below_depletion_level__dbt_backup" cascade
[0m03:48:15.260786 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
drop view if exists "postgres"."public"."hot_upsell__dbt_backup" cascade
[0m03:48:15.263294 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m03:48:15.263431 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m03:48:15.264644 [debug] [Thread-2 (]: finished collecting timing info
[0m03:48:15.265542 [debug] [Thread-1 (]: finished collecting timing info
[0m03:48:15.265806 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: Close
[0m03:48:15.266052 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: Close
[0m03:48:15.266661 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e4dff10-a9d0-4b8f-b591-0a1b95b4b6db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a1ca60>]}
[0m03:48:15.267177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e4dff10-a9d0-4b8f-b591-0a1b95b4b6db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a57a30>]}
[0m03:48:15.267658 [info ] [Thread-2 (]: 2 of 4 OK created view model public.hot_upsell ................................. [[32mCREATE VIEW[0m in 0.10s]
[0m03:48:15.268209 [info ] [Thread-1 (]: 1 of 4 OK created view model public.below_depletion_level ...................... [[32mCREATE VIEW[0m in 0.10s]
[0m03:48:15.268676 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.hot_upsell
[0m03:48:15.269194 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.below_depletion_level
[0m03:48:15.269721 [debug] [Thread-2 (]: Began running node model.jaffle_shop.underselling_product_specs
[0m03:48:15.270253 [debug] [Thread-1 (]: Began running node model.jaffle_shop.priority_order
[0m03:48:15.270541 [info ] [Thread-2 (]: 3 of 4 START view model public.underselling_product_specs ...................... [RUN]
[0m03:48:15.270827 [info ] [Thread-1 (]: 4 of 4 START view model public.priority_order .................................. [RUN]
[0m03:48:15.271309 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.underselling_product_specs"
[0m03:48:15.271813 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.priority_order"
[0m03:48:15.272125 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.underselling_product_specs
[0m03:48:15.272382 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.priority_order
[0m03:48:15.272648 [debug] [Thread-2 (]: Compiling model.jaffle_shop.underselling_product_specs
[0m03:48:15.272906 [debug] [Thread-1 (]: Compiling model.jaffle_shop.priority_order
[0m03:48:15.275870 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.underselling_product_specs"
[0m03:48:15.278653 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.priority_order"
[0m03:48:15.279956 [debug] [Thread-2 (]: finished collecting timing info
[0m03:48:15.280202 [debug] [Thread-1 (]: finished collecting timing info
[0m03:48:15.280317 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.underselling_product_specs
[0m03:48:15.280565 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.priority_order
[0m03:48:15.283531 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.underselling_product_specs"
[0m03:48:15.286186 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.priority_order"
[0m03:48:15.287272 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m03:48:15.287432 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m03:48:15.287617 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: BEGIN
[0m03:48:15.287816 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: BEGIN
[0m03:48:15.288006 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:48:15.288199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:48:15.295348 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m03:48:15.295747 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m03:48:15.295974 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */

  create view "postgres"."public"."priority_order__dbt_tmp" as (
    select distinct rup.name as product_name, ruv.variant as variant, ruv.actual_size, ruv.weave_cat, (msrp - price) as profit 
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
join "postgres"."public"."below_depletion_level" bdl on bdl.name = rup.name and bdl.variant = ruv.variant
order by profit desc
  );
[0m03:48:15.297370 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m03:48:15.297650 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m03:48:15.297854 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */

  create view "postgres"."public"."underselling_product_specs__dbt_tmp" as (
    select distinct rup.name, rucm.color_value, ruv.actual_size, ruv.weave_cat, ruv.size_grp, ruv.shape, (ruv.stock_level - ruv.depletion_level) as stock_depletion_ratio
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_color_map" rucm on rucm.color_id = ruv.pid 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
where stock_level > coalesce(depletion_level, 0) and depletion_level <> 0 
and stock_level is not null and stock_level <> 0 and new_arrival = 'N' and status = 'In_stock'
order by stock_depletion_ratio desc limit 10
  );
[0m03:48:15.298388 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m03:48:15.301834 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m03:48:15.302107 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
alter table "postgres"."public"."priority_order__dbt_tmp" rename to "priority_order"
[0m03:48:15.302676 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:48:15.303877 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: COMMIT
[0m03:48:15.304106 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m03:48:15.304292 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: COMMIT
[0m03:48:15.304498 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m03:48:15.306418 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m03:48:15.306537 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:48:15.306737 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
alter table "postgres"."public"."underselling_product_specs" rename to "underselling_product_specs__dbt_backup"
[0m03:48:15.307982 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m03:48:15.308376 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
drop view if exists "postgres"."public"."priority_order__dbt_backup" cascade
[0m03:48:15.308619 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:48:15.308739 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m03:48:15.310520 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m03:48:15.311395 [debug] [Thread-1 (]: finished collecting timing info
[0m03:48:15.311627 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
alter table "postgres"."public"."underselling_product_specs__dbt_tmp" rename to "underselling_product_specs"
[0m03:48:15.311848 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: Close
[0m03:48:15.312516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e4dff10-a9d0-4b8f-b591-0a1b95b4b6db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff81111e0>]}
[0m03:48:15.312611 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:48:15.312967 [info ] [Thread-1 (]: 4 of 4 OK created view model public.priority_order ............................. [[32mCREATE VIEW[0m in 0.04s]
[0m03:48:15.314227 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: COMMIT
[0m03:48:15.314613 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.priority_order
[0m03:48:15.314803 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m03:48:15.315333 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: COMMIT
[0m03:48:15.316243 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m03:48:15.317680 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m03:48:15.317893 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
drop view if exists "postgres"."public"."underselling_product_specs__dbt_backup" cascade
[0m03:48:15.319169 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m03:48:15.320138 [debug] [Thread-2 (]: finished collecting timing info
[0m03:48:15.320363 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: Close
[0m03:48:15.320779 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e4dff10-a9d0-4b8f-b591-0a1b95b4b6db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b900a0>]}
[0m03:48:15.321138 [info ] [Thread-2 (]: 3 of 4 OK created view model public.underselling_product_specs ................. [[32mCREATE VIEW[0m in 0.05s]
[0m03:48:15.321525 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.underselling_product_specs
[0m03:48:15.323133 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:48:15.323406 [debug] [MainThread]: Using postgres connection "master"
[0m03:48:15.323603 [debug] [MainThread]: On master: BEGIN
[0m03:48:15.323804 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:48:15.330176 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m03:48:15.330475 [debug] [MainThread]: On master: COMMIT
[0m03:48:15.330696 [debug] [MainThread]: Using postgres connection "master"
[0m03:48:15.330907 [debug] [MainThread]: On master: COMMIT
[0m03:48:15.331175 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:48:15.331387 [debug] [MainThread]: On master: Close
[0m03:48:15.332012 [info ] [MainThread]: 
[0m03:48:15.332329 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m03:48:15.332606 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:48:15.332813 [debug] [MainThread]: Connection 'model.jaffle_shop.priority_order' was properly closed.
[0m03:48:15.333010 [debug] [MainThread]: Connection 'model.jaffle_shop.underselling_product_specs' was properly closed.
[0m03:48:15.340644 [info ] [MainThread]: 
[0m03:48:15.340987 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:48:15.341334 [info ] [MainThread]: 
[0m03:48:15.341618 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m03:48:15.341997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bb3880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bb2260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff80fee00>]}


============================== 2024-07-14 04:23:01.898946 | fa7b7bc0-a4e3-406c-b8ac-0fd2b5b9e27e ==============================
[0m04:23:01.899258 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:23:01.909627 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:23:01.910418 [debug] [MainThread]: Tracking: tracking
[0m04:23:01.925470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2beb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2a7a0>]}
[0m04:23:01.952987 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m04:23:01.953521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fa7b7bc0-a4e3-406c-b8ac-0fd2b5b9e27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1f370>]}
[0m04:23:01.979016 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:23:01.982265 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:23:02.004333 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:23:02.005889 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:23:02.007482 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:23:02.008004 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:23:02.013412 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:23:02.014720 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:23:02.015646 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:23:02.016762 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:23:02.017345 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:23:02.019169 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:23:02.022129 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:23:02.023393 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:23:02.036950 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:23:02.044183 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:23:02.056568 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:23:02.060096 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:23:02.062344 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:23:02.066768 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:23:02.069418 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:23:02.073713 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:23:02.074790 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:23:02.076531 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:23:02.087058 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:23:02.099755 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:23:02.101125 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:23:02.110811 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:23:02.116152 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:23:02.130871 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:23:02.132310 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:23:02.133763 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:23:02.137209 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:23:02.138018 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:23:02.139139 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:23:02.139869 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:23:02.140529 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:23:02.141275 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:23:02.142100 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:23:02.144002 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:23:02.145044 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:23:02.146062 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:23:02.147111 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:23:02.148047 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:23:02.149409 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:23:02.151639 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:23:02.153324 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:23:02.154138 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:23:02.155083 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:23:02.155926 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:23:02.156910 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:23:02.162062 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:23:02.163511 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:23:02.164335 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:23:02.165243 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:23:02.166161 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:23:02.167210 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:23:02.168123 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:23:02.171457 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:23:02.178959 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:23:02.181187 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:23:02.191265 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:23:02.196755 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:23:02.198434 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:23:02.200605 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:23:02.211671 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:23:02.213729 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:23:02.215001 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:23:02.216196 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:23:02.222660 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:23:02.226122 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:23:02.412971 [debug] [MainThread]: 1699: static parser successfully parsed underselling_product_specs.sql
[0m04:23:02.422642 [debug] [MainThread]: 1699: static parser successfully parsed priority_order.sql
[0m04:23:02.424460 [debug] [MainThread]: 1699: static parser successfully parsed hot_upsell.sql
[0m04:23:02.426271 [debug] [MainThread]: 1699: static parser successfully parsed below_depletion_level.sql
[0m04:23:02.466088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa7b7bc0-a4e3-406c-b8ac-0fd2b5b9e27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89ee3b0>]}
[0m04:23:02.475746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa7b7bc0-a4e3-406c-b8ac-0fd2b5b9e27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ad4be0>]}
[0m04:23:02.476162 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:23:02.476505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa7b7bc0-a4e3-406c-b8ac-0fd2b5b9e27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89dff10>]}
[0m04:23:02.478026 [info ] [MainThread]: 
[0m04:23:02.478615 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:23:02.480934 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m04:23:02.489964 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m04:23:02.490336 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m04:23:02.490568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:23:02.550966 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.06 seconds
[0m04:23:02.552926 [debug] [ThreadPool]: On list_postgres: Close
[0m04:23:02.564301 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m04:23:02.569391 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m04:23:02.569667 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m04:23:02.569899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:23:02.577450 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:23:02.577826 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m04:23:02.578077 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:23:02.584333 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.01 seconds
[0m04:23:02.585660 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m04:23:02.586040 [debug] [ThreadPool]: On list_postgres_public: Close
[0m04:23:02.590080 [debug] [MainThread]: Using postgres connection "master"
[0m04:23:02.590365 [debug] [MainThread]: On master: BEGIN
[0m04:23:02.590555 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:23:02.597775 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:23:02.598131 [debug] [MainThread]: Using postgres connection "master"
[0m04:23:02.598367 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:23:02.609446 [debug] [MainThread]: SQL status: SELECT 11 in 0.01 seconds
[0m04:23:02.610921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa7b7bc0-a4e3-406c-b8ac-0fd2b5b9e27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89f0760>]}
[0m04:23:02.611278 [debug] [MainThread]: On master: ROLLBACK
[0m04:23:02.611576 [debug] [MainThread]: Using postgres connection "master"
[0m04:23:02.611772 [debug] [MainThread]: On master: BEGIN
[0m04:23:02.612111 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:23:02.612410 [debug] [MainThread]: On master: COMMIT
[0m04:23:02.612612 [debug] [MainThread]: Using postgres connection "master"
[0m04:23:02.612864 [debug] [MainThread]: On master: COMMIT
[0m04:23:02.613126 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:23:02.613331 [debug] [MainThread]: On master: Close
[0m04:23:02.613727 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m04:23:02.614045 [info ] [MainThread]: 
[0m04:23:02.617628 [debug] [Thread-1 (]: Began running node model.jaffle_shop.below_depletion_level
[0m04:23:02.617751 [debug] [Thread-2 (]: Began running node model.jaffle_shop.hot_upsell
[0m04:23:02.618076 [info ] [Thread-1 (]: 1 of 4 START view model public.below_depletion_level ........................... [RUN]
[0m04:23:02.618419 [info ] [Thread-2 (]: 2 of 4 START view model public.hot_upsell ...................................... [RUN]
[0m04:23:02.618933 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.below_depletion_level"
[0m04:23:02.619383 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.hot_upsell"
[0m04:23:02.619675 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.below_depletion_level
[0m04:23:02.620116 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.hot_upsell
[0m04:23:02.620366 [debug] [Thread-1 (]: Compiling model.jaffle_shop.below_depletion_level
[0m04:23:02.620716 [debug] [Thread-2 (]: Compiling model.jaffle_shop.hot_upsell
[0m04:23:02.623298 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.below_depletion_level"
[0m04:23:02.626366 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.hot_upsell"
[0m04:23:02.628745 [debug] [Thread-2 (]: finished collecting timing info
[0m04:23:02.629236 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.hot_upsell
[0m04:23:02.629449 [debug] [Thread-1 (]: finished collecting timing info
[0m04:23:02.651006 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.below_depletion_level
[0m04:23:02.669188 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.hot_upsell"
[0m04:23:02.672106 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.below_depletion_level"
[0m04:23:02.674794 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m04:23:02.674968 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m04:23:02.675197 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: BEGIN
[0m04:23:02.675435 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: BEGIN
[0m04:23:02.675654 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:23:02.675897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:23:02.685029 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m04:23:02.685236 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m04:23:02.685557 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m04:23:02.685903 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m04:23:02.686204 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */

  create view "postgres"."public"."below_depletion_level__dbt_tmp" as (
    select distinct name, ruv.variant, ruv.actual_size, ruv.weave_cat
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where stock_level < coalesce(depletion_level, 0)
  );
[0m04:23:02.686427 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */

  create view "postgres"."public"."hot_upsell__dbt_tmp" as (
    select distinct rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, (ruv.msrp - rupu.price) as profit_margin
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_pads_upsell" rupu on rupu.p_id = ruv.pid and rupu.variant = ruv.variant 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where new_arrival = 'Y' and stock_level < coalesce(depletion_level, 0) and rupu.stock is not null
order by profit_margin desc
  );
[0m04:23:02.694372 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m04:23:02.695040 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m04:23:02.702138 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m04:23:02.704191 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m04:23:02.704446 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level" rename to "below_depletion_level__dbt_backup"
[0m04:23:02.704649 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
alter table "postgres"."public"."hot_upsell" rename to "hot_upsell__dbt_backup"
[0m04:23:02.705796 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:23:02.705942 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:23:02.707718 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m04:23:02.709548 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m04:23:02.709809 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
alter table "postgres"."public"."hot_upsell__dbt_tmp" rename to "hot_upsell"
[0m04:23:02.710036 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level__dbt_tmp" rename to "below_depletion_level"
[0m04:23:02.710647 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:23:02.717188 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m04:23:02.726249 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: COMMIT
[0m04:23:02.727606 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m04:23:02.727889 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m04:23:02.728141 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m04:23:02.728387 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: COMMIT
[0m04:23:02.728602 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m04:23:02.731782 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m04:23:02.736321 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m04:23:02.736448 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m04:23:02.736649 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
drop view if exists "postgres"."public"."hot_upsell__dbt_backup" cascade
[0m04:23:02.738060 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m04:23:02.738468 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
drop view if exists "postgres"."public"."below_depletion_level__dbt_backup" cascade
[0m04:23:02.742204 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m04:23:02.743359 [debug] [Thread-2 (]: finished collecting timing info
[0m04:23:02.743456 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m04:23:02.743680 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: Close
[0m04:23:02.744567 [debug] [Thread-1 (]: finished collecting timing info
[0m04:23:02.745284 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa7b7bc0-a4e3-406c-b8ac-0fd2b5b9e27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a645b0>]}
[0m04:23:02.745531 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: Close
[0m04:23:02.746081 [info ] [Thread-2 (]: 2 of 4 OK created view model public.hot_upsell ................................. [[32mCREATE VIEW[0m in 0.13s]
[0m04:23:02.746697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa7b7bc0-a4e3-406c-b8ac-0fd2b5b9e27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a08280>]}
[0m04:23:02.747181 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.hot_upsell
[0m04:23:02.747549 [info ] [Thread-1 (]: 1 of 4 OK created view model public.below_depletion_level ...................... [[32mCREATE VIEW[0m in 0.13s]
[0m04:23:02.747878 [debug] [Thread-2 (]: Began running node model.jaffle_shop.underselling_product_specs
[0m04:23:02.748319 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.below_depletion_level
[0m04:23:02.748589 [info ] [Thread-2 (]: 3 of 4 START view model public.underselling_product_specs ...................... [RUN]
[0m04:23:02.749064 [debug] [Thread-1 (]: Began running node model.jaffle_shop.priority_order
[0m04:23:02.749881 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.underselling_product_specs"
[0m04:23:02.750178 [info ] [Thread-1 (]: 4 of 4 START view model public.priority_order .................................. [RUN]
[0m04:23:02.750463 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.underselling_product_specs
[0m04:23:02.750907 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.priority_order"
[0m04:23:02.751147 [debug] [Thread-2 (]: Compiling model.jaffle_shop.underselling_product_specs
[0m04:23:02.751360 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.priority_order
[0m04:23:02.754504 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.underselling_product_specs"
[0m04:23:02.754757 [debug] [Thread-1 (]: Compiling model.jaffle_shop.priority_order
[0m04:23:02.759301 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.priority_order"
[0m04:23:02.760393 [debug] [Thread-2 (]: finished collecting timing info
[0m04:23:02.760735 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.underselling_product_specs
[0m04:23:02.760965 [debug] [Thread-1 (]: finished collecting timing info
[0m04:23:02.791536 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.underselling_product_specs"
[0m04:23:02.791881 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.priority_order
[0m04:23:02.795159 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.priority_order"
[0m04:23:02.795983 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m04:23:02.796242 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: BEGIN
[0m04:23:02.796429 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m04:23:02.796510 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:23:02.796741 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: BEGIN
[0m04:23:02.798310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:23:02.803309 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m04:23:02.803685 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m04:23:02.803946 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */

  create view "postgres"."public"."underselling_product_specs__dbt_tmp" as (
    select distinct rup.name, rucm.color_value, ruv.actual_size, ruv.weave_cat, ruv.size_grp, ruv.shape, (ruv.stock_level - ruv.depletion_level) as stock_depletion_ratio
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_color_map" rucm on rucm.color_id = ruv.pid 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
where stock_level > coalesce(depletion_level, 0) and depletion_level <> 0 
and stock_level is not null and stock_level <> 0 and new_arrival = 'N' and status = 'In_stock'
order by stock_depletion_ratio desc limit 10
  );
[0m04:23:02.804231 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m04:23:02.807835 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m04:23:02.808094 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */

  create view "postgres"."public"."priority_order__dbt_tmp" as (
    select distinct rup.name as product_name, ruv.variant as variant, ruv.actual_size, ruv.weave_cat, (msrp - price) as profit 
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
join "postgres"."public"."below_depletion_level" bdl on bdl.name = rup.name and bdl.variant = ruv.variant
order by profit desc
  );
[0m04:23:02.809325 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m04:23:02.811604 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m04:23:02.811739 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m04:23:02.811990 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
alter table "postgres"."public"."underselling_product_specs" rename to "underselling_product_specs__dbt_backup"
[0m04:23:02.813690 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m04:23:02.814618 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:23:02.814713 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
alter table "postgres"."public"."priority_order__dbt_tmp" rename to "priority_order"
[0m04:23:02.816503 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m04:23:02.816951 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
alter table "postgres"."public"."underselling_product_specs__dbt_tmp" rename to "underselling_product_specs"
[0m04:23:02.817149 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:23:02.817518 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:23:02.818646 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: COMMIT
[0m04:23:02.819873 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: COMMIT
[0m04:23:02.820098 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m04:23:02.820303 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m04:23:02.820493 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: COMMIT
[0m04:23:02.820678 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: COMMIT
[0m04:23:02.821609 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m04:23:02.821724 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m04:23:02.823049 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m04:23:02.824383 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m04:23:02.824617 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
drop view if exists "postgres"."public"."priority_order__dbt_backup" cascade
[0m04:23:02.824821 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
drop view if exists "postgres"."public"."underselling_product_specs__dbt_backup" cascade
[0m04:23:02.825189 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m04:23:02.827512 [debug] [Thread-1 (]: finished collecting timing info
[0m04:23:02.827602 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m04:23:02.827829 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: Close
[0m04:23:02.828602 [debug] [Thread-2 (]: finished collecting timing info
[0m04:23:02.829050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa7b7bc0-a4e3-406c-b8ac-0fd2b5b9e27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff80d0340>]}
[0m04:23:02.829262 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: Close
[0m04:23:02.829640 [info ] [Thread-1 (]: 4 of 4 OK created view model public.priority_order ............................. [[32mCREATE VIEW[0m in 0.08s]
[0m04:23:02.830079 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa7b7bc0-a4e3-406c-b8ac-0fd2b5b9e27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff80d0280>]}
[0m04:23:02.830494 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.priority_order
[0m04:23:02.830858 [info ] [Thread-2 (]: 3 of 4 OK created view model public.underselling_product_specs ................. [[32mCREATE VIEW[0m in 0.08s]
[0m04:23:02.831470 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.underselling_product_specs
[0m04:23:02.833250 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:23:02.833494 [debug] [MainThread]: Using postgres connection "master"
[0m04:23:02.833694 [debug] [MainThread]: On master: BEGIN
[0m04:23:02.833895 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:23:02.840318 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:23:02.840637 [debug] [MainThread]: On master: COMMIT
[0m04:23:02.840856 [debug] [MainThread]: Using postgres connection "master"
[0m04:23:02.841057 [debug] [MainThread]: On master: COMMIT
[0m04:23:02.841308 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:23:02.841512 [debug] [MainThread]: On master: Close
[0m04:23:02.842134 [info ] [MainThread]: 
[0m04:23:02.842439 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m04:23:02.842751 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:23:02.842977 [debug] [MainThread]: Connection 'model.jaffle_shop.underselling_product_specs' was properly closed.
[0m04:23:02.843184 [debug] [MainThread]: Connection 'model.jaffle_shop.priority_order' was properly closed.
[0m04:23:02.849271 [info ] [MainThread]: 
[0m04:23:02.849559 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:23:02.849900 [info ] [MainThread]: 
[0m04:23:02.850176 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m04:23:02.850536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff80b3520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb4dd570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb4dec80>]}


============================== 2024-07-14 04:28:30.041120 | bde59e9f-b2dc-4ff4-8400-2e21fe6e7217 ==============================
[0m04:28:30.041435 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:28:30.047411 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
[0m04:28:30.047810 [debug] [MainThread]: Tracking: tracking
[0m04:28:30.063848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b280>]}
[0m04:28:30.087995 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m04:28:30.088524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bde59e9f-b2dc-4ff4-8400-2e21fe6e7217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1fa60>]}
[0m04:28:30.117289 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:28:30.120678 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:28:30.142692 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:28:30.144250 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:28:30.145915 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:28:30.146517 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:28:30.152275 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:28:30.153668 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:28:30.154655 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:28:30.155759 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:28:30.156389 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:28:30.158240 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:28:30.161241 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:28:30.162527 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:28:30.176089 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:28:30.183476 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:28:30.195938 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:28:30.199337 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:28:30.201544 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:28:30.205972 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:28:30.208615 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:28:30.212883 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:28:30.213941 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:28:30.215699 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:28:30.226290 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:28:30.239111 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:28:30.240469 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:28:30.250269 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:28:30.255723 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:28:30.270601 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:28:30.272052 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:28:30.273497 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:28:30.276928 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:28:30.277725 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:28:30.278851 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:28:30.279553 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:28:30.280156 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:28:30.280845 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:28:30.281653 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:28:30.282672 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:28:30.283716 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:28:30.284715 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:28:30.285743 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:28:30.286692 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:28:30.287444 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:28:30.289340 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:28:30.291004 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:28:30.291822 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:28:30.292765 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:28:30.293621 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:28:30.294596 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:28:30.299723 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:28:30.301184 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:28:30.301997 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:28:30.302903 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:28:30.303795 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:28:30.304837 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:28:30.305751 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:28:30.309088 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:28:30.316647 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:28:30.318880 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:28:30.329078 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:28:30.334508 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:28:30.336193 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:28:30.338317 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:28:30.353023 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:28:30.355745 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:28:30.357346 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:28:30.358738 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:28:30.366114 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:28:30.369904 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:28:30.565869 [debug] [MainThread]: 1699: static parser successfully parsed underselling_product_specs.sql
[0m04:28:30.575593 [debug] [MainThread]: 1699: static parser successfully parsed priority_order.sql
[0m04:28:30.577486 [debug] [MainThread]: 1699: static parser successfully parsed hot_upsell.sql
[0m04:28:30.579334 [debug] [MainThread]: 1699: static parser successfully parsed below_depletion_level.sql
[0m04:28:30.619115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bde59e9f-b2dc-4ff4-8400-2e21fe6e7217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89ea380>]}
[0m04:28:30.630125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bde59e9f-b2dc-4ff4-8400-2e21fe6e7217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ad0bb0>]}
[0m04:28:30.630560 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:28:30.630864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bde59e9f-b2dc-4ff4-8400-2e21fe6e7217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b60520>]}
[0m04:28:30.632252 [info ] [MainThread]: 
[0m04:28:30.632563 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m04:28:30.638158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba3be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba3a00>]}


============================== 2024-07-14 04:28:50.197768 | b0cf62f6-bfd1-4b7b-b704-d1ca59c1a945 ==============================
[0m04:28:50.198073 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:28:50.205726 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
[0m04:28:50.206145 [debug] [MainThread]: Tracking: tracking
[0m04:28:50.221400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c176a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c172b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c17430>]}
[0m04:28:50.264478 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m04:28:50.265255 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://snapshots/availability_clearance_rugs.sql
[0m04:28:50.289327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7cee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b8e4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b8e470>]}


============================== 2024-07-14 04:30:04.627566 | df79c813-a3cf-4b8d-af8a-e7882419cfca ==============================
[0m04:30:04.627885 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:30:04.639802 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
[0m04:30:04.640199 [debug] [MainThread]: Tracking: tracking
[0m04:30:04.654418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c19000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c18c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c187c0>]}
[0m04:30:04.697321 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m04:30:04.697926 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://snapshots/availability_clearance_rugs.sql
[0m04:30:04.731808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df79c813-a3cf-4b8d-af8a-e7882419cfca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99f4370>]}
[0m04:30:04.741621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df79c813-a3cf-4b8d-af8a-e7882419cfca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba4f70>]}
[0m04:30:04.742038 [info ] [MainThread]: Found 4 models, 0 tests, 1 snapshot, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:30:04.742391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df79c813-a3cf-4b8d-af8a-e7882419cfca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba6bc0>]}
[0m04:30:04.743956 [info ] [MainThread]: 
[0m04:30:04.744564 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:30:04.746628 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m04:30:04.754639 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m04:30:04.754971 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m04:30:04.755214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:30:04.806830 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.05 seconds
[0m04:30:04.808532 [debug] [ThreadPool]: On list_postgres: Close
[0m04:30:04.810668 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m04:30:04.815358 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m04:30:04.815646 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m04:30:04.815868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:30:04.823481 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:30:04.823884 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m04:30:04.824128 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:30:04.827883 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m04:30:04.829118 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m04:30:04.829479 [debug] [ThreadPool]: On list_postgres_public: Close
[0m04:30:04.833486 [debug] [MainThread]: Using postgres connection "master"
[0m04:30:04.833781 [debug] [MainThread]: On master: BEGIN
[0m04:30:04.833989 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:30:04.846735 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:30:04.847131 [debug] [MainThread]: Using postgres connection "master"
[0m04:30:04.847419 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:30:04.854297 [debug] [MainThread]: SQL status: SELECT 11 in 0.01 seconds
[0m04:30:04.855753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df79c813-a3cf-4b8d-af8a-e7882419cfca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99f5e10>]}
[0m04:30:04.856128 [debug] [MainThread]: On master: ROLLBACK
[0m04:30:04.856850 [debug] [MainThread]: Using postgres connection "master"
[0m04:30:04.857083 [debug] [MainThread]: On master: BEGIN
[0m04:30:04.858148 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:30:04.858458 [debug] [MainThread]: On master: COMMIT
[0m04:30:04.858689 [debug] [MainThread]: Using postgres connection "master"
[0m04:30:04.858905 [debug] [MainThread]: On master: COMMIT
[0m04:30:04.859193 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:30:04.859432 [debug] [MainThread]: On master: Close
[0m04:30:04.859842 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m04:30:04.860148 [info ] [MainThread]: 
[0m04:30:04.864473 [debug] [Thread-1 (]: Began running node snapshot.jaffle_shop.rugs_usa_parent_snapshot
[0m04:30:04.865075 [info ] [Thread-1 (]: 1 of 1 START snapshot public.rugs_usa_parent_snapshot .......................... [RUN]
[0m04:30:04.865940 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.jaffle_shop.rugs_usa_parent_snapshot"
[0m04:30:04.866754 [debug] [Thread-1 (]: Began compiling node snapshot.jaffle_shop.rugs_usa_parent_snapshot
[0m04:30:04.867137 [debug] [Thread-1 (]: Compiling snapshot.jaffle_shop.rugs_usa_parent_snapshot
[0m04:30:04.870750 [debug] [Thread-1 (]: finished collecting timing info
[0m04:30:04.871285 [debug] [Thread-1 (]: Began executing node snapshot.jaffle_shop.rugs_usa_parent_snapshot
[0m04:30:04.921729 [debug] [Thread-1 (]: Writing runtime SQL for node "snapshot.jaffle_shop.rugs_usa_parent_snapshot"
[0m04:30:04.924560 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.rugs_usa_parent_snapshot"
[0m04:30:04.924814 [debug] [Thread-1 (]: On snapshot.jaffle_shop.rugs_usa_parent_snapshot: BEGIN
[0m04:30:04.925036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:30:04.931276 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m04:30:04.931625 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.rugs_usa_parent_snapshot"
[0m04:30:04.931864 [debug] [Thread-1 (]: On snapshot.jaffle_shop.rugs_usa_parent_snapshot: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.rugs_usa_parent_snapshot"} */

      

  create  table "postgres"."public"."rugs_usa_parent_snapshot"
  as (
    

    select *,
        md5(coalesce(cast(url as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        nullif(now()::timestamp without time zone, now()::timestamp without time zone) as dbt_valid_to
    from (
        



SELECT 
    name,
    url,
    availability,
    clearance,
    NOW() AS updated_at
FROM 
    "postgres"."public"."rugs_usa_parent"

    ) sbq



  );
  
[0m04:30:05.013128 [debug] [Thread-1 (]: SQL status: SELECT 5562 in 0.08 seconds
[0m04:30:05.028914 [debug] [Thread-1 (]: On snapshot.jaffle_shop.rugs_usa_parent_snapshot: COMMIT
[0m04:30:05.029261 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.rugs_usa_parent_snapshot"
[0m04:30:05.029498 [debug] [Thread-1 (]: On snapshot.jaffle_shop.rugs_usa_parent_snapshot: COMMIT
[0m04:30:05.042391 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m04:30:05.043077 [debug] [Thread-1 (]: finished collecting timing info
[0m04:30:05.043353 [debug] [Thread-1 (]: On snapshot.jaffle_shop.rugs_usa_parent_snapshot: Close
[0m04:30:05.044484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df79c813-a3cf-4b8d-af8a-e7882419cfca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a3cf40>]}
[0m04:30:05.044962 [info ] [Thread-1 (]: 1 of 1 OK snapshotted public.rugs_usa_parent_snapshot .......................... [[32mSELECT 5562[0m in 0.18s]
[0m04:30:05.045604 [debug] [Thread-1 (]: Finished running node snapshot.jaffle_shop.rugs_usa_parent_snapshot
[0m04:30:05.048192 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:30:05.048545 [debug] [MainThread]: Using postgres connection "master"
[0m04:30:05.048774 [debug] [MainThread]: On master: BEGIN
[0m04:30:05.048979 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:30:05.061287 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:30:05.061896 [debug] [MainThread]: On master: COMMIT
[0m04:30:05.062145 [debug] [MainThread]: Using postgres connection "master"
[0m04:30:05.062387 [debug] [MainThread]: On master: COMMIT
[0m04:30:05.062685 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:30:05.062927 [debug] [MainThread]: On master: Close
[0m04:30:05.063617 [info ] [MainThread]: 
[0m04:30:05.063948 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m04:30:05.064316 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:30:05.064755 [debug] [MainThread]: Connection 'snapshot.jaffle_shop.rugs_usa_parent_snapshot' was properly closed.
[0m04:30:05.073948 [info ] [MainThread]: 
[0m04:30:05.074291 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:30:05.074632 [info ] [MainThread]: 
[0m04:30:05.074929 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:30:05.075305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a5bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a5b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a5be50>]}


============================== 2024-07-14 04:47:07.560143 | d33b9643-8871-4883-ab00-aa2be8e4605a ==============================
[0m04:47:07.560604 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:47:07.572879 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
[0m04:47:07.573237 [debug] [MainThread]: Tracking: tracking
[0m04:47:07.589428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c262c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c273a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c242e0>]}
[0m04:47:07.639186 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m04:47:07.639811 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://snapshots/low_stock_indicator.sql
[0m04:47:07.640167 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://snapshots/availability_clearance_rugs.sql
[0m04:47:07.654450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b72fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b92920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bb1f30>]}


============================== 2024-07-14 04:49:15.713319 | 8dc4fcb5-e776-4c34-9b96-5d9decab22ec ==============================
[0m04:49:15.713635 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:49:15.724145 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
[0m04:49:15.724707 [debug] [MainThread]: Tracking: tracking
[0m04:49:15.741255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c15d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c14c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c15900>]}
[0m04:49:15.792915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m04:49:15.793745 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://snapshots/low_stock_indicator.sql
[0m04:49:15.794172 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://snapshots/availability_clearance_rugs.sql
[0m04:49:15.837769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8dc4fcb5-e776-4c34-9b96-5d9decab22ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a080d0>]}
[0m04:49:15.848630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8dc4fcb5-e776-4c34-9b96-5d9decab22ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99c5b40>]}
[0m04:49:15.849038 [info ] [MainThread]: Found 4 models, 0 tests, 2 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:49:15.849377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dc4fcb5-e776-4c34-9b96-5d9decab22ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99c7460>]}
[0m04:49:15.850996 [info ] [MainThread]: 
[0m04:49:15.851604 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:49:15.854030 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m04:49:15.862387 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m04:49:15.862736 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m04:49:15.863005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:49:15.930979 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.07 seconds
[0m04:49:15.932828 [debug] [ThreadPool]: On list_postgres: Close
[0m04:49:15.935287 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m04:49:15.941317 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m04:49:15.941770 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m04:49:15.942016 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:49:15.951585 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:49:15.952043 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m04:49:15.952366 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:49:15.957011 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m04:49:15.958301 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m04:49:15.958661 [debug] [ThreadPool]: On list_postgres_public: Close
[0m04:49:15.962730 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:15.963070 [debug] [MainThread]: On master: BEGIN
[0m04:49:15.963289 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:49:15.971204 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:49:15.971608 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:15.971853 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:49:15.983866 [debug] [MainThread]: SQL status: SELECT 11 in 0.01 seconds
[0m04:49:15.985545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dc4fcb5-e776-4c34-9b96-5d9decab22ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b660b0>]}
[0m04:49:15.986008 [debug] [MainThread]: On master: ROLLBACK
[0m04:49:15.986368 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:15.986593 [debug] [MainThread]: On master: BEGIN
[0m04:49:15.986992 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:49:15.987304 [debug] [MainThread]: On master: COMMIT
[0m04:49:15.987531 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:15.987752 [debug] [MainThread]: On master: COMMIT
[0m04:49:15.988096 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:49:15.988346 [debug] [MainThread]: On master: Close
[0m04:49:15.988813 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m04:49:15.989274 [info ] [MainThread]: 
[0m04:49:15.993707 [debug] [Thread-1 (]: Began running node snapshot.jaffle_shop.availability_clearance_rugs
[0m04:49:15.993827 [debug] [Thread-2 (]: Began running node snapshot.jaffle_shop.low_stock_indicator
[0m04:49:15.994178 [info ] [Thread-1 (]: 1 of 2 START snapshot public.availability_clearance_rugs ....................... [RUN]
[0m04:49:15.994526 [info ] [Thread-2 (]: 2 of 2 START snapshot public.low_stock_indicator ............................... [RUN]
[0m04:49:15.994974 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.jaffle_shop.availability_clearance_rugs"
[0m04:49:15.995390 [debug] [Thread-2 (]: Acquiring new postgres connection "snapshot.jaffle_shop.low_stock_indicator"
[0m04:49:15.995603 [debug] [Thread-1 (]: Began compiling node snapshot.jaffle_shop.availability_clearance_rugs
[0m04:49:15.995812 [debug] [Thread-2 (]: Began compiling node snapshot.jaffle_shop.low_stock_indicator
[0m04:49:15.996061 [debug] [Thread-1 (]: Compiling snapshot.jaffle_shop.availability_clearance_rugs
[0m04:49:15.996263 [debug] [Thread-2 (]: Compiling snapshot.jaffle_shop.low_stock_indicator
[0m04:49:15.999047 [debug] [Thread-1 (]: finished collecting timing info
[0m04:49:16.001804 [debug] [Thread-2 (]: finished collecting timing info
[0m04:49:16.002105 [debug] [Thread-1 (]: Began executing node snapshot.jaffle_shop.availability_clearance_rugs
[0m04:49:16.002329 [debug] [Thread-2 (]: Began executing node snapshot.jaffle_shop.low_stock_indicator
[0m04:49:16.070980 [debug] [Thread-2 (]: Writing runtime SQL for node "snapshot.jaffle_shop.low_stock_indicator"
[0m04:49:16.071710 [debug] [Thread-1 (]: Writing runtime SQL for node "snapshot.jaffle_shop.availability_clearance_rugs"
[0m04:49:16.074103 [debug] [Thread-2 (]: Using postgres connection "snapshot.jaffle_shop.low_stock_indicator"
[0m04:49:16.074432 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.availability_clearance_rugs"
[0m04:49:16.074523 [debug] [Thread-2 (]: On snapshot.jaffle_shop.low_stock_indicator: BEGIN
[0m04:49:16.074768 [debug] [Thread-1 (]: On snapshot.jaffle_shop.availability_clearance_rugs: BEGIN
[0m04:49:16.075003 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:49:16.075233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:49:16.082260 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m04:49:16.082687 [debug] [Thread-2 (]: Using postgres connection "snapshot.jaffle_shop.low_stock_indicator"
[0m04:49:16.082993 [debug] [Thread-2 (]: On snapshot.jaffle_shop.low_stock_indicator: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.low_stock_indicator"} */

      

  create  table "postgres"."public"."low_stock_indicator"
  as (
    

    select *,
        md5(coalesce(cast(name_variant_color_weave_size_shape_weight as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        nullif(now()::timestamp without time zone, now()::timestamp without time zone) as dbt_valid_to
    from (
        



SELECT DISTINCT 
    rup.name,
    ruv.variant,
    rucm.color_value,
    ruv.weave_cat,
    ruv.size_grp,
    ruv.shape,
    ruv.weight,
    ruv.low_stock,
    CONCAT(rup.name, '_', ruv.variant, '_', rucm.color_value, '_', ruv.weave_cat, '_', ruv.size_grp, '_', ruv.shape, '_', ruv.weight) AS name_variant_color_weave_size_shape_weight,  
    NOW() AS updated_at
FROM 
    "postgres"."public"."rugs_usa_variant" ruv
JOIN 
    "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
JOIN 
    "postgres"."public"."rugs_usa_color_map" rucm ON rucm.color_id = ruv.pid

    ) sbq



  );
  
[0m04:49:16.083091 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m04:49:16.083471 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.availability_clearance_rugs"
[0m04:49:16.083729 [debug] [Thread-1 (]: On snapshot.jaffle_shop.availability_clearance_rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.availability_clearance_rugs"} */

      

  create  table "postgres"."public"."availability_clearance_rugs"
  as (
    

    select *,
        md5(coalesce(cast(url as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        nullif(now()::timestamp without time zone, now()::timestamp without time zone) as dbt_valid_to
    from (
        



SELECT 
    name,
    url,
    availability,
    clearance,
    NOW() AS updated_at
FROM 
    "postgres"."public"."rugs_usa_parent"

    ) sbq



  );
  
[0m04:49:16.172967 [debug] [Thread-1 (]: SQL status: SELECT 5562 in 0.09 seconds
[0m04:49:16.189765 [debug] [Thread-1 (]: On snapshot.jaffle_shop.availability_clearance_rugs: COMMIT
[0m04:49:16.190131 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.availability_clearance_rugs"
[0m04:49:16.190360 [debug] [Thread-1 (]: On snapshot.jaffle_shop.availability_clearance_rugs: COMMIT
[0m04:49:16.201650 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m04:49:16.202338 [debug] [Thread-1 (]: finished collecting timing info
[0m04:49:16.202604 [debug] [Thread-1 (]: On snapshot.jaffle_shop.availability_clearance_rugs: Close
[0m04:49:16.203196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dc4fcb5-e776-4c34-9b96-5d9decab22ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a70040>]}
[0m04:49:16.203657 [info ] [Thread-1 (]: 1 of 2 OK snapshotted public.availability_clearance_rugs ....................... [[32mSELECT 5562[0m in 0.21s]
[0m04:49:16.204220 [debug] [Thread-1 (]: Finished running node snapshot.jaffle_shop.availability_clearance_rugs
[0m04:49:16.816652 [debug] [Thread-2 (]: SQL status: SELECT 17944 in 0.73 seconds
[0m04:49:16.818635 [debug] [Thread-2 (]: On snapshot.jaffle_shop.low_stock_indicator: COMMIT
[0m04:49:16.818914 [debug] [Thread-2 (]: Using postgres connection "snapshot.jaffle_shop.low_stock_indicator"
[0m04:49:16.819150 [debug] [Thread-2 (]: On snapshot.jaffle_shop.low_stock_indicator: COMMIT
[0m04:49:16.836375 [debug] [Thread-2 (]: SQL status: COMMIT in 0.02 seconds
[0m04:49:16.837302 [debug] [Thread-2 (]: finished collecting timing info
[0m04:49:16.837597 [debug] [Thread-2 (]: On snapshot.jaffle_shop.low_stock_indicator: Close
[0m04:49:16.838134 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dc4fcb5-e776-4c34-9b96-5d9decab22ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b888b0>]}
[0m04:49:16.838623 [info ] [Thread-2 (]: 2 of 2 OK snapshotted public.low_stock_indicator ............................... [[32mSELECT 17944[0m in 0.84s]
[0m04:49:16.839187 [debug] [Thread-2 (]: Finished running node snapshot.jaffle_shop.low_stock_indicator
[0m04:49:16.841563 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:49:16.841854 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:16.842102 [debug] [MainThread]: On master: BEGIN
[0m04:49:16.842310 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:49:16.849780 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:49:16.850256 [debug] [MainThread]: On master: COMMIT
[0m04:49:16.850498 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:16.850729 [debug] [MainThread]: On master: COMMIT
[0m04:49:16.851056 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:49:16.851286 [debug] [MainThread]: On master: Close
[0m04:49:16.852005 [info ] [MainThread]: 
[0m04:49:16.852592 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 1.00 seconds (1.00s).
[0m04:49:16.853021 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:49:16.853263 [debug] [MainThread]: Connection 'snapshot.jaffle_shop.availability_clearance_rugs' was properly closed.
[0m04:49:16.853470 [debug] [MainThread]: Connection 'snapshot.jaffle_shop.low_stock_indicator' was properly closed.
[0m04:49:16.859713 [info ] [MainThread]: 
[0m04:49:16.860089 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:49:16.860458 [info ] [MainThread]: 
[0m04:49:16.860756 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m04:49:16.861190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b89e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b880d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b8b340>]}


============================== 2024-07-14 17:03:27.482706 | 80aa74fe-2fee-4263-8802-cea5fc7921ea ==============================
[0m17:03:27.483004 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:03:27.492812 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:03:27.493209 [debug] [MainThread]: Tracking: tracking
[0m17:03:27.517706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c15d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c14c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c17e80>]}
[0m17:03:27.566885 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:03:27.567562 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/below_depletion_level.sql
[0m17:03:27.604605 [debug] [MainThread]: 1699: static parser successfully parsed below_depletion_level.sql
[0m17:03:27.623484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80aa74fe-2fee-4263-8802-cea5fc7921ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89d1c00>]}
[0m17:03:27.634538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80aa74fe-2fee-4263-8802-cea5fc7921ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b6bf40>]}
[0m17:03:27.634951 [info ] [MainThread]: Found 4 models, 0 tests, 2 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:03:27.635278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80aa74fe-2fee-4263-8802-cea5fc7921ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b54d60>]}
[0m17:03:27.636876 [info ] [MainThread]: 
[0m17:03:27.637441 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:03:27.639685 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m17:03:27.647970 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:03:27.648315 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:03:27.648549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:27.704912 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.06 seconds
[0m17:03:27.706652 [debug] [ThreadPool]: On list_postgres: Close
[0m17:03:27.709051 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m17:03:27.713723 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:03:27.713925 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:03:27.714064 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:03:27.721816 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m17:03:27.722061 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:03:27.722202 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:03:27.727040 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m17:03:27.728233 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:03:27.728524 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:03:27.732413 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:27.732693 [debug] [MainThread]: On master: BEGIN
[0m17:03:27.732914 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:03:27.739937 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:03:27.740213 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:27.740437 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:03:27.748370 [debug] [MainThread]: SQL status: SELECT 11 in 0.01 seconds
[0m17:03:27.749734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80aa74fe-2fee-4263-8802-cea5fc7921ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89d0880>]}
[0m17:03:27.750072 [debug] [MainThread]: On master: ROLLBACK
[0m17:03:27.750353 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:27.750549 [debug] [MainThread]: On master: BEGIN
[0m17:03:27.750863 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:03:27.751139 [debug] [MainThread]: On master: COMMIT
[0m17:03:27.751447 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:27.751658 [debug] [MainThread]: On master: COMMIT
[0m17:03:27.751930 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:03:27.752133 [debug] [MainThread]: On master: Close
[0m17:03:27.752524 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:03:27.752852 [info ] [MainThread]: 
[0m17:03:27.757936 [debug] [Thread-1 (]: Began running node model.jaffle_shop.below_depletion_level
[0m17:03:27.758079 [debug] [Thread-2 (]: Began running node model.jaffle_shop.hot_upsell
[0m17:03:27.758419 [info ] [Thread-1 (]: 1 of 4 START view model public.below_depletion_level ........................... [RUN]
[0m17:03:27.758762 [info ] [Thread-2 (]: 2 of 4 START view model public.hot_upsell ...................................... [RUN]
[0m17:03:27.759204 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.below_depletion_level"
[0m17:03:27.759714 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.hot_upsell"
[0m17:03:27.759921 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.below_depletion_level
[0m17:03:27.760125 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.hot_upsell
[0m17:03:27.760333 [debug] [Thread-1 (]: Compiling model.jaffle_shop.below_depletion_level
[0m17:03:27.760533 [debug] [Thread-2 (]: Compiling model.jaffle_shop.hot_upsell
[0m17:03:27.762898 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.below_depletion_level"
[0m17:03:27.765293 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.hot_upsell"
[0m17:03:27.767825 [debug] [Thread-1 (]: finished collecting timing info
[0m17:03:27.768085 [debug] [Thread-2 (]: finished collecting timing info
[0m17:03:27.768243 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.below_depletion_level
[0m17:03:27.768478 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.hot_upsell
[0m17:03:27.807392 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.hot_upsell"
[0m17:03:27.808673 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.below_depletion_level"
[0m17:03:27.811054 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m17:03:27.811361 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:03:27.811475 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: BEGIN
[0m17:03:27.811755 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: BEGIN
[0m17:03:27.812004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:27.812276 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:03:27.823920 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m17:03:27.824163 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m17:03:27.829024 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m17:03:27.829279 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:03:27.829499 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */

  create view "postgres"."public"."below_depletion_level__dbt_tmp" as (
    select distinct name, ruv.variant, ruv.actual_size, ruv.weave_cat, ruv.size_grp, ruv.shape, ruv.weight
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where stock_level < coalesce(depletion_level, 0)
  );
[0m17:03:27.829731 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */

  create view "postgres"."public"."hot_upsell__dbt_tmp" as (
    select distinct rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, (ruv.msrp - rupu.price) as profit_margin
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_pads_upsell" rupu on rupu.p_id = ruv.pid and rupu.variant = ruv.variant 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where new_arrival = 'Y' and stock_level < coalesce(depletion_level, 0) and rupu.stock is not null
order by profit_margin desc
  );
[0m17:03:27.842560 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m17:03:27.851078 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:03:27.851290 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.02 seconds
[0m17:03:27.851645 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
alter table "postgres"."public"."hot_upsell" rename to "hot_upsell__dbt_backup"
[0m17:03:27.853811 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m17:03:27.854256 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level" rename to "below_depletion_level__dbt_backup"
[0m17:03:27.855486 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:27.855599 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:27.857357 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m17:03:27.859107 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:03:27.859340 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level__dbt_tmp" rename to "below_depletion_level"
[0m17:03:27.859559 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
alter table "postgres"."public"."hot_upsell__dbt_tmp" rename to "hot_upsell"
[0m17:03:27.860118 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:27.860275 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:27.875049 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m17:03:27.876564 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: COMMIT
[0m17:03:27.876843 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m17:03:27.877117 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:03:27.877382 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m17:03:27.877661 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: COMMIT
[0m17:03:27.880116 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:27.880201 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:27.883907 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m17:03:27.885275 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:03:27.885528 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
drop view if exists "postgres"."public"."below_depletion_level__dbt_backup" cascade
[0m17:03:27.885788 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
drop view if exists "postgres"."public"."hot_upsell__dbt_backup" cascade
[0m17:03:27.890409 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:03:27.891827 [debug] [Thread-2 (]: finished collecting timing info
[0m17:03:27.891928 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m17:03:27.892168 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: Close
[0m17:03:27.892993 [debug] [Thread-1 (]: finished collecting timing info
[0m17:03:27.893681 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80aa74fe-2fee-4263-8802-cea5fc7921ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff80bf9a0>]}
[0m17:03:27.893789 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: Close
[0m17:03:27.894247 [info ] [Thread-2 (]: 2 of 4 OK created view model public.hot_upsell ................................. [[32mCREATE VIEW[0m in 0.13s]
[0m17:03:27.894804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80aa74fe-2fee-4263-8802-cea5fc7921ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a600d0>]}
[0m17:03:27.895348 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.hot_upsell
[0m17:03:27.895978 [info ] [Thread-1 (]: 1 of 4 OK created view model public.below_depletion_level ...................... [[32mCREATE VIEW[0m in 0.14s]
[0m17:03:27.896288 [debug] [Thread-2 (]: Began running node model.jaffle_shop.underselling_product_specs
[0m17:03:27.896715 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.below_depletion_level
[0m17:03:27.896992 [info ] [Thread-2 (]: 3 of 4 START view model public.underselling_product_specs ...................... [RUN]
[0m17:03:27.897411 [debug] [Thread-1 (]: Began running node model.jaffle_shop.priority_order
[0m17:03:27.897837 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:03:27.898085 [info ] [Thread-1 (]: 4 of 4 START view model public.priority_order .................................. [RUN]
[0m17:03:27.898320 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.underselling_product_specs
[0m17:03:27.898717 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.priority_order"
[0m17:03:27.898953 [debug] [Thread-2 (]: Compiling model.jaffle_shop.underselling_product_specs
[0m17:03:27.899163 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.priority_order
[0m17:03:27.901763 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.underselling_product_specs"
[0m17:03:27.902017 [debug] [Thread-1 (]: Compiling model.jaffle_shop.priority_order
[0m17:03:27.905230 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.priority_order"
[0m17:03:27.906852 [debug] [Thread-2 (]: finished collecting timing info
[0m17:03:27.907079 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.underselling_product_specs
[0m17:03:27.907226 [debug] [Thread-1 (]: finished collecting timing info
[0m17:03:27.910142 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.underselling_product_specs"
[0m17:03:27.910395 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.priority_order
[0m17:03:27.913280 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.priority_order"
[0m17:03:27.913700 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:03:27.914184 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: BEGIN
[0m17:03:27.914483 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m17:03:27.914575 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:03:27.914915 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: BEGIN
[0m17:03:27.915432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:27.921994 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m17:03:27.922165 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m17:03:27.922478 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m17:03:27.922731 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:03:27.922956 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */

  create view "postgres"."public"."priority_order__dbt_tmp" as (
    select distinct rup.name as product_name, ruv.variant as variant, ruv.actual_size, ruv.weave_cat, (msrp - price) as profit 
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
join "postgres"."public"."below_depletion_level" bdl on bdl.name = rup.name and bdl.variant = ruv.variant
order by profit desc
  );
[0m17:03:27.923156 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */

  create view "postgres"."public"."underselling_product_specs__dbt_tmp" as (
    select distinct rup.name, rucm.color_value, ruv.actual_size, ruv.weave_cat, ruv.size_grp, ruv.shape, (ruv.stock_level - ruv.depletion_level) as stock_depletion_ratio
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_color_map" rucm on rucm.color_id = ruv.pid 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
where stock_level > coalesce(depletion_level, 0) and depletion_level <> 0 
and stock_level is not null and stock_level <> 0 and new_arrival = 'N' and status = 'In_stock'
order by stock_depletion_ratio desc limit 10
  );
[0m17:03:27.926121 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:03:27.926631 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:03:27.929671 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m17:03:27.932148 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:03:27.932462 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
alter table "postgres"."public"."priority_order__dbt_tmp" rename to "priority_order"
[0m17:03:27.932856 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
alter table "postgres"."public"."underselling_product_specs" rename to "underselling_product_specs__dbt_backup"
[0m17:03:27.933589 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:27.933676 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:27.934875 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: COMMIT
[0m17:03:27.936777 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:03:27.937061 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m17:03:27.937363 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
alter table "postgres"."public"."underselling_product_specs__dbt_tmp" rename to "underselling_product_specs"
[0m17:03:27.937668 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: COMMIT
[0m17:03:27.938700 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:27.942206 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: COMMIT
[0m17:03:27.942330 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:27.942548 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:03:27.943972 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m17:03:27.944211 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: COMMIT
[0m17:03:27.944420 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
drop view if exists "postgres"."public"."priority_order__dbt_backup" cascade
[0m17:03:27.945536 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:27.946905 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:03:27.946997 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:03:27.947201 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
drop view if exists "postgres"."public"."underselling_product_specs__dbt_backup" cascade
[0m17:03:27.948110 [debug] [Thread-1 (]: finished collecting timing info
[0m17:03:27.948733 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: Close
[0m17:03:27.949217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80aa74fe-2fee-4263-8802-cea5fc7921ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff80e6170>]}
[0m17:03:27.949638 [info ] [Thread-1 (]: 4 of 4 OK created view model public.priority_order ............................. [[32mCREATE VIEW[0m in 0.05s]
[0m17:03:27.950048 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.priority_order
[0m17:03:27.950144 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:03:27.951324 [debug] [Thread-2 (]: finished collecting timing info
[0m17:03:27.951559 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: Close
[0m17:03:27.951943 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80aa74fe-2fee-4263-8802-cea5fc7921ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a7ae60>]}
[0m17:03:27.952681 [info ] [Thread-2 (]: 3 of 4 OK created view model public.underselling_product_specs ................. [[32mCREATE VIEW[0m in 0.05s]
[0m17:03:27.953034 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.underselling_product_specs
[0m17:03:27.955036 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:03:27.955306 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:27.955515 [debug] [MainThread]: On master: BEGIN
[0m17:03:27.955696 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:03:27.962372 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:03:27.962769 [debug] [MainThread]: On master: COMMIT
[0m17:03:27.962966 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:27.963099 [debug] [MainThread]: On master: COMMIT
[0m17:03:27.963292 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:03:27.963441 [debug] [MainThread]: On master: Close
[0m17:03:27.964040 [info ] [MainThread]: 
[0m17:03:27.964310 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m17:03:27.964560 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:03:27.964715 [debug] [MainThread]: Connection 'model.jaffle_shop.priority_order' was properly closed.
[0m17:03:27.964922 [debug] [MainThread]: Connection 'model.jaffle_shop.underselling_product_specs' was properly closed.
[0m17:03:27.970781 [info ] [MainThread]: 
[0m17:03:27.971054 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:03:27.971342 [info ] [MainThread]: 
[0m17:03:27.971569 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:03:27.972011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b54cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff80bf9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff810ae00>]}


============================== 2024-07-14 17:06:57.993104 | 8ec0f3fb-9293-42d6-b571-1759ee2add0c ==============================
[0m17:06:57.993423 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:06:58.004513 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m17:06:58.005039 [debug] [MainThread]: Tracking: tracking
[0m17:06:58.021582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2dd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2cc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2d900>]}
[0m17:06:58.068744 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:06:58.069426 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/tests/below_depletion_level_tests.yml
[0m17:06:58.110797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ec0f3fb-9293-42d6-b571-1759ee2add0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a040d0>]}
[0m17:06:58.122318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ec0f3fb-9293-42d6-b571-1759ee2add0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bb2b00>]}
[0m17:06:58.122703 [info ] [MainThread]: Found 4 models, 3 tests, 2 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:06:58.123044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ec0f3fb-9293-42d6-b571-1759ee2add0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bb2a40>]}
[0m17:06:58.124755 [info ] [MainThread]: 
[0m17:06:58.125394 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:06:58.128767 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m17:06:58.137907 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:06:58.138333 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:06:58.138614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:58.199490 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
[0m17:06:58.199991 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:06:58.200257 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:06:58.204911 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m17:06:58.206644 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:06:58.207056 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:06:58.211802 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:58.212112 [debug] [MainThread]: On master: BEGIN
[0m17:06:58.212370 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:06:58.220200 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:06:58.220589 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:58.220832 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:06:58.227056 [debug] [MainThread]: SQL status: SELECT 11 in 0.01 seconds
[0m17:06:58.228406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ec0f3fb-9293-42d6-b571-1759ee2add0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b95540>]}
[0m17:06:58.228807 [debug] [MainThread]: On master: ROLLBACK
[0m17:06:58.229083 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:58.229294 [debug] [MainThread]: On master: BEGIN
[0m17:06:58.229614 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:06:58.229880 [debug] [MainThread]: On master: COMMIT
[0m17:06:58.230065 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:58.230242 [debug] [MainThread]: On master: COMMIT
[0m17:06:58.230472 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:06:58.230722 [debug] [MainThread]: On master: Close
[0m17:06:58.231081 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:06:58.231389 [info ] [MainThread]: 
[0m17:06:58.235466 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:06:58.235601 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:06:58.235867 [info ] [Thread-1 (]: 1 of 3 START test not_null_below_depletion_level_name .......................... [RUN]
[0m17:06:58.236175 [info ] [Thread-2 (]: 2 of 3 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m17:06:58.236606 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:06:58.237012 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:06:58.237329 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:06:58.237542 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:06:58.237755 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:06:58.237989 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:06:58.249622 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:06:58.252883 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:06:58.256257 [debug] [Thread-2 (]: finished collecting timing info
[0m17:06:58.256836 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:06:58.257076 [debug] [Thread-1 (]: finished collecting timing info
[0m17:06:58.271340 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:06:58.271770 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:06:58.273941 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:06:58.275472 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:06:58.275713 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:06:58.275823 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m17:06:58.276049 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m17:06:58.276281 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:06:58.276502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:58.284222 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m17:06:58.284447 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m17:06:58.285050 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:06:58.284752 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:06:58.285288 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m17:06:58.285673 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m17:06:58.329967 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.04 seconds
[0m17:06:58.332604 [debug] [Thread-1 (]: finished collecting timing info
[0m17:06:58.333002 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m17:06:58.333383 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m17:06:58.333914 [info ] [Thread-1 (]: 1 of 3 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.10s]
[0m17:06:58.334971 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:06:58.335333 [debug] [Thread-1 (]: Began running node test.jaffle_shop.stock_depletion_check.944e35ac3c
[0m17:06:58.335623 [info ] [Thread-1 (]: 3 of 3 START test stock_depletion_check ........................................ [RUN]
[0m17:06:58.336121 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.stock_depletion_check.944e35ac3c"
[0m17:06:58.336404 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.stock_depletion_check.944e35ac3c
[0m17:06:58.336639 [debug] [Thread-1 (]: Compiling test.jaffle_shop.stock_depletion_check.944e35ac3c
[0m17:06:58.342461 [debug] [Thread-1 (]: finished collecting timing info
[0m17:06:58.343643 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.05 seconds
[0m17:06:58.344222 [debug] [Thread-1 (]: Compilation Error in test stock_depletion_check (models/tests/below_depletion_level_tests.yml)
  'test_custom_sql' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:06:58.345575 [debug] [Thread-2 (]: finished collecting timing info
[0m17:06:58.346001 [error] [Thread-1 (]: 3 of 3 ERROR stock_depletion_check ............................................. [[31mERROR[0m in 0.01s]
[0m17:06:58.346295 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m17:06:58.346816 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.stock_depletion_check.944e35ac3c
[0m17:06:58.347383 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m17:06:58.348120 [info ] [Thread-2 (]: 2 of 3 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.11s]
[0m17:06:58.348594 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:06:58.350454 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:06:58.350742 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:58.350979 [debug] [MainThread]: On master: BEGIN
[0m17:06:58.351174 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:06:58.357327 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:06:58.357628 [debug] [MainThread]: On master: COMMIT
[0m17:06:58.357849 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:58.358061 [debug] [MainThread]: On master: COMMIT
[0m17:06:58.358317 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:06:58.358521 [debug] [MainThread]: On master: Close
[0m17:06:58.359085 [info ] [MainThread]: 
[0m17:06:58.359387 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m17:06:58.359681 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:06:58.359952 [debug] [MainThread]: Connection 'test.jaffle_shop.stock_depletion_check.944e35ac3c' was properly closed.
[0m17:06:58.360138 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1' was properly closed.
[0m17:06:58.367192 [info ] [MainThread]: 
[0m17:06:58.367518 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:06:58.367827 [info ] [MainThread]: 
[0m17:06:58.368110 [error] [MainThread]: [33mCompilation Error in test stock_depletion_check (models/tests/below_depletion_level_tests.yml)[0m
[0m17:06:58.368375 [error] [MainThread]:   'test_custom_sql' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:06:58.368656 [info ] [MainThread]: 
[0m17:06:58.368931 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:06:58.369288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a7b220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a7b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a7b0d0>]}


============================== 2024-07-14 17:08:03.993873 | 8f5bb314-fc70-4133-afde-cf40acb44f92 ==============================
[0m17:08:03.994179 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:08:04.006327 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m17:08:04.006741 [debug] [MainThread]: Tracking: tracking
[0m17:08:04.022314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c25480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c25090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c25210>]}
[0m17:08:04.067341 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m17:08:04.109189 [debug] [MainThread]: 1699: static parser successfully parsed below_depletion_level.sql
[0m17:08:04.130331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f5bb314-fc70-4133-afde-cf40acb44f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89e6320>]}
[0m17:08:04.139677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f5bb314-fc70-4133-afde-cf40acb44f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b6bf40>]}
[0m17:08:04.140072 [info ] [MainThread]: Found 4 models, 0 tests, 2 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:08:04.140401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f5bb314-fc70-4133-afde-cf40acb44f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b69f00>]}
[0m17:08:04.141847 [info ] [MainThread]: 
[0m17:08:04.142190 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m17:08:04.148665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b9e7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b9d660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b9da20>]}


============================== 2024-07-14 17:08:36.271688 | 56604d27-102b-4d03-b70d-a0cdeb3c1d25 ==============================
[0m17:08:36.272006 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:08:36.286408 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m17:08:36.286823 [debug] [MainThread]: Tracking: tracking
[0m17:08:36.302338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c176a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c172b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c16e60>]}
[0m17:08:36.346834 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:08:36.347211 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:08:36.353292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56604d27-102b-4d03-b70d-a0cdeb3c1d25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9baff40>]}
[0m17:08:36.362674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56604d27-102b-4d03-b70d-a0cdeb3c1d25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b72d10>]}
[0m17:08:36.363089 [info ] [MainThread]: Found 4 models, 0 tests, 2 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:08:36.363431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56604d27-102b-4d03-b70d-a0cdeb3c1d25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b72e30>]}
[0m17:08:36.364949 [info ] [MainThread]: 
[0m17:08:36.365299 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m17:08:36.371730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b70730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b72e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b70640>]}


============================== 2024-07-14 17:10:59.114199 | a98357df-2b9a-4687-a896-34d5f9d1ce5c ==============================
[0m17:10:59.114526 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:10:59.127295 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m17:10:59.127662 [debug] [MainThread]: Tracking: tracking
[0m17:10:59.143559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b280>]}
[0m17:10:59.189364 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:10:59.190062 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/below_depletion_level_tests.yml
[0m17:10:59.231625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a98357df-2b9a-4687-a896-34d5f9d1ce5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a040d0>]}
[0m17:10:59.242146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a98357df-2b9a-4687-a896-34d5f9d1ce5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bab730>]}
[0m17:10:59.242559 [info ] [MainThread]: Found 4 models, 3 tests, 2 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:10:59.242887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a98357df-2b9a-4687-a896-34d5f9d1ce5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9baa890>]}
[0m17:10:59.244530 [info ] [MainThread]: 
[0m17:10:59.245127 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:10:59.247540 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m17:10:59.255716 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:10:59.256047 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:10:59.256286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:59.301437 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m17:10:59.301922 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:10:59.302179 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:10:59.308819 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.01 seconds
[0m17:10:59.310599 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:10:59.311003 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:10:59.315375 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:59.315683 [debug] [MainThread]: On master: BEGIN
[0m17:10:59.315899 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:10:59.322616 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:10:59.322950 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:59.323176 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:10:59.329059 [debug] [MainThread]: SQL status: SELECT 11 in 0.01 seconds
[0m17:10:59.330445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a98357df-2b9a-4687-a896-34d5f9d1ce5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b91540>]}
[0m17:10:59.330798 [debug] [MainThread]: On master: ROLLBACK
[0m17:10:59.331091 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:59.331296 [debug] [MainThread]: On master: BEGIN
[0m17:10:59.331622 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:10:59.331887 [debug] [MainThread]: On master: COMMIT
[0m17:10:59.332092 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:59.332295 [debug] [MainThread]: On master: COMMIT
[0m17:10:59.332545 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:10:59.332750 [debug] [MainThread]: On master: Close
[0m17:10:59.333118 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:10:59.333426 [info ] [MainThread]: 
[0m17:10:59.344072 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:10:59.344284 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:10:59.344617 [info ] [Thread-1 (]: 1 of 3 START test not_null_below_depletion_level_name .......................... [RUN]
[0m17:10:59.344997 [info ] [Thread-2 (]: 2 of 3 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m17:10:59.345558 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:10:59.346493 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:10:59.346981 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:10:59.347372 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:10:59.347650 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:10:59.347904 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:10:59.356605 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:10:59.361148 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:10:59.363377 [debug] [Thread-1 (]: finished collecting timing info
[0m17:10:59.363801 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:10:59.364046 [debug] [Thread-2 (]: finished collecting timing info
[0m17:10:59.378539 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:10:59.378946 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:10:59.381306 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:10:59.382562 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:10:59.382794 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m17:10:59.382990 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:10:59.383080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:59.383302 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m17:10:59.383757 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:10:59.390325 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m17:10:59.390515 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m17:10:59.390791 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:10:59.391035 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:10:59.391284 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m17:10:59.391490 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m17:10:59.398298 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m17:10:59.401014 [debug] [Thread-1 (]: finished collecting timing info
[0m17:10:59.401381 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m17:10:59.401743 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m17:10:59.402357 [info ] [Thread-1 (]: 1 of 3 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.06s]
[0m17:10:59.403170 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:10:59.403719 [debug] [Thread-1 (]: Began running node test.jaffle_shop.stock_depletion_check.944e35ac3c
[0m17:10:59.404007 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m17:10:59.404117 [info ] [Thread-1 (]: 3 of 3 START test stock_depletion_check ........................................ [RUN]
[0m17:10:59.405281 [debug] [Thread-2 (]: finished collecting timing info
[0m17:10:59.405733 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.stock_depletion_check.944e35ac3c"
[0m17:10:59.405957 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m17:10:59.406202 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.stock_depletion_check.944e35ac3c
[0m17:10:59.406509 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m17:10:59.406602 [debug] [Thread-1 (]: Compiling test.jaffle_shop.stock_depletion_check.944e35ac3c
[0m17:10:59.406984 [info ] [Thread-2 (]: 2 of 3 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.06s]
[0m17:10:59.411606 [debug] [Thread-1 (]: finished collecting timing info
[0m17:10:59.411865 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:10:59.413089 [debug] [Thread-1 (]: Compilation Error in test stock_depletion_check (models/below_depletion_level_tests.yml)
  'test_custom_sql' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:10:59.413640 [error] [Thread-1 (]: 3 of 3 ERROR stock_depletion_check ............................................. [[31mERROR[0m in 0.01s]
[0m17:10:59.414009 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.stock_depletion_check.944e35ac3c
[0m17:10:59.415689 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:10:59.415961 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:59.416204 [debug] [MainThread]: On master: BEGIN
[0m17:10:59.416426 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:10:59.422712 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:10:59.423163 [debug] [MainThread]: On master: COMMIT
[0m17:10:59.423442 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:59.427008 [debug] [MainThread]: On master: COMMIT
[0m17:10:59.427313 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:10:59.428240 [debug] [MainThread]: On master: Close
[0m17:10:59.428836 [info ] [MainThread]: 
[0m17:10:59.429152 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m17:10:59.429508 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:59.429773 [debug] [MainThread]: Connection 'test.jaffle_shop.stock_depletion_check.944e35ac3c' was properly closed.
[0m17:10:59.429992 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1' was properly closed.
[0m17:10:59.438525 [info ] [MainThread]: 
[0m17:10:59.438884 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:10:59.439220 [info ] [MainThread]: 
[0m17:10:59.439527 [error] [MainThread]: [33mCompilation Error in test stock_depletion_check (models/below_depletion_level_tests.yml)[0m
[0m17:10:59.439779 [error] [MainThread]:   'test_custom_sql' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:10:59.440084 [info ] [MainThread]: 
[0m17:10:59.440365 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:10:59.440753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9aa4820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9aa4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9aa4130>]}


============================== 2024-07-14 17:32:44.232065 | 109bdc42-6970-4f7e-bd5f-9842ed680eb1 ==============================
[0m17:32:44.232413 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:32:44.247765 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m17:32:44.248280 [debug] [MainThread]: Tracking: tracking
[0m17:32:44.270834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c15d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c14c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c15930>]}
[0m17:32:44.330135 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 3 files added, 0 files changed.
[0m17:32:44.330780 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://macros/below_depletion_level_tests.sql
[0m17:32:44.331100 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/below_depletion_level/below_depletion_level.sql
[0m17:32:44.331406 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/below_depletion_level/below_depletion_level_tests.yml
[0m17:32:44.331763 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://models/below_depletion_level.sql
[0m17:32:44.331988 [debug] [MainThread]: Parsing macros/below_depletion_level_tests.sql
[0m17:32:44.368370 [debug] [MainThread]: 1699: static parser successfully parsed below_depletion_level/below_depletion_level.sql
[0m17:32:44.379090 [debug] [MainThread]: 1699: static parser successfully parsed priority_order.sql
[0m17:32:44.414007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '109bdc42-6970-4f7e-bd5f-9842ed680eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7ffd0>]}
[0m17:32:44.425076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '109bdc42-6970-4f7e-bd5f-9842ed680eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b6ff70>]}
[0m17:32:44.425590 [info ] [MainThread]: Found 4 models, 3 tests, 2 snapshots, 0 analyses, 257 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:32:44.425955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '109bdc42-6970-4f7e-bd5f-9842ed680eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b61300>]}
[0m17:32:44.427927 [info ] [MainThread]: 
[0m17:32:44.428718 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:32:44.432088 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m17:32:44.440262 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:32:44.440591 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:32:44.440824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:44.495449 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m17:32:44.495964 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:32:44.496227 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:32:44.503118 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.01 seconds
[0m17:32:44.504891 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:32:44.505256 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:32:44.509880 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:44.510200 [debug] [MainThread]: On master: BEGIN
[0m17:32:44.510418 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:32:44.517567 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:32:44.517944 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:44.518204 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:32:44.525248 [debug] [MainThread]: SQL status: SELECT 11 in 0.01 seconds
[0m17:32:44.526625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '109bdc42-6970-4f7e-bd5f-9842ed680eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b6eb90>]}
[0m17:32:44.526983 [debug] [MainThread]: On master: ROLLBACK
[0m17:32:44.527295 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:44.527505 [debug] [MainThread]: On master: BEGIN
[0m17:32:44.527833 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:32:44.528102 [debug] [MainThread]: On master: COMMIT
[0m17:32:44.528299 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:44.528505 [debug] [MainThread]: On master: COMMIT
[0m17:32:44.528750 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:32:44.528957 [debug] [MainThread]: On master: Close
[0m17:32:44.529395 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:32:44.529703 [info ] [MainThread]: 
[0m17:32:44.533608 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:32:44.533752 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:32:44.534033 [info ] [Thread-1 (]: 1 of 3 START test not_null_below_depletion_level_name .......................... [RUN]
[0m17:32:44.534465 [info ] [Thread-2 (]: 2 of 3 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m17:32:44.534956 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:32:44.535517 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:32:44.535866 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:32:44.536131 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:32:44.536383 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:32:44.536666 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:32:44.544168 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:32:44.548547 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:32:44.552192 [debug] [Thread-1 (]: finished collecting timing info
[0m17:32:44.552309 [debug] [Thread-2 (]: finished collecting timing info
[0m17:32:44.552545 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:32:44.552799 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:32:44.566375 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:32:44.570849 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:32:44.577544 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:32:44.578909 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m17:32:44.579259 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:32:44.581095 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:32:44.581613 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m17:32:44.582189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:44.594726 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m17:32:44.595219 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:32:44.595456 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m17:32:44.597838 [debug] [Thread-2 (]: SQL status: BEGIN in 0.02 seconds
[0m17:32:44.598228 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:32:44.598457 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m17:32:44.608394 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m17:32:44.614572 [debug] [Thread-1 (]: finished collecting timing info
[0m17:32:44.614934 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m17:32:44.615321 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m17:32:44.616205 [info ] [Thread-1 (]: 1 of 3 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.08s]
[0m17:32:44.617656 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:32:44.618214 [debug] [Thread-1 (]: Began running node test.jaffle_shop.stock_depletion_check.944e35ac3c
[0m17:32:44.618346 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.02 seconds
[0m17:32:44.618653 [info ] [Thread-1 (]: 3 of 3 START test stock_depletion_check ........................................ [RUN]
[0m17:32:44.619981 [debug] [Thread-2 (]: finished collecting timing info
[0m17:32:44.620697 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.stock_depletion_check.944e35ac3c"
[0m17:32:44.621256 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m17:32:44.621844 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.stock_depletion_check.944e35ac3c
[0m17:32:44.622726 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m17:32:44.622930 [debug] [Thread-1 (]: Compiling test.jaffle_shop.stock_depletion_check.944e35ac3c
[0m17:32:44.623703 [info ] [Thread-2 (]: 2 of 3 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.09s]
[0m17:32:44.628484 [debug] [Thread-1 (]: finished collecting timing info
[0m17:32:44.629091 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:32:44.629489 [debug] [Thread-1 (]: Compilation Error in test stock_depletion_check (models/below_depletion_level/below_depletion_level_tests.yml)
  'test_custom_sql' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:32:44.629991 [error] [Thread-1 (]: 3 of 3 ERROR stock_depletion_check ............................................. [[31mERROR[0m in 0.01s]
[0m17:32:44.630369 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.stock_depletion_check.944e35ac3c
[0m17:32:44.632160 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:32:44.632440 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:44.632670 [debug] [MainThread]: On master: BEGIN
[0m17:32:44.632892 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:32:44.639302 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:32:44.639626 [debug] [MainThread]: On master: COMMIT
[0m17:32:44.639856 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:44.640078 [debug] [MainThread]: On master: COMMIT
[0m17:32:44.640406 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:32:44.640675 [debug] [MainThread]: On master: Close
[0m17:32:44.641364 [info ] [MainThread]: 
[0m17:32:44.641686 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m17:32:44.642135 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:32:44.642587 [debug] [MainThread]: Connection 'test.jaffle_shop.stock_depletion_check.944e35ac3c' was properly closed.
[0m17:32:44.642794 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1' was properly closed.
[0m17:32:44.649347 [info ] [MainThread]: 
[0m17:32:44.649668 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:32:44.649999 [info ] [MainThread]: 
[0m17:32:44.650324 [error] [MainThread]: [33mCompilation Error in test stock_depletion_check (models/below_depletion_level/below_depletion_level_tests.yml)[0m
[0m17:32:44.650568 [error] [MainThread]:   'test_custom_sql' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:32:44.650830 [info ] [MainThread]: 
[0m17:32:44.651095 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:32:44.651454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b61330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b612d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bae4d0>]}


============================== 2024-07-14 17:36:21.638665 | 01b9018d-6cb4-473b-9caa-80f134487e05 ==============================
[0m17:36:21.638994 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:36:21.653048 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m17:36:21.653533 [debug] [MainThread]: Tracking: tracking
[0m17:36:21.668153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2afb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2bfd0>]}
[0m17:36:21.720707 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:36:21.721147 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:36:21.727417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01b9018d-6cb4-473b-9caa-80f134487e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bb54e0>]}
[0m17:36:21.737739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01b9018d-6cb4-473b-9caa-80f134487e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7f5e0>]}
[0m17:36:21.738255 [info ] [MainThread]: Found 4 models, 3 tests, 2 snapshots, 0 analyses, 257 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:36:21.738634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01b9018d-6cb4-473b-9caa-80f134487e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7f4f0>]}
[0m17:36:21.740954 [info ] [MainThread]: 
[0m17:36:21.741792 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:36:21.745176 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m17:36:21.753833 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:36:21.754238 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:36:21.754492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:21.801130 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m17:36:21.801667 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:36:21.801930 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:36:21.806101 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m17:36:21.807894 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:36:21.808322 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:36:21.812863 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:21.813183 [debug] [MainThread]: On master: BEGIN
[0m17:36:21.813427 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:36:21.819722 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:36:21.820102 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:21.820447 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:36:21.825534 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m17:36:21.826888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01b9018d-6cb4-473b-9caa-80f134487e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7e830>]}
[0m17:36:21.827249 [debug] [MainThread]: On master: ROLLBACK
[0m17:36:21.827528 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:21.827731 [debug] [MainThread]: On master: BEGIN
[0m17:36:21.828071 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:36:21.828338 [debug] [MainThread]: On master: COMMIT
[0m17:36:21.828546 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:21.828739 [debug] [MainThread]: On master: COMMIT
[0m17:36:21.828998 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:36:21.829210 [debug] [MainThread]: On master: Close
[0m17:36:21.829579 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:36:21.829859 [info ] [MainThread]: 
[0m17:36:21.833715 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:36:21.833849 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:36:21.834133 [info ] [Thread-1 (]: 1 of 3 START test not_null_below_depletion_level_name .......................... [RUN]
[0m17:36:21.834452 [info ] [Thread-2 (]: 2 of 3 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m17:36:21.834877 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:36:21.835377 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:36:21.835702 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:36:21.835915 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:36:21.836174 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:36:21.836411 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:36:21.847394 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:36:21.850224 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:36:21.852127 [debug] [Thread-1 (]: finished collecting timing info
[0m17:36:21.852232 [debug] [Thread-2 (]: finished collecting timing info
[0m17:36:21.852441 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:36:21.852695 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:36:21.867671 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:36:21.869496 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:36:21.871556 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:36:21.871676 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:36:21.871903 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m17:36:21.872174 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m17:36:21.872407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:21.872631 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:36:21.880402 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m17:36:21.881089 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m17:36:21.881376 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:36:21.881726 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:36:21.882240 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m17:36:21.883047 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m17:36:21.890817 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m17:36:21.893785 [debug] [Thread-1 (]: finished collecting timing info
[0m17:36:21.894203 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m17:36:21.894687 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m17:36:21.895244 [info ] [Thread-1 (]: 1 of 3 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.06s]
[0m17:36:21.896011 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:36:21.896466 [debug] [Thread-1 (]: Began running node test.jaffle_shop.stock_depletion_check.944e35ac3c
[0m17:36:21.896804 [info ] [Thread-1 (]: 3 of 3 START test stock_depletion_check ........................................ [RUN]
[0m17:36:21.897534 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.stock_depletion_check.944e35ac3c"
[0m17:36:21.897807 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.stock_depletion_check.944e35ac3c
[0m17:36:21.898074 [debug] [Thread-1 (]: Compiling test.jaffle_shop.stock_depletion_check.944e35ac3c
[0m17:36:21.898183 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m17:36:21.903436 [debug] [Thread-1 (]: finished collecting timing info
[0m17:36:21.904645 [debug] [Thread-2 (]: finished collecting timing info
[0m17:36:21.905220 [debug] [Thread-1 (]: Compilation Error in test stock_depletion_check (models/below_depletion_level/below_depletion_level_tests.yml)
  'test_custom_sql' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:36:21.905533 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m17:36:21.905818 [error] [Thread-1 (]: 3 of 3 ERROR stock_depletion_check ............................................. [[31mERROR[0m in 0.01s]
[0m17:36:21.906263 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m17:36:21.906535 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.stock_depletion_check.944e35ac3c
[0m17:36:21.907012 [info ] [Thread-2 (]: 2 of 3 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.07s]
[0m17:36:21.907728 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:36:21.909879 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:36:21.910229 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:21.910465 [debug] [MainThread]: On master: BEGIN
[0m17:36:21.910682 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:36:21.917132 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:36:21.917477 [debug] [MainThread]: On master: COMMIT
[0m17:36:21.917701 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:21.917920 [debug] [MainThread]: On master: COMMIT
[0m17:36:21.918276 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:36:21.918496 [debug] [MainThread]: On master: Close
[0m17:36:21.919112 [info ] [MainThread]: 
[0m17:36:21.919446 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m17:36:21.919819 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:36:21.920083 [debug] [MainThread]: Connection 'test.jaffle_shop.stock_depletion_check.944e35ac3c' was properly closed.
[0m17:36:21.920300 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1' was properly closed.
[0m17:36:21.928531 [info ] [MainThread]: 
[0m17:36:21.928924 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:36:21.929303 [info ] [MainThread]: 
[0m17:36:21.929686 [error] [MainThread]: [33mCompilation Error in test stock_depletion_check (models/below_depletion_level/below_depletion_level_tests.yml)[0m
[0m17:36:21.930006 [error] [MainThread]:   'test_custom_sql' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:36:21.930363 [info ] [MainThread]: 
[0m17:36:21.930706 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:36:21.931208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a3b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99e1f90>]}


============================== 2024-07-14 17:37:00.855669 | ec7a4adc-73cd-4844-9957-8b098bb2c221 ==============================
[0m17:37:00.855978 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:37:00.869322 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m17:37:00.869741 [debug] [MainThread]: Tracking: tracking
[0m17:37:00.884695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c26320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c27400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c25cf0>]}
[0m17:37:00.934163 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m17:37:00.934732 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://macros/custom_tests.sql
[0m17:37:00.935035 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://macros/below_depletion_level_tests.sql
[0m17:37:00.935320 [debug] [MainThread]: Parsing macros/custom_tests.sql
[0m17:37:00.947614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec7a4adc-73cd-4844-9957-8b098bb2c221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99d59f0>]}
[0m17:37:00.958249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec7a4adc-73cd-4844-9957-8b098bb2c221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b6ff40>]}
[0m17:37:00.958713 [info ] [MainThread]: Found 4 models, 3 tests, 2 snapshots, 0 analyses, 257 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:37:00.959055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec7a4adc-73cd-4844-9957-8b098bb2c221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b5d000>]}
[0m17:37:00.960699 [info ] [MainThread]: 
[0m17:37:00.961320 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:37:00.963972 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m17:37:00.973548 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:37:00.973912 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:37:00.974171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:01.018605 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m17:37:01.019114 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:37:01.019362 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:37:01.023287 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m17:37:01.025043 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:37:01.025470 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:37:01.030211 [debug] [MainThread]: Using postgres connection "master"
[0m17:37:01.030530 [debug] [MainThread]: On master: BEGIN
[0m17:37:01.030893 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:37:01.037940 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:37:01.038307 [debug] [MainThread]: Using postgres connection "master"
[0m17:37:01.038553 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:37:01.043124 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m17:37:01.044504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec7a4adc-73cd-4844-9957-8b098bb2c221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b6ed70>]}
[0m17:37:01.044884 [debug] [MainThread]: On master: ROLLBACK
[0m17:37:01.045210 [debug] [MainThread]: Using postgres connection "master"
[0m17:37:01.045462 [debug] [MainThread]: On master: BEGIN
[0m17:37:01.045848 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:37:01.046101 [debug] [MainThread]: On master: COMMIT
[0m17:37:01.046324 [debug] [MainThread]: Using postgres connection "master"
[0m17:37:01.046557 [debug] [MainThread]: On master: COMMIT
[0m17:37:01.046841 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:37:01.047076 [debug] [MainThread]: On master: Close
[0m17:37:01.047482 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:37:01.048302 [info ] [MainThread]: 
[0m17:37:01.052263 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:37:01.052422 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:37:01.052737 [info ] [Thread-1 (]: 1 of 3 START test not_null_below_depletion_level_name .......................... [RUN]
[0m17:37:01.053098 [info ] [Thread-2 (]: 2 of 3 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m17:37:01.053594 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:37:01.054082 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:37:01.054430 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:37:01.054681 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:37:01.055036 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:37:01.055273 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:37:01.066566 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:37:01.070348 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:37:01.072555 [debug] [Thread-1 (]: finished collecting timing info
[0m17:37:01.072681 [debug] [Thread-2 (]: finished collecting timing info
[0m17:37:01.072910 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:37:01.073160 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:37:01.086106 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:37:01.088159 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:37:01.090403 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:37:01.090564 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:37:01.090829 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m17:37:01.091107 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m17:37:01.091377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:01.091661 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:37:01.102423 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m17:37:01.103403 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:37:01.103663 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m17:37:01.104358 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m17:37:01.104677 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:37:01.105183 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m17:37:01.113718 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m17:37:01.116701 [debug] [Thread-1 (]: finished collecting timing info
[0m17:37:01.117074 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m17:37:01.117508 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m17:37:01.118073 [info ] [Thread-1 (]: 1 of 3 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.06s]
[0m17:37:01.118931 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:37:01.119542 [debug] [Thread-1 (]: Began running node test.jaffle_shop.stock_depletion_check.944e35ac3c
[0m17:37:01.119773 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m17:37:01.120048 [info ] [Thread-1 (]: 3 of 3 START test stock_depletion_check ........................................ [RUN]
[0m17:37:01.121657 [debug] [Thread-2 (]: finished collecting timing info
[0m17:37:01.122141 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.stock_depletion_check.944e35ac3c"
[0m17:37:01.122372 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m17:37:01.122624 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.stock_depletion_check.944e35ac3c
[0m17:37:01.122988 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m17:37:01.123076 [debug] [Thread-1 (]: Compiling test.jaffle_shop.stock_depletion_check.944e35ac3c
[0m17:37:01.123536 [info ] [Thread-2 (]: 2 of 3 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.07s]
[0m17:37:01.128243 [debug] [Thread-1 (]: finished collecting timing info
[0m17:37:01.128812 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:37:01.129239 [debug] [Thread-1 (]: Compilation Error in test stock_depletion_check (models/below_depletion_level/below_depletion_level_tests.yml)
  'test_custom_sql' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:37:01.129840 [error] [Thread-1 (]: 3 of 3 ERROR stock_depletion_check ............................................. [[31mERROR[0m in 0.01s]
[0m17:37:01.130218 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.stock_depletion_check.944e35ac3c
[0m17:37:01.132045 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:37:01.132320 [debug] [MainThread]: Using postgres connection "master"
[0m17:37:01.132560 [debug] [MainThread]: On master: BEGIN
[0m17:37:01.132776 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:37:01.139323 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:37:01.139704 [debug] [MainThread]: On master: COMMIT
[0m17:37:01.139935 [debug] [MainThread]: Using postgres connection "master"
[0m17:37:01.140155 [debug] [MainThread]: On master: COMMIT
[0m17:37:01.140475 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:37:01.140735 [debug] [MainThread]: On master: Close
[0m17:37:01.141376 [info ] [MainThread]: 
[0m17:37:01.141720 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m17:37:01.142089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:37:01.142352 [debug] [MainThread]: Connection 'test.jaffle_shop.stock_depletion_check.944e35ac3c' was properly closed.
[0m17:37:01.142570 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1' was properly closed.
[0m17:37:01.152812 [info ] [MainThread]: 
[0m17:37:01.153183 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:37:01.153578 [info ] [MainThread]: 
[0m17:37:01.154025 [error] [MainThread]: [33mCompilation Error in test stock_depletion_check (models/below_depletion_level/below_depletion_level_tests.yml)[0m
[0m17:37:01.154400 [error] [MainThread]:   'test_custom_sql' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:37:01.154739 [info ] [MainThread]: 
[0m17:37:01.155065 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:37:01.155520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a7d030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b5d030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b96d40>]}


============================== 2024-07-14 17:38:30.895713 | 38b8c628-8fc3-48b7-9ed1-533819884692 ==============================
[0m17:38:30.896034 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:38:30.908917 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m17:38:30.909611 [debug] [MainThread]: Tracking: tracking
[0m17:38:30.934749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c15d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c14c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c15900>]}
[0m17:38:31.011583 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:38:31.012513 [debug] [MainThread]: Partial parsing: update schema file: jaffle_shop://models/below_depletion_level/below_depletion_level_tests.yml
[0m17:38:31.050978 [debug] [MainThread]: 1699: static parser successfully parsed below_depletion_level/below_depletion_level.sql
[0m17:38:31.096464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38b8c628-8fc3-48b7-9ed1-533819884692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7fc70>]}
[0m17:38:31.109146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38b8c628-8fc3-48b7-9ed1-533819884692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c161d0>]}
[0m17:38:31.109637 [info ] [MainThread]: Found 4 models, 3 tests, 2 snapshots, 0 analyses, 257 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:38:31.109942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38b8c628-8fc3-48b7-9ed1-533819884692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1ed70>]}
[0m17:38:31.112334 [info ] [MainThread]: 
[0m17:38:31.113357 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:38:31.115911 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m17:38:31.125575 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:38:31.126062 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:38:31.126348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:31.177512 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m17:38:31.178064 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:38:31.178654 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:38:31.183023 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m17:38:31.184983 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:38:31.185439 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:38:31.190749 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:31.191172 [debug] [MainThread]: On master: BEGIN
[0m17:38:31.191721 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:38:31.199806 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:38:31.200323 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:31.200588 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:38:31.205589 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m17:38:31.207107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38b8c628-8fc3-48b7-9ed1-533819884692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7f2b0>]}
[0m17:38:31.207488 [debug] [MainThread]: On master: ROLLBACK
[0m17:38:31.207827 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:31.208010 [debug] [MainThread]: On master: BEGIN
[0m17:38:31.208419 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:38:31.208778 [debug] [MainThread]: On master: COMMIT
[0m17:38:31.208973 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:31.209149 [debug] [MainThread]: On master: COMMIT
[0m17:38:31.209403 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:38:31.209601 [debug] [MainThread]: On master: Close
[0m17:38:31.209979 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:38:31.210233 [info ] [MainThread]: 
[0m17:38:31.218411 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:38:31.218693 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:38:31.219154 [info ] [Thread-1 (]: 1 of 3 START test not_null_below_depletion_level_name .......................... [RUN]
[0m17:38:31.219587 [info ] [Thread-2 (]: 2 of 3 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m17:38:31.220432 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:38:31.221138 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:38:31.221569 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:38:31.221861 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:38:31.222204 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:38:31.222472 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:38:31.234096 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:38:31.238183 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:38:31.241972 [debug] [Thread-1 (]: finished collecting timing info
[0m17:38:31.242135 [debug] [Thread-2 (]: finished collecting timing info
[0m17:38:31.242428 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:38:31.242681 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:38:31.258062 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:38:31.259974 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:38:31.262050 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:38:31.262168 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:38:31.262550 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m17:38:31.262899 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m17:38:31.263373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:31.263642 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:38:31.271052 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m17:38:31.271411 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m17:38:31.271780 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:38:31.272051 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:38:31.272296 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m17:38:31.272560 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m17:38:31.279176 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m17:38:31.282254 [debug] [Thread-1 (]: finished collecting timing info
[0m17:38:31.282744 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m17:38:31.283163 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m17:38:31.283708 [info ] [Thread-1 (]: 1 of 3 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.06s]
[0m17:38:31.284429 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:38:31.284843 [debug] [Thread-1 (]: Began running node test.jaffle_shop.stock_depletion_check.4d525c0edd
[0m17:38:31.285180 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m17:38:31.285292 [info ] [Thread-1 (]: 3 of 3 START test stock_depletion_check ........................................ [RUN]
[0m17:38:31.286445 [debug] [Thread-2 (]: finished collecting timing info
[0m17:38:31.286990 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.stock_depletion_check.4d525c0edd"
[0m17:38:31.287246 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m17:38:31.287504 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.stock_depletion_check.4d525c0edd
[0m17:38:31.287866 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m17:38:31.288207 [debug] [Thread-1 (]: Compiling test.jaffle_shop.stock_depletion_check.4d525c0edd
[0m17:38:31.288762 [info ] [Thread-2 (]: 2 of 3 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.07s]
[0m17:38:31.293487 [debug] [Thread-1 (]: finished collecting timing info
[0m17:38:31.294049 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:38:31.294571 [debug] [Thread-1 (]: Compilation Error in test stock_depletion_check (models/below_depletion_level/below_depletion_level_tests.yml)
  'test_custom_sql' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:38:31.295159 [error] [Thread-1 (]: 3 of 3 ERROR stock_depletion_check ............................................. [[31mERROR[0m in 0.01s]
[0m17:38:31.295569 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.stock_depletion_check.4d525c0edd
[0m17:38:31.297365 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:38:31.297710 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:31.297942 [debug] [MainThread]: On master: BEGIN
[0m17:38:31.298169 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:38:31.305059 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:38:31.305501 [debug] [MainThread]: On master: COMMIT
[0m17:38:31.305738 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:31.305956 [debug] [MainThread]: On master: COMMIT
[0m17:38:31.306255 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:38:31.306560 [debug] [MainThread]: On master: Close
[0m17:38:31.307182 [info ] [MainThread]: 
[0m17:38:31.307566 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m17:38:31.307910 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:31.308169 [debug] [MainThread]: Connection 'test.jaffle_shop.stock_depletion_check.4d525c0edd' was properly closed.
[0m17:38:31.308403 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1' was properly closed.
[0m17:38:31.315798 [info ] [MainThread]: 
[0m17:38:31.316500 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:38:31.318289 [info ] [MainThread]: 
[0m17:38:31.318669 [error] [MainThread]: [33mCompilation Error in test stock_depletion_check (models/below_depletion_level/below_depletion_level_tests.yml)[0m
[0m17:38:31.319006 [error] [MainThread]:   'test_custom_sql' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:38:31.319350 [info ] [MainThread]: 
[0m17:38:31.319673 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:38:31.320120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1eb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1d330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b6f6d0>]}


============================== 2024-07-14 17:38:49.385777 | 3dcb9487-6618-4f6b-a843-e1178af9362a ==============================
[0m17:38:49.386111 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:38:49.393627 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m17:38:49.394014 [debug] [MainThread]: Tracking: tracking
[0m17:38:49.411261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2bf70>]}
[0m17:38:49.464193 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:38:49.464918 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://macros/custom_tests.sql
[0m17:38:49.465241 [debug] [MainThread]: Parsing macros/custom_tests.sql
[0m17:38:49.480315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3dcb9487-6618-4f6b-a843-e1178af9362a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99d5b70>]}
[0m17:38:49.493736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3dcb9487-6618-4f6b-a843-e1178af9362a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7f7c0>]}
[0m17:38:49.494382 [info ] [MainThread]: Found 4 models, 3 tests, 2 snapshots, 0 analyses, 257 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:38:49.495048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3dcb9487-6618-4f6b-a843-e1178af9362a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b610f0>]}
[0m17:38:49.497371 [info ] [MainThread]: 
[0m17:38:49.498154 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:38:49.501577 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m17:38:49.512735 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:38:49.513226 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:38:49.513518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:49.561672 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m17:38:49.562175 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:38:49.562437 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:38:49.566423 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m17:38:49.568470 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:38:49.568941 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:38:49.574128 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:49.574507 [debug] [MainThread]: On master: BEGIN
[0m17:38:49.574764 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:38:49.587489 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:38:49.588149 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:49.588428 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:38:49.594043 [debug] [MainThread]: SQL status: SELECT 11 in 0.01 seconds
[0m17:38:49.595704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3dcb9487-6618-4f6b-a843-e1178af9362a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7caf0>]}
[0m17:38:49.596421 [debug] [MainThread]: On master: ROLLBACK
[0m17:38:49.596990 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:49.597427 [debug] [MainThread]: On master: BEGIN
[0m17:38:49.597809 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:38:49.598105 [debug] [MainThread]: On master: COMMIT
[0m17:38:49.598403 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:49.598633 [debug] [MainThread]: On master: COMMIT
[0m17:38:49.598945 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:38:49.599226 [debug] [MainThread]: On master: Close
[0m17:38:49.599670 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:38:49.600000 [info ] [MainThread]: 
[0m17:38:49.604786 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:38:49.604960 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:38:49.605292 [info ] [Thread-1 (]: 1 of 3 START test not_null_below_depletion_level_name .......................... [RUN]
[0m17:38:49.605623 [info ] [Thread-2 (]: 2 of 3 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m17:38:49.606086 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:38:49.606511 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:38:49.606821 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:38:49.607042 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:38:49.607433 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:38:49.607666 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:38:49.620177 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:38:49.623353 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:38:49.624956 [debug] [Thread-1 (]: finished collecting timing info
[0m17:38:49.625180 [debug] [Thread-2 (]: finished collecting timing info
[0m17:38:49.625305 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:38:49.625612 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:38:49.639530 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:38:49.641313 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:38:49.642646 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:38:49.642761 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:38:49.642958 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m17:38:49.643169 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m17:38:49.643384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:49.643596 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:38:49.651010 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m17:38:49.651358 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m17:38:49.651487 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:38:49.651745 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:38:49.652011 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m17:38:49.652242 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m17:38:49.660776 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m17:38:49.663486 [debug] [Thread-1 (]: finished collecting timing info
[0m17:38:49.663905 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m17:38:49.664392 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m17:38:49.664983 [info ] [Thread-1 (]: 1 of 3 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.06s]
[0m17:38:49.665795 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:38:49.666327 [debug] [Thread-1 (]: Began running node test.jaffle_shop.stock_depletion_check.4d525c0edd
[0m17:38:49.666753 [info ] [Thread-1 (]: 3 of 3 START test stock_depletion_check ........................................ [RUN]
[0m17:38:49.667408 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.stock_depletion_check.4d525c0edd"
[0m17:38:49.667778 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.stock_depletion_check.4d525c0edd
[0m17:38:49.668112 [debug] [Thread-1 (]: Compiling test.jaffle_shop.stock_depletion_check.4d525c0edd
[0m17:38:49.674204 [debug] [Thread-1 (]: finished collecting timing info
[0m17:38:49.675117 [debug] [Thread-1 (]: Compilation Error in test stock_depletion_check (models/below_depletion_level/below_depletion_level_tests.yml)
  'test_custom_sql' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:38:49.675604 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.02 seconds
[0m17:38:49.677808 [error] [Thread-1 (]: 3 of 3 ERROR stock_depletion_check ............................................. [[31mERROR[0m in 0.01s]
[0m17:38:49.679235 [debug] [Thread-2 (]: finished collecting timing info
[0m17:38:49.681986 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.stock_depletion_check.4d525c0edd
[0m17:38:49.682373 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m17:38:49.683089 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m17:38:49.686978 [info ] [Thread-2 (]: 2 of 3 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.08s]
[0m17:38:49.687570 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:38:49.692686 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:38:49.693070 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:49.693301 [debug] [MainThread]: On master: BEGIN
[0m17:38:49.693576 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:38:49.700746 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:38:49.701134 [debug] [MainThread]: On master: COMMIT
[0m17:38:49.701407 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:49.701649 [debug] [MainThread]: On master: COMMIT
[0m17:38:49.701968 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:38:49.702220 [debug] [MainThread]: On master: Close
[0m17:38:49.702865 [info ] [MainThread]: 
[0m17:38:49.703185 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m17:38:49.703565 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:49.703795 [debug] [MainThread]: Connection 'test.jaffle_shop.stock_depletion_check.4d525c0edd' was properly closed.
[0m17:38:49.703998 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1' was properly closed.
[0m17:38:49.710204 [info ] [MainThread]: 
[0m17:38:49.710541 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:38:49.710871 [info ] [MainThread]: 
[0m17:38:49.711189 [error] [MainThread]: [33mCompilation Error in test stock_depletion_check (models/below_depletion_level/below_depletion_level_tests.yml)[0m
[0m17:38:49.711510 [error] [MainThread]:   'test_custom_sql' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:38:49.711783 [info ] [MainThread]: 
[0m17:38:49.712059 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:38:49.712469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a79270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b61120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b92e90>]}


============================== 2024-07-14 17:43:55.635387 | 74e03a81-e850-4166-9647-b9c2a9bdced8 ==============================
[0m17:43:55.635716 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:43:55.663367 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m17:43:55.672623 [debug] [MainThread]: Tracking: tracking
[0m17:43:55.690168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b280>]}
[0m17:43:55.742043 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:43:55.742779 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/below_depletion_level/below_depletion_level.sql
[0m17:43:55.776872 [debug] [MainThread]: 1699: static parser successfully parsed below_depletion_level/below_depletion_level.sql
[0m17:43:55.818517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74e03a81-e850-4166-9647-b9c2a9bdced8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7fdc0>]}
[0m17:43:55.828583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74e03a81-e850-4166-9647-b9c2a9bdced8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b6fe20>]}
[0m17:43:55.829049 [info ] [MainThread]: Found 4 models, 3 tests, 2 snapshots, 0 analyses, 257 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:43:55.829430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74e03a81-e850-4166-9647-b9c2a9bdced8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b6dff0>]}
[0m17:43:55.831155 [info ] [MainThread]: 
[0m17:43:55.831771 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:43:55.833876 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m17:43:55.841830 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:43:55.842134 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:43:55.842360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:55.885035 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m17:43:55.885535 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:43:55.885781 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:43:55.897781 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.01 seconds
[0m17:43:55.899978 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:43:55.900771 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:43:55.905357 [debug] [MainThread]: Using postgres connection "master"
[0m17:43:55.905700 [debug] [MainThread]: On master: BEGIN
[0m17:43:55.905922 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:43:55.912830 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:43:55.913202 [debug] [MainThread]: Using postgres connection "master"
[0m17:43:55.913467 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:43:55.920707 [debug] [MainThread]: SQL status: SELECT 11 in 0.01 seconds
[0m17:43:55.922421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74e03a81-e850-4166-9647-b9c2a9bdced8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b340>]}
[0m17:43:55.922862 [debug] [MainThread]: On master: ROLLBACK
[0m17:43:55.923223 [debug] [MainThread]: Using postgres connection "master"
[0m17:43:55.923448 [debug] [MainThread]: On master: BEGIN
[0m17:43:55.923831 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:43:55.924137 [debug] [MainThread]: On master: COMMIT
[0m17:43:55.924342 [debug] [MainThread]: Using postgres connection "master"
[0m17:43:55.924564 [debug] [MainThread]: On master: COMMIT
[0m17:43:55.924850 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:43:55.925055 [debug] [MainThread]: On master: Close
[0m17:43:55.925522 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:43:55.925833 [info ] [MainThread]: 
[0m17:43:55.930708 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:43:55.930914 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:43:55.931264 [info ] [Thread-1 (]: 1 of 3 START test not_null_below_depletion_level_name .......................... [RUN]
[0m17:43:55.931631 [info ] [Thread-2 (]: 2 of 3 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m17:43:55.932262 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:43:55.933124 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:43:55.933643 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:43:55.933926 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:43:55.934213 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:43:55.934475 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:43:55.941819 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:43:55.944548 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:43:55.946550 [debug] [Thread-1 (]: finished collecting timing info
[0m17:43:55.946665 [debug] [Thread-2 (]: finished collecting timing info
[0m17:43:55.946895 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:43:55.947129 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:43:55.960551 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:43:55.962231 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:43:55.964053 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:43:55.964173 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:43:55.964382 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m17:43:55.964627 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m17:43:55.964923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:55.965162 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:43:55.972057 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m17:43:55.972440 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:43:55.972711 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m17:43:55.973589 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m17:43:55.973871 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:43:55.974075 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m17:43:55.982885 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m17:43:55.985918 [debug] [Thread-1 (]: finished collecting timing info
[0m17:43:55.986261 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m17:43:55.986611 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m17:43:55.987068 [info ] [Thread-1 (]: 1 of 3 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.06s]
[0m17:43:55.987691 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:43:55.988101 [debug] [Thread-1 (]: Began running node test.jaffle_shop.stock_depletion_check.4d525c0edd
[0m17:43:55.988415 [info ] [Thread-1 (]: 3 of 3 START test stock_depletion_check ........................................ [RUN]
[0m17:43:55.988894 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.stock_depletion_check.4d525c0edd"
[0m17:43:55.989145 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.stock_depletion_check.4d525c0edd
[0m17:43:55.989367 [debug] [Thread-1 (]: Compiling test.jaffle_shop.stock_depletion_check.4d525c0edd
[0m17:43:55.994414 [debug] [Thread-1 (]: finished collecting timing info
[0m17:43:55.994906 [debug] [Thread-1 (]: Compilation Error in test stock_depletion_check (models/below_depletion_level/below_depletion_level_tests.yml)
  'test_custom_sql' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:43:55.995217 [error] [Thread-1 (]: 3 of 3 ERROR stock_depletion_check ............................................. [[31mERROR[0m in 0.01s]
[0m17:43:55.995623 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.stock_depletion_check.4d525c0edd
[0m17:43:56.010139 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.04 seconds
[0m17:43:56.011524 [debug] [Thread-2 (]: finished collecting timing info
[0m17:43:56.011794 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m17:43:56.012124 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m17:43:56.012694 [info ] [Thread-2 (]: 2 of 3 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.08s]
[0m17:43:56.013208 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:43:56.015711 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:43:56.016305 [debug] [MainThread]: Using postgres connection "master"
[0m17:43:56.016479 [debug] [MainThread]: On master: BEGIN
[0m17:43:56.016616 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:43:56.024351 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:43:56.024757 [debug] [MainThread]: On master: COMMIT
[0m17:43:56.025005 [debug] [MainThread]: Using postgres connection "master"
[0m17:43:56.025255 [debug] [MainThread]: On master: COMMIT
[0m17:43:56.025638 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:43:56.025929 [debug] [MainThread]: On master: Close
[0m17:43:56.026837 [info ] [MainThread]: 
[0m17:43:56.027437 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m17:43:56.028153 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:43:56.028764 [debug] [MainThread]: Connection 'test.jaffle_shop.stock_depletion_check.4d525c0edd' was properly closed.
[0m17:43:56.029071 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1' was properly closed.
[0m17:43:56.035553 [info ] [MainThread]: 
[0m17:43:56.035868 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:43:56.036262 [info ] [MainThread]: 
[0m17:43:56.036637 [error] [MainThread]: [33mCompilation Error in test stock_depletion_check (models/below_depletion_level/below_depletion_level_tests.yml)[0m
[0m17:43:56.036924 [error] [MainThread]:   'test_custom_sql' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:43:56.037192 [info ] [MainThread]: 
[0m17:43:56.037444 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:43:56.037849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b6df60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b6ffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a83250>]}


============================== 2024-07-14 17:44:59.990298 | f081472a-b6d3-498e-8486-2a198594505a ==============================
[0m17:44:59.990636 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:45:00.007867 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m17:45:00.008360 [debug] [MainThread]: Tracking: tracking
[0m17:45:00.034740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2bf70>]}
[0m17:45:00.086002 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:45:00.086763 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/below_depletion_level/below_depletion_level.sql
[0m17:45:00.121929 [debug] [MainThread]: 1699: static parser successfully parsed below_depletion_level/below_depletion_level.sql
[0m17:45:00.163331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f081472a-b6d3-498e-8486-2a198594505a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7fdc0>]}
[0m17:45:00.174082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f081472a-b6d3-498e-8486-2a198594505a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b6fe20>]}
[0m17:45:00.174505 [info ] [MainThread]: Found 4 models, 3 tests, 2 snapshots, 0 analyses, 257 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:45:00.174847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f081472a-b6d3-498e-8486-2a198594505a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b6dff0>]}
[0m17:45:00.176437 [info ] [MainThread]: 
[0m17:45:00.177010 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:45:00.179209 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m17:45:00.187258 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:45:00.187579 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:45:00.187824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:00.235387 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m17:45:00.235940 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:45:00.236192 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:45:00.240365 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m17:45:00.242143 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:45:00.242555 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:45:00.247087 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:00.247402 [debug] [MainThread]: On master: BEGIN
[0m17:45:00.247637 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:45:00.256510 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:45:00.256982 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:00.257311 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:45:00.268009 [debug] [MainThread]: SQL status: SELECT 11 in 0.01 seconds
[0m17:45:00.269592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f081472a-b6d3-498e-8486-2a198594505a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b340>]}
[0m17:45:00.269985 [debug] [MainThread]: On master: ROLLBACK
[0m17:45:00.270321 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:00.270541 [debug] [MainThread]: On master: BEGIN
[0m17:45:00.270985 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:45:00.271294 [debug] [MainThread]: On master: COMMIT
[0m17:45:00.271520 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:00.271740 [debug] [MainThread]: On master: COMMIT
[0m17:45:00.272036 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:45:00.272263 [debug] [MainThread]: On master: Close
[0m17:45:00.272685 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:45:00.272992 [info ] [MainThread]: 
[0m17:45:00.277652 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:45:00.277800 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:45:00.278089 [info ] [Thread-1 (]: 1 of 3 START test not_null_below_depletion_level_name .......................... [RUN]
[0m17:45:00.278423 [info ] [Thread-2 (]: 2 of 3 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m17:45:00.278912 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:45:00.279379 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:45:00.279714 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:45:00.280019 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:45:00.280433 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:45:00.280803 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:45:00.290006 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:45:00.293007 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:45:00.294946 [debug] [Thread-1 (]: finished collecting timing info
[0m17:45:00.295065 [debug] [Thread-2 (]: finished collecting timing info
[0m17:45:00.295291 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:45:00.295548 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:45:00.308050 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:45:00.309490 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:45:00.311241 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:45:00.311359 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:45:00.311555 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m17:45:00.311792 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m17:45:00.311995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:00.312198 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:45:00.318884 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m17:45:00.319065 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m17:45:00.319337 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:45:00.319528 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:45:00.319762 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m17:45:00.319931 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m17:45:00.329410 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m17:45:00.332209 [debug] [Thread-1 (]: finished collecting timing info
[0m17:45:00.332730 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m17:45:00.333172 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m17:45:00.333616 [info ] [Thread-1 (]: 1 of 3 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.05s]
[0m17:45:00.334263 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:45:00.334709 [debug] [Thread-1 (]: Began running node test.jaffle_shop.stock_depletion_check.4d525c0edd
[0m17:45:00.335186 [info ] [Thread-1 (]: 3 of 3 START test stock_depletion_check ........................................ [RUN]
[0m17:45:00.335809 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.stock_depletion_check.4d525c0edd"
[0m17:45:00.336018 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.stock_depletion_check.4d525c0edd
[0m17:45:00.336191 [debug] [Thread-1 (]: Compiling test.jaffle_shop.stock_depletion_check.4d525c0edd
[0m17:45:00.341808 [debug] [Thread-1 (]: finished collecting timing info
[0m17:45:00.342526 [debug] [Thread-1 (]: Compilation Error in test stock_depletion_check (models/below_depletion_level/below_depletion_level_tests.yml)
  'test_custom_sql' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:45:00.342926 [error] [Thread-1 (]: 3 of 3 ERROR stock_depletion_check ............................................. [[31mERROR[0m in 0.01s]
[0m17:45:00.343428 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.stock_depletion_check.4d525c0edd
[0m17:45:00.347035 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.03 seconds
[0m17:45:00.348354 [debug] [Thread-2 (]: finished collecting timing info
[0m17:45:00.348654 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m17:45:00.348997 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m17:45:00.349418 [info ] [Thread-2 (]: 2 of 3 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.07s]
[0m17:45:00.349893 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:45:00.351820 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:45:00.352143 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:00.352380 [debug] [MainThread]: On master: BEGIN
[0m17:45:00.352624 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:45:00.368568 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m17:45:00.369045 [debug] [MainThread]: On master: COMMIT
[0m17:45:00.369272 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:00.369486 [debug] [MainThread]: On master: COMMIT
[0m17:45:00.369773 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:45:00.370003 [debug] [MainThread]: On master: Close
[0m17:45:00.370656 [info ] [MainThread]: 
[0m17:45:00.370954 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m17:45:00.371338 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:00.371555 [debug] [MainThread]: Connection 'test.jaffle_shop.stock_depletion_check.4d525c0edd' was properly closed.
[0m17:45:00.371770 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1' was properly closed.
[0m17:45:00.378145 [info ] [MainThread]: 
[0m17:45:00.378476 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:45:00.378851 [info ] [MainThread]: 
[0m17:45:00.379149 [error] [MainThread]: [33mCompilation Error in test stock_depletion_check (models/below_depletion_level/below_depletion_level_tests.yml)[0m
[0m17:45:00.379456 [error] [MainThread]:   'test_custom_sql' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:45:00.379755 [info ] [MainThread]: 
[0m17:45:00.380071 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:45:00.380431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b6df60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b6ffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a83250>]}


============================== 2024-07-14 17:46:14.025676 | ab1ad210-9ee5-452d-8743-6ec1e0b6d927 ==============================
[0m17:46:14.025995 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:46:14.043005 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:46:14.043533 [debug] [MainThread]: Tracking: tracking
[0m17:46:14.058878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1a230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1b430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1af80>]}
[0m17:46:14.110681 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:46:14.111253 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:46:14.117889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab1ad210-9ee5-452d-8743-6ec1e0b6d927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bb5510>]}
[0m17:46:14.129671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab1ad210-9ee5-452d-8743-6ec1e0b6d927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7f610>]}
[0m17:46:14.130545 [info ] [MainThread]: Found 4 models, 3 tests, 2 snapshots, 0 analyses, 257 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:46:14.130836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab1ad210-9ee5-452d-8743-6ec1e0b6d927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7f520>]}
[0m17:46:14.132821 [info ] [MainThread]: 
[0m17:46:14.133465 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:46:14.135843 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m17:46:14.143881 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:46:14.144165 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:46:14.144404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:14.189542 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.05 seconds
[0m17:46:14.191389 [debug] [ThreadPool]: On list_postgres: Close
[0m17:46:14.193558 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m17:46:14.198334 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:46:14.198620 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:46:14.198864 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:46:14.205888 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m17:46:14.206218 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:46:14.206463 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:46:14.209378 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m17:46:14.210669 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:46:14.211046 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:46:14.215172 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:14.215484 [debug] [MainThread]: On master: BEGIN
[0m17:46:14.215717 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:46:14.222194 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:46:14.222519 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:14.222750 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:46:14.227040 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m17:46:14.228584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab1ad210-9ee5-452d-8743-6ec1e0b6d927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99e4bb0>]}
[0m17:46:14.228957 [debug] [MainThread]: On master: ROLLBACK
[0m17:46:14.229288 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:14.229540 [debug] [MainThread]: On master: BEGIN
[0m17:46:14.229929 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:46:14.230259 [debug] [MainThread]: On master: COMMIT
[0m17:46:14.230506 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:14.230726 [debug] [MainThread]: On master: COMMIT
[0m17:46:14.231011 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:46:14.231228 [debug] [MainThread]: On master: Close
[0m17:46:14.231630 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:46:14.231940 [info ] [MainThread]: 
[0m17:46:14.235213 [debug] [Thread-1 (]: Began running node model.jaffle_shop.below_depletion_level
[0m17:46:14.235345 [debug] [Thread-2 (]: Began running node model.jaffle_shop.hot_upsell
[0m17:46:14.235661 [info ] [Thread-1 (]: 1 of 4 START view model public.below_depletion_level ........................... [RUN]
[0m17:46:14.236040 [info ] [Thread-2 (]: 2 of 4 START view model public.hot_upsell ...................................... [RUN]
[0m17:46:14.236545 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.below_depletion_level"
[0m17:46:14.237019 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.hot_upsell"
[0m17:46:14.237308 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.below_depletion_level
[0m17:46:14.237620 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.hot_upsell
[0m17:46:14.237878 [debug] [Thread-1 (]: Compiling model.jaffle_shop.below_depletion_level
[0m17:46:14.238119 [debug] [Thread-2 (]: Compiling model.jaffle_shop.hot_upsell
[0m17:46:14.241070 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.below_depletion_level"
[0m17:46:14.243453 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.hot_upsell"
[0m17:46:14.246441 [debug] [Thread-2 (]: finished collecting timing info
[0m17:46:14.246543 [debug] [Thread-1 (]: finished collecting timing info
[0m17:46:14.246775 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.hot_upsell
[0m17:46:14.247027 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.below_depletion_level
[0m17:46:14.290146 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.hot_upsell"
[0m17:46:14.291175 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.below_depletion_level"
[0m17:46:14.293583 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m17:46:14.293870 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:46:14.293974 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: BEGIN
[0m17:46:14.294201 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: BEGIN
[0m17:46:14.294458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:14.294711 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:46:14.301603 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m17:46:14.301785 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m17:46:14.302082 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m17:46:14.302364 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:46:14.302618 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */

  create view "postgres"."public"."below_depletion_level__dbt_tmp" as (
    select distinct name, ruv.variant, ruv.actual_size, ruv.weave_cat, ruv.size_grp, ruv.shape, ruv.weight, coalesce(ruv.stock_level, 0), coalesce(rup.depletion_level, 0)
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where coalesce(stock_level, 0) < coalesce(depletion_level, 0)
  );
[0m17:46:14.302850 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */

  create view "postgres"."public"."hot_upsell__dbt_tmp" as (
    select distinct rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, (ruv.msrp - rupu.price) as profit_margin
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_pads_upsell" rupu on rupu.p_id = ruv.pid and rupu.variant = ruv.variant 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where new_arrival = 'Y' and stock_level < coalesce(depletion_level, 0) and rupu.stock is not null
order by profit_margin desc
  );
[0m17:46:14.304754 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column rup.depletion_level does not exist
LINE 4: ...uv.weight, coalesce(ruv.stock_level, 0), coalesce(rup.deplet...
                                                             ^
HINT:  Perhaps you meant to reference the column "ruv.depletion_level".

[0m17:46:14.306795 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: ROLLBACK
[0m17:46:14.307598 [debug] [Thread-1 (]: finished collecting timing info
[0m17:46:14.308012 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: Close
[0m17:46:14.308843 [debug] [Thread-1 (]: Database Error in model below_depletion_level (models/below_depletion_level/below_depletion_level.sql)
  column rup.depletion_level does not exist
  LINE 4: ...uv.weight, coalesce(ruv.stock_level, 0), coalesce(rup.deplet...
                                                               ^
  HINT:  Perhaps you meant to reference the column "ruv.depletion_level".
  compiled SQL at target/run/jaffle_shop/models/below_depletion_level/below_depletion_level.sql
[0m17:46:14.310401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab1ad210-9ee5-452d-8743-6ec1e0b6d927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7e020>]}
[0m17:46:14.310985 [error] [Thread-1 (]: 1 of 4 ERROR creating view model public.below_depletion_level .................. [[31mERROR[0m in 0.07s]
[0m17:46:14.311514 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.below_depletion_level
[0m17:46:14.311804 [debug] [Thread-1 (]: Began running node model.jaffle_shop.underselling_product_specs
[0m17:46:14.312194 [info ] [Thread-1 (]: 3 of 4 START view model public.underselling_product_specs ...................... [RUN]
[0m17:46:14.312884 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:46:14.313647 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.underselling_product_specs
[0m17:46:14.314085 [debug] [Thread-1 (]: Compiling model.jaffle_shop.underselling_product_specs
[0m17:46:14.316689 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.underselling_product_specs"
[0m17:46:14.316803 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m17:46:14.322258 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:46:14.322541 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
alter table "postgres"."public"."hot_upsell" rename to "hot_upsell__dbt_backup"
[0m17:46:14.322746 [debug] [Thread-1 (]: finished collecting timing info
[0m17:46:14.324638 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:46:14.324747 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.underselling_product_specs
[0m17:46:14.326616 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:46:14.329526 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.underselling_product_specs"
[0m17:46:14.329814 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
alter table "postgres"."public"."hot_upsell__dbt_tmp" rename to "hot_upsell"
[0m17:46:14.331295 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:46:14.331411 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:46:14.331607 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: BEGIN
[0m17:46:14.347723 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: COMMIT
[0m17:46:14.348084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:14.348401 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:46:14.348989 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: COMMIT
[0m17:46:14.353286 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:46:14.357519 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:46:14.357808 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
drop view if exists "postgres"."public"."hot_upsell__dbt_backup" cascade
[0m17:46:14.358743 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m17:46:14.359175 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:46:14.359496 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */

  create view "postgres"."public"."underselling_product_specs__dbt_tmp" as (
    select distinct rup.name, rucm.color_value, ruv.actual_size, ruv.weave_cat, ruv.size_grp, ruv.shape, (ruv.stock_level - ruv.depletion_level) as stock_depletion_ratio
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_color_map" rucm on rucm.color_id = ruv.pid 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
where stock_level > coalesce(depletion_level, 0) and depletion_level <> 0 
and stock_level is not null and stock_level <> 0 and new_arrival = 'N' and status = 'In_stock'
order by stock_depletion_ratio desc limit 10
  );
[0m17:46:14.362197 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:46:14.363646 [debug] [Thread-2 (]: finished collecting timing info
[0m17:46:14.363756 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:46:14.364006 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: Close
[0m17:46:14.365961 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:46:14.366470 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab1ad210-9ee5-452d-8743-6ec1e0b6d927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99f8250>]}
[0m17:46:14.366689 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
alter table "postgres"."public"."underselling_product_specs" rename to "underselling_product_specs__dbt_backup"
[0m17:46:14.367110 [info ] [Thread-2 (]: 2 of 4 OK created view model public.hot_upsell ................................. [[32mCREATE VIEW[0m in 0.13s]
[0m17:46:14.367768 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.hot_upsell
[0m17:46:14.368106 [debug] [Thread-2 (]: Began running node model.jaffle_shop.priority_order
[0m17:46:14.368204 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:46:14.368513 [info ] [Thread-2 (]: 4 of 4 SKIP relation public.priority_order ..................................... [[33mSKIP[0m]
[0m17:46:14.370370 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:46:14.370796 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.priority_order
[0m17:46:14.370983 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
alter table "postgres"."public"."underselling_product_specs__dbt_tmp" rename to "underselling_product_specs"
[0m17:46:14.371752 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:46:14.372913 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: COMMIT
[0m17:46:14.373133 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:46:14.373328 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: COMMIT
[0m17:46:14.374469 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:46:14.375843 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:46:14.376059 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
drop view if exists "postgres"."public"."underselling_product_specs__dbt_backup" cascade
[0m17:46:14.377577 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:46:14.378446 [debug] [Thread-1 (]: finished collecting timing info
[0m17:46:14.378682 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: Close
[0m17:46:14.379127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab1ad210-9ee5-452d-8743-6ec1e0b6d927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99e1c00>]}
[0m17:46:14.379558 [info ] [Thread-1 (]: 3 of 4 OK created view model public.underselling_product_specs ................. [[32mCREATE VIEW[0m in 0.07s]
[0m17:46:14.379941 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.underselling_product_specs
[0m17:46:14.381624 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:46:14.381897 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:14.382107 [debug] [MainThread]: On master: BEGIN
[0m17:46:14.382311 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:46:14.388741 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:46:14.389050 [debug] [MainThread]: On master: COMMIT
[0m17:46:14.389276 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:14.389512 [debug] [MainThread]: On master: COMMIT
[0m17:46:14.389778 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:46:14.389998 [debug] [MainThread]: On master: Close
[0m17:46:14.390615 [info ] [MainThread]: 
[0m17:46:14.390922 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m17:46:14.391205 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:46:14.391428 [debug] [MainThread]: Connection 'model.jaffle_shop.underselling_product_specs' was properly closed.
[0m17:46:14.391651 [debug] [MainThread]: Connection 'model.jaffle_shop.hot_upsell' was properly closed.
[0m17:46:14.397887 [info ] [MainThread]: 
[0m17:46:14.398238 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:46:14.398620 [info ] [MainThread]: 
[0m17:46:14.398934 [error] [MainThread]: [33mDatabase Error in model below_depletion_level (models/below_depletion_level/below_depletion_level.sql)[0m
[0m17:46:14.399244 [error] [MainThread]:   column rup.depletion_level does not exist
[0m17:46:14.399543 [error] [MainThread]:   LINE 4: ...uv.weight, coalesce(ruv.stock_level, 0), coalesce(rup.deplet...
[0m17:46:14.399838 [error] [MainThread]:                                                                ^
[0m17:46:14.400106 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "ruv.depletion_level".
[0m17:46:14.400379 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/below_depletion_level/below_depletion_level.sql
[0m17:46:14.400690 [info ] [MainThread]: 
[0m17:46:14.400962 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m17:46:14.401308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a63c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99e2b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99f8cd0>]}


============================== 2024-07-14 17:46:42.500209 | 2b6edf2a-af85-4b56-aa8a-c5eac669b552 ==============================
[0m17:46:42.500534 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:46:42.505372 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:46:42.505709 [debug] [MainThread]: Tracking: tracking
[0m17:46:42.519695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2a2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c28190>]}
[0m17:46:42.567520 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:46:42.568242 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/below_depletion_level/below_depletion_level.sql
[0m17:46:42.607781 [debug] [MainThread]: 1699: static parser successfully parsed below_depletion_level/below_depletion_level.sql
[0m17:46:42.649080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b6edf2a-af85-4b56-aa8a-c5eac669b552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7fd90>]}
[0m17:46:42.658839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b6edf2a-af85-4b56-aa8a-c5eac669b552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b6ff40>]}
[0m17:46:42.659342 [info ] [MainThread]: Found 4 models, 3 tests, 2 snapshots, 0 analyses, 257 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:46:42.659680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b6edf2a-af85-4b56-aa8a-c5eac669b552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b6dfc0>]}
[0m17:46:42.661877 [info ] [MainThread]: 
[0m17:46:42.662678 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:46:42.664398 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m17:46:42.672419 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:46:42.672774 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:46:42.673031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:42.726792 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.05 seconds
[0m17:46:42.728820 [debug] [ThreadPool]: On list_postgres: Close
[0m17:46:42.731137 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m17:46:42.736120 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:46:42.736488 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:46:42.736752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:46:42.744383 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m17:46:42.745117 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:46:42.745399 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:46:42.749426 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m17:46:42.750927 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:46:42.751375 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:46:42.755761 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:42.756024 [debug] [MainThread]: On master: BEGIN
[0m17:46:42.756283 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:46:42.762533 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:46:42.762914 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:42.763219 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:46:42.774632 [debug] [MainThread]: SQL status: SELECT 11 in 0.01 seconds
[0m17:46:42.778268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b6edf2a-af85-4b56-aa8a-c5eac669b552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2a3b0>]}
[0m17:46:42.778911 [debug] [MainThread]: On master: ROLLBACK
[0m17:46:42.779392 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:42.779670 [debug] [MainThread]: On master: BEGIN
[0m17:46:42.780101 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:46:42.780445 [debug] [MainThread]: On master: COMMIT
[0m17:46:42.780656 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:42.781517 [debug] [MainThread]: On master: COMMIT
[0m17:46:42.782656 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:46:42.783899 [debug] [MainThread]: On master: Close
[0m17:46:42.784641 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:46:42.785015 [info ] [MainThread]: 
[0m17:46:42.790858 [debug] [Thread-1 (]: Began running node model.jaffle_shop.below_depletion_level
[0m17:46:42.791114 [debug] [Thread-2 (]: Began running node model.jaffle_shop.hot_upsell
[0m17:46:42.791654 [info ] [Thread-1 (]: 1 of 4 START view model public.below_depletion_level ........................... [RUN]
[0m17:46:42.792198 [info ] [Thread-2 (]: 2 of 4 START view model public.hot_upsell ...................................... [RUN]
[0m17:46:42.793124 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.below_depletion_level"
[0m17:46:42.794229 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.hot_upsell"
[0m17:46:42.794909 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.below_depletion_level
[0m17:46:42.795308 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.hot_upsell
[0m17:46:42.795640 [debug] [Thread-1 (]: Compiling model.jaffle_shop.below_depletion_level
[0m17:46:42.795904 [debug] [Thread-2 (]: Compiling model.jaffle_shop.hot_upsell
[0m17:46:42.798859 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.below_depletion_level"
[0m17:46:42.802818 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.hot_upsell"
[0m17:46:42.804923 [debug] [Thread-1 (]: finished collecting timing info
[0m17:46:42.805075 [debug] [Thread-2 (]: finished collecting timing info
[0m17:46:42.805338 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.below_depletion_level
[0m17:46:42.805583 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.hot_upsell
[0m17:46:42.838824 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.below_depletion_level"
[0m17:46:42.838967 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.hot_upsell"
[0m17:46:42.840436 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:46:42.840552 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m17:46:42.840760 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: BEGIN
[0m17:46:42.840987 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: BEGIN
[0m17:46:42.841207 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:46:42.841407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:42.848748 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m17:46:42.849431 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m17:46:42.849593 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:46:42.849887 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m17:46:42.850286 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */

  create view "postgres"."public"."hot_upsell__dbt_tmp" as (
    select distinct rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, (ruv.msrp - rupu.price) as profit_margin
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_pads_upsell" rupu on rupu.p_id = ruv.pid and rupu.variant = ruv.variant 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where new_arrival = 'Y' and stock_level < coalesce(depletion_level, 0) and rupu.stock is not null
order by profit_margin desc
  );
[0m17:46:42.850535 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */

  create view "postgres"."public"."below_depletion_level__dbt_tmp" as (
    select distinct name, ruv.variant, ruv.actual_size, ruv.weave_cat, ruv.size_grp, ruv.shape, ruv.weight, coalesce(ruv.stock_level, 0), coalesce(ruv.depletion_level, 0)
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where coalesce(stock_level, 0) < coalesce(depletion_level, 0)
  );
[0m17:46:42.855913 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "coalesce" specified more than once

[0m17:46:42.856738 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: ROLLBACK
[0m17:46:42.857752 [debug] [Thread-1 (]: finished collecting timing info
[0m17:46:42.858109 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: Close
[0m17:46:42.858927 [debug] [Thread-1 (]: Database Error in model below_depletion_level (models/below_depletion_level/below_depletion_level.sql)
  column "coalesce" specified more than once
  compiled SQL at target/run/jaffle_shop/models/below_depletion_level/below_depletion_level.sql
[0m17:46:42.859670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b6edf2a-af85-4b56-aa8a-c5eac669b552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7f220>]}
[0m17:46:42.860425 [error] [Thread-1 (]: 1 of 4 ERROR creating view model public.below_depletion_level .................. [[31mERROR[0m in 0.07s]
[0m17:46:42.860747 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m17:46:42.861238 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.below_depletion_level
[0m17:46:42.867652 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:46:42.867965 [debug] [Thread-1 (]: Began running node model.jaffle_shop.underselling_product_specs
[0m17:46:42.868458 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
alter table "postgres"."public"."hot_upsell" rename to "hot_upsell__dbt_backup"
[0m17:46:42.868788 [info ] [Thread-1 (]: 3 of 4 START view model public.underselling_product_specs ...................... [RUN]
[0m17:46:42.869520 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:46:42.869696 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:46:42.869834 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.underselling_product_specs
[0m17:46:42.871754 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:46:42.872063 [debug] [Thread-1 (]: Compiling model.jaffle_shop.underselling_product_specs
[0m17:46:42.872325 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
alter table "postgres"."public"."hot_upsell__dbt_tmp" rename to "hot_upsell"
[0m17:46:42.874877 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.underselling_product_specs"
[0m17:46:42.875617 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:46:42.888146 [debug] [Thread-1 (]: finished collecting timing info
[0m17:46:42.892170 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: COMMIT
[0m17:46:42.892476 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.underselling_product_specs
[0m17:46:42.892708 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:46:42.895682 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.underselling_product_specs"
[0m17:46:42.895941 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: COMMIT
[0m17:46:42.896728 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:46:42.896903 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: BEGIN
[0m17:46:42.897098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:42.897510 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:46:42.902470 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:46:42.903082 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
drop view if exists "postgres"."public"."hot_upsell__dbt_backup" cascade
[0m17:46:42.903981 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m17:46:42.904319 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:46:42.904550 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */

  create view "postgres"."public"."underselling_product_specs__dbt_tmp" as (
    select distinct rup.name, rucm.color_value, ruv.actual_size, ruv.weave_cat, ruv.size_grp, ruv.shape, (ruv.stock_level - ruv.depletion_level) as stock_depletion_ratio
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_color_map" rucm on rucm.color_id = ruv.pid 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
where stock_level > coalesce(depletion_level, 0) and depletion_level <> 0 
and stock_level is not null and stock_level <> 0 and new_arrival = 'N' and status = 'In_stock'
order by stock_depletion_ratio desc limit 10
  );
[0m17:46:42.904795 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:46:42.906046 [debug] [Thread-2 (]: finished collecting timing info
[0m17:46:42.906314 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: Close
[0m17:46:42.906832 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b6edf2a-af85-4b56-aa8a-c5eac669b552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a044f0>]}
[0m17:46:42.907271 [info ] [Thread-2 (]: 2 of 4 OK created view model public.hot_upsell ................................. [[32mCREATE VIEW[0m in 0.11s]
[0m17:46:42.907762 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.hot_upsell
[0m17:46:42.908060 [debug] [Thread-2 (]: Began running node model.jaffle_shop.priority_order
[0m17:46:42.908338 [info ] [Thread-2 (]: 4 of 4 SKIP relation public.priority_order ..................................... [[33mSKIP[0m]
[0m17:46:42.908722 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.priority_order
[0m17:46:42.911347 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m17:46:42.914391 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:46:42.914628 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
alter table "postgres"."public"."underselling_product_specs" rename to "underselling_product_specs__dbt_backup"
[0m17:46:42.915239 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:46:42.916962 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:46:42.917194 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
alter table "postgres"."public"."underselling_product_specs__dbt_tmp" rename to "underselling_product_specs"
[0m17:46:42.917704 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:46:42.918806 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: COMMIT
[0m17:46:42.919036 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:46:42.919239 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: COMMIT
[0m17:46:42.919963 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:46:42.921235 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:46:42.921455 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
drop view if exists "postgres"."public"."underselling_product_specs__dbt_backup" cascade
[0m17:46:42.922674 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:46:42.923516 [debug] [Thread-1 (]: finished collecting timing info
[0m17:46:42.923748 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: Close
[0m17:46:42.924174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b6edf2a-af85-4b56-aa8a-c5eac669b552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff80dd180>]}
[0m17:46:42.924557 [info ] [Thread-1 (]: 3 of 4 OK created view model public.underselling_product_specs ................. [[32mCREATE VIEW[0m in 0.05s]
[0m17:46:42.924967 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.underselling_product_specs
[0m17:46:42.927439 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:46:42.927782 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:42.928020 [debug] [MainThread]: On master: BEGIN
[0m17:46:42.928226 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:46:42.934369 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:46:42.934697 [debug] [MainThread]: On master: COMMIT
[0m17:46:42.934915 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:42.935160 [debug] [MainThread]: On master: COMMIT
[0m17:46:42.935474 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:46:42.935699 [debug] [MainThread]: On master: Close
[0m17:46:42.936409 [info ] [MainThread]: 
[0m17:46:42.936725 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m17:46:42.937102 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:46:42.937382 [debug] [MainThread]: Connection 'model.jaffle_shop.underselling_product_specs' was properly closed.
[0m17:46:42.937585 [debug] [MainThread]: Connection 'model.jaffle_shop.hot_upsell' was properly closed.
[0m17:46:42.943410 [info ] [MainThread]: 
[0m17:46:42.943710 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:46:42.944048 [info ] [MainThread]: 
[0m17:46:42.944354 [error] [MainThread]: [33mDatabase Error in model below_depletion_level (models/below_depletion_level/below_depletion_level.sql)[0m
[0m17:46:42.944635 [error] [MainThread]:   column "coalesce" specified more than once
[0m17:46:42.944879 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/below_depletion_level/below_depletion_level.sql
[0m17:46:42.945164 [info ] [MainThread]: 
[0m17:46:42.945636 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m17:46:42.946209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff80eabc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff80dc3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a06e90>]}


============================== 2024-07-14 17:47:21.971314 | d44b6aac-4f7d-4d62-aa97-7a5c9d7676d1 ==============================
[0m17:47:21.971634 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:47:21.982214 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:47:21.982581 [debug] [MainThread]: Tracking: tracking
[0m17:47:22.003311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2bf70>]}
[0m17:47:22.066824 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:47:22.067761 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/below_depletion_level/below_depletion_level.sql
[0m17:47:22.103749 [debug] [MainThread]: 1699: static parser successfully parsed below_depletion_level/below_depletion_level.sql
[0m17:47:22.145608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd44b6aac-4f7d-4d62-aa97-7a5c9d7676d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7fdc0>]}
[0m17:47:22.155352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd44b6aac-4f7d-4d62-aa97-7a5c9d7676d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b6fe20>]}
[0m17:47:22.155801 [info ] [MainThread]: Found 4 models, 3 tests, 2 snapshots, 0 analyses, 257 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:47:22.156166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd44b6aac-4f7d-4d62-aa97-7a5c9d7676d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b6dff0>]}
[0m17:47:22.157917 [info ] [MainThread]: 
[0m17:47:22.158510 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:47:22.160433 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m17:47:22.169108 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:47:22.169515 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:47:22.169762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:22.216972 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.05 seconds
[0m17:47:22.218818 [debug] [ThreadPool]: On list_postgres: Close
[0m17:47:22.221167 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m17:47:22.225952 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:47:22.226244 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:47:22.226501 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:47:22.234164 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m17:47:22.234530 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:47:22.234775 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:47:22.237877 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m17:47:22.239117 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:47:22.239486 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:47:22.243610 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:22.243921 [debug] [MainThread]: On master: BEGIN
[0m17:47:22.244159 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:47:22.250389 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:47:22.250753 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:22.250979 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:47:22.258673 [debug] [MainThread]: SQL status: SELECT 11 in 0.01 seconds
[0m17:47:22.260083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd44b6aac-4f7d-4d62-aa97-7a5c9d7676d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c58670>]}
[0m17:47:22.260458 [debug] [MainThread]: On master: ROLLBACK
[0m17:47:22.260795 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:22.261024 [debug] [MainThread]: On master: BEGIN
[0m17:47:22.261402 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:47:22.261667 [debug] [MainThread]: On master: COMMIT
[0m17:47:22.261898 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:22.262135 [debug] [MainThread]: On master: COMMIT
[0m17:47:22.262471 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:47:22.262811 [debug] [MainThread]: On master: Close
[0m17:47:22.263458 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:47:22.266352 [info ] [MainThread]: 
[0m17:47:22.272550 [debug] [Thread-1 (]: Began running node model.jaffle_shop.below_depletion_level
[0m17:47:22.272699 [debug] [Thread-2 (]: Began running node model.jaffle_shop.hot_upsell
[0m17:47:22.273734 [info ] [Thread-1 (]: 1 of 4 START view model public.below_depletion_level ........................... [RUN]
[0m17:47:22.274114 [info ] [Thread-2 (]: 2 of 4 START view model public.hot_upsell ...................................... [RUN]
[0m17:47:22.274717 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.below_depletion_level"
[0m17:47:22.275166 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.hot_upsell"
[0m17:47:22.275565 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.below_depletion_level
[0m17:47:22.275828 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.hot_upsell
[0m17:47:22.276099 [debug] [Thread-1 (]: Compiling model.jaffle_shop.below_depletion_level
[0m17:47:22.276352 [debug] [Thread-2 (]: Compiling model.jaffle_shop.hot_upsell
[0m17:47:22.279181 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.below_depletion_level"
[0m17:47:22.283450 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.hot_upsell"
[0m17:47:22.287244 [debug] [Thread-1 (]: finished collecting timing info
[0m17:47:22.287442 [debug] [Thread-2 (]: finished collecting timing info
[0m17:47:22.287692 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.below_depletion_level
[0m17:47:22.287936 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.hot_upsell
[0m17:47:22.327290 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.hot_upsell"
[0m17:47:22.328543 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.below_depletion_level"
[0m17:47:22.331060 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m17:47:22.331191 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:47:22.331479 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: BEGIN
[0m17:47:22.331708 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: BEGIN
[0m17:47:22.331928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:22.332146 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:47:22.349005 [debug] [Thread-2 (]: SQL status: BEGIN in 0.02 seconds
[0m17:47:22.349506 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m17:47:22.349940 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:47:22.350265 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m17:47:22.350580 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */

  create view "postgres"."public"."hot_upsell__dbt_tmp" as (
    select distinct rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, (ruv.msrp - rupu.price) as profit_margin
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_pads_upsell" rupu on rupu.p_id = ruv.pid and rupu.variant = ruv.variant 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where new_arrival = 'Y' and stock_level < coalesce(depletion_level, 0) and rupu.stock is not null
order by profit_margin desc
  );
[0m17:47:22.350851 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */

  create view "postgres"."public"."below_depletion_level__dbt_tmp" as (
    select distinct name, ruv.variant, ruv.actual_size, ruv.weave_cat, ruv.size_grp, ruv.shape, ruv.weight, ruv.stock_level, 0, ruv.depletion_level
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where coalesce(stock_level, 0) < coalesce(depletion_level, 0)
  );
[0m17:47:22.354738 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:47:22.355036 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:47:22.361094 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m17:47:22.363109 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:47:22.363410 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level" rename to "below_depletion_level__dbt_backup"
[0m17:47:22.363665 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
alter table "postgres"."public"."hot_upsell" rename to "hot_upsell__dbt_backup"
[0m17:47:22.364457 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:47:22.364537 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:47:22.366249 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m17:47:22.368126 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:47:22.368384 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level__dbt_tmp" rename to "below_depletion_level"
[0m17:47:22.368637 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
alter table "postgres"."public"."hot_upsell__dbt_tmp" rename to "hot_upsell"
[0m17:47:22.369224 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:47:22.369460 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:47:22.386628 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m17:47:22.387813 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: COMMIT
[0m17:47:22.388071 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m17:47:22.388292 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:47:22.388507 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m17:47:22.388701 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: COMMIT
[0m17:47:22.389860 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:47:22.389984 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:47:22.394231 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m17:47:22.396375 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:47:22.396633 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
drop view if exists "postgres"."public"."below_depletion_level__dbt_backup" cascade
[0m17:47:22.396847 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
drop view if exists "postgres"."public"."hot_upsell__dbt_backup" cascade
[0m17:47:22.398637 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:47:22.399717 [debug] [Thread-2 (]: finished collecting timing info
[0m17:47:22.399825 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:47:22.400042 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: Close
[0m17:47:22.400889 [debug] [Thread-1 (]: finished collecting timing info
[0m17:47:22.401438 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd44b6aac-4f7d-4d62-aa97-7a5c9d7676d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff80f77c0>]}
[0m17:47:22.401677 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: Close
[0m17:47:22.402236 [info ] [Thread-2 (]: 2 of 4 OK created view model public.hot_upsell ................................. [[32mCREATE VIEW[0m in 0.13s]
[0m17:47:22.402850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd44b6aac-4f7d-4d62-aa97-7a5c9d7676d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff80d7af0>]}
[0m17:47:22.403331 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.hot_upsell
[0m17:47:22.403699 [info ] [Thread-1 (]: 1 of 4 OK created view model public.below_depletion_level ...................... [[32mCREATE VIEW[0m in 0.13s]
[0m17:47:22.403983 [debug] [Thread-2 (]: Began running node model.jaffle_shop.underselling_product_specs
[0m17:47:22.404398 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.below_depletion_level
[0m17:47:22.404694 [info ] [Thread-2 (]: 3 of 4 START view model public.underselling_product_specs ...................... [RUN]
[0m17:47:22.405140 [debug] [Thread-1 (]: Began running node model.jaffle_shop.priority_order
[0m17:47:22.405437 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:47:22.405684 [info ] [Thread-1 (]: 4 of 4 START view model public.priority_order .................................. [RUN]
[0m17:47:22.405913 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.underselling_product_specs
[0m17:47:22.406364 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.priority_order"
[0m17:47:22.406569 [debug] [Thread-2 (]: Compiling model.jaffle_shop.underselling_product_specs
[0m17:47:22.406782 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.priority_order
[0m17:47:22.409464 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.underselling_product_specs"
[0m17:47:22.409784 [debug] [Thread-1 (]: Compiling model.jaffle_shop.priority_order
[0m17:47:22.413176 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.priority_order"
[0m17:47:22.414162 [debug] [Thread-2 (]: finished collecting timing info
[0m17:47:22.414413 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.underselling_product_specs
[0m17:47:22.414633 [debug] [Thread-1 (]: finished collecting timing info
[0m17:47:22.417488 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.underselling_product_specs"
[0m17:47:22.417780 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.priority_order
[0m17:47:22.420905 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.priority_order"
[0m17:47:22.421340 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:47:22.421635 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: BEGIN
[0m17:47:22.421910 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m17:47:22.421992 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:47:22.422242 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: BEGIN
[0m17:47:22.422913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:22.429421 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m17:47:22.429665 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m17:47:22.429925 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:47:22.430165 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m17:47:22.430411 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */

  create view "postgres"."public"."underselling_product_specs__dbt_tmp" as (
    select distinct rup.name, rucm.color_value, ruv.actual_size, ruv.weave_cat, ruv.size_grp, ruv.shape, (ruv.stock_level - ruv.depletion_level) as stock_depletion_ratio
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_color_map" rucm on rucm.color_id = ruv.pid 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
where stock_level > coalesce(depletion_level, 0) and depletion_level <> 0 
and stock_level is not null and stock_level <> 0 and new_arrival = 'N' and status = 'In_stock'
order by stock_depletion_ratio desc limit 10
  );
[0m17:47:22.430642 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */

  create view "postgres"."public"."priority_order__dbt_tmp" as (
    select distinct rup.name as product_name, ruv.variant as variant, ruv.actual_size, ruv.weave_cat, (msrp - price) as profit 
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
join "postgres"."public"."below_depletion_level" bdl on bdl.name = rup.name and bdl.variant = ruv.variant
order by profit desc
  );
[0m17:47:22.433738 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:47:22.434052 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:47:22.436336 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:47:22.439398 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m17:47:22.439692 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
alter table "postgres"."public"."underselling_product_specs" rename to "underselling_product_specs__dbt_backup"
[0m17:47:22.439914 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
alter table "postgres"."public"."priority_order__dbt_tmp" rename to "priority_order"
[0m17:47:22.440703 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:47:22.440805 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:47:22.442870 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:47:22.444043 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: COMMIT
[0m17:47:22.444304 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
alter table "postgres"."public"."underselling_product_specs__dbt_tmp" rename to "underselling_product_specs"
[0m17:47:22.444600 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m17:47:22.446879 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: COMMIT
[0m17:47:22.447095 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:47:22.448555 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: COMMIT
[0m17:47:22.448644 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:47:22.448846 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:47:22.450359 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m17:47:22.450727 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: COMMIT
[0m17:47:22.450954 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
drop view if exists "postgres"."public"."priority_order__dbt_backup" cascade
[0m17:47:22.451514 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:47:22.451602 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:47:22.453060 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:47:22.454016 [debug] [Thread-1 (]: finished collecting timing info
[0m17:47:22.454249 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
drop view if exists "postgres"."public"."underselling_product_specs__dbt_backup" cascade
[0m17:47:22.454489 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: Close
[0m17:47:22.455137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd44b6aac-4f7d-4d62-aa97-7a5c9d7676d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a04280>]}
[0m17:47:22.455593 [info ] [Thread-1 (]: 4 of 4 OK created view model public.priority_order ............................. [[32mCREATE VIEW[0m in 0.05s]
[0m17:47:22.455958 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:47:22.456139 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.priority_order
[0m17:47:22.457057 [debug] [Thread-2 (]: finished collecting timing info
[0m17:47:22.457605 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: Close
[0m17:47:22.458111 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd44b6aac-4f7d-4d62-aa97-7a5c9d7676d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff80c5780>]}
[0m17:47:22.458520 [info ] [Thread-2 (]: 3 of 4 OK created view model public.underselling_product_specs ................. [[32mCREATE VIEW[0m in 0.05s]
[0m17:47:22.459019 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.underselling_product_specs
[0m17:47:22.461391 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:47:22.461681 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:22.461900 [debug] [MainThread]: On master: BEGIN
[0m17:47:22.462098 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:47:22.468405 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:47:22.468817 [debug] [MainThread]: On master: COMMIT
[0m17:47:22.469043 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:22.469250 [debug] [MainThread]: On master: COMMIT
[0m17:47:22.469594 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:47:22.469826 [debug] [MainThread]: On master: Close
[0m17:47:22.470630 [info ] [MainThread]: 
[0m17:47:22.470996 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m17:47:22.471370 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:47:22.471628 [debug] [MainThread]: Connection 'model.jaffle_shop.priority_order' was properly closed.
[0m17:47:22.471850 [debug] [MainThread]: Connection 'model.jaffle_shop.underselling_product_specs' was properly closed.
[0m17:47:22.480071 [info ] [MainThread]: 
[0m17:47:22.480432 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:47:22.480796 [info ] [MainThread]: 
[0m17:47:22.481062 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:47:22.481458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b6df60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b6ffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff81374f0>]}


============================== 2024-07-14 17:47:43.464883 | 2f9be2d3-15de-4eb7-953b-76a6855cc2d8 ==============================
[0m17:47:43.465199 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:47:43.468650 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:47:43.468973 [debug] [MainThread]: Tracking: tracking
[0m17:47:43.483917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2afb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b250>]}
[0m17:47:43.528675 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:47:43.529329 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/below_depletion_level/below_depletion_level.sql
[0m17:47:43.563619 [debug] [MainThread]: 1699: static parser successfully parsed below_depletion_level/below_depletion_level.sql
[0m17:47:43.604020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f9be2d3-15de-4eb7-953b-76a6855cc2d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7fdf0>]}
[0m17:47:43.612721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f9be2d3-15de-4eb7-953b-76a6855cc2d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b6ff40>]}
[0m17:47:43.613127 [info ] [MainThread]: Found 4 models, 3 tests, 2 snapshots, 0 analyses, 257 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:47:43.613375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f9be2d3-15de-4eb7-953b-76a6855cc2d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b6e020>]}
[0m17:47:43.615072 [info ] [MainThread]: 
[0m17:47:43.615657 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:47:43.617358 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m17:47:43.625124 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:47:43.625472 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:47:43.625729 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:43.677079 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.05 seconds
[0m17:47:43.678869 [debug] [ThreadPool]: On list_postgres: Close
[0m17:47:43.680998 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m17:47:43.685655 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:47:43.685933 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:47:43.686155 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:47:43.693265 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m17:47:43.693560 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:47:43.693717 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:47:43.696652 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m17:47:43.697883 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:47:43.698218 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:47:43.702300 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:43.702642 [debug] [MainThread]: On master: BEGIN
[0m17:47:43.702866 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:47:43.708960 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:47:43.709313 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:43.709555 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:47:43.713866 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m17:47:43.715194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f9be2d3-15de-4eb7-953b-76a6855cc2d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c58670>]}
[0m17:47:43.715570 [debug] [MainThread]: On master: ROLLBACK
[0m17:47:43.715888 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:43.716123 [debug] [MainThread]: On master: BEGIN
[0m17:47:43.716542 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:47:43.716901 [debug] [MainThread]: On master: COMMIT
[0m17:47:43.717126 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:43.717374 [debug] [MainThread]: On master: COMMIT
[0m17:47:43.717733 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:47:43.717968 [debug] [MainThread]: On master: Close
[0m17:47:43.718397 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:47:43.718714 [info ] [MainThread]: 
[0m17:47:43.722043 [debug] [Thread-1 (]: Began running node model.jaffle_shop.below_depletion_level
[0m17:47:43.722168 [debug] [Thread-2 (]: Began running node model.jaffle_shop.hot_upsell
[0m17:47:43.722456 [info ] [Thread-1 (]: 1 of 4 START view model public.below_depletion_level ........................... [RUN]
[0m17:47:43.722810 [info ] [Thread-2 (]: 2 of 4 START view model public.hot_upsell ...................................... [RUN]
[0m17:47:43.723361 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.below_depletion_level"
[0m17:47:43.723809 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.hot_upsell"
[0m17:47:43.724098 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.below_depletion_level
[0m17:47:43.724397 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.hot_upsell
[0m17:47:43.724656 [debug] [Thread-1 (]: Compiling model.jaffle_shop.below_depletion_level
[0m17:47:43.724900 [debug] [Thread-2 (]: Compiling model.jaffle_shop.hot_upsell
[0m17:47:43.727271 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.below_depletion_level"
[0m17:47:43.730158 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.hot_upsell"
[0m17:47:43.731646 [debug] [Thread-1 (]: finished collecting timing info
[0m17:47:43.731741 [debug] [Thread-2 (]: finished collecting timing info
[0m17:47:43.731955 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.below_depletion_level
[0m17:47:43.732268 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.hot_upsell
[0m17:47:43.765788 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.hot_upsell"
[0m17:47:43.766962 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.below_depletion_level"
[0m17:47:43.770328 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:47:43.770560 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m17:47:43.770767 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: BEGIN
[0m17:47:43.771000 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: BEGIN
[0m17:47:43.771226 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:47:43.773296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:43.780120 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m17:47:43.780366 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m17:47:43.780723 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:47:43.780958 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m17:47:43.781173 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */

  create view "postgres"."public"."hot_upsell__dbt_tmp" as (
    select distinct rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, (ruv.msrp - rupu.price) as profit_margin
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_pads_upsell" rupu on rupu.p_id = ruv.pid and rupu.variant = ruv.variant 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where new_arrival = 'Y' and stock_level < coalesce(depletion_level, 0) and rupu.stock is not null
order by profit_margin desc
  );
[0m17:47:43.781407 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */

  create view "postgres"."public"."below_depletion_level__dbt_tmp" as (
    select distinct name, ruv.variant, ruv.actual_size, ruv.weave_cat, ruv.size_grp, ruv.shape, ruv.weight, ruv.stock_level, ruv.depletion_level
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where coalesce(stock_level, 0) < coalesce(depletion_level, 0)
  );
[0m17:47:43.784783 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:47:43.790269 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:47:43.790393 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m17:47:43.790626 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
alter table "postgres"."public"."hot_upsell" rename to "hot_upsell__dbt_backup"
[0m17:47:43.792462 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m17:47:43.793229 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:47:43.793326 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level" rename to "below_depletion_level__dbt_backup"
[0m17:47:43.795061 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:47:43.795501 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
alter table "postgres"."public"."hot_upsell__dbt_tmp" rename to "hot_upsell"
[0m17:47:43.795660 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:47:43.796040 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:47:43.797571 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m17:47:43.812442 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: COMMIT
[0m17:47:43.812552 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level__dbt_tmp" rename to "below_depletion_level"
[0m17:47:43.812818 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:47:43.813284 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: COMMIT
[0m17:47:43.813478 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:47:43.815428 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m17:47:43.815529 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:47:43.815749 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m17:47:43.819348 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:47:43.819609 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m17:47:43.819820 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
drop view if exists "postgres"."public"."hot_upsell__dbt_backup" cascade
[0m17:47:43.820340 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:47:43.821441 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:47:43.823546 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m17:47:43.824778 [debug] [Thread-2 (]: finished collecting timing info
[0m17:47:43.825111 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
drop view if exists "postgres"."public"."below_depletion_level__dbt_backup" cascade
[0m17:47:43.825414 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: Close
[0m17:47:43.826157 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f9be2d3-15de-4eb7-953b-76a6855cc2d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff80eb3d0>]}
[0m17:47:43.827289 [info ] [Thread-2 (]: 2 of 4 OK created view model public.hot_upsell ................................. [[32mCREATE VIEW[0m in 0.10s]
[0m17:47:43.827889 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.hot_upsell
[0m17:47:43.828222 [debug] [Thread-2 (]: Began running node model.jaffle_shop.underselling_product_specs
[0m17:47:43.828514 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:47:43.828687 [info ] [Thread-2 (]: 3 of 4 START view model public.underselling_product_specs ...................... [RUN]
[0m17:47:43.829825 [debug] [Thread-1 (]: finished collecting timing info
[0m17:47:43.830349 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:47:43.830607 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: Close
[0m17:47:43.830840 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.underselling_product_specs
[0m17:47:43.831253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f9be2d3-15de-4eb7-953b-76a6855cc2d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff80e5990>]}
[0m17:47:43.831457 [debug] [Thread-2 (]: Compiling model.jaffle_shop.underselling_product_specs
[0m17:47:43.831832 [info ] [Thread-1 (]: 1 of 4 OK created view model public.below_depletion_level ...................... [[32mCREATE VIEW[0m in 0.11s]
[0m17:47:43.834470 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.underselling_product_specs"
[0m17:47:43.834885 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.below_depletion_level
[0m17:47:43.835748 [debug] [Thread-1 (]: Began running node model.jaffle_shop.priority_order
[0m17:47:43.836119 [info ] [Thread-1 (]: 4 of 4 START view model public.priority_order .................................. [RUN]
[0m17:47:43.836223 [debug] [Thread-2 (]: finished collecting timing info
[0m17:47:43.836642 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.priority_order"
[0m17:47:43.836880 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.underselling_product_specs
[0m17:47:43.837099 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.priority_order
[0m17:47:43.839906 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.underselling_product_specs"
[0m17:47:43.840249 [debug] [Thread-1 (]: Compiling model.jaffle_shop.priority_order
[0m17:47:43.843285 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.priority_order"
[0m17:47:43.843915 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:47:43.844131 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: BEGIN
[0m17:47:43.844320 [debug] [Thread-1 (]: finished collecting timing info
[0m17:47:43.844403 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:47:43.844649 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.priority_order
[0m17:47:43.848004 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.priority_order"
[0m17:47:43.848986 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m17:47:43.849205 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: BEGIN
[0m17:47:43.849422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:43.851342 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m17:47:43.851679 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:47:43.851901 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */

  create view "postgres"."public"."underselling_product_specs__dbt_tmp" as (
    select distinct rup.name, rucm.color_value, ruv.actual_size, ruv.weave_cat, ruv.size_grp, ruv.shape, (ruv.stock_level - ruv.depletion_level) as stock_depletion_ratio
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_color_map" rucm on rucm.color_id = ruv.pid 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
where stock_level > coalesce(depletion_level, 0) and depletion_level <> 0 
and stock_level is not null and stock_level <> 0 and new_arrival = 'N' and status = 'In_stock'
order by stock_depletion_ratio desc limit 10
  );
[0m17:47:43.854288 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:47:43.856714 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:47:43.857078 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m17:47:43.857215 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
alter table "postgres"."public"."underselling_product_specs" rename to "underselling_product_specs__dbt_backup"
[0m17:47:43.857591 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m17:47:43.857969 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */

  create view "postgres"."public"."priority_order__dbt_tmp" as (
    select distinct rup.name as product_name, ruv.variant as variant, ruv.actual_size, ruv.weave_cat, (msrp - price) as profit 
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
join "postgres"."public"."below_depletion_level" bdl on bdl.name = rup.name and bdl.variant = ruv.variant
order by profit desc
  );
[0m17:47:43.858299 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:47:43.860534 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:47:43.860675 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:47:43.860915 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
alter table "postgres"."public"."underselling_product_specs__dbt_tmp" rename to "underselling_product_specs"
[0m17:47:43.862763 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m17:47:43.863186 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
alter table "postgres"."public"."priority_order__dbt_tmp" rename to "priority_order"
[0m17:47:43.863453 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:47:43.864601 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: COMMIT
[0m17:47:43.864702 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:47:43.864913 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:47:43.865993 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: COMMIT
[0m17:47:43.866259 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: COMMIT
[0m17:47:43.866537 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m17:47:43.867096 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: COMMIT
[0m17:47:43.867265 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:47:43.869212 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:47:43.869370 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:47:43.869606 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
drop view if exists "postgres"."public"."underselling_product_specs__dbt_backup" cascade
[0m17:47:43.870879 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m17:47:43.871291 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
drop view if exists "postgres"."public"."priority_order__dbt_backup" cascade
[0m17:47:43.871649 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:47:43.872628 [debug] [Thread-1 (]: finished collecting timing info
[0m17:47:43.872729 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:47:43.872954 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: Close
[0m17:47:43.873808 [debug] [Thread-2 (]: finished collecting timing info
[0m17:47:43.874264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f9be2d3-15de-4eb7-953b-76a6855cc2d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff80aa920>]}
[0m17:47:43.874480 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: Close
[0m17:47:43.874864 [info ] [Thread-1 (]: 4 of 4 OK created view model public.priority_order ............................. [[32mCREATE VIEW[0m in 0.04s]
[0m17:47:43.875285 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f9be2d3-15de-4eb7-953b-76a6855cc2d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff80aa0b0>]}
[0m17:47:43.875680 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.priority_order
[0m17:47:43.876082 [info ] [Thread-2 (]: 3 of 4 OK created view model public.underselling_product_specs ................. [[32mCREATE VIEW[0m in 0.05s]
[0m17:47:43.876648 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.underselling_product_specs
[0m17:47:43.878275 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:47:43.878540 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:43.878746 [debug] [MainThread]: On master: BEGIN
[0m17:47:43.878934 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:47:43.884926 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:47:43.885215 [debug] [MainThread]: On master: COMMIT
[0m17:47:43.885437 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:43.885640 [debug] [MainThread]: On master: COMMIT
[0m17:47:43.885898 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:47:43.886099 [debug] [MainThread]: On master: Close
[0m17:47:43.886683 [info ] [MainThread]: 
[0m17:47:43.886988 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m17:47:43.887268 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:47:43.887517 [debug] [MainThread]: Connection 'model.jaffle_shop.priority_order' was properly closed.
[0m17:47:43.887708 [debug] [MainThread]: Connection 'model.jaffle_shop.underselling_product_specs' was properly closed.
[0m17:47:43.894746 [info ] [MainThread]: 
[0m17:47:43.895072 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:47:43.895449 [info ] [MainThread]: 
[0m17:47:43.895744 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:47:43.896130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff812a8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff812a980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff812af20>]}


============================== 2024-07-14 17:48:26.853629 | 461c9258-79c0-4c0c-b172-e6d7bc6aac99 ==============================
[0m17:48:26.853952 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:48:26.869314 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m17:48:26.869761 [debug] [MainThread]: Tracking: tracking
[0m17:48:26.886329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c15d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c14c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c17e80>]}
[0m17:48:26.934949 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:48:26.935709 [debug] [MainThread]: Partial parsing: update schema file: jaffle_shop://models/below_depletion_level/below_depletion_level_tests.yml
[0m17:48:26.936073 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://macros/custom_tests.sql
[0m17:48:26.936351 [debug] [MainThread]: Parsing macros/custom_tests.sql
[0m17:48:26.974678 [debug] [MainThread]: 1699: static parser successfully parsed below_depletion_level/below_depletion_level.sql
[0m17:48:27.015035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '461c9258-79c0-4c0c-b172-e6d7bc6aac99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9baa140>]}
[0m17:48:27.024799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '461c9258-79c0-4c0c-b172-e6d7bc6aac99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1cfa0>]}
[0m17:48:27.025204 [info ] [MainThread]: Found 4 models, 3 tests, 2 snapshots, 0 analyses, 257 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:48:27.025535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '461c9258-79c0-4c0c-b172-e6d7bc6aac99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b610c0>]}
[0m17:48:27.027214 [info ] [MainThread]: 
[0m17:48:27.027808 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:48:27.029892 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m17:48:27.037805 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:48:27.038115 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:48:27.038339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:27.081737 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m17:48:27.082217 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:48:27.082484 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:48:27.087092 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m17:48:27.088835 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:48:27.089176 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:48:27.093645 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:27.093947 [debug] [MainThread]: On master: BEGIN
[0m17:48:27.094172 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:48:27.100892 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:48:27.101187 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:27.101392 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:48:27.105755 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m17:48:27.107070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '461c9258-79c0-4c0c-b172-e6d7bc6aac99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9baa6e0>]}
[0m17:48:27.107418 [debug] [MainThread]: On master: ROLLBACK
[0m17:48:27.107741 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:27.107956 [debug] [MainThread]: On master: BEGIN
[0m17:48:27.108315 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:48:27.108655 [debug] [MainThread]: On master: COMMIT
[0m17:48:27.108918 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:27.109135 [debug] [MainThread]: On master: COMMIT
[0m17:48:27.109444 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:48:27.109692 [debug] [MainThread]: On master: Close
[0m17:48:27.110087 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:48:27.110399 [info ] [MainThread]: 
[0m17:48:27.114674 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:48:27.114810 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:48:27.115071 [info ] [Thread-1 (]: 1 of 3 START test not_null_below_depletion_level_name .......................... [RUN]
[0m17:48:27.115376 [info ] [Thread-2 (]: 2 of 3 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m17:48:27.115811 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:48:27.116178 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:48:27.116440 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:48:27.116677 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:48:27.116923 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:48:27.117126 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:48:27.124244 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:48:27.127688 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:48:27.129627 [debug] [Thread-1 (]: finished collecting timing info
[0m17:48:27.129723 [debug] [Thread-2 (]: finished collecting timing info
[0m17:48:27.129952 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:48:27.130197 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:48:27.142152 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:48:27.143824 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:48:27.145888 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:48:27.146144 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:48:27.146234 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m17:48:27.146474 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m17:48:27.146702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:27.146936 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:48:27.153734 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m17:48:27.153882 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m17:48:27.154171 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:48:27.154408 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:48:27.154647 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m17:48:27.154872 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m17:48:27.161123 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m17:48:27.163625 [debug] [Thread-1 (]: finished collecting timing info
[0m17:48:27.163965 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m17:48:27.164291 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m17:48:27.164790 [info ] [Thread-1 (]: 1 of 3 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.05s]
[0m17:48:27.165909 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:48:27.166234 [debug] [Thread-1 (]: Began running node test.jaffle_shop.stock_depletion_check.78cd93890c
[0m17:48:27.166557 [info ] [Thread-1 (]: 3 of 3 START test stock_depletion_check ........................................ [RUN]
[0m17:48:27.167052 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.stock_depletion_check.78cd93890c"
[0m17:48:27.167293 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.stock_depletion_check.78cd93890c
[0m17:48:27.167532 [debug] [Thread-1 (]: Compiling test.jaffle_shop.stock_depletion_check.78cd93890c
[0m17:48:27.171948 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m17:48:27.172905 [debug] [Thread-1 (]: finished collecting timing info
[0m17:48:27.173903 [debug] [Thread-2 (]: finished collecting timing info
[0m17:48:27.174311 [debug] [Thread-1 (]: Compilation Error in test stock_depletion_check (models/below_depletion_level/below_depletion_level_tests.yml)
  'test_custom_sql' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:48:27.174577 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m17:48:27.174872 [error] [Thread-1 (]: 3 of 3 ERROR stock_depletion_check ............................................. [[31mERROR[0m in 0.01s]
[0m17:48:27.175215 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m17:48:27.175460 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.stock_depletion_check.78cd93890c
[0m17:48:27.175863 [info ] [Thread-2 (]: 2 of 3 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.06s]
[0m17:48:27.176498 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:48:27.178272 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:48:27.178535 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:27.178766 [debug] [MainThread]: On master: BEGIN
[0m17:48:27.178964 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:48:27.185384 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:48:27.185726 [debug] [MainThread]: On master: COMMIT
[0m17:48:27.185947 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:27.186147 [debug] [MainThread]: On master: COMMIT
[0m17:48:27.186402 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:48:27.186608 [debug] [MainThread]: On master: Close
[0m17:48:27.187194 [info ] [MainThread]: 
[0m17:48:27.187515 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m17:48:27.187822 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:48:27.188046 [debug] [MainThread]: Connection 'test.jaffle_shop.stock_depletion_check.78cd93890c' was properly closed.
[0m17:48:27.188241 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1' was properly closed.
[0m17:48:27.194743 [info ] [MainThread]: 
[0m17:48:27.195068 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:48:27.195443 [info ] [MainThread]: 
[0m17:48:27.195773 [error] [MainThread]: [33mCompilation Error in test stock_depletion_check (models/below_depletion_level/below_depletion_level_tests.yml)[0m
[0m17:48:27.196084 [error] [MainThread]:   'test_custom_sql' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:48:27.196415 [info ] [MainThread]: 
[0m17:48:27.196759 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:48:27.197132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bace50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bad840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bba380>]}


============================== 2024-07-14 17:49:43.338003 | 1320d0af-bffe-4deb-abe1-380d42ad035b ==============================
[0m17:49:43.338312 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:49:43.354923 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m17:49:43.355621 [debug] [MainThread]: Tracking: tracking
[0m17:49:43.372193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c17760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c17370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c16ef0>]}
[0m17:49:43.421958 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:49:43.422341 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:49:43.430126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1320d0af-bffe-4deb-abe1-380d42ad035b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bb54e0>]}
[0m17:49:43.440186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1320d0af-bffe-4deb-abe1-380d42ad035b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7f5e0>]}
[0m17:49:43.440622 [info ] [MainThread]: Found 4 models, 3 tests, 2 snapshots, 0 analyses, 257 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:49:43.440947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1320d0af-bffe-4deb-abe1-380d42ad035b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7f4f0>]}
[0m17:49:43.442723 [info ] [MainThread]: 
[0m17:49:43.443500 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:49:43.446220 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m17:49:43.456094 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:49:43.456555 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:49:43.456830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:43.501845 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m17:49:43.502368 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:49:43.502634 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:49:43.506460 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m17:49:43.508288 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:49:43.508698 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:49:43.513664 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:43.514005 [debug] [MainThread]: On master: BEGIN
[0m17:49:43.514227 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:49:43.521399 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:49:43.521735 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:43.522006 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:49:43.526684 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m17:49:43.528043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1320d0af-bffe-4deb-abe1-380d42ad035b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7e830>]}
[0m17:49:43.528410 [debug] [MainThread]: On master: ROLLBACK
[0m17:49:43.528711 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:43.528964 [debug] [MainThread]: On master: BEGIN
[0m17:49:43.529346 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:49:43.529683 [debug] [MainThread]: On master: COMMIT
[0m17:49:43.529900 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:43.530113 [debug] [MainThread]: On master: COMMIT
[0m17:49:43.530445 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:49:43.530692 [debug] [MainThread]: On master: Close
[0m17:49:43.531220 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:49:43.531586 [info ] [MainThread]: 
[0m17:49:43.548665 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:49:43.549010 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:49:43.550797 [info ] [Thread-1 (]: 1 of 3 START test not_null_below_depletion_level_name .......................... [RUN]
[0m17:49:43.551442 [info ] [Thread-2 (]: 2 of 3 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m17:49:43.552092 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:49:43.552808 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:49:43.553189 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:49:43.553437 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:49:43.553708 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:49:43.553963 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:49:43.566507 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:49:43.569736 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:49:43.571641 [debug] [Thread-1 (]: finished collecting timing info
[0m17:49:43.571743 [debug] [Thread-2 (]: finished collecting timing info
[0m17:49:43.571993 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:49:43.572239 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:49:43.585827 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:49:43.587894 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:49:43.590551 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:49:43.590686 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:49:43.590905 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m17:49:43.591165 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m17:49:43.591414 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:49:43.591678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:43.599157 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m17:49:43.599556 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m17:49:43.599671 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:49:43.599972 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:49:43.600242 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m17:49:43.600574 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m17:49:43.607426 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m17:49:43.610411 [debug] [Thread-1 (]: finished collecting timing info
[0m17:49:43.610976 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m17:49:43.611317 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m17:49:43.611984 [info ] [Thread-1 (]: 1 of 3 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.06s]
[0m17:49:43.612779 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:49:43.613264 [debug] [Thread-1 (]: Began running node test.jaffle_shop.stock_depletion_check.78cd93890c
[0m17:49:43.613648 [info ] [Thread-1 (]: 3 of 3 START test stock_depletion_check ........................................ [RUN]
[0m17:49:43.615386 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.stock_depletion_check.78cd93890c"
[0m17:49:43.616017 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.stock_depletion_check.78cd93890c
[0m17:49:43.616679 [debug] [Thread-1 (]: Compiling test.jaffle_shop.stock_depletion_check.78cd93890c
[0m17:49:43.617274 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.02 seconds
[0m17:49:43.625991 [debug] [Thread-2 (]: finished collecting timing info
[0m17:49:43.627432 [debug] [Thread-1 (]: finished collecting timing info
[0m17:49:43.627596 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m17:49:43.628183 [debug] [Thread-1 (]: Compilation Error in test stock_depletion_check (models/below_depletion_level/below_depletion_level_tests.yml)
  'test_custom_sql' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:49:43.628875 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m17:49:43.629073 [error] [Thread-1 (]: 3 of 3 ERROR stock_depletion_check ............................................. [[31mERROR[0m in 0.01s]
[0m17:49:43.629677 [info ] [Thread-2 (]: 2 of 3 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.08s]
[0m17:49:43.631191 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.stock_depletion_check.78cd93890c
[0m17:49:43.631720 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:49:43.634474 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:49:43.634887 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:43.635162 [debug] [MainThread]: On master: BEGIN
[0m17:49:43.635396 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:49:43.642073 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:49:43.642512 [debug] [MainThread]: On master: COMMIT
[0m17:49:43.642740 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:43.642971 [debug] [MainThread]: On master: COMMIT
[0m17:49:43.643289 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:49:43.643522 [debug] [MainThread]: On master: Close
[0m17:49:43.644161 [info ] [MainThread]: 
[0m17:49:43.644483 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m17:49:43.644941 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:49:43.645254 [debug] [MainThread]: Connection 'test.jaffle_shop.stock_depletion_check.78cd93890c' was properly closed.
[0m17:49:43.645537 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1' was properly closed.
[0m17:49:43.652426 [info ] [MainThread]: 
[0m17:49:43.652792 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:49:43.653174 [info ] [MainThread]: 
[0m17:49:43.653499 [error] [MainThread]: [33mCompilation Error in test stock_depletion_check (models/below_depletion_level/below_depletion_level_tests.yml)[0m
[0m17:49:43.653886 [error] [MainThread]:   'test_custom_sql' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:49:43.654288 [info ] [MainThread]: 
[0m17:49:43.654658 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:49:43.655070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7f670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99e3ee0>]}


============================== 2024-07-14 17:49:49.513367 | 6444d233-e0a5-4f3c-a587-4944ce62aba6 ==============================
[0m17:49:49.513706 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:49:49.517113 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:49:49.517586 [debug] [MainThread]: Tracking: tracking
[0m17:49:49.533242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b280>]}
[0m17:49:49.580961 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:49:49.581332 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:49:49.587487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6444d233-e0a5-4f3c-a587-4944ce62aba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bb54b0>]}
[0m17:49:49.596780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6444d233-e0a5-4f3c-a587-4944ce62aba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7f5b0>]}
[0m17:49:49.597215 [info ] [MainThread]: Found 4 models, 3 tests, 2 snapshots, 0 analyses, 257 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:49:49.597572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6444d233-e0a5-4f3c-a587-4944ce62aba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7f4f0>]}
[0m17:49:49.599315 [info ] [MainThread]: 
[0m17:49:49.599961 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:49:49.602274 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m17:49:49.611442 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:49:49.611866 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:49:49.612134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:49.672991 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.06 seconds
[0m17:49:49.674815 [debug] [ThreadPool]: On list_postgres: Close
[0m17:49:49.677077 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m17:49:49.681768 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:49:49.682059 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:49:49.682307 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:49:49.690667 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m17:49:49.691393 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:49:49.691795 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:49:49.695380 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m17:49:49.696791 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:49:49.697226 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:49:49.701396 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:49.701688 [debug] [MainThread]: On master: BEGIN
[0m17:49:49.701943 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:49:49.708054 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:49:49.708678 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:49.708907 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:49:49.713391 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m17:49:49.714861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6444d233-e0a5-4f3c-a587-4944ce62aba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99e4b50>]}
[0m17:49:49.715229 [debug] [MainThread]: On master: ROLLBACK
[0m17:49:49.715568 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:49.715792 [debug] [MainThread]: On master: BEGIN
[0m17:49:49.716172 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:49:49.716450 [debug] [MainThread]: On master: COMMIT
[0m17:49:49.716667 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:49.716909 [debug] [MainThread]: On master: COMMIT
[0m17:49:49.717215 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:49:49.717455 [debug] [MainThread]: On master: Close
[0m17:49:49.717850 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:49:49.718174 [info ] [MainThread]: 
[0m17:49:49.721369 [debug] [Thread-1 (]: Began running node model.jaffle_shop.below_depletion_level
[0m17:49:49.721503 [debug] [Thread-2 (]: Began running node model.jaffle_shop.hot_upsell
[0m17:49:49.721836 [info ] [Thread-1 (]: 1 of 4 START view model public.below_depletion_level ........................... [RUN]
[0m17:49:49.722236 [info ] [Thread-2 (]: 2 of 4 START view model public.hot_upsell ...................................... [RUN]
[0m17:49:49.722684 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.below_depletion_level"
[0m17:49:49.723191 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.hot_upsell"
[0m17:49:49.723481 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.below_depletion_level
[0m17:49:49.723735 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.hot_upsell
[0m17:49:49.724043 [debug] [Thread-1 (]: Compiling model.jaffle_shop.below_depletion_level
[0m17:49:49.724274 [debug] [Thread-2 (]: Compiling model.jaffle_shop.hot_upsell
[0m17:49:49.727190 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.below_depletion_level"
[0m17:49:49.729484 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.hot_upsell"
[0m17:49:49.730985 [debug] [Thread-2 (]: finished collecting timing info
[0m17:49:49.731083 [debug] [Thread-1 (]: finished collecting timing info
[0m17:49:49.731309 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.hot_upsell
[0m17:49:49.731574 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.below_depletion_level
[0m17:49:49.769638 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.hot_upsell"
[0m17:49:49.770645 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.below_depletion_level"
[0m17:49:49.772284 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:49:49.772538 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m17:49:49.772628 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: BEGIN
[0m17:49:49.772845 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: BEGIN
[0m17:49:49.773050 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:49:49.773252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:49.780263 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m17:49:49.780681 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m17:49:49.780808 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:49:49.781209 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m17:49:49.781512 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */

  create view "postgres"."public"."hot_upsell__dbt_tmp" as (
    select distinct rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, (ruv.msrp - rupu.price) as profit_margin
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_pads_upsell" rupu on rupu.p_id = ruv.pid and rupu.variant = ruv.variant 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where new_arrival = 'Y' and stock_level < coalesce(depletion_level, 0) and rupu.stock is not null
order by profit_margin desc
  );
[0m17:49:49.781783 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */

  create view "postgres"."public"."below_depletion_level__dbt_tmp" as (
    select distinct name, ruv.variant, ruv.actual_size, ruv.weave_cat, ruv.size_grp, ruv.shape, ruv.weight, ruv.stock_level, ruv.depletion_level
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where coalesce(stock_level, 0) < coalesce(depletion_level, 0)
  );
[0m17:49:49.787099 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:49:49.792628 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:49:49.792753 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m17:49:49.793005 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
alter table "postgres"."public"."hot_upsell" rename to "hot_upsell__dbt_backup"
[0m17:49:49.794845 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m17:49:49.796523 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:49:49.796613 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level" rename to "below_depletion_level__dbt_backup"
[0m17:49:49.798498 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:49:49.798976 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
alter table "postgres"."public"."hot_upsell__dbt_tmp" rename to "hot_upsell"
[0m17:49:49.799436 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:49:49.799627 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:49:49.801249 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m17:49:49.815891 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: COMMIT
[0m17:49:49.815997 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level__dbt_tmp" rename to "below_depletion_level"
[0m17:49:49.816260 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:49:49.816709 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: COMMIT
[0m17:49:49.816927 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:49:49.818480 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m17:49:49.818580 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:49:49.818793 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m17:49:49.823278 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m17:49:49.823558 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m17:49:49.823770 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
drop view if exists "postgres"."public"."hot_upsell__dbt_backup" cascade
[0m17:49:49.824497 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:49:49.826000 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m17:49:49.826229 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
drop view if exists "postgres"."public"."below_depletion_level__dbt_backup" cascade
[0m17:49:49.826479 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:49:49.827569 [debug] [Thread-2 (]: finished collecting timing info
[0m17:49:49.827859 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: Close
[0m17:49:49.828444 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6444d233-e0a5-4f3c-a587-4944ce62aba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99fc250>]}
[0m17:49:49.828869 [info ] [Thread-2 (]: 2 of 4 OK created view model public.hot_upsell ................................. [[32mCREATE VIEW[0m in 0.11s]
[0m17:49:49.829108 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:49:49.829502 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.hot_upsell
[0m17:49:49.830443 [debug] [Thread-1 (]: finished collecting timing info
[0m17:49:49.830724 [debug] [Thread-2 (]: Began running node model.jaffle_shop.underselling_product_specs
[0m17:49:49.831021 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: Close
[0m17:49:49.831297 [info ] [Thread-2 (]: 3 of 4 START view model public.underselling_product_specs ...................... [RUN]
[0m17:49:49.831764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6444d233-e0a5-4f3c-a587-4944ce62aba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff80cb010>]}
[0m17:49:49.832152 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:49:49.832534 [info ] [Thread-1 (]: 1 of 4 OK created view model public.below_depletion_level ...................... [[32mCREATE VIEW[0m in 0.11s]
[0m17:49:49.832779 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.underselling_product_specs
[0m17:49:49.833160 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.below_depletion_level
[0m17:49:49.833398 [debug] [Thread-2 (]: Compiling model.jaffle_shop.underselling_product_specs
[0m17:49:49.833868 [debug] [Thread-1 (]: Began running node model.jaffle_shop.priority_order
[0m17:49:49.836286 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.underselling_product_specs"
[0m17:49:49.836614 [info ] [Thread-1 (]: 4 of 4 START view model public.priority_order .................................. [RUN]
[0m17:49:49.837398 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.priority_order"
[0m17:49:49.837752 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.priority_order
[0m17:49:49.838011 [debug] [Thread-2 (]: finished collecting timing info
[0m17:49:49.838244 [debug] [Thread-1 (]: Compiling model.jaffle_shop.priority_order
[0m17:49:49.838507 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.underselling_product_specs
[0m17:49:49.841103 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.priority_order"
[0m17:49:49.843889 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.underselling_product_specs"
[0m17:49:49.844890 [debug] [Thread-1 (]: finished collecting timing info
[0m17:49:49.845071 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:49:49.845267 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.priority_order
[0m17:49:49.845482 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: BEGIN
[0m17:49:49.848245 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.priority_order"
[0m17:49:49.848535 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:49:49.849492 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m17:49:49.849927 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: BEGIN
[0m17:49:49.850151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:49.855519 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m17:49:49.855863 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:49:49.856079 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */

  create view "postgres"."public"."underselling_product_specs__dbt_tmp" as (
    select distinct rup.name, rucm.color_value, ruv.actual_size, ruv.weave_cat, ruv.size_grp, ruv.shape, (ruv.stock_level - ruv.depletion_level) as stock_depletion_ratio
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_color_map" rucm on rucm.color_id = ruv.pid 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
where stock_level > coalesce(depletion_level, 0) and depletion_level <> 0 
and stock_level is not null and stock_level <> 0 and new_arrival = 'N' and status = 'In_stock'
order by stock_depletion_ratio desc limit 10
  );
[0m17:49:49.856588 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m17:49:49.856881 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m17:49:49.857134 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */

  create view "postgres"."public"."priority_order__dbt_tmp" as (
    select distinct rup.name as product_name, ruv.variant as variant, ruv.actual_size, ruv.weave_cat, (msrp - price) as profit 
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
join "postgres"."public"."below_depletion_level" bdl on bdl.name = rup.name and bdl.variant = ruv.variant
order by profit desc
  );
[0m17:49:49.860666 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:49:49.863106 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:49:49.863380 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
alter table "postgres"."public"."underselling_product_specs" rename to "underselling_product_specs__dbt_backup"
[0m17:49:49.863682 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m17:49:49.865528 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m17:49:49.865640 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:49:49.865842 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
alter table "postgres"."public"."priority_order__dbt_tmp" rename to "priority_order"
[0m17:49:49.868501 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:49:49.868949 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
alter table "postgres"."public"."underselling_product_specs__dbt_tmp" rename to "underselling_product_specs"
[0m17:49:49.869134 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:49:49.870200 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: COMMIT
[0m17:49:49.870289 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:49:49.870489 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m17:49:49.871831 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: COMMIT
[0m17:49:49.872089 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: COMMIT
[0m17:49:49.872968 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:49:49.873369 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: COMMIT
[0m17:49:49.873839 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:49:49.873975 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:49:49.875308 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m17:49:49.877974 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m17:49:49.878249 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
drop view if exists "postgres"."public"."priority_order__dbt_backup" cascade
[0m17:49:49.879754 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
drop view if exists "postgres"."public"."underselling_product_specs__dbt_backup" cascade
[0m17:49:49.880218 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:49:49.881344 [debug] [Thread-1 (]: finished collecting timing info
[0m17:49:49.881647 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: Close
[0m17:49:49.881989 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:49:49.882353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6444d233-e0a5-4f3c-a587-4944ce62aba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff80f9570>]}
[0m17:49:49.883564 [debug] [Thread-2 (]: finished collecting timing info
[0m17:49:49.884004 [info ] [Thread-1 (]: 4 of 4 OK created view model public.priority_order ............................. [[32mCREATE VIEW[0m in 0.04s]
[0m17:49:49.884266 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: Close
[0m17:49:49.884635 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.priority_order
[0m17:49:49.885052 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6444d233-e0a5-4f3c-a587-4944ce62aba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff80ffd90>]}
[0m17:49:49.886253 [info ] [Thread-2 (]: 3 of 4 OK created view model public.underselling_product_specs ................. [[32mCREATE VIEW[0m in 0.05s]
[0m17:49:49.886620 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.underselling_product_specs
[0m17:49:49.888349 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:49:49.888631 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:49.888842 [debug] [MainThread]: On master: BEGIN
[0m17:49:49.889174 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:49:49.895380 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:49:49.896161 [debug] [MainThread]: On master: COMMIT
[0m17:49:49.896435 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:49.896673 [debug] [MainThread]: On master: COMMIT
[0m17:49:49.897000 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:49:49.897394 [debug] [MainThread]: On master: Close
[0m17:49:49.898089 [info ] [MainThread]: 
[0m17:49:49.898520 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m17:49:49.899012 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:49:49.899297 [debug] [MainThread]: Connection 'model.jaffle_shop.priority_order' was properly closed.
[0m17:49:49.899525 [debug] [MainThread]: Connection 'model.jaffle_shop.underselling_product_specs' was properly closed.
[0m17:49:49.910348 [info ] [MainThread]: 
[0m17:49:49.910661 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:49:49.911003 [info ] [MainThread]: 
[0m17:49:49.911259 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:49:49.911828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff80ff6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff80ff490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff80fa200>]}


============================== 2024-07-14 17:49:54.519530 | 14d2591e-2f3d-43ee-90fe-d17f44083428 ==============================
[0m17:49:54.519853 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:49:54.522365 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m17:49:54.522650 [debug] [MainThread]: Tracking: tracking
[0m17:49:54.536182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c15d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c14c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c17d30>]}
[0m17:49:54.577829 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:49:54.578390 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:49:54.585186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14d2591e-2f3d-43ee-90fe-d17f44083428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bb5420>]}
[0m17:49:54.595322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14d2591e-2f3d-43ee-90fe-d17f44083428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7f520>]}
[0m17:49:54.595776 [info ] [MainThread]: Found 4 models, 3 tests, 2 snapshots, 0 analyses, 257 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:49:54.596085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14d2591e-2f3d-43ee-90fe-d17f44083428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7f460>]}
[0m17:49:54.598146 [info ] [MainThread]: 
[0m17:49:54.598877 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:49:54.601803 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m17:49:54.612355 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:49:54.612782 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:49:54.613048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:54.655216 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m17:49:54.655742 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:49:54.656003 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:49:54.659207 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m17:49:54.661080 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:49:54.661455 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:49:54.665911 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:54.666176 [debug] [MainThread]: On master: BEGIN
[0m17:49:54.666335 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:49:54.673517 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:49:54.673834 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:54.674021 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:49:54.677725 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m17:49:54.679042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14d2591e-2f3d-43ee-90fe-d17f44083428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7e770>]}
[0m17:49:54.679358 [debug] [MainThread]: On master: ROLLBACK
[0m17:49:54.679619 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:54.679779 [debug] [MainThread]: On master: BEGIN
[0m17:49:54.680116 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:49:54.680374 [debug] [MainThread]: On master: COMMIT
[0m17:49:54.680555 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:54.680711 [debug] [MainThread]: On master: COMMIT
[0m17:49:54.680939 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:49:54.681148 [debug] [MainThread]: On master: Close
[0m17:49:54.681507 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:49:54.681762 [info ] [MainThread]: 
[0m17:49:54.685242 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:49:54.685389 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:49:54.685654 [info ] [Thread-1 (]: 1 of 3 START test not_null_below_depletion_level_name .......................... [RUN]
[0m17:49:54.685976 [info ] [Thread-2 (]: 2 of 3 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m17:49:54.686426 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:49:54.687021 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:49:54.687361 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:49:54.687612 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:49:54.687878 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:49:54.688128 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:49:54.704518 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:49:54.710460 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:49:54.713252 [debug] [Thread-1 (]: finished collecting timing info
[0m17:49:54.713731 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:49:54.713846 [debug] [Thread-2 (]: finished collecting timing info
[0m17:49:54.731385 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:49:54.731833 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:49:54.734063 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:49:54.735271 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:49:54.735511 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:49:54.735609 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m17:49:54.735838 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m17:49:54.736047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:54.736275 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:49:54.747135 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m17:49:54.747398 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m17:49:54.747742 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:49:54.748240 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:49:54.748643 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m17:49:54.749092 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m17:49:54.757192 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m17:49:54.760206 [debug] [Thread-1 (]: finished collecting timing info
[0m17:49:54.760593 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m17:49:54.761032 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m17:49:54.761576 [info ] [Thread-1 (]: 1 of 3 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.08s]
[0m17:49:54.762858 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:49:54.763298 [debug] [Thread-1 (]: Began running node test.jaffle_shop.stock_depletion_check.78cd93890c
[0m17:49:54.763659 [info ] [Thread-1 (]: 3 of 3 START test stock_depletion_check ........................................ [RUN]
[0m17:49:54.764469 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.stock_depletion_check.78cd93890c"
[0m17:49:54.764762 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.stock_depletion_check.78cd93890c
[0m17:49:54.764986 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m17:49:54.765109 [debug] [Thread-1 (]: Compiling test.jaffle_shop.stock_depletion_check.78cd93890c
[0m17:49:54.766408 [debug] [Thread-2 (]: finished collecting timing info
[0m17:49:54.771172 [debug] [Thread-1 (]: finished collecting timing info
[0m17:49:54.771303 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m17:49:54.771712 [debug] [Thread-1 (]: Compilation Error in test stock_depletion_check (models/below_depletion_level/below_depletion_level_tests.yml)
  'test_custom_sql' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:49:54.772143 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m17:49:54.772267 [error] [Thread-1 (]: 3 of 3 ERROR stock_depletion_check ............................................. [[31mERROR[0m in 0.01s]
[0m17:49:54.772689 [info ] [Thread-2 (]: 2 of 3 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.09s]
[0m17:49:54.773081 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.stock_depletion_check.78cd93890c
[0m17:49:54.773571 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:49:54.775871 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:49:54.776154 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:54.776380 [debug] [MainThread]: On master: BEGIN
[0m17:49:54.776605 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:49:54.782814 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:49:54.783155 [debug] [MainThread]: On master: COMMIT
[0m17:49:54.783318 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:54.783486 [debug] [MainThread]: On master: COMMIT
[0m17:49:54.783738 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:49:54.783945 [debug] [MainThread]: On master: Close
[0m17:49:54.784513 [info ] [MainThread]: 
[0m17:49:54.784767 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m17:49:54.785140 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:49:54.785372 [debug] [MainThread]: Connection 'test.jaffle_shop.stock_depletion_check.78cd93890c' was properly closed.
[0m17:49:54.785534 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1' was properly closed.
[0m17:49:54.791732 [info ] [MainThread]: 
[0m17:49:54.791995 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:49:54.792334 [info ] [MainThread]: 
[0m17:49:54.792692 [error] [MainThread]: [33mCompilation Error in test stock_depletion_check (models/below_depletion_level/below_depletion_level_tests.yml)[0m
[0m17:49:54.792962 [error] [MainThread]:   'test_custom_sql' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:49:54.793220 [info ] [MainThread]: 
[0m17:49:54.793478 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:49:54.793922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7f5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99e15d0>]}


============================== 2024-07-14 17:55:16.490580 | 70c2c0b0-52bc-4ac6-a367-348df604e929 ==============================
[0m17:55:16.490883 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:55:16.507677 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m17:55:16.508315 [debug] [MainThread]: Tracking: tracking
[0m17:55:16.523460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b280>]}
[0m17:55:16.579804 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:55:16.580741 [debug] [MainThread]: Partial parsing: update schema file: jaffle_shop://models/below_depletion_level/below_depletion_level_tests.yml
[0m17:55:16.616831 [debug] [MainThread]: 1699: static parser successfully parsed below_depletion_level/below_depletion_level.sql
[0m17:55:16.659994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70c2c0b0-52bc-4ac6-a367-348df604e929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7fca0>]}
[0m17:55:16.670282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70c2c0b0-52bc-4ac6-a367-348df604e929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1c880>]}
[0m17:55:16.670718 [info ] [MainThread]: Found 4 models, 3 tests, 2 snapshots, 0 analyses, 257 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:55:16.671061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70c2c0b0-52bc-4ac6-a367-348df604e929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1c400>]}
[0m17:55:16.672788 [info ] [MainThread]: 
[0m17:55:16.673402 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:55:16.675612 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m17:55:16.684048 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:55:16.684380 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:55:16.684633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:16.731396 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m17:55:16.731897 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:55:16.732164 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:55:16.737114 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m17:55:16.738976 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:55:16.739403 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:55:16.743945 [debug] [MainThread]: Using postgres connection "master"
[0m17:55:16.744289 [debug] [MainThread]: On master: BEGIN
[0m17:55:16.744528 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:55:16.752355 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:55:16.752869 [debug] [MainThread]: Using postgres connection "master"
[0m17:55:16.753162 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:55:16.759105 [debug] [MainThread]: SQL status: SELECT 11 in 0.01 seconds
[0m17:55:16.760798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70c2c0b0-52bc-4ac6-a367-348df604e929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7f2b0>]}
[0m17:55:16.761359 [debug] [MainThread]: On master: ROLLBACK
[0m17:55:16.761765 [debug] [MainThread]: Using postgres connection "master"
[0m17:55:16.762020 [debug] [MainThread]: On master: BEGIN
[0m17:55:16.762442 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:55:16.762749 [debug] [MainThread]: On master: COMMIT
[0m17:55:16.762996 [debug] [MainThread]: Using postgres connection "master"
[0m17:55:16.763270 [debug] [MainThread]: On master: COMMIT
[0m17:55:16.763759 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:55:16.764120 [debug] [MainThread]: On master: Close
[0m17:55:16.764557 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:55:16.764906 [info ] [MainThread]: 
[0m17:55:16.768755 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m17:55:16.768922 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:55:16.769213 [info ] [Thread-1 (]: 1 of 3 START test below_depletion_level_tests_below_depletion_level_ ........... [RUN]
[0m17:55:16.769550 [info ] [Thread-2 (]: 2 of 3 START test not_null_below_depletion_level_name .......................... [RUN]
[0m17:55:16.770015 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m17:55:16.770505 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:55:16.770852 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m17:55:16.771128 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:55:16.771431 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m17:55:16.771671 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:55:16.775883 [debug] [Thread-1 (]: finished collecting timing info
[0m17:55:16.785441 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:55:16.786050 [debug] [Thread-1 (]: Compilation Error in test below_depletion_level_tests_below_depletion_level_ (models/below_depletion_level/below_depletion_level_tests.yml)
  'test_below_depletion_level_tests' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:55:16.786785 [error] [Thread-1 (]: 1 of 3 ERROR below_depletion_level_tests_below_depletion_level_ ................ [[31mERROR[0m in 0.02s]
[0m17:55:16.787826 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m17:55:16.788253 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:55:16.788662 [debug] [Thread-2 (]: finished collecting timing info
[0m17:55:16.788767 [info ] [Thread-1 (]: 3 of 3 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m17:55:16.789058 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:55:16.789553 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:55:16.802479 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:55:16.802643 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:55:16.803255 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:55:16.806389 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:55:16.807077 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:55:16.807354 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m17:55:16.807576 [debug] [Thread-1 (]: finished collecting timing info
[0m17:55:16.807668 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:55:16.807936 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:55:16.810141 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:55:16.811042 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:55:16.811246 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m17:55:16.811453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:16.814681 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m17:55:16.815014 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:55:16.815350 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m17:55:16.818206 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m17:55:16.819310 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:55:16.819542 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m17:55:16.821690 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m17:55:16.824322 [debug] [Thread-2 (]: finished collecting timing info
[0m17:55:16.824751 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m17:55:16.825164 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m17:55:16.825654 [info ] [Thread-2 (]: 2 of 3 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.06s]
[0m17:55:16.826745 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:55:16.833105 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m17:55:16.834480 [debug] [Thread-1 (]: finished collecting timing info
[0m17:55:16.834731 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m17:55:16.835046 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m17:55:16.835454 [info ] [Thread-1 (]: 3 of 3 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.05s]
[0m17:55:16.835859 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:55:16.837806 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:55:16.838090 [debug] [MainThread]: Using postgres connection "master"
[0m17:55:16.838291 [debug] [MainThread]: On master: BEGIN
[0m17:55:16.838496 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:55:16.845340 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:55:16.845696 [debug] [MainThread]: On master: COMMIT
[0m17:55:16.845927 [debug] [MainThread]: Using postgres connection "master"
[0m17:55:16.846164 [debug] [MainThread]: On master: COMMIT
[0m17:55:16.846477 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:55:16.846718 [debug] [MainThread]: On master: Close
[0m17:55:16.847340 [info ] [MainThread]: 
[0m17:55:16.847656 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m17:55:16.847997 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:55:16.848275 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1' was properly closed.
[0m17:55:16.848495 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9' was properly closed.
[0m17:55:16.854389 [info ] [MainThread]: 
[0m17:55:16.854699 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:55:16.855083 [info ] [MainThread]: 
[0m17:55:16.855374 [error] [MainThread]: [33mCompilation Error in test below_depletion_level_tests_below_depletion_level_ (models/below_depletion_level/below_depletion_level_tests.yml)[0m
[0m17:55:16.855665 [error] [MainThread]:   'test_below_depletion_level_tests' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:55:16.855961 [info ] [MainThread]: 
[0m17:55:16.856294 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:55:16.856722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1f040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a78a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b9e620>]}


============================== 2024-07-14 17:56:21.155754 | 67a796ea-473c-4029-a719-771812231b16 ==============================
[0m17:56:21.156072 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:56:21.173202 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m17:56:21.173507 [debug] [MainThread]: Tracking: tracking
[0m17:56:21.187497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c15d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c14c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c17e80>]}
[0m17:56:21.239757 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m17:56:21.240353 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://macros/below_depletion_level_tests.sql
[0m17:56:21.240622 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://macros/custom_tests.sql
[0m17:56:21.240866 [debug] [MainThread]: Parsing macros/below_depletion_level_tests.sql
[0m17:56:21.253262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67a796ea-473c-4029-a719-771812231b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99d5a80>]}
[0m17:56:21.263943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67a796ea-473c-4029-a719-771812231b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b6ffa0>]}
[0m17:56:21.264370 [info ] [MainThread]: Found 4 models, 3 tests, 2 snapshots, 0 analyses, 257 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:56:21.264711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67a796ea-473c-4029-a719-771812231b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b5d0f0>]}
[0m17:56:21.266335 [info ] [MainThread]: 
[0m17:56:21.266936 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:56:21.269554 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m17:56:21.278094 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:56:21.278454 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:56:21.278697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:21.322926 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m17:56:21.323449 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:56:21.323737 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:56:21.331230 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.01 seconds
[0m17:56:21.334056 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:56:21.334638 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:56:21.339644 [debug] [MainThread]: Using postgres connection "master"
[0m17:56:21.340091 [debug] [MainThread]: On master: BEGIN
[0m17:56:21.340327 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:56:21.347896 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:56:21.348302 [debug] [MainThread]: Using postgres connection "master"
[0m17:56:21.348486 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:56:21.353607 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m17:56:21.355145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67a796ea-473c-4029-a719-771812231b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1ceb0>]}
[0m17:56:21.355480 [debug] [MainThread]: On master: ROLLBACK
[0m17:56:21.355725 [debug] [MainThread]: Using postgres connection "master"
[0m17:56:21.355910 [debug] [MainThread]: On master: BEGIN
[0m17:56:21.356189 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:56:21.356551 [debug] [MainThread]: On master: COMMIT
[0m17:56:21.356921 [debug] [MainThread]: Using postgres connection "master"
[0m17:56:21.357393 [debug] [MainThread]: On master: COMMIT
[0m17:56:21.357729 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:56:21.358005 [debug] [MainThread]: On master: Close
[0m17:56:21.358398 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:56:21.358635 [info ] [MainThread]: 
[0m17:56:21.362939 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m17:56:21.363116 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:56:21.363465 [info ] [Thread-1 (]: 1 of 3 START test below_depletion_level_tests_below_depletion_level_ ........... [RUN]
[0m17:56:21.363896 [info ] [Thread-2 (]: 2 of 3 START test not_null_below_depletion_level_name .......................... [RUN]
[0m17:56:21.364504 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m17:56:21.366178 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:56:21.367603 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m17:56:21.368115 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:56:21.368687 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m17:56:21.368964 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:56:21.390890 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:56:21.391870 [debug] [Thread-1 (]: finished collecting timing info
[0m17:56:21.392730 [debug] [Thread-1 (]: Compilation Error in test below_depletion_level_tests_below_depletion_level_ (models/below_depletion_level/below_depletion_level_tests.yml)
  'test_below_depletion_level_tests' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:56:21.393908 [error] [Thread-1 (]: 1 of 3 ERROR below_depletion_level_tests_below_depletion_level_ ................ [[31mERROR[0m in 0.03s]
[0m17:56:21.394649 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m17:56:21.395199 [debug] [Thread-2 (]: finished collecting timing info
[0m17:56:21.395533 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:56:21.395968 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:56:21.396231 [info ] [Thread-1 (]: 3 of 3 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m17:56:21.409366 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:56:21.409918 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:56:21.410376 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:56:21.410564 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:56:21.414238 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:56:21.414679 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:56:21.415113 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m17:56:21.415366 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:56:21.415464 [debug] [Thread-1 (]: finished collecting timing info
[0m17:56:21.415953 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:56:21.417726 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:56:21.418711 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:56:21.418930 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m17:56:21.419162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:21.422642 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m17:56:21.423577 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:56:21.423971 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m17:56:21.425840 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m17:56:21.426234 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:56:21.426487 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m17:56:21.432072 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m17:56:21.434903 [debug] [Thread-2 (]: finished collecting timing info
[0m17:56:21.435264 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m17:56:21.435650 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m17:56:21.436170 [info ] [Thread-2 (]: 2 of 3 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.07s]
[0m17:56:21.436695 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:56:21.438556 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m17:56:21.439785 [debug] [Thread-1 (]: finished collecting timing info
[0m17:56:21.440050 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m17:56:21.440380 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m17:56:21.440783 [info ] [Thread-1 (]: 3 of 3 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.03s]
[0m17:56:21.441192 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:56:21.443098 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:56:21.443332 [debug] [MainThread]: Using postgres connection "master"
[0m17:56:21.443509 [debug] [MainThread]: On master: BEGIN
[0m17:56:21.443666 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:56:21.449969 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:56:21.450445 [debug] [MainThread]: On master: COMMIT
[0m17:56:21.450658 [debug] [MainThread]: Using postgres connection "master"
[0m17:56:21.450858 [debug] [MainThread]: On master: COMMIT
[0m17:56:21.451186 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:56:21.451371 [debug] [MainThread]: On master: Close
[0m17:56:21.451980 [info ] [MainThread]: 
[0m17:56:21.452281 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m17:56:21.452614 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:56:21.452863 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1' was properly closed.
[0m17:56:21.453055 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9' was properly closed.
[0m17:56:21.459072 [info ] [MainThread]: 
[0m17:56:21.459319 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:56:21.459703 [info ] [MainThread]: 
[0m17:56:21.460036 [error] [MainThread]: [33mCompilation Error in test below_depletion_level_tests_below_depletion_level_ (models/below_depletion_level/below_depletion_level_tests.yml)[0m
[0m17:56:21.460323 [error] [MainThread]:   'test_below_depletion_level_tests' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:56:21.460586 [info ] [MainThread]: 
[0m17:56:21.460886 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:56:21.461265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b5d090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a19e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a1a620>]}


============================== 2024-07-14 17:58:01.468708 | 934a3367-df73-457a-9d72-918ba389f09c ==============================
[0m17:58:01.469010 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:58:01.487556 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m17:58:01.487994 [debug] [MainThread]: Tracking: tracking
[0m17:58:01.502841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c262c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c273a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c26710>]}
[0m17:58:01.551746 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:58:01.552102 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:58:01.558110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '934a3367-df73-457a-9d72-918ba389f09c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bb5480>]}
[0m17:58:01.569325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '934a3367-df73-457a-9d72-918ba389f09c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae3550>]}
[0m17:58:01.569874 [info ] [MainThread]: Found 4 models, 3 tests, 2 snapshots, 0 analyses, 257 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:58:01.570245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '934a3367-df73-457a-9d72-918ba389f09c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae3670>]}
[0m17:58:01.572325 [info ] [MainThread]: 
[0m17:58:01.573052 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:58:01.576411 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m17:58:01.586196 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:58:01.586563 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:58:01.586823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:01.633693 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m17:58:01.634249 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:58:01.634633 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:58:01.638734 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m17:58:01.640601 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:58:01.641017 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:58:01.645726 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:01.646044 [debug] [MainThread]: On master: BEGIN
[0m17:58:01.646276 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:58:01.652991 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:58:01.653602 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:01.653854 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:58:01.658203 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m17:58:01.659610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '934a3367-df73-457a-9d72-918ba389f09c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae0a90>]}
[0m17:58:01.660003 [debug] [MainThread]: On master: ROLLBACK
[0m17:58:01.660596 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:01.660835 [debug] [MainThread]: On master: BEGIN
[0m17:58:01.661202 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:58:01.661543 [debug] [MainThread]: On master: COMMIT
[0m17:58:01.661764 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:01.661972 [debug] [MainThread]: On master: COMMIT
[0m17:58:01.662272 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:58:01.662501 [debug] [MainThread]: On master: Close
[0m17:58:01.662903 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:58:01.663888 [info ] [MainThread]: 
[0m17:58:01.667777 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m17:58:01.667926 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:58:01.668195 [info ] [Thread-1 (]: 1 of 3 START test below_depletion_level_tests_below_depletion_level_ ........... [RUN]
[0m17:58:01.668546 [info ] [Thread-2 (]: 2 of 3 START test not_null_below_depletion_level_name .......................... [RUN]
[0m17:58:01.669038 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m17:58:01.669584 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:58:01.669934 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m17:58:01.670179 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:58:01.670479 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m17:58:01.670731 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:58:01.677773 [debug] [Thread-1 (]: finished collecting timing info
[0m17:58:01.688879 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:58:01.689399 [debug] [Thread-1 (]: Compilation Error in test below_depletion_level_tests_below_depletion_level_ (models/below_depletion_level/below_depletion_level_tests.yml)
  'test_below_depletion_level_tests' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:58:01.690082 [error] [Thread-1 (]: 1 of 3 ERROR below_depletion_level_tests_below_depletion_level_ ................ [[31mERROR[0m in 0.02s]
[0m17:58:01.691136 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m17:58:01.691596 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:58:01.691800 [debug] [Thread-2 (]: finished collecting timing info
[0m17:58:01.692010 [info ] [Thread-1 (]: 3 of 3 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m17:58:01.692278 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:58:01.692723 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:58:01.705444 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:58:01.705838 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:58:01.706438 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:58:01.710237 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:58:01.711223 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:58:01.711470 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m17:58:01.711645 [debug] [Thread-1 (]: finished collecting timing info
[0m17:58:01.711820 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:58:01.712101 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:58:01.714808 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:58:01.715771 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:58:01.715973 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m17:58:01.716181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:01.720137 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m17:58:01.720555 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m17:58:01.720781 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m17:58:01.722655 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m17:58:01.723000 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m17:58:01.723223 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m17:58:01.727025 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m17:58:01.733028 [debug] [Thread-2 (]: finished collecting timing info
[0m17:58:01.733384 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m17:58:01.733803 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m17:58:01.734434 [info ] [Thread-2 (]: 2 of 3 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.06s]
[0m17:58:01.735169 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m17:58:01.735334 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m17:58:01.736839 [debug] [Thread-1 (]: finished collecting timing info
[0m17:58:01.737100 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m17:58:01.737416 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m17:58:01.737829 [info ] [Thread-1 (]: 3 of 3 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.05s]
[0m17:58:01.738634 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m17:58:01.740448 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:58:01.740727 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:01.740962 [debug] [MainThread]: On master: BEGIN
[0m17:58:01.741171 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:58:01.748946 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:58:01.749280 [debug] [MainThread]: On master: COMMIT
[0m17:58:01.749525 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:01.749792 [debug] [MainThread]: On master: COMMIT
[0m17:58:01.750078 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:58:01.750319 [debug] [MainThread]: On master: Close
[0m17:58:01.750937 [info ] [MainThread]: 
[0m17:58:01.751248 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m17:58:01.751622 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:58:01.751888 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1' was properly closed.
[0m17:58:01.752090 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9' was properly closed.
[0m17:58:01.758599 [info ] [MainThread]: 
[0m17:58:01.758898 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:58:01.759228 [info ] [MainThread]: 
[0m17:58:01.759535 [error] [MainThread]: [33mCompilation Error in test below_depletion_level_tests_below_depletion_level_ (models/below_depletion_level/below_depletion_level_tests.yml)[0m
[0m17:58:01.759799 [error] [MainThread]:   'test_below_depletion_level_tests' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:58:01.760081 [info ] [MainThread]: 
[0m17:58:01.760352 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:58:01.760737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bb4160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a73430>]}


============================== 2024-07-14 18:00:09.958416 | 110dbdc1-03f4-40e9-97c2-8dcf2005ef74 ==============================
[0m18:00:09.958718 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:00:09.975340 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m18:00:09.975808 [debug] [MainThread]: Tracking: tracking
[0m18:00:09.990672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2dd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2cc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2fdc0>]}
[0m18:00:10.038850 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m18:00:10.039506 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://macros/depletion_test.sql
[0m18:00:10.039811 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://macros/below_depletion_level_tests.sql
[0m18:00:10.040075 [debug] [MainThread]: Parsing macros/depletion_test.sql
[0m18:00:10.052501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '110dbdc1-03f4-40e9-97c2-8dcf2005ef74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99d5a50>]}
[0m18:00:10.062234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '110dbdc1-03f4-40e9-97c2-8dcf2005ef74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b6ffd0>]}
[0m18:00:10.062639 [info ] [MainThread]: Found 4 models, 3 tests, 2 snapshots, 0 analyses, 257 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:00:10.062956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '110dbdc1-03f4-40e9-97c2-8dcf2005ef74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b5d0c0>]}
[0m18:00:10.064646 [info ] [MainThread]: 
[0m18:00:10.065273 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:00:10.067879 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m18:00:10.076224 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:00:10.076535 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:00:10.076766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:10.121832 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m18:00:10.122366 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:00:10.122643 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:00:10.126773 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m18:00:10.128474 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:00:10.128885 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:00:10.133793 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:10.134114 [debug] [MainThread]: On master: BEGIN
[0m18:00:10.134367 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:00:10.143821 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:00:10.144213 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:10.144449 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:00:10.150263 [debug] [MainThread]: SQL status: SELECT 11 in 0.01 seconds
[0m18:00:10.151633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '110dbdc1-03f4-40e9-97c2-8dcf2005ef74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2a290>]}
[0m18:00:10.151995 [debug] [MainThread]: On master: ROLLBACK
[0m18:00:10.152307 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:10.152517 [debug] [MainThread]: On master: BEGIN
[0m18:00:10.152898 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:00:10.153275 [debug] [MainThread]: On master: COMMIT
[0m18:00:10.153497 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:10.153706 [debug] [MainThread]: On master: COMMIT
[0m18:00:10.153992 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:00:10.154213 [debug] [MainThread]: On master: Close
[0m18:00:10.154603 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:00:10.154896 [info ] [MainThread]: 
[0m18:00:10.158161 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:00:10.158303 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:00:10.158566 [info ] [Thread-1 (]: 1 of 3 START test below_depletion_level_tests_below_depletion_level_ ........... [RUN]
[0m18:00:10.158878 [info ] [Thread-2 (]: 2 of 3 START test not_null_below_depletion_level_name .......................... [RUN]
[0m18:00:10.159337 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:00:10.160282 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:00:10.160635 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:00:10.160890 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:00:10.161163 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:00:10.161429 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:00:10.168703 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:00:10.176392 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:00:10.179026 [debug] [Thread-1 (]: finished collecting timing info
[0m18:00:10.179312 [debug] [Thread-2 (]: finished collecting timing info
[0m18:00:10.179425 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:00:10.179665 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:00:10.191913 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:00:10.193763 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:00:10.196021 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:00:10.196339 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m18:00:10.196448 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:00:10.196638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:10.196889 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m18:00:10.197529 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:00:10.203660 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:00:10.203992 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:00:10.204112 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:00:10.204382 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:00:10.204608 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT *
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level >= depletion_level
    )
    SELECT 
        COUNT(*)
    FROM test_data
    WHERE COUNT(*) > 0;

      
    ) dbt_internal_test
[0m18:00:10.204809 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m18:00:10.205570 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 16:     WHERE COUNT(*) > 0;
                               ^

[0m18:00:10.205840 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m18:00:10.206270 [debug] [Thread-1 (]: finished collecting timing info
[0m18:00:10.206519 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m18:00:10.206966 [debug] [Thread-1 (]: Database Error in test below_depletion_level_tests_below_depletion_level_ (models/below_depletion_level/below_depletion_level_tests.yml)
  syntax error at or near ";"
  LINE 16:     WHERE COUNT(*) > 0;
                                 ^
  compiled SQL at target/run/jaffle_shop/models/below_depletion_level/below_depletion_level_tests.yml/below_depletion_level_tests_below_depletion_level_.sql
[0m18:00:10.207568 [error] [Thread-1 (]: 1 of 3 ERROR below_depletion_level_tests_below_depletion_level_ ................ [[31mERROR[0m in 0.05s]
[0m18:00:10.208179 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:00:10.208555 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:00:10.208958 [info ] [Thread-1 (]: 3 of 3 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m18:00:10.209542 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:00:10.209932 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:00:10.210207 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:00:10.213560 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:00:10.213710 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:00:10.216354 [debug] [Thread-2 (]: finished collecting timing info
[0m18:00:10.216671 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m18:00:10.216839 [debug] [Thread-1 (]: finished collecting timing info
[0m18:00:10.217136 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m18:00:10.217228 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:00:10.217628 [info ] [Thread-2 (]: 2 of 3 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.06s]
[0m18:00:10.219378 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:00:10.219928 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:00:10.221161 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:00:10.221358 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m18:00:10.221574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:10.230069 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:00:10.230440 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:00:10.230669 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m18:00:10.245675 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:00:10.247817 [debug] [Thread-1 (]: finished collecting timing info
[0m18:00:10.248151 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m18:00:10.248492 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m18:00:10.248923 [info ] [Thread-1 (]: 3 of 3 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.04s]
[0m18:00:10.249420 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:00:10.251316 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:00:10.251603 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:10.251836 [debug] [MainThread]: On master: BEGIN
[0m18:00:10.252090 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:00:10.259192 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:00:10.259665 [debug] [MainThread]: On master: COMMIT
[0m18:00:10.259899 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:10.260139 [debug] [MainThread]: On master: COMMIT
[0m18:00:10.260485 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:00:10.260722 [debug] [MainThread]: On master: Close
[0m18:00:10.261352 [info ] [MainThread]: 
[0m18:00:10.261686 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m18:00:10.262070 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:10.262383 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1' was properly closed.
[0m18:00:10.262603 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9' was properly closed.
[0m18:00:10.269579 [info ] [MainThread]: 
[0m18:00:10.269897 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:00:10.270233 [info ] [MainThread]: 
[0m18:00:10.270530 [error] [MainThread]: [33mDatabase Error in test below_depletion_level_tests_below_depletion_level_ (models/below_depletion_level/below_depletion_level_tests.yml)[0m
[0m18:00:10.270795 [error] [MainThread]:   syntax error at or near ";"
[0m18:00:10.271048 [error] [MainThread]:   LINE 16:     WHERE COUNT(*) > 0;
[0m18:00:10.271320 [error] [MainThread]:                                  ^
[0m18:00:10.271574 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/below_depletion_level/below_depletion_level_tests.yml/below_depletion_level_tests_below_depletion_level_.sql
[0m18:00:10.271840 [info ] [MainThread]: 
[0m18:00:10.272101 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m18:00:10.272536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b5d060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a8ff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a97850>]}


============================== 2024-07-14 18:00:25.408985 | c1ef91bd-0e4d-497f-884b-67cd650da176 ==============================
[0m18:00:25.409305 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:00:25.412861 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m18:00:25.413330 [debug] [MainThread]: Tracking: tracking
[0m18:00:25.427889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c262c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c273a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c26710>]}
[0m18:00:25.481401 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:00:25.482070 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://macros/depletion_test.sql
[0m18:00:25.482407 [debug] [MainThread]: Parsing macros/depletion_test.sql
[0m18:00:25.494514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1ef91bd-0e4d-497f-884b-67cd650da176', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99d5b10>]}
[0m18:00:25.504192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1ef91bd-0e4d-497f-884b-67cd650da176', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae3790>]}
[0m18:00:25.504619 [info ] [MainThread]: Found 4 models, 3 tests, 2 snapshots, 0 analyses, 257 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:00:25.504968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1ef91bd-0e4d-497f-884b-67cd650da176', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b610f0>]}
[0m18:00:25.506736 [info ] [MainThread]: 
[0m18:00:25.507386 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:00:25.510155 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m18:00:25.518417 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:00:25.518760 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:00:25.519000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:25.562211 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m18:00:25.562697 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:00:25.562949 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:00:25.566965 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m18:00:25.568645 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:00:25.569043 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:00:25.573737 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:25.574109 [debug] [MainThread]: On master: BEGIN
[0m18:00:25.574361 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:00:25.580638 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:00:25.581000 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:25.581282 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:00:25.585626 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m18:00:25.586937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1ef91bd-0e4d-497f-884b-67cd650da176', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae0ac0>]}
[0m18:00:25.587303 [debug] [MainThread]: On master: ROLLBACK
[0m18:00:25.587613 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:25.587827 [debug] [MainThread]: On master: BEGIN
[0m18:00:25.588224 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:00:25.588535 [debug] [MainThread]: On master: COMMIT
[0m18:00:25.588758 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:25.588964 [debug] [MainThread]: On master: COMMIT
[0m18:00:25.589268 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:00:25.589515 [debug] [MainThread]: On master: Close
[0m18:00:25.589891 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:00:25.590210 [info ] [MainThread]: 
[0m18:00:25.593409 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:00:25.593557 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:00:25.593808 [info ] [Thread-1 (]: 1 of 3 START test below_depletion_level_tests_below_depletion_level_ ........... [RUN]
[0m18:00:25.594148 [info ] [Thread-2 (]: 2 of 3 START test not_null_below_depletion_level_name .......................... [RUN]
[0m18:00:25.594633 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:00:25.595562 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:00:25.595894 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:00:25.596147 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:00:25.596407 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:00:25.596638 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:00:25.603473 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:00:25.610013 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:00:25.612111 [debug] [Thread-2 (]: finished collecting timing info
[0m18:00:25.612250 [debug] [Thread-1 (]: finished collecting timing info
[0m18:00:25.612519 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:00:25.612787 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:00:25.627174 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:00:25.628937 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:00:25.630377 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:00:25.630507 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:00:25.630697 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m18:00:25.630900 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m18:00:25.631116 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:00:25.631355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:25.638447 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:00:25.638978 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:00:25.639090 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:00:25.639350 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:00:25.639573 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT *
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level >= depletion_level
    )
    SELECT 
        COUNT(*)
    FROM test_data
    WHERE COUNT(*) > 0

      
    ) dbt_internal_test
[0m18:00:25.639795 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m18:00:25.641418 [debug] [Thread-1 (]: Postgres adapter: Postgres error: aggregate functions are not allowed in WHERE
LINE 16:     WHERE COUNT(*) > 0
                   ^

[0m18:00:25.644451 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m18:00:25.645136 [debug] [Thread-1 (]: finished collecting timing info
[0m18:00:25.645486 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m18:00:25.646030 [debug] [Thread-1 (]: Database Error in test below_depletion_level_tests_below_depletion_level_ (models/below_depletion_level/below_depletion_level_tests.yml)
  aggregate functions are not allowed in WHERE
  LINE 16:     WHERE COUNT(*) > 0
                     ^
  compiled SQL at target/run/jaffle_shop/models/below_depletion_level/below_depletion_level_tests.yml/below_depletion_level_tests_below_depletion_level_.sql
[0m18:00:25.646204 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:00:25.646535 [error] [Thread-1 (]: 1 of 3 ERROR below_depletion_level_tests_below_depletion_level_ ................ [[31mERROR[0m in 0.05s]
[0m18:00:25.648787 [debug] [Thread-2 (]: finished collecting timing info
[0m18:00:25.649336 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:00:25.649561 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m18:00:25.649841 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:00:25.650302 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m18:00:25.650521 [info ] [Thread-1 (]: 3 of 3 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m18:00:25.650959 [info ] [Thread-2 (]: 2 of 3 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.06s]
[0m18:00:25.651646 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:00:25.652082 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:00:25.652397 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:00:25.652851 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:00:25.656685 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:00:25.658078 [debug] [Thread-1 (]: finished collecting timing info
[0m18:00:25.658575 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:00:25.660110 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:00:25.661503 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:00:25.661713 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m18:00:25.661959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:25.668275 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:00:25.668631 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:00:25.668951 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m18:00:25.681761 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:00:25.683516 [debug] [Thread-1 (]: finished collecting timing info
[0m18:00:25.683816 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m18:00:25.684174 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m18:00:25.684604 [info ] [Thread-1 (]: 3 of 3 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.03s]
[0m18:00:25.685039 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:00:25.687385 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:00:25.687719 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:25.687957 [debug] [MainThread]: On master: BEGIN
[0m18:00:25.688181 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:00:25.694287 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:00:25.694647 [debug] [MainThread]: On master: COMMIT
[0m18:00:25.694873 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:25.695084 [debug] [MainThread]: On master: COMMIT
[0m18:00:25.695409 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:00:25.695635 [debug] [MainThread]: On master: Close
[0m18:00:25.696240 [info ] [MainThread]: 
[0m18:00:25.696582 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m18:00:25.697005 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:25.697301 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1' was properly closed.
[0m18:00:25.697539 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9' was properly closed.
[0m18:00:25.703632 [info ] [MainThread]: 
[0m18:00:25.703978 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:00:25.704416 [info ] [MainThread]: 
[0m18:00:25.704756 [error] [MainThread]: [33mDatabase Error in test below_depletion_level_tests_below_depletion_level_ (models/below_depletion_level/below_depletion_level_tests.yml)[0m
[0m18:00:25.705063 [error] [MainThread]:   aggregate functions are not allowed in WHERE
[0m18:00:25.705375 [error] [MainThread]:   LINE 16:     WHERE COUNT(*) > 0
[0m18:00:25.705654 [error] [MainThread]:                      ^
[0m18:00:25.705939 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/below_depletion_level/below_depletion_level_tests.yml/below_depletion_level_tests_below_depletion_level_.sql
[0m18:00:25.706277 [info ] [MainThread]: 
[0m18:00:25.706562 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m18:00:25.706957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b61090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a19990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a19810>]}


============================== 2024-07-14 18:01:13.690824 | 26ffa515-8e0f-401b-946c-1a56dfe515de ==============================
[0m18:01:13.691122 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:01:13.718329 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m18:01:13.718758 [debug] [MainThread]: Tracking: tracking
[0m18:01:13.733772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2bf70>]}
[0m18:01:13.780631 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:01:13.781349 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://macros/depletion_test.sql
[0m18:01:13.781646 [debug] [MainThread]: Parsing macros/depletion_test.sql
[0m18:01:13.793738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26ffa515-8e0f-401b-946c-1a56dfe515de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99d5b40>]}
[0m18:01:13.803478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26ffa515-8e0f-401b-946c-1a56dfe515de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae77c0>]}
[0m18:01:13.803979 [info ] [MainThread]: Found 4 models, 3 tests, 2 snapshots, 0 analyses, 257 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:01:13.804378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26ffa515-8e0f-401b-946c-1a56dfe515de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b5d120>]}
[0m18:01:13.806918 [info ] [MainThread]: 
[0m18:01:13.807559 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:01:13.810535 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m18:01:13.819270 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:01:13.819650 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:01:13.819898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:13.866048 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m18:01:13.869975 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:01:13.871656 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:01:13.877454 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m18:01:13.879434 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:01:13.880548 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:01:13.885743 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:13.886138 [debug] [MainThread]: On master: BEGIN
[0m18:01:13.886471 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:01:13.894080 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:01:13.894672 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:13.894977 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:01:13.904141 [debug] [MainThread]: SQL status: SELECT 11 in 0.01 seconds
[0m18:01:13.905724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26ffa515-8e0f-401b-946c-1a56dfe515de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae4af0>]}
[0m18:01:13.906089 [debug] [MainThread]: On master: ROLLBACK
[0m18:01:13.906403 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:13.906632 [debug] [MainThread]: On master: BEGIN
[0m18:01:13.907001 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:01:13.907345 [debug] [MainThread]: On master: COMMIT
[0m18:01:13.907602 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:13.907835 [debug] [MainThread]: On master: COMMIT
[0m18:01:13.908173 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:01:13.908437 [debug] [MainThread]: On master: Close
[0m18:01:13.908874 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:01:13.909196 [info ] [MainThread]: 
[0m18:01:13.914365 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:01:13.914618 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:01:13.915153 [info ] [Thread-1 (]: 1 of 3 START test below_depletion_level_tests_below_depletion_level_ ........... [RUN]
[0m18:01:13.915705 [info ] [Thread-2 (]: 2 of 3 START test not_null_below_depletion_level_name .......................... [RUN]
[0m18:01:13.917985 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:01:13.920752 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:01:13.921213 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:01:13.921472 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:01:13.921722 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:01:13.921942 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:01:13.929050 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:01:13.936000 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:01:13.938199 [debug] [Thread-1 (]: finished collecting timing info
[0m18:01:13.938301 [debug] [Thread-2 (]: finished collecting timing info
[0m18:01:13.938523 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:01:13.938746 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:01:13.951103 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:01:13.952525 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:01:13.954434 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:01:13.954561 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:01:13.954803 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m18:01:13.955050 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m18:01:13.955299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:13.955538 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:01:13.962488 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:01:13.962680 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:01:13.962949 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:01:13.963193 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:01:13.963403 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT *
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        COUNT(*)
    FROM test_data

      
    ) dbt_internal_test
[0m18:01:13.963670 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m18:01:13.978041 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:01:13.980810 [debug] [Thread-2 (]: finished collecting timing info
[0m18:01:13.981164 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m18:01:13.981589 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m18:01:13.982128 [info ] [Thread-2 (]: 2 of 3 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.06s]
[0m18:01:13.982982 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:01:13.983546 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:01:13.983942 [info ] [Thread-2 (]: 3 of 3 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m18:01:13.984555 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:01:13.984880 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:01:13.985130 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:01:13.989026 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:01:13.989299 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m18:01:13.991303 [debug] [Thread-1 (]: finished collecting timing info
[0m18:01:13.991683 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m18:01:13.992047 [debug] [Thread-2 (]: finished collecting timing info
[0m18:01:13.992183 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m18:01:13.992432 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:01:13.992904 [error] [Thread-1 (]: 1 of 3 FAIL 1 below_depletion_level_tests_below_depletion_level_ ............... [[31mFAIL 1[0m in 0.08s]
[0m18:01:13.994816 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:01:13.995335 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:01:13.996570 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:01:13.996797 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m18:01:13.996985 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:01:14.003626 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:01:14.003967 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:01:14.004197 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m18:01:14.010264 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:01:14.011837 [debug] [Thread-2 (]: finished collecting timing info
[0m18:01:14.012107 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m18:01:14.012510 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m18:01:14.012945 [info ] [Thread-2 (]: 3 of 3 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.03s]
[0m18:01:14.013396 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:01:14.015438 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:01:14.015723 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:14.015966 [debug] [MainThread]: On master: BEGIN
[0m18:01:14.016196 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:01:14.022451 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:01:14.022858 [debug] [MainThread]: On master: COMMIT
[0m18:01:14.023096 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:14.023359 [debug] [MainThread]: On master: COMMIT
[0m18:01:14.023662 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:01:14.023890 [debug] [MainThread]: On master: Close
[0m18:01:14.024564 [info ] [MainThread]: 
[0m18:01:14.024915 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m18:01:14.025322 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:14.025577 [debug] [MainThread]: Connection 'test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e' was properly closed.
[0m18:01:14.025902 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1' was properly closed.
[0m18:01:14.031895 [info ] [MainThread]: 
[0m18:01:14.032208 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:01:14.032634 [info ] [MainThread]: 
[0m18:01:14.033042 [error] [MainThread]: [31mFailure in test below_depletion_level_tests_below_depletion_level_ (models/below_depletion_level/below_depletion_level_tests.yml)[0m
[0m18:01:14.033429 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:01:14.033718 [info ] [MainThread]: 
[0m18:01:14.033997 [info ] [MainThread]:   compiled SQL at target/compiled/jaffle_shop/models/below_depletion_level/below_depletion_level_tests.yml/below_depletion_level_tests_below_depletion_level_.sql
[0m18:01:14.034299 [info ] [MainThread]: 
[0m18:01:14.034585 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m18:01:14.034967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b5d0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a8e3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a8fa30>]}


============================== 2024-07-14 18:02:00.193254 | 5dce9d8b-7a6c-4d7f-8a89-442c39b87332 ==============================
[0m18:02:00.193560 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:02:00.208239 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m18:02:00.208537 [debug] [MainThread]: Tracking: tracking
[0m18:02:00.224293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2bf70>]}
[0m18:02:00.279085 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:02:00.280049 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://macros/depletion_test.sql
[0m18:02:00.281233 [debug] [MainThread]: Parsing macros/depletion_test.sql
[0m18:02:00.303074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dce9d8b-7a6c-4d7f-8a89-442c39b87332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99d5b40>]}
[0m18:02:00.314464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dce9d8b-7a6c-4d7f-8a89-442c39b87332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae37c0>]}
[0m18:02:00.314895 [info ] [MainThread]: Found 4 models, 3 tests, 2 snapshots, 0 analyses, 257 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:02:00.315256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dce9d8b-7a6c-4d7f-8a89-442c39b87332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b61120>]}
[0m18:02:00.316927 [info ] [MainThread]: 
[0m18:02:00.317519 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:02:00.320154 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m18:02:00.332320 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:02:00.333201 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:02:00.333700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:02:00.378930 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m18:02:00.379434 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:02:00.379694 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:02:00.383502 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m18:02:00.385226 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:02:00.385632 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:02:00.390046 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:00.390361 [debug] [MainThread]: On master: BEGIN
[0m18:02:00.390602 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:02:00.396900 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:02:00.397251 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:00.397494 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:02:00.401768 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m18:02:00.403105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dce9d8b-7a6c-4d7f-8a89-442c39b87332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae0af0>]}
[0m18:02:00.403463 [debug] [MainThread]: On master: ROLLBACK
[0m18:02:00.403779 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:00.404004 [debug] [MainThread]: On master: BEGIN
[0m18:02:00.404399 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:02:00.404671 [debug] [MainThread]: On master: COMMIT
[0m18:02:00.404908 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:00.405111 [debug] [MainThread]: On master: COMMIT
[0m18:02:00.405387 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:02:00.405605 [debug] [MainThread]: On master: Close
[0m18:02:00.405998 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:02:00.406305 [info ] [MainThread]: 
[0m18:02:00.409992 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:02:00.410137 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:02:00.410400 [info ] [Thread-1 (]: 1 of 3 START test below_depletion_level_tests_below_depletion_level_ ........... [RUN]
[0m18:02:00.410727 [info ] [Thread-2 (]: 2 of 3 START test not_null_below_depletion_level_name .......................... [RUN]
[0m18:02:00.411243 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:02:00.412172 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:02:00.412514 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:02:00.412755 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:02:00.413023 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:02:00.413263 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:02:00.420247 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:02:00.426953 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:02:00.428608 [debug] [Thread-2 (]: finished collecting timing info
[0m18:02:00.428724 [debug] [Thread-1 (]: finished collecting timing info
[0m18:02:00.428929 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:02:00.429166 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:02:00.441568 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:02:00.443737 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:02:00.446023 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:02:00.446156 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:02:00.446371 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m18:02:00.446598 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m18:02:00.446811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:00.447019 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:02:00.453745 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:02:00.453896 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:02:00.454170 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:02:00.454427 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:02:00.454676 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        COUNT(errors)
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m18:02:00.454917 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m18:02:00.461377 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:02:00.464096 [debug] [Thread-2 (]: finished collecting timing info
[0m18:02:00.464447 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m18:02:00.464838 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m18:02:00.465365 [info ] [Thread-2 (]: 2 of 3 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.05s]
[0m18:02:00.466061 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:02:00.466425 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:02:00.466747 [info ] [Thread-2 (]: 3 of 3 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m18:02:00.467245 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:02:00.467476 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:02:00.467588 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:02:00.468802 [debug] [Thread-1 (]: finished collecting timing info
[0m18:02:00.469120 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:02:00.469386 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m18:02:00.472460 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:02:00.472871 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m18:02:00.473523 [error] [Thread-1 (]: 1 of 3 FAIL 1 below_depletion_level_tests_below_depletion_level_ ............... [[31mFAIL 1[0m in 0.06s]
[0m18:02:00.473993 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:02:00.474103 [debug] [Thread-2 (]: finished collecting timing info
[0m18:02:00.474649 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:02:00.476369 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:02:00.477277 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:02:00.477496 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m18:02:00.477701 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:02:00.483653 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:02:00.483947 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:02:00.484158 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m18:02:00.489527 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:02:00.490986 [debug] [Thread-2 (]: finished collecting timing info
[0m18:02:00.491258 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m18:02:00.491586 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m18:02:00.492014 [info ] [Thread-2 (]: 3 of 3 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.02s]
[0m18:02:00.492433 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:02:00.494256 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:02:00.494567 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:00.494791 [debug] [MainThread]: On master: BEGIN
[0m18:02:00.495018 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:02:00.501953 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:02:00.502342 [debug] [MainThread]: On master: COMMIT
[0m18:02:00.502574 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:00.502842 [debug] [MainThread]: On master: COMMIT
[0m18:02:00.503161 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:02:00.503390 [debug] [MainThread]: On master: Close
[0m18:02:00.504047 [info ] [MainThread]: 
[0m18:02:00.504364 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m18:02:00.504742 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:02:00.505003 [debug] [MainThread]: Connection 'test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e' was properly closed.
[0m18:02:00.505264 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1' was properly closed.
[0m18:02:00.511152 [info ] [MainThread]: 
[0m18:02:00.511500 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:02:00.511842 [info ] [MainThread]: 
[0m18:02:00.512192 [error] [MainThread]: [31mFailure in test below_depletion_level_tests_below_depletion_level_ (models/below_depletion_level/below_depletion_level_tests.yml)[0m
[0m18:02:00.512560 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:02:00.512894 [info ] [MainThread]: 
[0m18:02:00.513228 [info ] [MainThread]:   compiled SQL at target/compiled/jaffle_shop/models/below_depletion_level/below_depletion_level_tests.yml/below_depletion_level_tests_below_depletion_level_.sql
[0m18:02:00.513520 [info ] [MainThread]: 
[0m18:02:00.513788 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m18:02:00.514294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b610c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a8bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a7f850>]}


============================== 2024-07-14 18:02:15.602446 | fd44e606-482d-4fa9-847c-3c91f16621e5 ==============================
[0m18:02:15.602837 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:02:15.607429 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m18:02:15.607947 [debug] [MainThread]: Tracking: tracking
[0m18:02:15.622153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c15d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c14c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c15930>]}
[0m18:02:15.669291 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:02:15.669898 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://macros/depletion_test.sql
[0m18:02:15.670180 [debug] [MainThread]: Parsing macros/depletion_test.sql
[0m18:02:15.682105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd44e606-482d-4fa9-847c-3c91f16621e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99d5ae0>]}
[0m18:02:15.692544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd44e606-482d-4fa9-847c-3c91f16621e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae3760>]}
[0m18:02:15.693026 [info ] [MainThread]: Found 4 models, 3 tests, 2 snapshots, 0 analyses, 257 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:02:15.693388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd44e606-482d-4fa9-847c-3c91f16621e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b5d0c0>]}
[0m18:02:15.695133 [info ] [MainThread]: 
[0m18:02:15.695767 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:02:15.698640 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m18:02:15.707146 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:02:15.707514 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:02:15.707798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:02:15.751687 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m18:02:15.752208 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:02:15.752461 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:02:15.756311 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m18:02:15.758006 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:02:15.758412 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:02:15.762938 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:15.763315 [debug] [MainThread]: On master: BEGIN
[0m18:02:15.763567 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:02:15.770749 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:02:15.771144 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:15.771384 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:02:15.775942 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m18:02:15.777348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd44e606-482d-4fa9-847c-3c91f16621e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae0a90>]}
[0m18:02:15.777767 [debug] [MainThread]: On master: ROLLBACK
[0m18:02:15.778115 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:15.778334 [debug] [MainThread]: On master: BEGIN
[0m18:02:15.778721 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:02:15.779006 [debug] [MainThread]: On master: COMMIT
[0m18:02:15.779224 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:15.779430 [debug] [MainThread]: On master: COMMIT
[0m18:02:15.779726 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:02:15.779955 [debug] [MainThread]: On master: Close
[0m18:02:15.780371 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:02:15.780703 [info ] [MainThread]: 
[0m18:02:15.785113 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:02:15.785245 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:02:15.785508 [info ] [Thread-1 (]: 1 of 3 START test below_depletion_level_tests_below_depletion_level_ ........... [RUN]
[0m18:02:15.785811 [info ] [Thread-2 (]: 2 of 3 START test not_null_below_depletion_level_name .......................... [RUN]
[0m18:02:15.786254 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:02:15.787184 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:02:15.787466 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:02:15.787669 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:02:15.787884 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:02:15.788108 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:02:15.794953 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:02:15.801890 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:02:15.804363 [debug] [Thread-2 (]: finished collecting timing info
[0m18:02:15.804574 [debug] [Thread-1 (]: finished collecting timing info
[0m18:02:15.804795 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:02:15.805063 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:02:15.817924 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:02:15.819470 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:02:15.821170 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:02:15.821316 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:02:15.821526 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m18:02:15.821772 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m18:02:15.822035 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:02:15.822295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:15.828805 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:02:15.828986 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:02:15.829254 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:02:15.829494 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:02:15.829748 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m18:02:15.829990 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m18:02:15.836691 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:02:15.839382 [debug] [Thread-2 (]: finished collecting timing info
[0m18:02:15.839738 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m18:02:15.840112 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m18:02:15.840635 [info ] [Thread-2 (]: 2 of 3 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.05s]
[0m18:02:15.841278 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:02:15.841637 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:02:15.842007 [info ] [Thread-2 (]: 3 of 3 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m18:02:15.842485 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:02:15.842763 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:02:15.842880 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:02:15.844076 [debug] [Thread-1 (]: finished collecting timing info
[0m18:02:15.844350 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:02:15.844600 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m18:02:15.847719 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:02:15.848174 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m18:02:15.848758 [info ] [Thread-1 (]: 1 of 3 PASS below_depletion_level_tests_below_depletion_level_ ................. [[32mPASS[0m in 0.06s]
[0m18:02:15.849243 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:02:15.849345 [debug] [Thread-2 (]: finished collecting timing info
[0m18:02:15.849868 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:02:15.851504 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:02:15.852389 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:02:15.852605 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m18:02:15.852851 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:02:15.859081 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:02:15.859445 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:02:15.859677 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m18:02:15.865018 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:02:15.866495 [debug] [Thread-2 (]: finished collecting timing info
[0m18:02:15.866769 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m18:02:15.867103 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m18:02:15.867502 [info ] [Thread-2 (]: 3 of 3 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.03s]
[0m18:02:15.867984 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:02:15.869861 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:02:15.870190 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:15.870431 [debug] [MainThread]: On master: BEGIN
[0m18:02:15.870647 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:02:15.877361 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:02:15.877910 [debug] [MainThread]: On master: COMMIT
[0m18:02:15.878171 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:15.878404 [debug] [MainThread]: On master: COMMIT
[0m18:02:15.878704 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:02:15.878955 [debug] [MainThread]: On master: Close
[0m18:02:15.879603 [info ] [MainThread]: 
[0m18:02:15.879963 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m18:02:15.880308 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:02:15.880586 [debug] [MainThread]: Connection 'test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e' was properly closed.
[0m18:02:15.880810 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1' was properly closed.
[0m18:02:15.886826 [info ] [MainThread]: 
[0m18:02:15.887155 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:02:15.887615 [info ] [MainThread]: 
[0m18:02:15.887988 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:02:15.888424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b5d060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a7bc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a7bfd0>]}


============================== 2024-07-14 18:25:39.006051 | 5f6c38c5-8c17-4dfd-a034-3efd5b68a98a ==============================
[0m18:25:39.006387 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:25:39.024840 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m18:25:39.025389 [debug] [MainThread]: Tracking: tracking
[0m18:25:39.040823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1c880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1c490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1c5b0>]}
[0m18:25:39.099550 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 0 files changed.
[0m18:25:39.100157 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/hot_upsell/hot_upsell.sql
[0m18:25:39.100457 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://macros/upsell_test.sql
[0m18:25:39.100761 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/hot_upsell/hot_upsell_tests.yml
[0m18:25:39.101037 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://models/hot_upsell.sql
[0m18:25:39.101318 [debug] [MainThread]: Parsing macros/upsell_test.sql
[0m18:25:39.141789 [debug] [MainThread]: 1699: static parser successfully parsed hot_upsell/hot_upsell.sql
[0m18:25:39.194130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f6c38c5-8c17-4dfd-a034-3efd5b68a98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b878e0>]}
[0m18:25:39.206626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f6c38c5-8c17-4dfd-a034-3efd5b68a98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b6fe50>]}
[0m18:25:39.207038 [info ] [MainThread]: Found 4 models, 6 tests, 2 snapshots, 0 analyses, 258 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:25:39.207358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f6c38c5-8c17-4dfd-a034-3efd5b68a98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b5d360>]}
[0m18:25:39.209187 [info ] [MainThread]: 
[0m18:25:39.209780 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:25:39.212180 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m18:25:39.220442 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:25:39.220726 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:25:39.220954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:39.277730 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
[0m18:25:39.278274 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:25:39.278530 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:25:39.294035 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.02 seconds
[0m18:25:39.295835 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:25:39.296237 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:25:39.300901 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:39.301225 [debug] [MainThread]: On master: BEGIN
[0m18:25:39.301443 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:25:39.309226 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:25:39.309607 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:39.309859 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:25:39.316396 [debug] [MainThread]: SQL status: SELECT 11 in 0.01 seconds
[0m18:25:39.318062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f6c38c5-8c17-4dfd-a034-3efd5b68a98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c5a380>]}
[0m18:25:39.318459 [debug] [MainThread]: On master: ROLLBACK
[0m18:25:39.318795 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:39.319018 [debug] [MainThread]: On master: BEGIN
[0m18:25:39.319361 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:25:39.319697 [debug] [MainThread]: On master: COMMIT
[0m18:25:39.319903 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:39.320105 [debug] [MainThread]: On master: COMMIT
[0m18:25:39.320404 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:25:39.320619 [debug] [MainThread]: On master: Close
[0m18:25:39.321079 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:25:39.321425 [info ] [MainThread]: 
[0m18:25:39.327634 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:25:39.327807 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:25:39.328091 [info ] [Thread-1 (]: 1 of 6 START test below_depletion_level_tests_below_depletion_level_ ........... [RUN]
[0m18:25:39.328412 [info ] [Thread-2 (]: 2 of 6 START test new_arrival_stock_depletion_test_hot_upsell_ ................. [RUN]
[0m18:25:39.328870 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:25:39.329452 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:25:39.329775 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:25:39.330039 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:25:39.330289 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:25:39.330527 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:25:39.334681 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:25:39.337741 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:25:39.339710 [debug] [Thread-1 (]: finished collecting timing info
[0m18:25:39.339995 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:25:39.353397 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:25:39.353544 [debug] [Thread-2 (]: finished collecting timing info
[0m18:25:39.354060 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:25:39.355786 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:25:39.356267 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:25:39.356570 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m18:25:39.356792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:39.357813 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:25:39.358036 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m18:25:39.358285 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:25:39.364663 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:25:39.364804 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:25:39.365064 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:25:39.365291 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:25:39.365515 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT DISTINCT rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, 
                        (ruv.msrp - rupu.price) AS profit_margin
        FROM "postgres"."public"."hot_upsell" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        WHERE new_arrival = 'Y' AND stock_level < COALESCE(depletion_level, 0) AND rupu.stock IS NOT NULL
        ORDER BY profit_margin DESC
    )
    SELECT 
        (*) as errors
    FROM test_data;
    having count(errors) > 0

      
    ) dbt_internal_test
[0m18:25:39.365722 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m18:25:39.366675 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "*"
LINE 18:         (*) as errors
                  ^

[0m18:25:39.367060 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m18:25:39.367557 [debug] [Thread-2 (]: finished collecting timing info
[0m18:25:39.367797 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m18:25:39.368214 [debug] [Thread-2 (]: Database Error in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)
  syntax error at or near "*"
  LINE 18:         (*) as errors
                    ^
  compiled SQL at target/run/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m18:25:39.368575 [error] [Thread-2 (]: 2 of 6 ERROR new_arrival_stock_depletion_test_hot_upsell_ ...................... [[31mERROR[0m in 0.04s]
[0m18:25:39.369105 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:25:39.369458 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:25:39.369743 [info ] [Thread-2 (]: 3 of 6 START test not_null_below_depletion_level_name .......................... [RUN]
[0m18:25:39.370206 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:25:39.370441 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:25:39.370660 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:25:39.376863 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:25:39.378299 [debug] [Thread-2 (]: finished collecting timing info
[0m18:25:39.378530 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:25:39.380255 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:25:39.381310 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:25:39.381512 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m18:25:39.381715 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:25:39.389231 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:25:39.389731 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:25:39.390028 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m18:25:39.407281 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.02 seconds
[0m18:25:39.410091 [debug] [Thread-2 (]: finished collecting timing info
[0m18:25:39.410465 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m18:25:39.410898 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m18:25:39.411446 [info ] [Thread-2 (]: 3 of 6 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.04s]
[0m18:25:39.412301 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:25:39.413255 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:25:39.413996 [info ] [Thread-2 (]: 4 of 6 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m18:25:39.414866 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:25:39.415448 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:25:39.415750 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:25:39.420211 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:25:39.422126 [debug] [Thread-2 (]: finished collecting timing info
[0m18:25:39.423451 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:25:39.426491 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:25:39.428250 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:25:39.428680 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m18:25:39.429032 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:25:39.437530 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:25:39.438072 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:25:39.438348 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m18:25:39.441494 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.07 seconds
[0m18:25:39.442940 [debug] [Thread-1 (]: finished collecting timing info
[0m18:25:39.443233 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m18:25:39.443554 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m18:25:39.443986 [info ] [Thread-1 (]: 1 of 6 PASS below_depletion_level_tests_below_depletion_level_ ................. [[32mPASS[0m in 0.12s]
[0m18:25:39.444196 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:25:39.444676 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:25:39.446212 [debug] [Thread-2 (]: finished collecting timing info
[0m18:25:39.446527 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:25:39.446815 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m18:25:39.447046 [info ] [Thread-1 (]: 5 of 6 START test not_null_hot_upsell_name ..................................... [RUN]
[0m18:25:39.447372 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m18:25:39.447659 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:25:39.448012 [info ] [Thread-2 (]: 4 of 6 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.03s]
[0m18:25:39.448304 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:25:39.448695 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:25:39.448924 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:25:39.449177 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:25:39.452200 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:25:39.452476 [info ] [Thread-2 (]: 6 of 6 START test not_null_hot_upsell_variant .................................. [RUN]
[0m18:25:39.453068 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:25:39.453436 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:25:39.453577 [debug] [Thread-1 (]: finished collecting timing info
[0m18:25:39.453666 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:25:39.453886 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:25:39.456716 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:25:39.459308 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:25:39.460309 [debug] [Thread-2 (]: finished collecting timing info
[0m18:25:39.460546 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:25:39.460771 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:25:39.462330 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:25:39.462609 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m18:25:39.463050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:39.463609 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:25:39.463868 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m18:25:39.464093 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:25:39.469854 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:25:39.470235 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:25:39.470481 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:25:39.470578 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m18:25:39.470801 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:25:39.471266 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m18:25:39.477096 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:25:39.478626 [debug] [Thread-1 (]: finished collecting timing info
[0m18:25:39.478912 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m18:25:39.479246 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m18:25:39.479656 [info ] [Thread-1 (]: 5 of 6 PASS not_null_hot_upsell_name ........................................... [[32mPASS[0m in 0.03s]
[0m18:25:39.480076 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:25:39.480302 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:25:39.481668 [debug] [Thread-2 (]: finished collecting timing info
[0m18:25:39.481905 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m18:25:39.482210 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m18:25:39.482598 [info ] [Thread-2 (]: 6 of 6 PASS not_null_hot_upsell_variant ........................................ [[32mPASS[0m in 0.03s]
[0m18:25:39.482975 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:25:39.484804 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:25:39.485072 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:39.485285 [debug] [MainThread]: On master: BEGIN
[0m18:25:39.485486 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:25:39.491652 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:25:39.491977 [debug] [MainThread]: On master: COMMIT
[0m18:25:39.492221 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:39.492441 [debug] [MainThread]: On master: COMMIT
[0m18:25:39.492733 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:25:39.492958 [debug] [MainThread]: On master: Close
[0m18:25:39.493586 [info ] [MainThread]: 
[0m18:25:39.493894 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m18:25:39.494226 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:25:39.494443 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb' was properly closed.
[0m18:25:39.494638 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b' was properly closed.
[0m18:25:39.501362 [info ] [MainThread]: 
[0m18:25:39.501653 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:25:39.501978 [info ] [MainThread]: 
[0m18:25:39.502283 [error] [MainThread]: [33mDatabase Error in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)[0m
[0m18:25:39.502553 [error] [MainThread]:   syntax error at or near "*"
[0m18:25:39.502835 [error] [MainThread]:   LINE 18:         (*) as errors
[0m18:25:39.503066 [error] [MainThread]:                     ^
[0m18:25:39.503339 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m18:25:39.503628 [info ] [MainThread]: 
[0m18:25:39.503886 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m18:25:39.504249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b5d390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89079a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff88ee740>]}


============================== 2024-07-14 18:25:56.746475 | 88903c15-3695-421a-aaca-a415738edb4e ==============================
[0m18:25:56.746775 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:25:56.753935 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m18:25:56.754339 [debug] [MainThread]: Tracking: tracking
[0m18:25:56.769097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2afb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2bfd0>]}
[0m18:25:56.817153 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:25:56.817861 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://macros/upsell_test.sql
[0m18:25:56.818175 [debug] [MainThread]: Parsing macros/upsell_test.sql
[0m18:25:56.856948 [debug] [MainThread]: 1699: static parser successfully parsed hot_upsell/hot_upsell.sql
[0m18:25:57.023383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88903c15-3695-421a-aaca-a415738edb4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba3e50>]}
[0m18:25:57.033235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88903c15-3695-421a-aaca-a415738edb4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1c880>]}
[0m18:25:57.033676 [info ] [MainThread]: Found 4 models, 6 tests, 2 snapshots, 0 analyses, 258 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:25:57.034005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88903c15-3695-421a-aaca-a415738edb4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b697e0>]}
[0m18:25:57.035836 [info ] [MainThread]: 
[0m18:25:57.036439 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:25:57.038695 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m18:25:57.046680 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:25:57.047002 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:25:57.047246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:57.094101 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m18:25:57.094931 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:25:57.095238 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:25:57.101202 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.01 seconds
[0m18:25:57.103359 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:25:57.103921 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:25:57.109267 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:57.109703 [debug] [MainThread]: On master: BEGIN
[0m18:25:57.109959 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:25:57.117153 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:25:57.117570 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:57.117809 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:25:57.122531 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m18:25:57.123886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88903c15-3695-421a-aaca-a415738edb4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba0070>]}
[0m18:25:57.124258 [debug] [MainThread]: On master: ROLLBACK
[0m18:25:57.124579 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:57.124808 [debug] [MainThread]: On master: BEGIN
[0m18:25:57.125288 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:25:57.125613 [debug] [MainThread]: On master: COMMIT
[0m18:25:57.125839 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:57.126052 [debug] [MainThread]: On master: COMMIT
[0m18:25:57.126370 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:25:57.126596 [debug] [MainThread]: On master: Close
[0m18:25:57.127009 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:25:57.127320 [info ] [MainThread]: 
[0m18:25:57.131247 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:25:57.131413 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:25:57.131696 [info ] [Thread-1 (]: 1 of 6 START test below_depletion_level_tests_below_depletion_level_ ........... [RUN]
[0m18:25:57.132027 [info ] [Thread-2 (]: 2 of 6 START test new_arrival_stock_depletion_test_hot_upsell_ ................. [RUN]
[0m18:25:57.132791 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:25:57.133396 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:25:57.133743 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:25:57.133994 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:25:57.134301 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:25:57.134542 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:25:57.138595 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:25:57.141905 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:25:57.144043 [debug] [Thread-1 (]: finished collecting timing info
[0m18:25:57.144327 [debug] [Thread-2 (]: finished collecting timing info
[0m18:25:57.144433 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:25:57.144675 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:25:57.163369 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:25:57.165679 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:25:57.167725 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:25:57.167927 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:25:57.168185 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m18:25:57.168426 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m18:25:57.168649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:57.168878 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:25:57.176862 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:25:57.177159 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:25:57.177481 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:25:57.177753 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:25:57.178026 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m18:25:57.178321 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT DISTINCT rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, 
                        (ruv.msrp - rupu.price) AS profit_margin
        FROM "postgres"."public"."hot_upsell" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        WHERE new_arrival = 'Y' AND stock_level < COALESCE(depletion_level, 0) AND rupu.stock IS NOT NULL
        ORDER BY profit_margin DESC
    )
    SELECT 
        * as errors
    FROM test_data;
    having count(errors) > 0

      
    ) dbt_internal_test
[0m18:25:57.179570 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "as"
LINE 18:         * as errors
                   ^

[0m18:25:57.179871 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m18:25:57.180333 [debug] [Thread-2 (]: finished collecting timing info
[0m18:25:57.180589 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m18:25:57.181034 [debug] [Thread-2 (]: Database Error in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)
  syntax error at or near "as"
  LINE 18:         * as errors
                     ^
  compiled SQL at target/run/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m18:25:57.181398 [error] [Thread-2 (]: 2 of 6 ERROR new_arrival_stock_depletion_test_hot_upsell_ ...................... [[31mERROR[0m in 0.05s]
[0m18:25:57.181970 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:25:57.182389 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:25:57.182706 [info ] [Thread-2 (]: 3 of 6 START test not_null_below_depletion_level_name .......................... [RUN]
[0m18:25:57.183195 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:25:57.183456 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:25:57.183686 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:25:57.190229 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:25:57.190429 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:25:57.192935 [debug] [Thread-1 (]: finished collecting timing info
[0m18:25:57.193336 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m18:25:57.193440 [debug] [Thread-2 (]: finished collecting timing info
[0m18:25:57.193775 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m18:25:57.193875 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:25:57.194304 [info ] [Thread-1 (]: 1 of 6 PASS below_depletion_level_tests_below_depletion_level_ ................. [[32mPASS[0m in 0.06s]
[0m18:25:57.196032 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:25:57.196453 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:25:57.197021 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:25:57.197312 [info ] [Thread-1 (]: 4 of 6 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m18:25:57.197536 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:25:57.197941 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:25:57.198129 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m18:25:57.198372 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:25:57.198571 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:25:57.198818 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:25:57.202373 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:25:57.203611 [debug] [Thread-1 (]: finished collecting timing info
[0m18:25:57.203848 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:25:57.205471 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:25:57.205827 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:25:57.206169 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:25:57.206466 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m18:25:57.206588 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:25:57.206925 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m18:25:57.207116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:57.211684 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:25:57.213070 [debug] [Thread-2 (]: finished collecting timing info
[0m18:25:57.213988 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m18:25:57.214089 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:25:57.214479 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m18:25:57.214581 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:25:57.217493 [info ] [Thread-2 (]: 3 of 6 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.03s]
[0m18:25:57.217749 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m18:25:57.218216 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:25:57.222698 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:25:57.223427 [info ] [Thread-2 (]: 5 of 6 START test not_null_hot_upsell_name ..................................... [RUN]
[0m18:25:57.224393 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:25:57.224932 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:25:57.225209 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:25:57.229715 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:25:57.229929 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:25:57.231890 [debug] [Thread-1 (]: finished collecting timing info
[0m18:25:57.232534 [debug] [Thread-2 (]: finished collecting timing info
[0m18:25:57.232660 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m18:25:57.232941 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:25:57.233408 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m18:25:57.235105 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:25:57.235714 [info ] [Thread-1 (]: 4 of 6 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.04s]
[0m18:25:57.237558 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:25:57.237975 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:25:57.238118 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:25:57.238480 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m18:25:57.238744 [info ] [Thread-1 (]: 6 of 6 START test not_null_hot_upsell_variant .................................. [RUN]
[0m18:25:57.238987 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:25:57.239574 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:25:57.240540 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:25:57.240902 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:25:57.248068 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:25:57.250361 [debug] [Thread-1 (]: finished collecting timing info
[0m18:25:57.250804 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:25:57.252743 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:25:57.253341 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:25:57.253947 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:25:57.254293 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m18:25:57.254614 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:25:57.254900 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m18:25:57.255173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:57.262022 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:25:57.263886 [debug] [Thread-2 (]: finished collecting timing info
[0m18:25:57.264192 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m18:25:57.264500 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m18:25:57.264913 [info ] [Thread-2 (]: 5 of 6 PASS not_null_hot_upsell_name ........................................... [[32mPASS[0m in 0.04s]
[0m18:25:57.265399 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:25:57.266377 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:25:57.266725 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:25:57.266928 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m18:25:57.278490 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:25:57.279863 [debug] [Thread-1 (]: finished collecting timing info
[0m18:25:57.280124 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m18:25:57.280454 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m18:25:57.280862 [info ] [Thread-1 (]: 6 of 6 PASS not_null_hot_upsell_variant ........................................ [[32mPASS[0m in 0.04s]
[0m18:25:57.281294 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:25:57.283050 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:25:57.283337 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:57.283552 [debug] [MainThread]: On master: BEGIN
[0m18:25:57.283747 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:25:57.289895 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:25:57.290269 [debug] [MainThread]: On master: COMMIT
[0m18:25:57.290530 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:57.290753 [debug] [MainThread]: On master: COMMIT
[0m18:25:57.291047 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:25:57.291285 [debug] [MainThread]: On master: Close
[0m18:25:57.291903 [info ] [MainThread]: 
[0m18:25:57.292225 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m18:25:57.292539 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:25:57.292791 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b' was properly closed.
[0m18:25:57.293016 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb' was properly closed.
[0m18:25:57.298821 [info ] [MainThread]: 
[0m18:25:57.299137 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:25:57.299546 [info ] [MainThread]: 
[0m18:25:57.299852 [error] [MainThread]: [33mDatabase Error in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)[0m
[0m18:25:57.300199 [error] [MainThread]:   syntax error at or near "as"
[0m18:25:57.300507 [error] [MainThread]:   LINE 18:         * as errors
[0m18:25:57.300780 [error] [MainThread]:                      ^
[0m18:25:57.301031 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m18:25:57.301334 [info ] [MainThread]: 
[0m18:25:57.301604 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m18:25:57.301951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b697b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff88fdfc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bba140>]}


============================== 2024-07-14 18:26:30.588348 | fe1bdb6e-00b4-416d-8e71-b4044702ad5d ==============================
[0m18:26:30.588665 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:26:30.611269 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m18:26:30.611914 [debug] [MainThread]: Tracking: tracking
[0m18:26:30.626957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c15d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c14c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c15900>]}
[0m18:26:30.676683 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:26:30.677422 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://macros/upsell_test.sql
[0m18:26:30.677716 [debug] [MainThread]: Parsing macros/upsell_test.sql
[0m18:26:30.716876 [debug] [MainThread]: 1699: static parser successfully parsed hot_upsell/hot_upsell.sql
[0m18:26:30.758148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe1bdb6e-00b4-416d-8e71-b4044702ad5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba3910>]}
[0m18:26:30.768110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe1bdb6e-00b4-416d-8e71-b4044702ad5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1eb00>]}
[0m18:26:30.768541 [info ] [MainThread]: Found 4 models, 6 tests, 2 snapshots, 0 analyses, 258 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:26:30.768887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe1bdb6e-00b4-416d-8e71-b4044702ad5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b65780>]}
[0m18:26:30.770645 [info ] [MainThread]: 
[0m18:26:30.771246 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:26:30.773430 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m18:26:30.781764 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:26:30.782025 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:26:30.782173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:30.827272 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m18:26:30.827766 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:26:30.828026 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:26:30.842341 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.01 seconds
[0m18:26:30.844206 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:26:30.844696 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:26:30.849789 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:30.851282 [debug] [MainThread]: On master: BEGIN
[0m18:26:30.851553 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:26:30.859730 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:26:30.860262 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:30.860533 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:26:30.865880 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m18:26:30.867407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe1bdb6e-00b4-416d-8e71-b4044702ad5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba0070>]}
[0m18:26:30.867791 [debug] [MainThread]: On master: ROLLBACK
[0m18:26:30.868148 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:30.868379 [debug] [MainThread]: On master: BEGIN
[0m18:26:30.868767 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:26:30.869046 [debug] [MainThread]: On master: COMMIT
[0m18:26:30.869318 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:30.869528 [debug] [MainThread]: On master: COMMIT
[0m18:26:30.869841 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:26:30.870063 [debug] [MainThread]: On master: Close
[0m18:26:30.870443 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:26:30.870724 [info ] [MainThread]: 
[0m18:26:30.874638 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:26:30.874807 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:26:30.875091 [info ] [Thread-1 (]: 1 of 6 START test below_depletion_level_tests_below_depletion_level_ ........... [RUN]
[0m18:26:30.875370 [info ] [Thread-2 (]: 2 of 6 START test new_arrival_stock_depletion_test_hot_upsell_ ................. [RUN]
[0m18:26:30.875863 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:26:30.876468 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:26:30.876810 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:26:30.877008 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:26:30.877276 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:26:30.877519 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:26:30.881387 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:26:30.883987 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:26:30.886075 [debug] [Thread-2 (]: finished collecting timing info
[0m18:26:30.886177 [debug] [Thread-1 (]: finished collecting timing info
[0m18:26:30.886373 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:26:30.886600 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:26:30.900645 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:26:30.902267 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:26:30.904192 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:26:30.904775 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:26:30.904869 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m18:26:30.905355 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m18:26:30.905721 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:26:30.905994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:26:30.916834 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:26:30.918176 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:26:30.918836 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT DISTINCT rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, 
                        (ruv.msrp - rupu.price) AS profit_margin
        FROM "postgres"."public"."hot_upsell" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        WHERE new_arrival = 'Y' AND stock_level < COALESCE(depletion_level, 0) AND rupu.stock IS NOT NULL
        ORDER BY profit_margin DESC
    )
    SELECT 
        count(*) as errors
    FROM test_data;
    where errors > 0

      
    ) dbt_internal_test
[0m18:26:30.919000 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:26:30.919539 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:26:30.920160 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 19:     FROM test_data;
                           ^

[0m18:26:30.920292 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m18:26:30.920712 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m18:26:30.922054 [debug] [Thread-2 (]: finished collecting timing info
[0m18:26:30.923389 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m18:26:30.924234 [debug] [Thread-2 (]: Database Error in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)
  syntax error at or near ";"
  LINE 19:     FROM test_data;
                             ^
  compiled SQL at target/run/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m18:26:30.925462 [error] [Thread-2 (]: 2 of 6 ERROR new_arrival_stock_depletion_test_hot_upsell_ ...................... [[31mERROR[0m in 0.05s]
[0m18:26:30.926605 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:26:30.927346 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:26:30.927774 [info ] [Thread-2 (]: 3 of 6 START test not_null_below_depletion_level_name .......................... [RUN]
[0m18:26:30.928375 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:26:30.928801 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:26:30.929078 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:26:30.936784 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:26:30.936995 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m18:26:30.940123 [debug] [Thread-1 (]: finished collecting timing info
[0m18:26:30.940485 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m18:26:30.941623 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m18:26:30.941871 [debug] [Thread-2 (]: finished collecting timing info
[0m18:26:30.942256 [info ] [Thread-1 (]: 1 of 6 PASS below_depletion_level_tests_below_depletion_level_ ................. [[32mPASS[0m in 0.07s]
[0m18:26:30.942621 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:26:30.943254 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:26:30.945182 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:26:30.945586 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:26:30.946443 [info ] [Thread-1 (]: 4 of 6 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m18:26:30.947541 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:26:30.947687 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:26:30.947934 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:26:30.948167 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m18:26:30.948416 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:26:30.948627 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:26:30.953168 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:26:30.955808 [debug] [Thread-1 (]: finished collecting timing info
[0m18:26:30.956358 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:26:30.958540 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:26:30.959577 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:26:30.959843 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m18:26:30.960046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:26:30.961171 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:26:30.961661 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:26:30.961890 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m18:26:30.966899 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:26:30.967206 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:26:30.967490 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:26:30.968884 [debug] [Thread-2 (]: finished collecting timing info
[0m18:26:30.969153 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m18:26:30.969409 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m18:26:30.969858 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m18:26:30.970324 [info ] [Thread-2 (]: 3 of 6 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.04s]
[0m18:26:30.970783 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:26:30.971150 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:26:30.971479 [info ] [Thread-2 (]: 5 of 6 START test not_null_hot_upsell_name ..................................... [RUN]
[0m18:26:30.971928 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:26:30.972161 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:26:30.972389 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:26:30.976313 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:26:30.976523 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:26:30.978254 [debug] [Thread-1 (]: finished collecting timing info
[0m18:26:30.978624 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m18:26:30.979180 [debug] [Thread-2 (]: finished collecting timing info
[0m18:26:30.979509 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m18:26:30.979622 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:26:30.980158 [info ] [Thread-1 (]: 4 of 6 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.03s]
[0m18:26:30.981950 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:26:30.982395 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:26:30.983593 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:26:30.983999 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:26:30.984099 [info ] [Thread-1 (]: 6 of 6 START test not_null_hot_upsell_variant .................................. [RUN]
[0m18:26:30.984341 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m18:26:30.984773 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:26:30.984961 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:26:30.985183 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:26:30.985653 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:26:30.989740 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:26:30.991663 [debug] [Thread-1 (]: finished collecting timing info
[0m18:26:30.991966 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:26:30.992084 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:26:30.993778 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:26:30.994034 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:26:30.994534 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m18:26:30.994913 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:26:30.995148 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m18:26:30.995348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:26:30.998267 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:26:30.999625 [debug] [Thread-2 (]: finished collecting timing info
[0m18:26:30.999931 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m18:26:31.000342 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m18:26:31.000941 [info ] [Thread-2 (]: 5 of 6 PASS not_null_hot_upsell_name ........................................... [[32mPASS[0m in 0.03s]
[0m18:26:31.002052 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:26:31.002312 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:26:31.002676 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:26:31.003246 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m18:26:31.010259 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:26:31.011642 [debug] [Thread-1 (]: finished collecting timing info
[0m18:26:31.011903 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m18:26:31.012214 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m18:26:31.012632 [info ] [Thread-1 (]: 6 of 6 PASS not_null_hot_upsell_variant ........................................ [[32mPASS[0m in 0.03s]
[0m18:26:31.013055 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:26:31.014874 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:26:31.015171 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:31.015402 [debug] [MainThread]: On master: BEGIN
[0m18:26:31.015624 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:26:31.022278 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:26:31.022599 [debug] [MainThread]: On master: COMMIT
[0m18:26:31.022822 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:31.023003 [debug] [MainThread]: On master: COMMIT
[0m18:26:31.023249 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:26:31.023459 [debug] [MainThread]: On master: Close
[0m18:26:31.024063 [info ] [MainThread]: 
[0m18:26:31.024372 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m18:26:31.024687 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:26:31.024887 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b' was properly closed.
[0m18:26:31.025076 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb' was properly closed.
[0m18:26:31.031185 [info ] [MainThread]: 
[0m18:26:31.031478 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:26:31.031786 [info ] [MainThread]: 
[0m18:26:31.032060 [error] [MainThread]: [33mDatabase Error in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)[0m
[0m18:26:31.032331 [error] [MainThread]:   syntax error at or near ";"
[0m18:26:31.032599 [error] [MainThread]:   LINE 19:     FROM test_data;
[0m18:26:31.032855 [error] [MainThread]:                              ^
[0m18:26:31.033088 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m18:26:31.033485 [info ] [MainThread]: 
[0m18:26:31.033748 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m18:26:31.034095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b65750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff88fe470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bbbe50>]}


============================== 2024-07-14 18:26:44.997898 | db420fa0-6d83-49ed-b4db-192a499f5fbd ==============================
[0m18:26:44.998226 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:26:45.001645 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m18:26:45.002516 [debug] [MainThread]: Tracking: tracking
[0m18:26:45.018371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c25480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c25090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c25210>]}
[0m18:26:45.077610 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:26:45.078378 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://macros/upsell_test.sql
[0m18:26:45.078714 [debug] [MainThread]: Parsing macros/upsell_test.sql
[0m18:26:45.118129 [debug] [MainThread]: 1699: static parser successfully parsed hot_upsell/hot_upsell.sql
[0m18:26:45.163628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db420fa0-6d83-49ed-b4db-192a499f5fbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba3520>]}
[0m18:26:45.176257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db420fa0-6d83-49ed-b4db-192a499f5fbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1b880>]}
[0m18:26:45.176785 [info ] [MainThread]: Found 4 models, 6 tests, 2 snapshots, 0 analyses, 258 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:26:45.177152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db420fa0-6d83-49ed-b4db-192a499f5fbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b657b0>]}
[0m18:26:45.179661 [info ] [MainThread]: 
[0m18:26:45.181076 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:26:45.184055 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m18:26:45.192492 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:26:45.192901 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:26:45.193162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:45.242353 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m18:26:45.242932 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:26:45.243184 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:26:45.247777 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m18:26:45.249678 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:26:45.250144 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:26:45.255071 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:45.255461 [debug] [MainThread]: On master: BEGIN
[0m18:26:45.255721 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:26:45.263412 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:26:45.263881 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:45.264132 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:26:45.271741 [debug] [MainThread]: SQL status: SELECT 11 in 0.01 seconds
[0m18:26:45.273366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db420fa0-6d83-49ed-b4db-192a499f5fbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba02e0>]}
[0m18:26:45.273802 [debug] [MainThread]: On master: ROLLBACK
[0m18:26:45.274195 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:45.274434 [debug] [MainThread]: On master: BEGIN
[0m18:26:45.274845 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:26:45.275135 [debug] [MainThread]: On master: COMMIT
[0m18:26:45.275370 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:45.275596 [debug] [MainThread]: On master: COMMIT
[0m18:26:45.275917 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:26:45.276161 [debug] [MainThread]: On master: Close
[0m18:26:45.276582 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:26:45.276926 [info ] [MainThread]: 
[0m18:26:45.281146 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:26:45.281341 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:26:45.281662 [info ] [Thread-1 (]: 1 of 6 START test below_depletion_level_tests_below_depletion_level_ ........... [RUN]
[0m18:26:45.282008 [info ] [Thread-2 (]: 2 of 6 START test new_arrival_stock_depletion_test_hot_upsell_ ................. [RUN]
[0m18:26:45.282597 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:26:45.283289 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:26:45.283654 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:26:45.283943 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:26:45.284233 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:26:45.284488 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:26:45.289404 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:26:45.292561 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:26:45.294175 [debug] [Thread-1 (]: finished collecting timing info
[0m18:26:45.294502 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:26:45.294600 [debug] [Thread-2 (]: finished collecting timing info
[0m18:26:45.310353 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:26:45.310836 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:26:45.313035 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:26:45.315861 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:26:45.316218 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m18:26:45.316355 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:26:45.316572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:26:45.316821 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m18:26:45.317371 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:26:45.326434 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:26:45.326748 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:26:45.327037 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:26:45.327270 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:26:45.327481 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT DISTINCT rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, 
                        (ruv.msrp - rupu.price) AS profit_margin
        FROM "postgres"."public"."hot_upsell" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        WHERE new_arrival = 'Y' AND stock_level < COALESCE(depletion_level, 0) AND rupu.stock IS NOT NULL
        ORDER BY profit_margin DESC
    )
    SELECT 
        count(*) as errors
    FROM test_data
    where errors > 0

      
    ) dbt_internal_test
[0m18:26:45.327693 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m18:26:45.330697 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column ruv.pid does not exist
LINE 12: ...ublic"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AN...
                                                              ^
HINT:  Perhaps you meant to reference the column "rupu.p_id".

[0m18:26:45.331047 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m18:26:45.331470 [debug] [Thread-2 (]: finished collecting timing info
[0m18:26:45.331711 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m18:26:45.332308 [debug] [Thread-2 (]: Database Error in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)
  column ruv.pid does not exist
  LINE 12: ...ublic"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AN...
                                                                ^
  HINT:  Perhaps you meant to reference the column "rupu.p_id".
  compiled SQL at target/run/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m18:26:45.332652 [error] [Thread-2 (]: 2 of 6 ERROR new_arrival_stock_depletion_test_hot_upsell_ ...................... [[31mERROR[0m in 0.05s]
[0m18:26:45.333285 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:26:45.333546 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:26:45.334433 [info ] [Thread-2 (]: 3 of 6 START test not_null_below_depletion_level_name .......................... [RUN]
[0m18:26:45.334941 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:26:45.335192 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:26:45.335384 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:26:45.341479 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:26:45.341674 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:26:45.344333 [debug] [Thread-1 (]: finished collecting timing info
[0m18:26:45.344870 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m18:26:45.345092 [debug] [Thread-2 (]: finished collecting timing info
[0m18:26:45.345472 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m18:26:45.345582 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:26:45.346124 [info ] [Thread-1 (]: 1 of 6 PASS below_depletion_level_tests_below_depletion_level_ ................. [[32mPASS[0m in 0.06s]
[0m18:26:45.347958 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:26:45.348438 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:26:45.349443 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:26:45.349882 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:26:45.349992 [info ] [Thread-1 (]: 4 of 6 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m18:26:45.350178 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m18:26:45.350720 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:26:45.350895 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:26:45.351244 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:26:45.352032 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:26:45.355335 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:26:45.356435 [debug] [Thread-1 (]: finished collecting timing info
[0m18:26:45.356691 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:26:45.358515 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:26:45.358924 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:26:45.359345 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:26:45.359566 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m18:26:45.359907 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:26:45.360204 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m18:26:45.360482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:26:45.370288 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:26:45.370767 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:26:45.371112 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m18:26:45.381647 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:26:45.383340 [debug] [Thread-1 (]: finished collecting timing info
[0m18:26:45.383480 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.02 seconds
[0m18:26:45.383754 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m18:26:45.384883 [debug] [Thread-2 (]: finished collecting timing info
[0m18:26:45.385285 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m18:26:45.385391 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m18:26:45.385919 [info ] [Thread-1 (]: 4 of 6 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.04s]
[0m18:26:45.386222 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m18:26:45.386683 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:26:45.387243 [info ] [Thread-2 (]: 3 of 6 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.05s]
[0m18:26:45.387642 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:26:45.388173 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:26:45.388532 [info ] [Thread-1 (]: 5 of 6 START test not_null_hot_upsell_name ..................................... [RUN]
[0m18:26:45.388927 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:26:45.389725 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:26:45.390292 [info ] [Thread-2 (]: 6 of 6 START test not_null_hot_upsell_variant .................................. [RUN]
[0m18:26:45.390596 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:26:45.391100 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:26:45.391444 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:26:45.391694 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:26:45.394914 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:26:45.395231 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:26:45.398441 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:26:45.399029 [debug] [Thread-1 (]: finished collecting timing info
[0m18:26:45.399322 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:26:45.399530 [debug] [Thread-2 (]: finished collecting timing info
[0m18:26:45.401685 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:26:45.401940 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:26:45.403703 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:26:45.404210 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:26:45.404443 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m18:26:45.404659 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:26:45.404752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:26:45.404976 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m18:26:45.405624 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:26:45.412465 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:26:45.413147 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:26:45.413268 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:26:45.413507 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:26:45.413788 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m18:26:45.414293 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m18:26:45.418556 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:26:45.420178 [debug] [Thread-1 (]: finished collecting timing info
[0m18:26:45.420461 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m18:26:45.420890 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m18:26:45.421411 [info ] [Thread-1 (]: 5 of 6 PASS not_null_hot_upsell_name ........................................... [[32mPASS[0m in 0.03s]
[0m18:26:45.421700 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:26:45.422075 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:26:45.423534 [debug] [Thread-2 (]: finished collecting timing info
[0m18:26:45.424163 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m18:26:45.424604 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m18:26:45.425372 [info ] [Thread-2 (]: 6 of 6 PASS not_null_hot_upsell_variant ........................................ [[32mPASS[0m in 0.03s]
[0m18:26:45.425837 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:26:45.427713 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:26:45.427970 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:45.428242 [debug] [MainThread]: On master: BEGIN
[0m18:26:45.428431 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:26:45.434587 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:26:45.434926 [debug] [MainThread]: On master: COMMIT
[0m18:26:45.435091 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:45.435251 [debug] [MainThread]: On master: COMMIT
[0m18:26:45.435500 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:26:45.435677 [debug] [MainThread]: On master: Close
[0m18:26:45.436246 [info ] [MainThread]: 
[0m18:26:45.436519 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m18:26:45.436884 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:26:45.437081 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb' was properly closed.
[0m18:26:45.437240 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b' was properly closed.
[0m18:26:45.443008 [info ] [MainThread]: 
[0m18:26:45.443310 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:26:45.443649 [info ] [MainThread]: 
[0m18:26:45.443961 [error] [MainThread]: [33mDatabase Error in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)[0m
[0m18:26:45.444244 [error] [MainThread]:   column ruv.pid does not exist
[0m18:26:45.444473 [error] [MainThread]:   LINE 12: ...ublic"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AN...
[0m18:26:45.444716 [error] [MainThread]:                                                                 ^
[0m18:26:45.444975 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "rupu.p_id".
[0m18:26:45.445222 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m18:26:45.445471 [info ] [MainThread]: 
[0m18:26:45.445728 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m18:26:45.446096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b65780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8904760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bb9d80>]}


============================== 2024-07-14 18:31:05.995679 | 03b603d7-4bb0-4f60-856b-4f2d64779c9c ==============================
[0m18:31:05.995989 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:31:06.016998 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:31:06.017680 [debug] [MainThread]: Tracking: tracking
[0m18:31:06.032408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2bf70>]}
[0m18:31:06.081764 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:31:06.082562 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/hot_upsell/hot_upsell.sql
[0m18:31:06.120180 [debug] [MainThread]: 1699: static parser successfully parsed hot_upsell/hot_upsell.sql
[0m18:31:06.162207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03b603d7-4bb0-4f60-856b-4f2d64779c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9baba00>]}
[0m18:31:06.172175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03b603d7-4bb0-4f60-856b-4f2d64779c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9af7f70>]}
[0m18:31:06.172587 [info ] [MainThread]: Found 4 models, 6 tests, 2 snapshots, 0 analyses, 258 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:31:06.172943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03b603d7-4bb0-4f60-856b-4f2d64779c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9af7d60>]}
[0m18:31:06.174566 [info ] [MainThread]: 
[0m18:31:06.175137 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:31:06.176850 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m18:31:06.184765 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:31:06.185072 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:31:06.185287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:06.229219 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.04 seconds
[0m18:31:06.230934 [debug] [ThreadPool]: On list_postgres: Close
[0m18:31:06.233051 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m18:31:06.237776 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:31:06.238077 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:31:06.238345 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:31:06.245117 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:31:06.245431 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:31:06.245677 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:31:06.248473 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m18:31:06.249700 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:31:06.250126 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:31:06.254214 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:06.254539 [debug] [MainThread]: On master: BEGIN
[0m18:31:06.254763 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:31:06.260905 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:31:06.261263 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:06.261502 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:31:06.265721 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m18:31:06.267014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03b603d7-4bb0-4f60-856b-4f2d64779c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba42e0>]}
[0m18:31:06.267366 [debug] [MainThread]: On master: ROLLBACK
[0m18:31:06.267667 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:06.267881 [debug] [MainThread]: On master: BEGIN
[0m18:31:06.268270 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:31:06.268543 [debug] [MainThread]: On master: COMMIT
[0m18:31:06.268759 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:06.268966 [debug] [MainThread]: On master: COMMIT
[0m18:31:06.269276 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:31:06.269516 [debug] [MainThread]: On master: Close
[0m18:31:06.269901 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:31:06.270208 [info ] [MainThread]: 
[0m18:31:06.274036 [debug] [Thread-1 (]: Began running node model.jaffle_shop.below_depletion_level
[0m18:31:06.274190 [debug] [Thread-2 (]: Began running node model.jaffle_shop.hot_upsell
[0m18:31:06.274546 [info ] [Thread-1 (]: 1 of 4 START view model public.below_depletion_level ........................... [RUN]
[0m18:31:06.274956 [info ] [Thread-2 (]: 2 of 4 START view model public.hot_upsell ...................................... [RUN]
[0m18:31:06.275987 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.below_depletion_level"
[0m18:31:06.276435 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.hot_upsell"
[0m18:31:06.276728 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.below_depletion_level
[0m18:31:06.276970 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.hot_upsell
[0m18:31:06.277244 [debug] [Thread-1 (]: Compiling model.jaffle_shop.below_depletion_level
[0m18:31:06.277491 [debug] [Thread-2 (]: Compiling model.jaffle_shop.hot_upsell
[0m18:31:06.279825 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.below_depletion_level"
[0m18:31:06.282064 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.hot_upsell"
[0m18:31:06.283515 [debug] [Thread-1 (]: finished collecting timing info
[0m18:31:06.283610 [debug] [Thread-2 (]: finished collecting timing info
[0m18:31:06.283829 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.below_depletion_level
[0m18:31:06.284077 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.hot_upsell
[0m18:31:06.320515 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.below_depletion_level"
[0m18:31:06.320913 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.hot_upsell"
[0m18:31:06.323156 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m18:31:06.323301 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m18:31:06.323554 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: BEGIN
[0m18:31:06.323815 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: BEGIN
[0m18:31:06.324064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:06.324289 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:31:06.332497 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:31:06.332758 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:31:06.333383 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m18:31:06.333649 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m18:31:06.333942 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */

  create view "postgres"."public"."hot_upsell__dbt_tmp" as (
    select distinct ruv.pid as product_id, rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, (ruv.msrp - rupu.price) as profit_margin
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_pads_upsell" rupu on rupu.p_id = ruv.pid and rupu.variant = ruv.variant 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where new_arrival = 'Y' and stock_level < coalesce(depletion_level, 0) and rupu.stock is not null
order by profit_margin desc
  );
[0m18:31:06.334230 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */

  create view "postgres"."public"."below_depletion_level__dbt_tmp" as (
    select distinct name, ruv.variant, ruv.actual_size, ruv.weave_cat, ruv.size_grp, ruv.shape, ruv.weight, ruv.stock_level, ruv.depletion_level
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where coalesce(stock_level, 0) < coalesce(depletion_level, 0)
  );
[0m18:31:06.345861 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m18:31:06.346050 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m18:31:06.351244 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m18:31:06.353309 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m18:31:06.353574 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level" rename to "below_depletion_level__dbt_backup"
[0m18:31:06.353796 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
alter table "postgres"."public"."hot_upsell" rename to "hot_upsell__dbt_backup"
[0m18:31:06.354959 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:06.355050 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:06.356814 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m18:31:06.358547 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m18:31:06.358792 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level__dbt_tmp" rename to "below_depletion_level"
[0m18:31:06.358994 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
alter table "postgres"."public"."hot_upsell__dbt_tmp" rename to "hot_upsell"
[0m18:31:06.359528 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:06.359677 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:06.374926 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m18:31:06.376060 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: COMMIT
[0m18:31:06.376380 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m18:31:06.376662 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m18:31:06.376908 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m18:31:06.377166 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: COMMIT
[0m18:31:06.383870 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m18:31:06.388325 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m18:31:06.388520 [debug] [Thread-2 (]: SQL status: COMMIT in 0.01 seconds
[0m18:31:06.388806 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
drop view if exists "postgres"."public"."below_depletion_level__dbt_backup" cascade
[0m18:31:06.390371 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m18:31:06.390967 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
drop view if exists "postgres"."public"."hot_upsell__dbt_backup" cascade
[0m18:31:06.395215 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:31:06.395460 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:31:06.396859 [debug] [Thread-2 (]: finished collecting timing info
[0m18:31:06.397961 [debug] [Thread-1 (]: finished collecting timing info
[0m18:31:06.398460 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: Close
[0m18:31:06.398826 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: Close
[0m18:31:06.399648 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03b603d7-4bb0-4f60-856b-4f2d64779c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b8c100>]}
[0m18:31:06.401028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03b603d7-4bb0-4f60-856b-4f2d64779c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b8f3a0>]}
[0m18:31:06.402632 [info ] [Thread-2 (]: 2 of 4 OK created view model public.hot_upsell ................................. [[32mCREATE VIEW[0m in 0.12s]
[0m18:31:06.403428 [info ] [Thread-1 (]: 1 of 4 OK created view model public.below_depletion_level ...................... [[32mCREATE VIEW[0m in 0.13s]
[0m18:31:06.404091 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.hot_upsell
[0m18:31:06.405113 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.below_depletion_level
[0m18:31:06.405845 [debug] [Thread-2 (]: Began running node model.jaffle_shop.underselling_product_specs
[0m18:31:06.406796 [debug] [Thread-1 (]: Began running node model.jaffle_shop.priority_order
[0m18:31:06.407051 [info ] [Thread-2 (]: 3 of 4 START view model public.underselling_product_specs ...................... [RUN]
[0m18:31:06.407503 [info ] [Thread-1 (]: 4 of 4 START view model public.priority_order .................................. [RUN]
[0m18:31:06.408355 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.underselling_product_specs"
[0m18:31:06.408914 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.priority_order"
[0m18:31:06.409485 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.underselling_product_specs
[0m18:31:06.409902 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.priority_order
[0m18:31:06.410339 [debug] [Thread-2 (]: Compiling model.jaffle_shop.underselling_product_specs
[0m18:31:06.410645 [debug] [Thread-1 (]: Compiling model.jaffle_shop.priority_order
[0m18:31:06.413661 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.underselling_product_specs"
[0m18:31:06.416826 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.priority_order"
[0m18:31:06.418626 [debug] [Thread-2 (]: finished collecting timing info
[0m18:31:06.418751 [debug] [Thread-1 (]: finished collecting timing info
[0m18:31:06.418987 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.underselling_product_specs
[0m18:31:06.419239 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.priority_order
[0m18:31:06.422531 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.underselling_product_specs"
[0m18:31:06.425366 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.priority_order"
[0m18:31:06.426430 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m18:31:06.426637 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m18:31:06.426715 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: BEGIN
[0m18:31:06.426941 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: BEGIN
[0m18:31:06.427150 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:31:06.427357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:06.434882 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:31:06.435148 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:31:06.435461 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m18:31:06.435690 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m18:31:06.435895 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */

  create view "postgres"."public"."underselling_product_specs__dbt_tmp" as (
    select distinct rup.name, rucm.color_value, ruv.actual_size, ruv.weave_cat, ruv.size_grp, ruv.shape, (ruv.stock_level - ruv.depletion_level) as stock_depletion_ratio
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_color_map" rucm on rucm.color_id = ruv.pid 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
where stock_level > coalesce(depletion_level, 0) and depletion_level <> 0 
and stock_level is not null and stock_level <> 0 and new_arrival = 'N' and status = 'In_stock'
order by stock_depletion_ratio desc limit 10
  );
[0m18:31:06.436092 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */

  create view "postgres"."public"."priority_order__dbt_tmp" as (
    select distinct rup.name as product_name, ruv.variant as variant, ruv.actual_size, ruv.weave_cat, (msrp - price) as profit 
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
join "postgres"."public"."below_depletion_level" bdl on bdl.name = rup.name and bdl.variant = ruv.variant
order by profit desc
  );
[0m18:31:06.440524 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:31:06.442843 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m18:31:06.442999 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m18:31:06.443226 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
alter table "postgres"."public"."priority_order__dbt_tmp" rename to "priority_order"
[0m18:31:06.445027 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m18:31:06.445469 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
alter table "postgres"."public"."underselling_product_specs" rename to "underselling_product_specs__dbt_backup"
[0m18:31:06.445700 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:06.446296 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:06.447274 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: COMMIT
[0m18:31:06.449032 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m18:31:06.449265 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m18:31:06.449473 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
alter table "postgres"."public"."underselling_product_specs__dbt_tmp" rename to "underselling_product_specs"
[0m18:31:06.449697 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: COMMIT
[0m18:31:06.450266 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:06.451725 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: COMMIT
[0m18:31:06.451845 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:31:06.452086 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m18:31:06.454889 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m18:31:06.455345 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: COMMIT
[0m18:31:06.455586 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
drop view if exists "postgres"."public"."priority_order__dbt_backup" cascade
[0m18:31:06.456603 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:31:06.456696 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:31:06.458036 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m18:31:06.458966 [debug] [Thread-1 (]: finished collecting timing info
[0m18:31:06.459200 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
drop view if exists "postgres"."public"."underselling_product_specs__dbt_backup" cascade
[0m18:31:06.459442 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: Close
[0m18:31:06.461156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03b603d7-4bb0-4f60-856b-4f2d64779c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b97eb0>]}
[0m18:31:06.461263 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:31:06.461632 [info ] [Thread-1 (]: 4 of 4 OK created view model public.priority_order ............................. [[32mCREATE VIEW[0m in 0.05s]
[0m18:31:06.462548 [debug] [Thread-2 (]: finished collecting timing info
[0m18:31:06.463034 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.priority_order
[0m18:31:06.463317 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: Close
[0m18:31:06.464027 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03b603d7-4bb0-4f60-856b-4f2d64779c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b957b0>]}
[0m18:31:06.464826 [info ] [Thread-2 (]: 3 of 4 OK created view model public.underselling_product_specs ................. [[32mCREATE VIEW[0m in 0.06s]
[0m18:31:06.465163 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.underselling_product_specs
[0m18:31:06.466935 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:31:06.467192 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:06.467412 [debug] [MainThread]: On master: BEGIN
[0m18:31:06.467608 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:31:06.474086 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:31:06.474400 [debug] [MainThread]: On master: COMMIT
[0m18:31:06.474614 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:06.474843 [debug] [MainThread]: On master: COMMIT
[0m18:31:06.475144 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:31:06.475374 [debug] [MainThread]: On master: Close
[0m18:31:06.476061 [info ] [MainThread]: 
[0m18:31:06.476377 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m18:31:06.476751 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:31:06.476967 [debug] [MainThread]: Connection 'model.jaffle_shop.priority_order' was properly closed.
[0m18:31:06.477185 [debug] [MainThread]: Connection 'model.jaffle_shop.underselling_product_specs' was properly closed.
[0m18:31:06.485438 [info ] [MainThread]: 
[0m18:31:06.486121 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:31:06.487221 [info ] [MainThread]: 
[0m18:31:06.487672 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:31:06.488200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9af7fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9af5ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8950ee0>]}


============================== 2024-07-14 18:31:11.640122 | 7828d5e7-94b5-4139-80c1-dafd2a1efb4e ==============================
[0m18:31:11.640454 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:31:11.643999 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:31:11.644503 [debug] [MainThread]: Tracking: tracking
[0m18:31:11.666706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2afb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b250>]}
[0m18:31:11.717359 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:31:11.717758 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:31:11.723936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7828d5e7-94b5-4139-80c1-dafd2a1efb4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bbdf90>]}
[0m18:31:11.735854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7828d5e7-94b5-4139-80c1-dafd2a1efb4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b8c070>]}
[0m18:31:11.736346 [info ] [MainThread]: Found 4 models, 6 tests, 2 snapshots, 0 analyses, 258 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:31:11.736704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7828d5e7-94b5-4139-80c1-dafd2a1efb4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b8c130>]}
[0m18:31:11.738701 [info ] [MainThread]: 
[0m18:31:11.739341 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:31:11.741769 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m18:31:11.750696 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:31:11.751104 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:31:11.751373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:11.800253 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.05 seconds
[0m18:31:11.802147 [debug] [ThreadPool]: On list_postgres: Close
[0m18:31:11.804625 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m18:31:11.809587 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:31:11.809882 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:31:11.810104 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:31:11.817241 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:31:11.817624 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:31:11.817872 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:31:11.820921 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m18:31:11.822206 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:31:11.822590 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:31:11.826713 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:11.827075 [debug] [MainThread]: On master: BEGIN
[0m18:31:11.827329 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:31:11.833717 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:31:11.834104 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:11.834366 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:31:11.839018 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m18:31:11.840539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7828d5e7-94b5-4139-80c1-dafd2a1efb4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99f14b0>]}
[0m18:31:11.840910 [debug] [MainThread]: On master: ROLLBACK
[0m18:31:11.841232 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:11.841467 [debug] [MainThread]: On master: BEGIN
[0m18:31:11.841851 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:31:11.842144 [debug] [MainThread]: On master: COMMIT
[0m18:31:11.842355 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:11.842595 [debug] [MainThread]: On master: COMMIT
[0m18:31:11.842883 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:31:11.843101 [debug] [MainThread]: On master: Close
[0m18:31:11.843509 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:31:11.844695 [info ] [MainThread]: 
[0m18:31:11.848722 [debug] [Thread-1 (]: Began running node model.jaffle_shop.below_depletion_level
[0m18:31:11.848859 [debug] [Thread-2 (]: Began running node model.jaffle_shop.hot_upsell
[0m18:31:11.849195 [info ] [Thread-1 (]: 1 of 4 START view model public.below_depletion_level ........................... [RUN]
[0m18:31:11.849630 [info ] [Thread-2 (]: 2 of 4 START view model public.hot_upsell ...................................... [RUN]
[0m18:31:11.850178 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.below_depletion_level"
[0m18:31:11.851527 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.hot_upsell"
[0m18:31:11.851833 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.below_depletion_level
[0m18:31:11.852071 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.hot_upsell
[0m18:31:11.852348 [debug] [Thread-1 (]: Compiling model.jaffle_shop.below_depletion_level
[0m18:31:11.852605 [debug] [Thread-2 (]: Compiling model.jaffle_shop.hot_upsell
[0m18:31:11.855590 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.below_depletion_level"
[0m18:31:11.857888 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.hot_upsell"
[0m18:31:11.859301 [debug] [Thread-1 (]: finished collecting timing info
[0m18:31:11.859543 [debug] [Thread-2 (]: finished collecting timing info
[0m18:31:11.859674 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.below_depletion_level
[0m18:31:11.859936 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.hot_upsell
[0m18:31:11.902626 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.hot_upsell"
[0m18:31:11.903003 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.below_depletion_level"
[0m18:31:11.904501 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m18:31:11.904627 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m18:31:11.904847 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: BEGIN
[0m18:31:11.905135 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: BEGIN
[0m18:31:11.905522 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:31:11.905827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:11.914446 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:31:11.914841 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m18:31:11.915096 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */

  create view "postgres"."public"."hot_upsell__dbt_tmp" as (
    select distinct ruv.pid as product_id, rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, (ruv.msrp - rupu.price) as profit_margin
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_pads_upsell" rupu on rupu.p_id = ruv.pid and rupu.variant = ruv.variant 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where new_arrival = 'Y' and stock_level < coalesce(depletion_level, 0) and rupu.stock is not null
order by profit_margin desc
  );
[0m18:31:11.915615 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:31:11.915896 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m18:31:11.916124 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */

  create view "postgres"."public"."below_depletion_level__dbt_tmp" as (
    select distinct name, ruv.variant, ruv.actual_size, ruv.weave_cat, ruv.size_grp, ruv.shape, ruv.weight, ruv.stock_level, ruv.depletion_level
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where coalesce(stock_level, 0) < coalesce(depletion_level, 0)
  );
[0m18:31:11.919106 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:31:11.924292 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m18:31:11.924435 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m18:31:11.924667 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
alter table "postgres"."public"."hot_upsell" rename to "hot_upsell__dbt_backup"
[0m18:31:11.926518 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m18:31:11.926944 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level" rename to "below_depletion_level__dbt_backup"
[0m18:31:11.927289 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:11.927518 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:11.929148 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m18:31:11.930871 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m18:31:11.931134 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
alter table "postgres"."public"."hot_upsell__dbt_tmp" rename to "hot_upsell"
[0m18:31:11.931376 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level__dbt_tmp" rename to "below_depletion_level"
[0m18:31:11.931987 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:11.932151 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:11.946792 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: COMMIT
[0m18:31:11.947973 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m18:31:11.948224 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m18:31:11.948449 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m18:31:11.948653 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: COMMIT
[0m18:31:11.948844 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m18:31:11.949392 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:31:11.949508 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:31:11.953950 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m18:31:11.955370 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m18:31:11.955645 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
drop view if exists "postgres"."public"."hot_upsell__dbt_backup" cascade
[0m18:31:11.955847 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
drop view if exists "postgres"."public"."below_depletion_level__dbt_backup" cascade
[0m18:31:11.957721 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:31:11.957840 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:31:11.958809 [debug] [Thread-2 (]: finished collecting timing info
[0m18:31:11.959691 [debug] [Thread-1 (]: finished collecting timing info
[0m18:31:11.959948 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: Close
[0m18:31:11.960177 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: Close
[0m18:31:11.960786 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7828d5e7-94b5-4139-80c1-dafd2a1efb4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a7a590>]}
[0m18:31:11.961313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7828d5e7-94b5-4139-80c1-dafd2a1efb4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff80c93f0>]}
[0m18:31:11.961794 [info ] [Thread-2 (]: 2 of 4 OK created view model public.hot_upsell ................................. [[32mCREATE VIEW[0m in 0.11s]
[0m18:31:11.962302 [info ] [Thread-1 (]: 1 of 4 OK created view model public.below_depletion_level ...................... [[32mCREATE VIEW[0m in 0.11s]
[0m18:31:11.962783 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.hot_upsell
[0m18:31:11.963134 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.below_depletion_level
[0m18:31:11.963414 [debug] [Thread-2 (]: Began running node model.jaffle_shop.underselling_product_specs
[0m18:31:11.963946 [debug] [Thread-1 (]: Began running node model.jaffle_shop.priority_order
[0m18:31:11.964091 [info ] [Thread-2 (]: 3 of 4 START view model public.underselling_product_specs ...................... [RUN]
[0m18:31:11.964362 [info ] [Thread-1 (]: 4 of 4 START view model public.priority_order .................................. [RUN]
[0m18:31:11.964775 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.underselling_product_specs"
[0m18:31:11.965171 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.priority_order"
[0m18:31:11.965366 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.underselling_product_specs
[0m18:31:11.965602 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.priority_order
[0m18:31:11.965820 [debug] [Thread-2 (]: Compiling model.jaffle_shop.underselling_product_specs
[0m18:31:11.966019 [debug] [Thread-1 (]: Compiling model.jaffle_shop.priority_order
[0m18:31:11.968579 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.underselling_product_specs"
[0m18:31:11.970926 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.priority_order"
[0m18:31:11.972315 [debug] [Thread-2 (]: finished collecting timing info
[0m18:31:11.972581 [debug] [Thread-1 (]: finished collecting timing info
[0m18:31:11.972709 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.underselling_product_specs
[0m18:31:11.973050 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.priority_order
[0m18:31:11.976835 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.underselling_product_specs"
[0m18:31:11.979831 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.priority_order"
[0m18:31:11.981207 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m18:31:11.981315 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m18:31:11.981511 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: BEGIN
[0m18:31:11.981724 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: BEGIN
[0m18:31:11.981937 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:31:11.982150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:11.990957 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:31:11.991535 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m18:31:11.991812 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */

  create view "postgres"."public"."underselling_product_specs__dbt_tmp" as (
    select distinct rup.name, rucm.color_value, ruv.actual_size, ruv.weave_cat, ruv.size_grp, ruv.shape, (ruv.stock_level - ruv.depletion_level) as stock_depletion_ratio
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_color_map" rucm on rucm.color_id = ruv.pid 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
where stock_level > coalesce(depletion_level, 0) and depletion_level <> 0 
and stock_level is not null and stock_level <> 0 and new_arrival = 'N' and status = 'In_stock'
order by stock_depletion_ratio desc limit 10
  );
[0m18:31:11.992476 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:31:11.995665 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:31:11.995836 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m18:31:11.998356 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m18:31:11.998646 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */

  create view "postgres"."public"."priority_order__dbt_tmp" as (
    select distinct rup.name as product_name, ruv.variant as variant, ruv.actual_size, ruv.weave_cat, (msrp - price) as profit 
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
join "postgres"."public"."below_depletion_level" bdl on bdl.name = rup.name and bdl.variant = ruv.variant
order by profit desc
  );
[0m18:31:11.998893 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
alter table "postgres"."public"."underselling_product_specs" rename to "underselling_product_specs__dbt_backup"
[0m18:31:12.000046 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:12.004981 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m18:31:12.005575 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
alter table "postgres"."public"."underselling_product_specs__dbt_tmp" rename to "underselling_product_specs"
[0m18:31:12.006671 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:12.009582 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: COMMIT
[0m18:31:12.009801 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m18:31:12.010289 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m18:31:12.013265 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m18:31:12.013831 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: COMMIT
[0m18:31:12.014210 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
alter table "postgres"."public"."priority_order__dbt_tmp" rename to "priority_order"
[0m18:31:12.015922 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:12.016097 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:31:12.017463 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: COMMIT
[0m18:31:12.018956 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m18:31:12.019223 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m18:31:12.019449 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
drop view if exists "postgres"."public"."underselling_product_specs__dbt_backup" cascade
[0m18:31:12.019666 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: COMMIT
[0m18:31:12.020501 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:31:12.023233 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m18:31:12.023377 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:31:12.023615 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
drop view if exists "postgres"."public"."priority_order__dbt_backup" cascade
[0m18:31:12.024593 [debug] [Thread-2 (]: finished collecting timing info
[0m18:31:12.025013 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: Close
[0m18:31:12.025098 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:31:12.025632 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7828d5e7-94b5-4139-80c1-dafd2a1efb4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99ecb80>]}
[0m18:31:12.026479 [debug] [Thread-1 (]: finished collecting timing info
[0m18:31:12.026907 [info ] [Thread-2 (]: 3 of 4 OK created view model public.underselling_product_specs ................. [[32mCREATE VIEW[0m in 0.06s]
[0m18:31:12.027166 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: Close
[0m18:31:12.027653 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.underselling_product_specs
[0m18:31:12.028264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7828d5e7-94b5-4139-80c1-dafd2a1efb4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99ed960>]}
[0m18:31:12.028831 [info ] [Thread-1 (]: 4 of 4 OK created view model public.priority_order ............................. [[32mCREATE VIEW[0m in 0.06s]
[0m18:31:12.029200 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.priority_order
[0m18:31:12.030941 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:31:12.031220 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:12.031445 [debug] [MainThread]: On master: BEGIN
[0m18:31:12.031649 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:31:12.038617 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:31:12.039053 [debug] [MainThread]: On master: COMMIT
[0m18:31:12.039300 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:12.039569 [debug] [MainThread]: On master: COMMIT
[0m18:31:12.039884 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:31:12.040117 [debug] [MainThread]: On master: Close
[0m18:31:12.040794 [info ] [MainThread]: 
[0m18:31:12.041122 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m18:31:12.041542 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:31:12.041807 [debug] [MainThread]: Connection 'model.jaffle_shop.priority_order' was properly closed.
[0m18:31:12.042030 [debug] [MainThread]: Connection 'model.jaffle_shop.underselling_product_specs' was properly closed.
[0m18:31:12.048054 [info ] [MainThread]: 
[0m18:31:12.048378 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:31:12.048808 [info ] [MainThread]: 
[0m18:31:12.049102 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:31:12.049548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99ec0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b8c0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff810f640>]}


============================== 2024-07-14 18:31:16.870177 | 29913389-e87c-419a-89b7-ed26d4a960b8 ==============================
[0m18:31:16.870500 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:31:16.875714 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m18:31:16.876158 [debug] [MainThread]: Tracking: tracking
[0m18:31:16.890516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c25510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c25120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c24ca0>]}
[0m18:31:16.946316 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:31:16.946827 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:31:16.953919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29913389-e87c-419a-89b7-ed26d4a960b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bbdf90>]}
[0m18:31:16.963996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29913389-e87c-419a-89b7-ed26d4a960b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b8c070>]}
[0m18:31:16.964494 [info ] [MainThread]: Found 4 models, 6 tests, 2 snapshots, 0 analyses, 258 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:31:16.964885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29913389-e87c-419a-89b7-ed26d4a960b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b8c130>]}
[0m18:31:16.967230 [info ] [MainThread]: 
[0m18:31:16.967946 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:31:16.971069 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m18:31:16.980615 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:31:16.981026 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:31:16.981293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:17.027989 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m18:31:17.028618 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:31:17.028914 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:31:17.032935 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m18:31:17.034926 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:31:17.035313 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:31:17.040391 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:17.040779 [debug] [MainThread]: On master: BEGIN
[0m18:31:17.041031 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:31:17.048013 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:31:17.048393 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:17.048654 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:31:17.053271 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m18:31:17.054682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29913389-e87c-419a-89b7-ed26d4a960b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9af5240>]}
[0m18:31:17.055077 [debug] [MainThread]: On master: ROLLBACK
[0m18:31:17.055407 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:17.055671 [debug] [MainThread]: On master: BEGIN
[0m18:31:17.056065 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:31:17.056420 [debug] [MainThread]: On master: COMMIT
[0m18:31:17.056671 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:17.056900 [debug] [MainThread]: On master: COMMIT
[0m18:31:17.057215 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:31:17.057473 [debug] [MainThread]: On master: Close
[0m18:31:17.057910 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:31:17.058764 [info ] [MainThread]: 
[0m18:31:17.063338 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:31:17.063612 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:31:17.063907 [info ] [Thread-1 (]: 1 of 6 START test below_depletion_level_tests_below_depletion_level_ ........... [RUN]
[0m18:31:17.064239 [info ] [Thread-2 (]: 2 of 6 START test new_arrival_stock_depletion_test_hot_upsell_ ................. [RUN]
[0m18:31:17.064710 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:31:17.065136 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:31:17.065421 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:31:17.065652 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:31:17.065893 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:31:17.066164 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:31:17.073331 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:31:17.077788 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:31:17.080189 [debug] [Thread-1 (]: finished collecting timing info
[0m18:31:17.080586 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:31:17.080670 [debug] [Thread-2 (]: finished collecting timing info
[0m18:31:17.097414 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:31:17.097708 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:31:17.099993 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:31:17.101945 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:31:17.102303 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m18:31:17.102744 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:31:17.102937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:17.103178 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m18:31:17.103812 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:31:17.111491 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:31:17.111978 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:31:17.112412 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:31:17.112839 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:31:17.113161 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m18:31:17.113401 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT DISTINCT rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, 
                        (ruv.msrp - rupu.price) AS profit_margin
        FROM "postgres"."public"."hot_upsell" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        WHERE new_arrival = 'Y' AND stock_level < COALESCE(depletion_level, 0) AND rupu.stock IS NOT NULL
        ORDER BY profit_margin DESC
    )
    SELECT 
        count(*) as errors
    FROM test_data
    where errors > 0

      
    ) dbt_internal_test
[0m18:31:17.115372 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column ruv.pid does not exist
LINE 12: ...ublic"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AN...
                                                              ^
HINT:  Perhaps you meant to reference the column "rupu.p_id".

[0m18:31:17.115847 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m18:31:17.116364 [debug] [Thread-2 (]: finished collecting timing info
[0m18:31:17.116597 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m18:31:17.117079 [debug] [Thread-2 (]: Database Error in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)
  column ruv.pid does not exist
  LINE 12: ...ublic"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AN...
                                                                ^
  HINT:  Perhaps you meant to reference the column "rupu.p_id".
  compiled SQL at target/run/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m18:31:17.117470 [error] [Thread-2 (]: 2 of 6 ERROR new_arrival_stock_depletion_test_hot_upsell_ ...................... [[31mERROR[0m in 0.05s]
[0m18:31:17.118127 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:31:17.118436 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:31:17.118784 [info ] [Thread-2 (]: 3 of 6 START test not_null_below_depletion_level_name .......................... [RUN]
[0m18:31:17.119237 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:31:17.119596 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:31:17.119875 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:31:17.127899 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:31:17.130631 [debug] [Thread-2 (]: finished collecting timing info
[0m18:31:17.131307 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:31:17.134639 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:31:17.137092 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:31:17.137519 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m18:31:17.137817 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m18:31:17.137920 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:31:17.141507 [debug] [Thread-1 (]: finished collecting timing info
[0m18:31:17.143764 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m18:31:17.145166 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m18:31:17.146039 [info ] [Thread-1 (]: 1 of 6 PASS below_depletion_level_tests_below_depletion_level_ ................. [[32mPASS[0m in 0.08s]
[0m18:31:17.147213 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:31:17.148210 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:31:17.148766 [info ] [Thread-1 (]: 4 of 6 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m18:31:17.149324 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:31:17.149905 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:31:17.150190 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:31:17.159365 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:31:17.159863 [debug] [Thread-2 (]: SQL status: BEGIN in 0.02 seconds
[0m18:31:17.160737 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:31:17.162690 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m18:31:17.162835 [debug] [Thread-1 (]: finished collecting timing info
[0m18:31:17.163255 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:31:17.165251 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:31:17.166381 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:31:17.166601 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m18:31:17.166806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:17.171861 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:31:17.173770 [debug] [Thread-2 (]: finished collecting timing info
[0m18:31:17.174159 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:31:17.175322 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m18:31:17.175613 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:31:17.176395 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m18:31:17.176513 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m18:31:17.176926 [info ] [Thread-2 (]: 3 of 6 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.06s]
[0m18:31:17.177500 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:31:17.177796 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:31:17.178053 [info ] [Thread-2 (]: 5 of 6 START test not_null_hot_upsell_name ..................................... [RUN]
[0m18:31:17.178417 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:31:17.178636 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:31:17.178825 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:31:17.182287 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:31:17.182614 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:31:17.184231 [debug] [Thread-1 (]: finished collecting timing info
[0m18:31:17.184557 [debug] [Thread-2 (]: finished collecting timing info
[0m18:31:17.184663 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m18:31:17.184923 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:31:17.185343 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m18:31:17.186970 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:31:17.187458 [info ] [Thread-1 (]: 4 of 6 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.04s]
[0m18:31:17.188258 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:31:17.188610 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:31:17.188744 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:31:17.188968 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m18:31:17.189189 [info ] [Thread-1 (]: 6 of 6 START test not_null_hot_upsell_variant .................................. [RUN]
[0m18:31:17.189360 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:31:17.189773 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:31:17.190404 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:31:17.190793 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:31:17.194778 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:31:17.196116 [debug] [Thread-1 (]: finished collecting timing info
[0m18:31:17.196490 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:31:17.196616 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:31:17.196866 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:31:17.198548 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:31:17.198811 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m18:31:17.199792 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:31:17.200043 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m18:31:17.200236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:17.203365 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:31:17.204962 [debug] [Thread-2 (]: finished collecting timing info
[0m18:31:17.205258 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m18:31:17.205578 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m18:31:17.205988 [info ] [Thread-2 (]: 5 of 6 PASS not_null_hot_upsell_name ........................................... [[32mPASS[0m in 0.03s]
[0m18:31:17.206393 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:31:17.207097 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:31:17.207635 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:31:17.207907 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m18:31:17.214599 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:31:17.216096 [debug] [Thread-1 (]: finished collecting timing info
[0m18:31:17.216390 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m18:31:17.216734 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m18:31:17.217185 [info ] [Thread-1 (]: 6 of 6 PASS not_null_hot_upsell_variant ........................................ [[32mPASS[0m in 0.03s]
[0m18:31:17.217616 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:31:17.219813 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:31:17.220171 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:17.220417 [debug] [MainThread]: On master: BEGIN
[0m18:31:17.220690 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:31:17.227285 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:31:17.227738 [debug] [MainThread]: On master: COMMIT
[0m18:31:17.227979 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:17.228216 [debug] [MainThread]: On master: COMMIT
[0m18:31:17.228529 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:31:17.228762 [debug] [MainThread]: On master: Close
[0m18:31:17.229455 [info ] [MainThread]: 
[0m18:31:17.229841 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m18:31:17.230198 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:31:17.230476 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b' was properly closed.
[0m18:31:17.230704 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb' was properly closed.
[0m18:31:17.236820 [info ] [MainThread]: 
[0m18:31:17.237144 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:31:17.237463 [info ] [MainThread]: 
[0m18:31:17.237775 [error] [MainThread]: [33mDatabase Error in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)[0m
[0m18:31:17.238050 [error] [MainThread]:   column ruv.pid does not exist
[0m18:31:17.238319 [error] [MainThread]:   LINE 12: ...ublic"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AN...
[0m18:31:17.238590 [error] [MainThread]:                                                                 ^
[0m18:31:17.238868 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "rupu.p_id".
[0m18:31:17.239114 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m18:31:17.239386 [info ] [MainThread]: 
[0m18:31:17.239673 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m18:31:17.240257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9abee00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b8c0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9aade40>]}


============================== 2024-07-14 18:31:58.474803 | 3ff76d4b-0762-4d93-9fc3-81ea2ba8529d ==============================
[0m18:31:58.475144 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:31:58.489922 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m18:31:58.490282 [debug] [MainThread]: Tracking: tracking
[0m18:31:58.505362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2a2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2a710>]}
[0m18:31:58.553415 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:31:58.554141 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/hot_upsell/hot_upsell.sql
[0m18:31:58.592156 [debug] [MainThread]: 1699: static parser successfully parsed hot_upsell/hot_upsell.sql
[0m18:31:58.635136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ff76d4b-0762-4d93-9fc3-81ea2ba8529d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9baa7d0>]}
[0m18:31:58.644291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ff76d4b-0762-4d93-9fc3-81ea2ba8529d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9afbf10>]}
[0m18:31:58.644717 [info ] [MainThread]: Found 4 models, 6 tests, 2 snapshots, 0 analyses, 258 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:31:58.645042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ff76d4b-0762-4d93-9fc3-81ea2ba8529d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9afbfd0>]}
[0m18:31:58.646850 [info ] [MainThread]: 
[0m18:31:58.647435 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:31:58.649621 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m18:31:58.657653 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:31:58.657974 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:31:58.658202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:58.704481 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m18:31:58.705032 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:31:58.705285 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:31:58.709328 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m18:31:58.711054 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:31:58.711460 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:31:58.715871 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:58.716210 [debug] [MainThread]: On master: BEGIN
[0m18:31:58.716434 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:31:58.722735 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:31:58.723067 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:58.723310 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:31:58.727739 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m18:31:58.729111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ff76d4b-0762-4d93-9fc3-81ea2ba8529d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9afad10>]}
[0m18:31:58.729478 [debug] [MainThread]: On master: ROLLBACK
[0m18:31:58.729797 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:58.730026 [debug] [MainThread]: On master: BEGIN
[0m18:31:58.730403 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:31:58.730683 [debug] [MainThread]: On master: COMMIT
[0m18:31:58.730905 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:58.731118 [debug] [MainThread]: On master: COMMIT
[0m18:31:58.731401 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:31:58.731634 [debug] [MainThread]: On master: Close
[0m18:31:58.732017 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:31:58.732316 [info ] [MainThread]: 
[0m18:31:58.736868 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:31:58.737009 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:31:58.737276 [info ] [Thread-1 (]: 1 of 6 START test below_depletion_level_tests_below_depletion_level_ ........... [RUN]
[0m18:31:58.737631 [info ] [Thread-2 (]: 2 of 6 START test new_arrival_stock_depletion_test_hot_upsell_ ................. [RUN]
[0m18:31:58.738119 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:31:58.738698 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:31:58.739035 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:31:58.739326 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:31:58.739580 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:31:58.739841 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:31:58.743685 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:31:58.746378 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:31:58.747803 [debug] [Thread-1 (]: finished collecting timing info
[0m18:31:58.748032 [debug] [Thread-2 (]: finished collecting timing info
[0m18:31:58.748139 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:31:58.748380 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:31:58.762276 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:31:58.764099 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:31:58.766115 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:31:58.766240 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:31:58.766441 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m18:31:58.766665 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m18:31:58.766878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:58.767098 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:31:58.773879 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:31:58.774073 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:31:58.774359 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:31:58.774634 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:31:58.774899 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m18:31:58.775146 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT DISTINCT rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, 
                        (ruv.msrp - rupu.price) AS profit_margin
        FROM "postgres"."public"."hot_upsell" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        WHERE new_arrival = 'Y' AND stock_level < COALESCE(depletion_level, 0) AND rupu.stock IS NOT NULL
        ORDER BY profit_margin DESC
    )
    SELECT 
        count(*) as errors
    FROM test_data
    where errors > 0

      
    ) dbt_internal_test
[0m18:31:58.776910 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column ruv.pid does not exist
LINE 12: ...ublic"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AN...
                                                              ^
HINT:  Perhaps you meant to reference the column "rupu.p_id".

[0m18:31:58.777292 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m18:31:58.777819 [debug] [Thread-2 (]: finished collecting timing info
[0m18:31:58.778073 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m18:31:58.778519 [debug] [Thread-2 (]: Database Error in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)
  column ruv.pid does not exist
  LINE 12: ...ublic"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AN...
                                                                ^
  HINT:  Perhaps you meant to reference the column "rupu.p_id".
  compiled SQL at target/run/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m18:31:58.778902 [error] [Thread-2 (]: 2 of 6 ERROR new_arrival_stock_depletion_test_hot_upsell_ ...................... [[31mERROR[0m in 0.04s]
[0m18:31:58.779539 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:31:58.779963 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:31:58.780268 [info ] [Thread-2 (]: 3 of 6 START test not_null_below_depletion_level_name .......................... [RUN]
[0m18:31:58.780754 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:31:58.781028 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:31:58.781283 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:31:58.787611 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:31:58.787801 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:31:58.790126 [debug] [Thread-1 (]: finished collecting timing info
[0m18:31:58.790494 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m18:31:58.790764 [debug] [Thread-2 (]: finished collecting timing info
[0m18:31:58.791098 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m18:31:58.791217 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:31:58.791677 [info ] [Thread-1 (]: 1 of 6 PASS below_depletion_level_tests_below_depletion_level_ ................. [[32mPASS[0m in 0.05s]
[0m18:31:58.793466 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:31:58.793930 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:31:58.794552 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:31:58.794893 [info ] [Thread-1 (]: 4 of 6 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m18:31:58.795113 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:31:58.795625 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:31:58.795861 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m18:31:58.796079 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:31:58.796269 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:31:58.796477 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:31:58.799741 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:31:58.800966 [debug] [Thread-1 (]: finished collecting timing info
[0m18:31:58.801206 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:31:58.802852 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:31:58.803212 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:31:58.803552 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:31:58.803860 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m18:31:58.803979 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:31:58.804338 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m18:31:58.804543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:58.808688 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:31:58.810083 [debug] [Thread-2 (]: finished collecting timing info
[0m18:31:58.810346 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m18:31:58.810657 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m18:31:58.811095 [info ] [Thread-2 (]: 3 of 6 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.03s]
[0m18:31:58.811518 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:31:58.811947 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:31:58.812244 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:31:58.812530 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:31:58.812823 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m18:31:58.813043 [info ] [Thread-2 (]: 5 of 6 START test not_null_hot_upsell_name ..................................... [RUN]
[0m18:31:58.813661 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:31:58.813990 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:31:58.814256 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:31:58.817986 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:31:58.819079 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:31:58.819214 [debug] [Thread-2 (]: finished collecting timing info
[0m18:31:58.820459 [debug] [Thread-1 (]: finished collecting timing info
[0m18:31:58.820763 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:31:58.821015 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m18:31:58.822679 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:31:58.823069 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m18:31:58.823720 [info ] [Thread-1 (]: 4 of 6 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.03s]
[0m18:31:58.824188 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:31:58.824368 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:31:58.824624 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m18:31:58.824882 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:31:58.825137 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:31:58.825360 [info ] [Thread-1 (]: 6 of 6 START test not_null_hot_upsell_variant .................................. [RUN]
[0m18:31:58.826054 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:31:58.826428 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:31:58.826674 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:31:58.830725 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:31:58.831745 [debug] [Thread-1 (]: finished collecting timing info
[0m18:31:58.831905 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:31:58.832167 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:31:58.832390 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:31:58.834001 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:31:58.834231 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m18:31:58.835090 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:31:58.835301 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m18:31:58.835505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:58.838482 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:31:58.839980 [debug] [Thread-2 (]: finished collecting timing info
[0m18:31:58.840243 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m18:31:58.840532 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m18:31:58.840947 [info ] [Thread-2 (]: 5 of 6 PASS not_null_hot_upsell_name ........................................... [[32mPASS[0m in 0.03s]
[0m18:31:58.841430 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:31:58.842314 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:31:58.842742 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:31:58.843001 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m18:31:58.849572 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:31:58.850954 [debug] [Thread-1 (]: finished collecting timing info
[0m18:31:58.851219 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m18:31:58.851537 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m18:31:58.851974 [info ] [Thread-1 (]: 6 of 6 PASS not_null_hot_upsell_variant ........................................ [[32mPASS[0m in 0.03s]
[0m18:31:58.852379 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:31:58.854410 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:31:58.854711 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:58.854933 [debug] [MainThread]: On master: BEGIN
[0m18:31:58.855153 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:31:58.861745 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:31:58.862181 [debug] [MainThread]: On master: COMMIT
[0m18:31:58.862429 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:58.862656 [debug] [MainThread]: On master: COMMIT
[0m18:31:58.862964 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:31:58.863200 [debug] [MainThread]: On master: Close
[0m18:31:58.863870 [info ] [MainThread]: 
[0m18:31:58.864209 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m18:31:58.864538 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:31:58.865413 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b' was properly closed.
[0m18:31:58.865749 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb' was properly closed.
[0m18:31:58.872168 [info ] [MainThread]: 
[0m18:31:58.873079 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:31:58.873441 [info ] [MainThread]: 
[0m18:31:58.873731 [error] [MainThread]: [33mDatabase Error in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)[0m
[0m18:31:58.874036 [error] [MainThread]:   column ruv.pid does not exist
[0m18:31:58.874289 [error] [MainThread]:   LINE 12: ...ublic"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AN...
[0m18:31:58.874561 [error] [MainThread]:                                                                 ^
[0m18:31:58.874826 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "rupu.p_id".
[0m18:31:58.875099 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m18:31:58.875380 [info ] [MainThread]: 
[0m18:31:58.876002 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m18:31:58.876363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff88f9f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff88fa7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff88cc430>]}


============================== 2024-07-14 18:32:57.170191 | d86e6bba-99aa-4620-aa67-9016a196201c ==============================
[0m18:32:57.170484 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:32:57.175874 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m18:32:57.176307 [debug] [MainThread]: Tracking: tracking
[0m18:32:57.190958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2afb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2bfd0>]}
[0m18:32:57.239534 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:32:57.240154 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/hot_upsell/hot_upsell.sql
[0m18:32:57.240531 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://macros/upsell_test.sql
[0m18:32:57.240806 [debug] [MainThread]: Parsing macros/upsell_test.sql
[0m18:32:57.279957 [debug] [MainThread]: 1699: static parser successfully parsed hot_upsell/hot_upsell.sql
[0m18:32:57.321107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd86e6bba-99aa-4620-aa67-9016a196201c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99f6da0>]}
[0m18:32:57.332642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd86e6bba-99aa-4620-aa67-9016a196201c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1c880>]}
[0m18:32:57.333134 [info ] [MainThread]: Found 4 models, 6 tests, 2 snapshots, 0 analyses, 258 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:32:57.333489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd86e6bba-99aa-4620-aa67-9016a196201c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b697e0>]}
[0m18:32:57.335368 [info ] [MainThread]: 
[0m18:32:57.335991 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:32:57.338365 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m18:32:57.346413 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:32:57.346722 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:32:57.346943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:57.390792 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m18:32:57.391307 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:32:57.391560 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:32:57.395618 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m18:32:57.397307 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:32:57.397711 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:32:57.402107 [debug] [MainThread]: Using postgres connection "master"
[0m18:32:57.402445 [debug] [MainThread]: On master: BEGIN
[0m18:32:57.402687 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:32:57.409341 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:32:57.409694 [debug] [MainThread]: Using postgres connection "master"
[0m18:32:57.409944 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:32:57.414648 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m18:32:57.415988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd86e6bba-99aa-4620-aa67-9016a196201c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99f4a00>]}
[0m18:32:57.416349 [debug] [MainThread]: On master: ROLLBACK
[0m18:32:57.416674 [debug] [MainThread]: Using postgres connection "master"
[0m18:32:57.416895 [debug] [MainThread]: On master: BEGIN
[0m18:32:57.417286 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:32:57.417564 [debug] [MainThread]: On master: COMMIT
[0m18:32:57.417785 [debug] [MainThread]: Using postgres connection "master"
[0m18:32:57.417996 [debug] [MainThread]: On master: COMMIT
[0m18:32:57.418310 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:32:57.418542 [debug] [MainThread]: On master: Close
[0m18:32:57.418932 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:32:57.419237 [info ] [MainThread]: 
[0m18:32:57.423234 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:32:57.423381 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:32:57.423655 [info ] [Thread-1 (]: 1 of 6 START test below_depletion_level_tests_below_depletion_level_ ........... [RUN]
[0m18:32:57.423973 [info ] [Thread-2 (]: 2 of 6 START test new_arrival_stock_depletion_test_hot_upsell_ ................. [RUN]
[0m18:32:57.424485 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:32:57.425079 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:32:57.425426 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:32:57.425665 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:32:57.425925 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:32:57.426165 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:32:57.429995 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:32:57.432710 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:32:57.434217 [debug] [Thread-1 (]: finished collecting timing info
[0m18:32:57.434312 [debug] [Thread-2 (]: finished collecting timing info
[0m18:32:57.434534 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:32:57.434772 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:32:57.448749 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:32:57.450456 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:32:57.453661 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:32:57.453789 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:32:57.453999 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m18:32:57.454755 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m18:32:57.455015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:57.455357 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:32:57.462693 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:32:57.462874 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:32:57.463164 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:32:57.463682 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:32:57.463889 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m18:32:57.464092 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT DISTINCT ruv.product_id, rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, 
                        (ruv.msrp - rupu.price) AS profit_margin
        FROM "postgres"."public"."hot_upsell" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.product_id
        WHERE new_arrival = 'Y' AND stock_level < COALESCE(depletion_level, 0) AND rupu.stock IS NOT NULL
        ORDER BY profit_margin DESC
    )
    SELECT 
        count(*) as errors
    FROM test_data
    where errors > 0

      
    ) dbt_internal_test
[0m18:32:57.471028 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column ruv.pid does not exist
LINE 12: ...ublic"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AN...
                                                              ^
HINT:  Perhaps you meant to reference the column "rupu.p_id".

[0m18:32:57.471496 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m18:32:57.472026 [debug] [Thread-2 (]: finished collecting timing info
[0m18:32:57.472520 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m18:32:57.473178 [debug] [Thread-2 (]: Database Error in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)
  column ruv.pid does not exist
  LINE 12: ...ublic"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AN...
                                                                ^
  HINT:  Perhaps you meant to reference the column "rupu.p_id".
  compiled SQL at target/run/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m18:32:57.473943 [error] [Thread-2 (]: 2 of 6 ERROR new_arrival_stock_depletion_test_hot_upsell_ ...................... [[31mERROR[0m in 0.05s]
[0m18:32:57.474613 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:32:57.474999 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:32:57.475390 [info ] [Thread-2 (]: 3 of 6 START test not_null_below_depletion_level_name .......................... [RUN]
[0m18:32:57.475900 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:32:57.476176 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:32:57.476436 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:32:57.482775 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:32:57.484406 [debug] [Thread-2 (]: finished collecting timing info
[0m18:32:57.484717 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:32:57.484919 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m18:32:57.486453 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:32:57.488468 [debug] [Thread-1 (]: finished collecting timing info
[0m18:32:57.489081 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m18:32:57.489408 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m18:32:57.489614 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:32:57.489978 [info ] [Thread-1 (]: 1 of 6 PASS below_depletion_level_tests_below_depletion_level_ ................. [[32mPASS[0m in 0.07s]
[0m18:32:57.490801 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m18:32:57.491234 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:32:57.491441 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:32:57.491720 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:32:57.492267 [info ] [Thread-1 (]: 4 of 6 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m18:32:57.492897 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:32:57.493150 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:32:57.493385 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:32:57.496759 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:32:57.497671 [debug] [Thread-1 (]: finished collecting timing info
[0m18:32:57.497899 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:32:57.499534 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:32:57.499882 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:32:57.500279 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:32:57.500516 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m18:32:57.500625 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:32:57.500960 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m18:32:57.501156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:57.505385 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:32:57.507176 [debug] [Thread-2 (]: finished collecting timing info
[0m18:32:57.507771 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m18:32:57.507868 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:32:57.508238 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m18:32:57.508327 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:32:57.508753 [info ] [Thread-2 (]: 3 of 6 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.03s]
[0m18:32:57.508960 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m18:32:57.509362 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:32:57.513318 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:32:57.513613 [info ] [Thread-2 (]: 5 of 6 START test not_null_hot_upsell_name ..................................... [RUN]
[0m18:32:57.514004 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:32:57.514222 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:32:57.514383 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:32:57.517405 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:32:57.517539 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:32:57.519113 [debug] [Thread-1 (]: finished collecting timing info
[0m18:32:57.519442 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m18:32:57.519682 [debug] [Thread-2 (]: finished collecting timing info
[0m18:32:57.519996 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m18:32:57.520098 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:32:57.520475 [info ] [Thread-1 (]: 4 of 6 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.03s]
[0m18:32:57.522658 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:32:57.523039 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:32:57.523781 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:32:57.524107 [info ] [Thread-1 (]: 6 of 6 START test not_null_hot_upsell_variant .................................. [RUN]
[0m18:32:57.524340 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:32:57.524776 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:32:57.524961 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m18:32:57.525216 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:32:57.525423 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:32:57.525641 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:32:57.530045 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:32:57.531511 [debug] [Thread-1 (]: finished collecting timing info
[0m18:32:57.531754 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:32:57.533357 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:32:57.533666 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:32:57.533963 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:32:57.534237 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m18:32:57.534344 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:32:57.534701 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m18:32:57.534935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:57.537993 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:32:57.539410 [debug] [Thread-2 (]: finished collecting timing info
[0m18:32:57.539665 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m18:32:57.539952 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m18:32:57.540421 [info ] [Thread-2 (]: 5 of 6 PASS not_null_hot_upsell_name ........................................... [[32mPASS[0m in 0.03s]
[0m18:32:57.540839 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:32:57.541279 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:32:57.541659 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:32:57.541897 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m18:32:57.548786 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:32:57.550209 [debug] [Thread-1 (]: finished collecting timing info
[0m18:32:57.550530 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m18:32:57.550859 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m18:32:57.551301 [info ] [Thread-1 (]: 6 of 6 PASS not_null_hot_upsell_variant ........................................ [[32mPASS[0m in 0.03s]
[0m18:32:57.551722 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:32:57.553535 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:32:57.553818 [debug] [MainThread]: Using postgres connection "master"
[0m18:32:57.554040 [debug] [MainThread]: On master: BEGIN
[0m18:32:57.554269 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:32:57.560295 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:32:57.560619 [debug] [MainThread]: On master: COMMIT
[0m18:32:57.560841 [debug] [MainThread]: Using postgres connection "master"
[0m18:32:57.561076 [debug] [MainThread]: On master: COMMIT
[0m18:32:57.561384 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:32:57.561619 [debug] [MainThread]: On master: Close
[0m18:32:57.562225 [info ] [MainThread]: 
[0m18:32:57.562540 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m18:32:57.562870 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:32:57.563144 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b' was properly closed.
[0m18:32:57.563348 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb' was properly closed.
[0m18:32:57.569637 [info ] [MainThread]: 
[0m18:32:57.569927 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:32:57.570338 [info ] [MainThread]: 
[0m18:32:57.570681 [error] [MainThread]: [33mDatabase Error in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)[0m
[0m18:32:57.570978 [error] [MainThread]:   column ruv.pid does not exist
[0m18:32:57.571287 [error] [MainThread]:   LINE 12: ...ublic"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AN...
[0m18:32:57.571584 [error] [MainThread]:                                                                 ^
[0m18:32:57.571852 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "rupu.p_id".
[0m18:32:57.572149 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m18:32:57.572398 [info ] [MainThread]: 
[0m18:32:57.572643 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m18:32:57.572986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b697b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff88fe4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff88c26e0>]}


============================== 2024-07-14 18:33:17.632377 | 4c608f79-c8c7-4c4b-99c9-13c1e05cfcc5 ==============================
[0m18:33:17.632693 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:33:17.649159 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m18:33:17.649545 [debug] [MainThread]: Tracking: tracking
[0m18:33:17.664833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c262c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c273a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c26710>]}
[0m18:33:17.713812 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:33:17.714644 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://macros/upsell_test.sql
[0m18:33:17.714952 [debug] [MainThread]: Parsing macros/upsell_test.sql
[0m18:33:17.755279 [debug] [MainThread]: 1699: static parser successfully parsed hot_upsell/hot_upsell.sql
[0m18:33:17.796687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c608f79-c8c7-4c4b-99c9-13c1e05cfcc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba3d90>]}
[0m18:33:17.806382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c608f79-c8c7-4c4b-99c9-13c1e05cfcc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c0ea70>]}
[0m18:33:17.806822 [info ] [MainThread]: Found 4 models, 6 tests, 2 snapshots, 0 analyses, 258 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:33:17.807178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c608f79-c8c7-4c4b-99c9-13c1e05cfcc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b65780>]}
[0m18:33:17.809033 [info ] [MainThread]: 
[0m18:33:17.809650 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:33:17.811935 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m18:33:17.820354 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:33:17.820708 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:33:17.820951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:33:17.871505 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m18:33:17.872006 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:33:17.872266 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:33:17.876313 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m18:33:17.878062 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:33:17.878470 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:33:17.883152 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:17.883477 [debug] [MainThread]: On master: BEGIN
[0m18:33:17.883705 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:33:17.891093 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:33:17.891432 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:17.891688 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:33:17.896295 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m18:33:17.897683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c608f79-c8c7-4c4b-99c9-13c1e05cfcc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba0070>]}
[0m18:33:17.898050 [debug] [MainThread]: On master: ROLLBACK
[0m18:33:17.898362 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:17.898602 [debug] [MainThread]: On master: BEGIN
[0m18:33:17.898997 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:33:17.899288 [debug] [MainThread]: On master: COMMIT
[0m18:33:17.899536 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:17.899755 [debug] [MainThread]: On master: COMMIT
[0m18:33:17.900045 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:33:17.900271 [debug] [MainThread]: On master: Close
[0m18:33:17.900716 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:33:17.901037 [info ] [MainThread]: 
[0m18:33:17.904361 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:33:17.904515 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:33:17.905291 [info ] [Thread-1 (]: 1 of 6 START test below_depletion_level_tests_below_depletion_level_ ........... [RUN]
[0m18:33:17.905618 [info ] [Thread-2 (]: 2 of 6 START test new_arrival_stock_depletion_test_hot_upsell_ ................. [RUN]
[0m18:33:17.906158 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:33:17.906735 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:33:17.907084 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:33:17.907341 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:33:17.907618 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:33:17.907869 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:33:17.912071 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:33:17.915017 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:33:17.918098 [debug] [Thread-1 (]: finished collecting timing info
[0m18:33:17.918325 [debug] [Thread-2 (]: finished collecting timing info
[0m18:33:17.918448 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:33:17.918690 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:33:17.932936 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:33:17.934432 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:33:17.935966 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:33:17.936186 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:33:17.936291 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m18:33:17.936543 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m18:33:17.937083 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:33:17.936804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:17.944221 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:33:17.944432 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:33:17.944686 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:33:17.944948 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:33:17.945206 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT DISTINCT ruv.product_id, rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, 
                        (ruv.msrp - rupu.price) AS profit_margin
        FROM "postgres"."public"."hot_upsell" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.product_id AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.product_id
        WHERE new_arrival = 'Y' AND stock_level < COALESCE(depletion_level, 0) AND rupu.stock IS NOT NULL
        ORDER BY profit_margin DESC
    )
    SELECT 
        count(*) as errors
    FROM test_data
    where errors > 0

      
    ) dbt_internal_test
[0m18:33:17.945452 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m18:33:17.947573 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column ruv.msrp does not exist
LINE 10:                         (ruv.msrp - rupu.price) AS profit_ma...
                                  ^

[0m18:33:17.947907 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m18:33:17.948394 [debug] [Thread-2 (]: finished collecting timing info
[0m18:33:17.948701 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m18:33:17.949184 [debug] [Thread-2 (]: Database Error in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)
  column ruv.msrp does not exist
  LINE 10:                         (ruv.msrp - rupu.price) AS profit_ma...
                                    ^
  compiled SQL at target/run/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m18:33:17.949566 [error] [Thread-2 (]: 2 of 6 ERROR new_arrival_stock_depletion_test_hot_upsell_ ...................... [[31mERROR[0m in 0.04s]
[0m18:33:17.950163 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:33:17.950519 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:33:17.950839 [info ] [Thread-2 (]: 3 of 6 START test not_null_below_depletion_level_name .......................... [RUN]
[0m18:33:17.951314 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:33:17.951566 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:33:17.951791 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:33:17.958151 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:33:17.958340 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:33:17.960732 [debug] [Thread-1 (]: finished collecting timing info
[0m18:33:17.961037 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m18:33:17.961260 [debug] [Thread-2 (]: finished collecting timing info
[0m18:33:17.961476 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m18:33:17.961566 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:33:17.961975 [info ] [Thread-1 (]: 1 of 6 PASS below_depletion_level_tests_below_depletion_level_ ................. [[32mPASS[0m in 0.06s]
[0m18:33:17.963682 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:33:17.964153 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:33:17.964791 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:33:17.965084 [info ] [Thread-1 (]: 4 of 6 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m18:33:17.965366 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:33:17.965709 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:33:17.966056 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m18:33:17.966339 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:33:17.966592 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:33:17.967440 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:33:17.971086 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:33:17.972052 [debug] [Thread-1 (]: finished collecting timing info
[0m18:33:17.972282 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:33:17.973955 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:33:17.974278 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:33:17.974676 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:33:17.974907 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m18:33:17.975151 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:33:17.975391 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m18:33:17.975608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:17.980245 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:33:17.981647 [debug] [Thread-2 (]: finished collecting timing info
[0m18:33:17.981920 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m18:33:17.982229 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m18:33:17.982677 [info ] [Thread-2 (]: 3 of 6 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.03s]
[0m18:33:17.983156 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:33:17.983305 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:33:17.983614 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:33:17.983889 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:33:17.984113 [info ] [Thread-2 (]: 5 of 6 START test not_null_hot_upsell_name ..................................... [RUN]
[0m18:33:17.984322 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m18:33:17.984793 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:33:17.985159 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:33:17.985406 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:33:17.989216 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:33:17.991463 [debug] [Thread-2 (]: finished collecting timing info
[0m18:33:17.991935 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:33:17.993937 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:33:17.994087 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:33:17.996002 [debug] [Thread-1 (]: finished collecting timing info
[0m18:33:17.996265 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m18:33:17.996501 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:33:17.996795 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m18:33:17.996880 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m18:33:17.997267 [info ] [Thread-1 (]: 4 of 6 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.03s]
[0m18:33:17.997480 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:33:17.997878 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:33:17.998457 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:33:17.998795 [info ] [Thread-1 (]: 6 of 6 START test not_null_hot_upsell_variant .................................. [RUN]
[0m18:33:17.999271 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:33:17.999542 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:33:17.999768 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:33:18.003904 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:33:18.004557 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:33:18.004900 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:33:18.005123 [debug] [Thread-1 (]: finished collecting timing info
[0m18:33:18.005203 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m18:33:18.005447 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:33:18.007322 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:33:18.008193 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:33:18.008404 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m18:33:18.008614 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:18.009169 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:33:18.010555 [debug] [Thread-2 (]: finished collecting timing info
[0m18:33:18.010817 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m18:33:18.011081 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m18:33:18.011495 [info ] [Thread-2 (]: 5 of 6 PASS not_null_hot_upsell_name ........................................... [[32mPASS[0m in 0.03s]
[0m18:33:18.011935 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:33:18.015239 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:33:18.015693 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:33:18.015941 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m18:33:18.022803 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:33:18.024206 [debug] [Thread-1 (]: finished collecting timing info
[0m18:33:18.024478 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m18:33:18.024809 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m18:33:18.025252 [info ] [Thread-1 (]: 6 of 6 PASS not_null_hot_upsell_variant ........................................ [[32mPASS[0m in 0.03s]
[0m18:33:18.025706 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:33:18.027604 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:33:18.027935 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:18.028205 [debug] [MainThread]: On master: BEGIN
[0m18:33:18.028445 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:33:18.035369 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:33:18.035767 [debug] [MainThread]: On master: COMMIT
[0m18:33:18.035997 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:18.036225 [debug] [MainThread]: On master: COMMIT
[0m18:33:18.036545 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:33:18.036789 [debug] [MainThread]: On master: Close
[0m18:33:18.037453 [info ] [MainThread]: 
[0m18:33:18.037799 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m18:33:18.038132 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:33:18.038379 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b' was properly closed.
[0m18:33:18.038636 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb' was properly closed.
[0m18:33:18.044711 [info ] [MainThread]: 
[0m18:33:18.045043 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:33:18.045412 [info ] [MainThread]: 
[0m18:33:18.045724 [error] [MainThread]: [33mDatabase Error in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)[0m
[0m18:33:18.046014 [error] [MainThread]:   column ruv.msrp does not exist
[0m18:33:18.046303 [error] [MainThread]:   LINE 10:                         (ruv.msrp - rupu.price) AS profit_ma...
[0m18:33:18.046708 [error] [MainThread]:                                     ^
[0m18:33:18.046988 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m18:33:18.047276 [info ] [MainThread]: 
[0m18:33:18.047570 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m18:33:18.047913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff88ec160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b65750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bb9360>]}


============================== 2024-07-14 18:38:05.296484 | a846e8c5-13ae-42db-8e8f-c344bd8a7a12 ==============================
[0m18:38:05.296792 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:38:05.319812 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m18:38:05.320163 [debug] [MainThread]: Tracking: tracking
[0m18:38:05.335131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2afb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b250>]}
[0m18:38:05.396930 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:38:05.397623 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://macros/upsell_test.sql
[0m18:38:05.397941 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/hot_upsell/hot_upsell.sql
[0m18:38:05.398206 [debug] [MainThread]: Parsing macros/upsell_test.sql
[0m18:38:05.434320 [debug] [MainThread]: 1699: static parser successfully parsed hot_upsell/hot_upsell.sql
[0m18:38:05.477544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a846e8c5-13ae-42db-8e8f-c344bd8a7a12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba3790>]}
[0m18:38:05.513979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a846e8c5-13ae-42db-8e8f-c344bd8a7a12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1f970>]}
[0m18:38:05.514431 [info ] [MainThread]: Found 4 models, 6 tests, 2 snapshots, 0 analyses, 258 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:38:05.514788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a846e8c5-13ae-42db-8e8f-c344bd8a7a12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b657e0>]}
[0m18:38:05.516765 [info ] [MainThread]: 
[0m18:38:05.517425 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:38:05.520087 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m18:38:05.528381 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:38:05.528666 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:38:05.528889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:05.574083 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m18:38:05.574618 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:38:05.574871 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:38:05.578988 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m18:38:05.580660 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:38:05.581069 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:38:05.585441 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:05.585746 [debug] [MainThread]: On master: BEGIN
[0m18:38:05.585971 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:38:05.593248 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:38:05.593602 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:05.593829 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:38:05.598603 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m18:38:05.599951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a846e8c5-13ae-42db-8e8f-c344bd8a7a12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba20e0>]}
[0m18:38:05.600317 [debug] [MainThread]: On master: ROLLBACK
[0m18:38:05.600603 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:05.600810 [debug] [MainThread]: On master: BEGIN
[0m18:38:05.601123 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:38:05.601355 [debug] [MainThread]: On master: COMMIT
[0m18:38:05.601551 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:05.601786 [debug] [MainThread]: On master: COMMIT
[0m18:38:05.602033 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:38:05.602234 [debug] [MainThread]: On master: Close
[0m18:38:05.602598 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:38:05.602910 [info ] [MainThread]: 
[0m18:38:05.606649 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:38:05.606807 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:38:05.607073 [info ] [Thread-1 (]: 1 of 6 START test below_depletion_level_tests_below_depletion_level_ ........... [RUN]
[0m18:38:05.607414 [info ] [Thread-2 (]: 2 of 6 START test new_arrival_stock_depletion_test_hot_upsell_ ................. [RUN]
[0m18:38:05.607876 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:38:05.608465 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:38:05.608806 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:38:05.609048 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:38:05.609317 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:38:05.609580 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:38:05.613476 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:38:05.616101 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:38:05.618189 [debug] [Thread-1 (]: finished collecting timing info
[0m18:38:05.618305 [debug] [Thread-2 (]: finished collecting timing info
[0m18:38:05.618525 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:38:05.618815 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:38:05.634457 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:38:05.635936 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:38:05.637763 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:38:05.637887 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:38:05.638099 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m18:38:05.638344 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m18:38:05.638579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:38:05.638816 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:38:05.645846 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:38:05.646049 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:38:05.646334 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:38:05.646630 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:38:05.646866 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT DISTINCT rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, 
                        (ruv.msrp - rupu.price) AS profit_margin
        FROM "postgres"."public"."rugs_usa_variant" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.product_id AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.product_id
        /* joining on model as none of these should show. doing an inner join for this purpose to test */
        JOIN "postgres"."public"."hot_upsell" model on model.name = rup.name and model.variant = rup.variant and model.size = rupu.size and model.shape = rupu.shape and model.type = rupu.type
        ORDER BY profit_margin DESC
    )
    SELECT 
        count(*) as errors
    FROM test_data
    where errors > 0

      
    ) dbt_internal_test
[0m18:38:05.647080 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m18:38:05.648487 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column ruv.product_id does not exist
LINE 12: ...ublic"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.produc...
                                                              ^

[0m18:38:05.648878 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m18:38:05.649826 [debug] [Thread-2 (]: finished collecting timing info
[0m18:38:05.650170 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m18:38:05.650701 [debug] [Thread-2 (]: Database Error in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)
  column ruv.product_id does not exist
  LINE 12: ...ublic"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.produc...
                                                                ^
  compiled SQL at target/run/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m18:38:05.651740 [error] [Thread-2 (]: 2 of 6 ERROR new_arrival_stock_depletion_test_hot_upsell_ ...................... [[31mERROR[0m in 0.04s]
[0m18:38:05.652468 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:38:05.652843 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:38:05.653237 [info ] [Thread-2 (]: 3 of 6 START test not_null_below_depletion_level_name .......................... [RUN]
[0m18:38:05.653820 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:38:05.654178 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:38:05.654471 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:38:05.661228 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:38:05.662711 [debug] [Thread-2 (]: finished collecting timing info
[0m18:38:05.662866 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m18:38:05.663124 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:38:05.665332 [debug] [Thread-1 (]: finished collecting timing info
[0m18:38:05.667107 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:38:05.667387 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m18:38:05.668065 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m18:38:05.668314 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:38:05.668634 [info ] [Thread-1 (]: 1 of 6 PASS below_depletion_level_tests_below_depletion_level_ ................. [[32mPASS[0m in 0.06s]
[0m18:38:05.668746 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m18:38:05.669204 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:38:05.669511 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:38:05.669797 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:38:05.670369 [info ] [Thread-1 (]: 4 of 6 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m18:38:05.671090 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:38:05.671344 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:38:05.671574 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:38:05.674759 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:38:05.675674 [debug] [Thread-1 (]: finished collecting timing info
[0m18:38:05.675919 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:38:05.677445 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:38:05.677776 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:38:05.678113 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:38:05.678402 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m18:38:05.678513 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:38:05.678856 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m18:38:05.679053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:38:05.683486 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:38:05.684926 [debug] [Thread-2 (]: finished collecting timing info
[0m18:38:05.685194 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m18:38:05.685494 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m18:38:05.685975 [info ] [Thread-2 (]: 3 of 6 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.03s]
[0m18:38:05.686800 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:38:05.686921 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:38:05.687249 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:38:05.706459 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:38:05.706811 [info ] [Thread-2 (]: 5 of 6 START test not_null_hot_upsell_name ..................................... [RUN]
[0m18:38:05.707125 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m18:38:05.707718 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:38:05.708207 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:38:05.708504 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:38:05.712406 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:38:05.713821 [debug] [Thread-2 (]: finished collecting timing info
[0m18:38:05.714110 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:38:05.716105 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:38:05.716241 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:38:05.718037 [debug] [Thread-1 (]: finished collecting timing info
[0m18:38:05.718698 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m18:38:05.719799 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:38:05.720590 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m18:38:05.721399 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m18:38:05.722626 [info ] [Thread-1 (]: 4 of 6 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.05s]
[0m18:38:05.722870 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:38:05.723344 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:38:05.723991 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:38:05.724556 [info ] [Thread-1 (]: 6 of 6 START test not_null_hot_upsell_variant .................................. [RUN]
[0m18:38:05.725245 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:38:05.725637 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:38:05.725873 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:38:05.730960 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:38:05.731324 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:38:05.731918 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:38:05.732159 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m18:38:05.732384 [debug] [Thread-1 (]: finished collecting timing info
[0m18:38:05.732683 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:38:05.734515 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:38:05.735369 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:38:05.735591 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m18:38:05.735786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:38:05.736139 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:38:05.737566 [debug] [Thread-2 (]: finished collecting timing info
[0m18:38:05.737836 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m18:38:05.738128 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m18:38:05.738530 [info ] [Thread-2 (]: 5 of 6 PASS not_null_hot_upsell_name ........................................... [[32mPASS[0m in 0.03s]
[0m18:38:05.738951 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:38:05.742229 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:38:05.742500 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:38:05.742714 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m18:38:05.749384 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:38:05.750743 [debug] [Thread-1 (]: finished collecting timing info
[0m18:38:05.751011 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m18:38:05.751328 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m18:38:05.751775 [info ] [Thread-1 (]: 6 of 6 PASS not_null_hot_upsell_variant ........................................ [[32mPASS[0m in 0.03s]
[0m18:38:05.752215 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:38:05.754046 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:38:05.754325 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:05.754557 [debug] [MainThread]: On master: BEGIN
[0m18:38:05.754772 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:38:05.761354 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:38:05.761638 [debug] [MainThread]: On master: COMMIT
[0m18:38:05.761844 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:05.762055 [debug] [MainThread]: On master: COMMIT
[0m18:38:05.762333 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:38:05.762568 [debug] [MainThread]: On master: Close
[0m18:38:05.763187 [info ] [MainThread]: 
[0m18:38:05.763516 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m18:38:05.763831 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:38:05.764106 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b' was properly closed.
[0m18:38:05.764314 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb' was properly closed.
[0m18:38:05.770579 [info ] [MainThread]: 
[0m18:38:05.770890 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:38:05.771313 [info ] [MainThread]: 
[0m18:38:05.771700 [error] [MainThread]: [33mDatabase Error in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)[0m
[0m18:38:05.771968 [error] [MainThread]:   column ruv.product_id does not exist
[0m18:38:05.772229 [error] [MainThread]:   LINE 12: ...ublic"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.produc...
[0m18:38:05.772524 [error] [MainThread]:                                                                 ^
[0m18:38:05.772819 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m18:38:05.773094 [info ] [MainThread]: 
[0m18:38:05.773354 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m18:38:05.773715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff88f0580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b657b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bbb5e0>]}


============================== 2024-07-14 18:38:21.542667 | 2be2b39a-886f-4cf4-8578-e69754e979ec ==============================
[0m18:38:21.542968 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:38:21.546526 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m18:38:21.546923 [debug] [MainThread]: Tracking: tracking
[0m18:38:21.561205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c15d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c14c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c15900>]}
[0m18:38:21.609163 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:38:21.609846 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://macros/upsell_test.sql
[0m18:38:21.610120 [debug] [MainThread]: Parsing macros/upsell_test.sql
[0m18:38:21.651921 [debug] [MainThread]: 1699: static parser successfully parsed hot_upsell/hot_upsell.sql
[0m18:38:21.693000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2be2b39a-886f-4cf4-8578-e69754e979ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba3490>]}
[0m18:38:21.702312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2be2b39a-886f-4cf4-8578-e69754e979ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1ead0>]}
[0m18:38:21.702753 [info ] [MainThread]: Found 4 models, 6 tests, 2 snapshots, 0 analyses, 258 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:38:21.703085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2be2b39a-886f-4cf4-8578-e69754e979ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b65780>]}
[0m18:38:21.704806 [info ] [MainThread]: 
[0m18:38:21.705436 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:38:21.707635 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m18:38:21.715491 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:38:21.715821 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:38:21.716062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:21.759532 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m18:38:21.760004 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:38:21.760257 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:38:21.763918 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m18:38:21.765685 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:38:21.766046 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:38:21.770397 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:21.770722 [debug] [MainThread]: On master: BEGIN
[0m18:38:21.770956 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:38:21.778054 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:38:21.778387 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:21.778622 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:38:21.783249 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m18:38:21.784580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2be2b39a-886f-4cf4-8578-e69754e979ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba01f0>]}
[0m18:38:21.784949 [debug] [MainThread]: On master: ROLLBACK
[0m18:38:21.785309 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:21.785549 [debug] [MainThread]: On master: BEGIN
[0m18:38:21.785949 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:38:21.786210 [debug] [MainThread]: On master: COMMIT
[0m18:38:21.786461 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:21.786671 [debug] [MainThread]: On master: COMMIT
[0m18:38:21.786966 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:38:21.787189 [debug] [MainThread]: On master: Close
[0m18:38:21.787603 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:38:21.787925 [info ] [MainThread]: 
[0m18:38:21.792143 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:38:21.792283 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:38:21.792581 [info ] [Thread-1 (]: 1 of 6 START test below_depletion_level_tests_below_depletion_level_ ........... [RUN]
[0m18:38:21.792919 [info ] [Thread-2 (]: 2 of 6 START test new_arrival_stock_depletion_test_hot_upsell_ ................. [RUN]
[0m18:38:21.793391 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:38:21.793999 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:38:21.794319 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:38:21.794554 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:38:21.794777 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:38:21.794976 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:38:21.798882 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:38:21.801651 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:38:21.803207 [debug] [Thread-1 (]: finished collecting timing info
[0m18:38:21.804358 [debug] [Thread-2 (]: finished collecting timing info
[0m18:38:21.804486 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:38:21.804758 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:38:21.819783 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:38:21.821424 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:38:21.822852 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:38:21.823169 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m18:38:21.823295 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:38:21.823510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:38:21.823760 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m18:38:21.824458 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:38:21.830645 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:38:21.830983 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:38:21.831106 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:38:21.831356 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:38:21.831638 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m18:38:21.831863 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT DISTINCT rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, 
                        (ruv.msrp - rupu.price) AS profit_margin
        FROM "postgres"."public"."rugs_usa_variant" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        /* joining on model as none of these should show. doing an inner join for this purpose to test */
        JOIN "postgres"."public"."hot_upsell" model on model.name = rup.name and model.variant = rup.variant and model.size = rupu.size and model.shape = rupu.shape and model.type = rupu.type
        ORDER BY profit_margin DESC
    )
    SELECT 
        count(*) as errors
    FROM test_data
    where errors > 0

      
    ) dbt_internal_test
[0m18:38:21.833955 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column rup.variant does not exist
LINE 15: ...odel on model.name = rup.name and model.variant = rup.varian...
                                                              ^
HINT:  Perhaps you meant to reference the column "ruv.variant" or the column "rupu.variant".

[0m18:38:21.834243 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m18:38:21.834709 [debug] [Thread-2 (]: finished collecting timing info
[0m18:38:21.834956 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m18:38:21.835407 [debug] [Thread-2 (]: Database Error in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)
  column rup.variant does not exist
  LINE 15: ...odel on model.name = rup.name and model.variant = rup.varian...
                                                                ^
  HINT:  Perhaps you meant to reference the column "ruv.variant" or the column "rupu.variant".
  compiled SQL at target/run/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m18:38:21.836209 [error] [Thread-2 (]: 2 of 6 ERROR new_arrival_stock_depletion_test_hot_upsell_ ...................... [[31mERROR[0m in 0.04s]
[0m18:38:21.836827 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:38:21.837179 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:38:21.837527 [info ] [Thread-2 (]: 3 of 6 START test not_null_below_depletion_level_name .......................... [RUN]
[0m18:38:21.838019 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:38:21.838358 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:38:21.838632 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:38:21.844844 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:38:21.845076 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:38:21.847503 [debug] [Thread-1 (]: finished collecting timing info
[0m18:38:21.847835 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m18:38:21.847924 [debug] [Thread-2 (]: finished collecting timing info
[0m18:38:21.848264 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m18:38:21.848369 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:38:21.848801 [info ] [Thread-1 (]: 1 of 6 PASS below_depletion_level_tests_below_depletion_level_ ................. [[32mPASS[0m in 0.06s]
[0m18:38:21.850583 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:38:21.851038 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:38:21.851607 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:38:21.851910 [info ] [Thread-1 (]: 4 of 6 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m18:38:21.852146 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:38:21.852589 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:38:21.852791 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m18:38:21.853027 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:38:21.853243 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:38:21.853481 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:38:21.856950 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:38:21.858219 [debug] [Thread-1 (]: finished collecting timing info
[0m18:38:21.858495 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:38:21.860113 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:38:21.860512 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:38:21.860816 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:38:21.861108 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m18:38:21.861230 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:38:21.861588 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m18:38:21.861784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:38:21.866058 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:38:21.867421 [debug] [Thread-2 (]: finished collecting timing info
[0m18:38:21.868248 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:38:21.868384 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m18:38:21.868651 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:38:21.868952 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m18:38:21.869044 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m18:38:21.869520 [info ] [Thread-2 (]: 3 of 6 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.03s]
[0m18:38:21.873966 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:38:21.874263 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:38:21.874524 [info ] [Thread-2 (]: 5 of 6 START test not_null_hot_upsell_name ..................................... [RUN]
[0m18:38:21.874919 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:38:21.875095 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:38:21.875254 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:38:21.878289 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:38:21.878417 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:38:21.879986 [debug] [Thread-1 (]: finished collecting timing info
[0m18:38:21.880352 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m18:38:21.880590 [debug] [Thread-2 (]: finished collecting timing info
[0m18:38:21.880910 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m18:38:21.881007 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:38:21.881406 [info ] [Thread-1 (]: 4 of 6 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.03s]
[0m18:38:21.883542 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:38:21.883945 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:38:21.884589 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:38:21.884969 [info ] [Thread-1 (]: 6 of 6 START test not_null_hot_upsell_variant .................................. [RUN]
[0m18:38:21.885085 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:38:21.885466 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:38:21.885699 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m18:38:21.885914 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:38:21.886109 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:38:21.886312 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:38:21.890747 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:38:21.891873 [debug] [Thread-1 (]: finished collecting timing info
[0m18:38:21.892127 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:38:21.893834 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:38:21.894196 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:38:21.894558 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:38:21.894803 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m18:38:21.894915 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:38:21.895248 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m18:38:21.895451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:38:21.898648 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:38:21.899961 [debug] [Thread-2 (]: finished collecting timing info
[0m18:38:21.900218 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m18:38:21.900491 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m18:38:21.900893 [info ] [Thread-2 (]: 5 of 6 PASS not_null_hot_upsell_name ........................................... [[32mPASS[0m in 0.03s]
[0m18:38:21.901347 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:38:21.902246 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:38:21.902502 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:38:21.902723 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m18:38:21.909759 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:38:21.911133 [debug] [Thread-1 (]: finished collecting timing info
[0m18:38:21.911377 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m18:38:21.911663 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m18:38:21.912055 [info ] [Thread-1 (]: 6 of 6 PASS not_null_hot_upsell_variant ........................................ [[32mPASS[0m in 0.03s]
[0m18:38:21.912470 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:38:21.914550 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:38:21.914849 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:21.915067 [debug] [MainThread]: On master: BEGIN
[0m18:38:21.915272 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:38:21.921278 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:38:21.921663 [debug] [MainThread]: On master: COMMIT
[0m18:38:21.921893 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:21.922105 [debug] [MainThread]: On master: COMMIT
[0m18:38:21.922419 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:38:21.922663 [debug] [MainThread]: On master: Close
[0m18:38:21.923274 [info ] [MainThread]: 
[0m18:38:21.923655 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m18:38:21.924056 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:38:21.924451 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b' was properly closed.
[0m18:38:21.924710 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb' was properly closed.
[0m18:38:21.930731 [info ] [MainThread]: 
[0m18:38:21.931050 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:38:21.931417 [info ] [MainThread]: 
[0m18:38:21.931760 [error] [MainThread]: [33mDatabase Error in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)[0m
[0m18:38:21.932050 [error] [MainThread]:   column rup.variant does not exist
[0m18:38:21.932293 [error] [MainThread]:   LINE 15: ...odel on model.name = rup.name and model.variant = rup.varian...
[0m18:38:21.932587 [error] [MainThread]:                                                                 ^
[0m18:38:21.932871 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "ruv.variant" or the column "rupu.variant".
[0m18:38:21.933129 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m18:38:21.933399 [info ] [MainThread]: 
[0m18:38:21.933676 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m18:38:21.934037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b65750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8906290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bb91e0>]}


============================== 2024-07-14 18:38:37.809442 | ec96f130-ba9a-4b97-8cb7-fe1b3d986ecf ==============================
[0m18:38:37.809749 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:38:37.817831 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m18:38:37.818186 [debug] [MainThread]: Tracking: tracking
[0m18:38:37.833119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2bf70>]}
[0m18:38:37.878280 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:38:37.878921 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://macros/upsell_test.sql
[0m18:38:37.879313 [debug] [MainThread]: Parsing macros/upsell_test.sql
[0m18:38:37.919924 [debug] [MainThread]: 1699: static parser successfully parsed hot_upsell/hot_upsell.sql
[0m18:38:37.961087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec96f130-ba9a-4b97-8cb7-fe1b3d986ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba3d00>]}
[0m18:38:37.970211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec96f130-ba9a-4b97-8cb7-fe1b3d986ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1f970>]}
[0m18:38:37.970624 [info ] [MainThread]: Found 4 models, 6 tests, 2 snapshots, 0 analyses, 258 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:38:37.970884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec96f130-ba9a-4b97-8cb7-fe1b3d986ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b657b0>]}
[0m18:38:37.972752 [info ] [MainThread]: 
[0m18:38:37.973324 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:38:37.975475 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m18:38:37.983585 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:38:37.983903 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:38:37.984134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:38.027066 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m18:38:38.027614 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:38:38.027877 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:38:38.031901 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m18:38:38.033592 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:38:38.033982 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:38:38.038382 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:38.038662 [debug] [MainThread]: On master: BEGIN
[0m18:38:38.038819 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:38:38.045750 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:38:38.046051 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:38.046259 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:38:38.051105 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m18:38:38.052436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec96f130-ba9a-4b97-8cb7-fe1b3d986ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba00d0>]}
[0m18:38:38.052756 [debug] [MainThread]: On master: ROLLBACK
[0m18:38:38.053010 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:38.053175 [debug] [MainThread]: On master: BEGIN
[0m18:38:38.053516 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:38:38.053772 [debug] [MainThread]: On master: COMMIT
[0m18:38:38.053956 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:38.054108 [debug] [MainThread]: On master: COMMIT
[0m18:38:38.054334 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:38:38.054527 [debug] [MainThread]: On master: Close
[0m18:38:38.054883 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:38:38.055136 [info ] [MainThread]: 
[0m18:38:38.058599 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:38:38.058740 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:38:38.059005 [info ] [Thread-1 (]: 1 of 6 START test below_depletion_level_tests_below_depletion_level_ ........... [RUN]
[0m18:38:38.059359 [info ] [Thread-2 (]: 2 of 6 START test new_arrival_stock_depletion_test_hot_upsell_ ................. [RUN]
[0m18:38:38.059800 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:38:38.060410 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:38:38.060912 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:38:38.061239 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:38:38.061580 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:38:38.061880 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:38:38.065923 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:38:38.068641 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:38:38.070105 [debug] [Thread-1 (]: finished collecting timing info
[0m18:38:38.070283 [debug] [Thread-2 (]: finished collecting timing info
[0m18:38:38.070398 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:38:38.070675 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:38:38.084677 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:38:38.086360 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:38:38.087868 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:38:38.088111 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:38:38.088332 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m18:38:38.088601 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m18:38:38.088884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:38:38.089119 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:38:38.096403 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:38:38.096640 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:38:38.096913 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:38:38.097147 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:38:38.097356 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT DISTINCT rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, 
                        (ruv.msrp - rupu.price) AS profit_margin
        FROM "postgres"."public"."rugs_usa_variant" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        /* joining on model as none of these should show. doing an inner join for this purpose to test */
        JOIN "postgres"."public"."hot_upsell" model on model.name = rup.name and model.variant = ruv.variant and model.size = rupu.size and model.shape = rupu.shape and model.type = rupu.type
        ORDER BY profit_margin DESC
    )
    SELECT 
        count(*) as errors
    FROM test_data
    where errors > 0

      
    ) dbt_internal_test
[0m18:38:38.097554 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m18:38:38.099708 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "errors" does not exist
LINE 21:     where errors > 0
                   ^

[0m18:38:38.100098 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m18:38:38.100555 [debug] [Thread-2 (]: finished collecting timing info
[0m18:38:38.100833 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m18:38:38.101291 [debug] [Thread-2 (]: Database Error in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)
  column "errors" does not exist
  LINE 21:     where errors > 0
                     ^
  compiled SQL at target/run/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m18:38:38.101669 [error] [Thread-2 (]: 2 of 6 ERROR new_arrival_stock_depletion_test_hot_upsell_ ...................... [[31mERROR[0m in 0.04s]
[0m18:38:38.102236 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:38:38.102526 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:38:38.102909 [info ] [Thread-2 (]: 3 of 6 START test not_null_below_depletion_level_name .......................... [RUN]
[0m18:38:38.103331 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:38:38.103550 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:38:38.103761 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:38:38.110151 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:38:38.110337 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:38:38.112639 [debug] [Thread-1 (]: finished collecting timing info
[0m18:38:38.113044 [debug] [Thread-2 (]: finished collecting timing info
[0m18:38:38.113161 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m18:38:38.113370 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:38:38.113741 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m18:38:38.115234 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:38:38.115673 [info ] [Thread-1 (]: 1 of 6 PASS below_depletion_level_tests_below_depletion_level_ ................. [[32mPASS[0m in 0.06s]
[0m18:38:38.116330 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:38:38.116695 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:38:38.116824 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:38:38.117039 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m18:38:38.117258 [info ] [Thread-1 (]: 4 of 6 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m18:38:38.117423 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:38:38.117935 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:38:38.118542 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:38:38.118940 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:38:38.121938 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:38:38.123263 [debug] [Thread-1 (]: finished collecting timing info
[0m18:38:38.123458 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:38:38.125083 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:38:38.125457 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:38:38.125921 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:38:38.126110 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m18:38:38.126421 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:38:38.126685 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m18:38:38.126876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:38:38.130971 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:38:38.132292 [debug] [Thread-2 (]: finished collecting timing info
[0m18:38:38.132515 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m18:38:38.132743 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m18:38:38.133083 [info ] [Thread-2 (]: 3 of 6 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.03s]
[0m18:38:38.133443 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:38:38.133683 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:38:38.133916 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:38:38.134194 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:38:38.134525 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m18:38:38.134795 [info ] [Thread-2 (]: 5 of 6 START test not_null_hot_upsell_name ..................................... [RUN]
[0m18:38:38.135439 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:38:38.135689 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:38:38.135913 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:38:38.139787 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:38:38.140742 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:38:38.142180 [debug] [Thread-1 (]: finished collecting timing info
[0m18:38:38.142285 [debug] [Thread-2 (]: finished collecting timing info
[0m18:38:38.142502 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m18:38:38.142762 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:38:38.143065 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m18:38:38.144558 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:38:38.144984 [info ] [Thread-1 (]: 4 of 6 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.03s]
[0m18:38:38.145679 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:38:38.146102 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:38:38.146222 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:38:38.146479 [info ] [Thread-1 (]: 6 of 6 START test not_null_hot_upsell_variant .................................. [RUN]
[0m18:38:38.146716 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m18:38:38.147113 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:38:38.147299 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:38:38.147524 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:38:38.148088 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:38:38.152288 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:38:38.153478 [debug] [Thread-1 (]: finished collecting timing info
[0m18:38:38.153752 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:38:38.155412 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:38:38.155528 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:38:38.156039 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:38:38.156260 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m18:38:38.156454 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:38:38.156817 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m18:38:38.157007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:38:38.160277 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:38:38.161587 [debug] [Thread-2 (]: finished collecting timing info
[0m18:38:38.161855 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m18:38:38.162134 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m18:38:38.162550 [info ] [Thread-2 (]: 5 of 6 PASS not_null_hot_upsell_name ........................................... [[32mPASS[0m in 0.03s]
[0m18:38:38.162985 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:38:38.164028 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:38:38.164820 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:38:38.165039 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m18:38:38.171244 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:38:38.172526 [debug] [Thread-1 (]: finished collecting timing info
[0m18:38:38.172784 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m18:38:38.173068 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m18:38:38.173462 [info ] [Thread-1 (]: 6 of 6 PASS not_null_hot_upsell_variant ........................................ [[32mPASS[0m in 0.03s]
[0m18:38:38.173963 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:38:38.175799 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:38:38.176073 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:38.176304 [debug] [MainThread]: On master: BEGIN
[0m18:38:38.176523 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:38:38.182518 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:38:38.182847 [debug] [MainThread]: On master: COMMIT
[0m18:38:38.183126 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:38.183344 [debug] [MainThread]: On master: COMMIT
[0m18:38:38.183632 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:38:38.183877 [debug] [MainThread]: On master: Close
[0m18:38:38.184473 [info ] [MainThread]: 
[0m18:38:38.184791 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m18:38:38.185134 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:38:38.185413 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b' was properly closed.
[0m18:38:38.185629 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb' was properly closed.
[0m18:38:38.191669 [info ] [MainThread]: 
[0m18:38:38.191992 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:38:38.192344 [info ] [MainThread]: 
[0m18:38:38.192669 [error] [MainThread]: [33mDatabase Error in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)[0m
[0m18:38:38.192970 [error] [MainThread]:   column "errors" does not exist
[0m18:38:38.193286 [error] [MainThread]:   LINE 21:     where errors > 0
[0m18:38:38.193590 [error] [MainThread]:                      ^
[0m18:38:38.193878 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m18:38:38.194164 [info ] [MainThread]: 
[0m18:38:38.194413 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m18:38:38.194772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b65780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff890e530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bbb5b0>]}


============================== 2024-07-14 18:39:02.938016 | 75ff3342-238a-4dd2-a666-45ba350ca237 ==============================
[0m18:39:02.938328 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:39:02.955380 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m18:39:02.955832 [debug] [MainThread]: Tracking: tracking
[0m18:39:02.969916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2a2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2a710>]}
[0m18:39:03.016195 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:39:03.016984 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://macros/upsell_test.sql
[0m18:39:03.017251 [debug] [MainThread]: Parsing macros/upsell_test.sql
[0m18:39:03.056117 [debug] [MainThread]: 1699: static parser successfully parsed hot_upsell/hot_upsell.sql
[0m18:39:03.096738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75ff3342-238a-4dd2-a666-45ba350ca237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b9fdf0>]}
[0m18:39:03.106400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75ff3342-238a-4dd2-a666-45ba350ca237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c26f20>]}
[0m18:39:03.106830 [info ] [MainThread]: Found 4 models, 6 tests, 2 snapshots, 0 analyses, 258 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:39:03.107202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75ff3342-238a-4dd2-a666-45ba350ca237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b65780>]}
[0m18:39:03.108913 [info ] [MainThread]: 
[0m18:39:03.109489 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:39:03.111648 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m18:39:03.119923 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:39:03.120256 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:39:03.120484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:39:03.164209 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m18:39:03.164693 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:39:03.164972 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:39:03.168988 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m18:39:03.170697 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:39:03.171099 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:39:03.175452 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:03.175780 [debug] [MainThread]: On master: BEGIN
[0m18:39:03.176018 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:39:03.183272 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:39:03.183605 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:03.183845 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:39:03.188145 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m18:39:03.189485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75ff3342-238a-4dd2-a666-45ba350ca237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b9c0d0>]}
[0m18:39:03.189876 [debug] [MainThread]: On master: ROLLBACK
[0m18:39:03.190182 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:03.190403 [debug] [MainThread]: On master: BEGIN
[0m18:39:03.190769 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:39:03.191054 [debug] [MainThread]: On master: COMMIT
[0m18:39:03.191275 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:03.191487 [debug] [MainThread]: On master: COMMIT
[0m18:39:03.191819 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:39:03.192058 [debug] [MainThread]: On master: Close
[0m18:39:03.192458 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:39:03.192769 [info ] [MainThread]: 
[0m18:39:03.197360 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:39:03.197578 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:39:03.198113 [info ] [Thread-1 (]: 1 of 6 START test below_depletion_level_tests_below_depletion_level_ ........... [RUN]
[0m18:39:03.199075 [info ] [Thread-2 (]: 2 of 6 START test new_arrival_stock_depletion_test_hot_upsell_ ................. [RUN]
[0m18:39:03.199872 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:39:03.200496 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:39:03.200886 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:39:03.201145 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:39:03.201395 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:39:03.201610 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:39:03.205933 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:39:03.209909 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:39:03.212203 [debug] [Thread-1 (]: finished collecting timing info
[0m18:39:03.212358 [debug] [Thread-2 (]: finished collecting timing info
[0m18:39:03.212616 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:39:03.212852 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:39:03.247503 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:39:03.247868 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:39:03.249601 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:39:03.249730 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:39:03.249950 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m18:39:03.250247 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m18:39:03.250494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:39:03.250754 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:39:03.257269 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:39:03.257434 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:39:03.257730 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:39:03.257956 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:39:03.258161 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m18:39:03.258356 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT DISTINCT rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, 
                        (ruv.msrp - rupu.price) AS profit_margin
        FROM "postgres"."public"."rugs_usa_variant" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        /* joining on model as none of these should show. doing an inner join for this purpose to test */
        JOIN "postgres"."public"."hot_upsell" model on model.name = rup.name and model.variant = ruv.variant and model.size = rupu.size and model.shape = rupu.shape and model.type = rupu.type
        ORDER BY profit_margin DESC
    )
    SELECT 
        count(*) as errors
    FROM test_data
    having errors > 0

      
    ) dbt_internal_test
[0m18:39:03.260490 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "errors" does not exist
LINE 21:     having errors > 0
                    ^

[0m18:39:03.261270 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m18:39:03.261819 [debug] [Thread-2 (]: finished collecting timing info
[0m18:39:03.262103 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m18:39:03.262632 [debug] [Thread-2 (]: Database Error in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)
  column "errors" does not exist
  LINE 21:     having errors > 0
                      ^
  compiled SQL at target/run/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m18:39:03.263478 [error] [Thread-2 (]: 2 of 6 ERROR new_arrival_stock_depletion_test_hot_upsell_ ...................... [[31mERROR[0m in 0.06s]
[0m18:39:03.264115 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:39:03.264494 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:39:03.264858 [info ] [Thread-2 (]: 3 of 6 START test not_null_below_depletion_level_name .......................... [RUN]
[0m18:39:03.265370 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:39:03.265656 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:39:03.265898 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:39:03.272612 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:39:03.272783 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:39:03.275208 [debug] [Thread-1 (]: finished collecting timing info
[0m18:39:03.275529 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m18:39:03.275627 [debug] [Thread-2 (]: finished collecting timing info
[0m18:39:03.275959 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m18:39:03.276057 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:39:03.276481 [info ] [Thread-1 (]: 1 of 6 PASS below_depletion_level_tests_below_depletion_level_ ................. [[32mPASS[0m in 0.08s]
[0m18:39:03.278159 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:39:03.278600 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:39:03.279215 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:39:03.279489 [info ] [Thread-1 (]: 4 of 6 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m18:39:03.279727 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:39:03.280099 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:39:03.280296 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m18:39:03.280538 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:39:03.280741 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:39:03.280961 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:39:03.284407 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:39:03.285579 [debug] [Thread-1 (]: finished collecting timing info
[0m18:39:03.285812 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:39:03.287406 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:39:03.287790 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:39:03.288087 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:39:03.288375 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m18:39:03.288491 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:39:03.288894 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m18:39:03.289093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:39:03.293756 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:39:03.295156 [debug] [Thread-2 (]: finished collecting timing info
[0m18:39:03.295438 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m18:39:03.295543 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:39:03.295873 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m18:39:03.295962 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:39:03.296431 [info ] [Thread-2 (]: 3 of 6 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.03s]
[0m18:39:03.296838 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m18:39:03.297390 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:39:03.297821 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:39:03.298043 [info ] [Thread-2 (]: 5 of 6 START test not_null_hot_upsell_name ..................................... [RUN]
[0m18:39:03.298542 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:39:03.298741 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:39:03.298901 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:39:03.302399 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:39:03.303230 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:39:03.303658 [debug] [Thread-2 (]: finished collecting timing info
[0m18:39:03.304795 [debug] [Thread-1 (]: finished collecting timing info
[0m18:39:03.305047 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:39:03.305306 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m18:39:03.306985 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:39:03.307370 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m18:39:03.308227 [info ] [Thread-1 (]: 4 of 6 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.03s]
[0m18:39:03.308697 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:39:03.308991 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:39:03.309180 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m18:39:03.309506 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:39:03.309769 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:39:03.310011 [info ] [Thread-1 (]: 6 of 6 START test not_null_hot_upsell_variant .................................. [RUN]
[0m18:39:03.310795 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:39:03.311135 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:39:03.311355 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:39:03.315510 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:39:03.316525 [debug] [Thread-1 (]: finished collecting timing info
[0m18:39:03.316653 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:39:03.316885 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:39:03.317103 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:39:03.318702 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:39:03.318949 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m18:39:03.319785 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:39:03.319994 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m18:39:03.320184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:39:03.322999 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:39:03.324518 [debug] [Thread-2 (]: finished collecting timing info
[0m18:39:03.324786 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m18:39:03.325081 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m18:39:03.325480 [info ] [Thread-2 (]: 5 of 6 PASS not_null_hot_upsell_name ........................................... [[32mPASS[0m in 0.03s]
[0m18:39:03.326781 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:39:03.326899 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:39:03.327386 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:39:03.327651 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m18:39:03.334411 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:39:03.335782 [debug] [Thread-1 (]: finished collecting timing info
[0m18:39:03.336049 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m18:39:03.336356 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m18:39:03.336788 [info ] [Thread-1 (]: 6 of 6 PASS not_null_hot_upsell_variant ........................................ [[32mPASS[0m in 0.03s]
[0m18:39:03.337657 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:39:03.339424 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:39:03.339732 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:03.339962 [debug] [MainThread]: On master: BEGIN
[0m18:39:03.340187 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:39:03.346451 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:39:03.346838 [debug] [MainThread]: On master: COMMIT
[0m18:39:03.347065 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:03.347289 [debug] [MainThread]: On master: COMMIT
[0m18:39:03.347594 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:39:03.347816 [debug] [MainThread]: On master: Close
[0m18:39:03.348428 [info ] [MainThread]: 
[0m18:39:03.348770 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m18:39:03.349125 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:39:03.349382 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b' was properly closed.
[0m18:39:03.349592 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb' was properly closed.
[0m18:39:03.355933 [info ] [MainThread]: 
[0m18:39:03.356245 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:39:03.356700 [info ] [MainThread]: 
[0m18:39:03.357020 [error] [MainThread]: [33mDatabase Error in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)[0m
[0m18:39:03.357339 [error] [MainThread]:   column "errors" does not exist
[0m18:39:03.357605 [error] [MainThread]:   LINE 21:     having errors > 0
[0m18:39:03.357880 [error] [MainThread]:                       ^
[0m18:39:03.358152 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m18:39:03.358419 [info ] [MainThread]: 
[0m18:39:03.358671 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m18:39:03.359036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b65750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff890e2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bb45b0>]}


============================== 2024-07-14 18:39:19.251986 | 5636bfb8-c876-4eab-af5a-a9b32e0cc616 ==============================
[0m18:39:19.252320 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:39:19.258587 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m18:39:19.259117 [debug] [MainThread]: Tracking: tracking
[0m18:39:19.273953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c15d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c14c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c15900>]}
[0m18:39:19.323249 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:39:19.324045 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://macros/upsell_test.sql
[0m18:39:19.324386 [debug] [MainThread]: Parsing macros/upsell_test.sql
[0m18:39:19.364094 [debug] [MainThread]: 1699: static parser successfully parsed hot_upsell/hot_upsell.sql
[0m18:39:19.404469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5636bfb8-c876-4eab-af5a-a9b32e0cc616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba3430>]}
[0m18:39:19.414004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5636bfb8-c876-4eab-af5a-a9b32e0cc616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1eaa0>]}
[0m18:39:19.414420 [info ] [MainThread]: Found 4 models, 6 tests, 2 snapshots, 0 analyses, 258 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:39:19.414792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5636bfb8-c876-4eab-af5a-a9b32e0cc616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b69780>]}
[0m18:39:19.416569 [info ] [MainThread]: 
[0m18:39:19.417185 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:39:19.419317 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m18:39:19.427170 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:39:19.427485 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:39:19.427734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:39:19.470842 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m18:39:19.471308 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:39:19.471550 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:39:19.475603 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m18:39:19.477302 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:39:19.477694 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:39:19.482133 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:19.482452 [debug] [MainThread]: On master: BEGIN
[0m18:39:19.482675 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:39:19.489086 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:39:19.489434 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:19.489666 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:39:19.494055 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m18:39:19.495435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5636bfb8-c876-4eab-af5a-a9b32e0cc616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba0130>]}
[0m18:39:19.495807 [debug] [MainThread]: On master: ROLLBACK
[0m18:39:19.496136 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:19.496399 [debug] [MainThread]: On master: BEGIN
[0m18:39:19.496790 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:39:19.497103 [debug] [MainThread]: On master: COMMIT
[0m18:39:19.497387 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:19.497615 [debug] [MainThread]: On master: COMMIT
[0m18:39:19.497908 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:39:19.498151 [debug] [MainThread]: On master: Close
[0m18:39:19.498543 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:39:19.498853 [info ] [MainThread]: 
[0m18:39:19.502837 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:39:19.502991 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:39:19.503923 [info ] [Thread-1 (]: 1 of 6 START test below_depletion_level_tests_below_depletion_level_ ........... [RUN]
[0m18:39:19.504278 [info ] [Thread-2 (]: 2 of 6 START test new_arrival_stock_depletion_test_hot_upsell_ ................. [RUN]
[0m18:39:19.504781 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:39:19.505383 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:39:19.505730 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:39:19.506069 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:39:19.506337 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:39:19.506574 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:39:19.510640 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:39:19.513855 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:39:19.515992 [debug] [Thread-2 (]: finished collecting timing info
[0m18:39:19.516117 [debug] [Thread-1 (]: finished collecting timing info
[0m18:39:19.516390 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:39:19.516642 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:39:19.531386 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:39:19.533118 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:39:19.536449 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:39:19.536571 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:39:19.536872 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m18:39:19.537195 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m18:39:19.537446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:39:19.537682 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:39:19.544979 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:39:19.545194 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:39:19.545471 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:39:19.545711 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:39:19.545935 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m18:39:19.546148 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT DISTINCT rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, 
                        (ruv.msrp - rupu.price) AS profit_margin
        FROM "postgres"."public"."rugs_usa_variant" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        /* joining on model as none of these should show. doing an inner join for this purpose to test */
        JOIN "postgres"."public"."hot_upsell" model on model.name = rup.name and model.variant = ruv.variant and model.size = rupu.size and model.shape = rupu.shape and model.type = rupu.type
        ORDER BY profit_margin DESC
    )
    SELECT 
        count(*) as errors
    FROM test_data
    having count(*) > 0

      
    ) dbt_internal_test
[0m18:39:19.558875 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:39:19.561369 [debug] [Thread-1 (]: finished collecting timing info
[0m18:39:19.561690 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m18:39:19.562047 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m18:39:19.562553 [info ] [Thread-1 (]: 1 of 6 PASS below_depletion_level_tests_below_depletion_level_ ................. [[32mPASS[0m in 0.06s]
[0m18:39:19.563250 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:39:19.563633 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:39:19.563938 [info ] [Thread-1 (]: 3 of 6 START test not_null_below_depletion_level_name .......................... [RUN]
[0m18:39:19.564420 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:39:19.564720 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:39:19.564952 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:39:19.571166 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:39:19.572405 [debug] [Thread-1 (]: finished collecting timing info
[0m18:39:19.572675 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:39:19.574465 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:39:19.575350 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:39:19.575573 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m18:39:19.575778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:39:19.582963 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:39:19.583430 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:39:19.583657 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m18:39:19.587327 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:39:19.589064 [debug] [Thread-1 (]: finished collecting timing info
[0m18:39:19.589478 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m18:39:19.589853 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m18:39:19.590357 [info ] [Thread-1 (]: 3 of 6 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.03s]
[0m18:39:19.590878 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:39:19.591359 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:39:19.591702 [info ] [Thread-1 (]: 4 of 6 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m18:39:19.592199 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:39:19.592512 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:39:19.592721 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:39:19.596155 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:39:19.597075 [debug] [Thread-1 (]: finished collecting timing info
[0m18:39:19.597324 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:39:19.599033 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:39:19.600193 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:39:19.600522 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m18:39:19.600727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:39:19.607492 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:39:19.608051 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:39:19.608395 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m18:39:19.614229 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:39:19.615726 [debug] [Thread-1 (]: finished collecting timing info
[0m18:39:19.615994 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m18:39:19.616309 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m18:39:19.616747 [info ] [Thread-1 (]: 4 of 6 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.02s]
[0m18:39:19.617200 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:39:19.617612 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:39:19.617883 [info ] [Thread-1 (]: 5 of 6 START test not_null_hot_upsell_name ..................................... [RUN]
[0m18:39:19.618311 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:39:19.618522 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:39:19.618736 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:39:19.622009 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:39:19.623025 [debug] [Thread-1 (]: finished collecting timing info
[0m18:39:19.623310 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:39:19.625005 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:39:19.625792 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:39:19.625996 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m18:39:19.626204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:39:19.633130 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:39:19.633615 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:39:19.633862 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m18:39:19.642815 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:39:19.644335 [debug] [Thread-1 (]: finished collecting timing info
[0m18:39:19.644609 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m18:39:19.644929 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m18:39:19.645366 [info ] [Thread-1 (]: 5 of 6 PASS not_null_hot_upsell_name ........................................... [[32mPASS[0m in 0.03s]
[0m18:39:19.645799 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:39:19.646195 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:39:19.646515 [info ] [Thread-1 (]: 6 of 6 START test not_null_hot_upsell_variant .................................. [RUN]
[0m18:39:19.646946 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:39:19.647190 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:39:19.647404 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:39:19.651455 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:39:19.652375 [debug] [Thread-1 (]: finished collecting timing info
[0m18:39:19.652607 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:39:19.654284 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:39:19.655083 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:39:19.655315 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m18:39:19.655535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:39:19.662191 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:39:19.662667 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:39:19.662904 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m18:39:19.673483 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:39:19.674967 [debug] [Thread-1 (]: finished collecting timing info
[0m18:39:19.675241 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m18:39:19.675547 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m18:39:19.675954 [info ] [Thread-1 (]: 6 of 6 PASS not_null_hot_upsell_variant ........................................ [[32mPASS[0m in 0.03s]
[0m18:39:19.676404 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:41:35.329667 [debug] [Thread-2 (]: SQL status: SELECT 1 in 135.78 seconds
[0m18:41:35.343789 [debug] [Thread-2 (]: finished collecting timing info
[0m18:41:35.344369 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m18:41:35.345148 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m18:41:35.347154 [error] [Thread-2 (]: 2 of 6 FAIL 1 new_arrival_stock_depletion_test_hot_upsell_ ..................... [[31mFAIL 1[0m in 135.84s]
[0m18:41:35.348904 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:41:35.355125 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:41:35.355586 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:35.355820 [debug] [MainThread]: On master: BEGIN
[0m18:41:35.356050 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:41:35.364549 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:41:35.365069 [debug] [MainThread]: On master: COMMIT
[0m18:41:35.365342 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:35.365592 [debug] [MainThread]: On master: COMMIT
[0m18:41:35.365949 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:41:35.366202 [debug] [MainThread]: On master: Close
[0m18:41:35.370911 [info ] [MainThread]: 
[0m18:41:35.371478 [info ] [MainThread]: Finished running 6 tests in 0 hours 2 minutes and 15.95 seconds (135.95s).
[0m18:41:35.372071 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:35.372266 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b' was properly closed.
[0m18:41:35.372479 [debug] [MainThread]: Connection 'test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38' was properly closed.
[0m18:41:35.388524 [info ] [MainThread]: 
[0m18:41:35.388896 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:41:35.389295 [info ] [MainThread]: 
[0m18:41:35.389649 [error] [MainThread]: [31mFailure in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)[0m
[0m18:41:35.389946 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:41:35.390263 [info ] [MainThread]: 
[0m18:41:35.390541 [info ] [MainThread]:   compiled SQL at target/compiled/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m18:41:35.390821 [info ] [MainThread]: 
[0m18:41:35.391121 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m18:41:35.392140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b69750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bb8610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bbbdf0>]}


============================== 2024-07-14 18:54:49.350120 | 3fd849c5-59dd-4351-97a1-8c17074ed92c ==============================
[0m18:54:49.350437 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:54:49.378014 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m18:54:49.378389 [debug] [MainThread]: Tracking: tracking
[0m18:54:49.395299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1c7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1c400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1ffd0>]}
[0m18:54:49.457927 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 0 files changed.
[0m18:54:49.458524 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://macros/priority_orders.sql
[0m18:54:49.458810 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/priority_order/priority_order.sql
[0m18:54:49.459118 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/priority_order/priority_order_tests.yml
[0m18:54:49.459356 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://models/priority_order.sql
[0m18:54:49.459584 [debug] [MainThread]: Parsing macros/priority_orders.sql
[0m18:54:49.497714 [debug] [MainThread]: 1699: static parser successfully parsed priority_order/priority_order.sql
[0m18:54:49.513090 [warn ] [MainThread]: [[33mWARNING[0m]: 'rugs_usa_variant' is a seed node, but it is specified in the models section of
models/priority_order/priority_order_tests.yml. To fix this error, place the
`rugs_usa_variant` specification under the seeds key instead.
[0m18:54:49.539338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fd849c5-59dd-4351-97a1-8c17074ed92c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b9f5b0>]}
[0m18:54:49.550672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fd849c5-59dd-4351-97a1-8c17074ed92c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9af7f10>]}
[0m18:54:49.551132 [info ] [MainThread]: Found 4 models, 9 tests, 2 snapshots, 0 analyses, 259 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:54:49.551461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fd849c5-59dd-4351-97a1-8c17074ed92c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b69960>]}
[0m18:54:49.553341 [info ] [MainThread]: 
[0m18:54:49.553992 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:54:49.556928 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m18:54:49.564699 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:54:49.564983 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:54:49.565209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:49.621471 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
[0m18:54:49.622026 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:54:49.622312 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:54:49.641473 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.02 seconds
[0m18:54:49.643359 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:54:49.643772 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:54:49.648303 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:49.648645 [debug] [MainThread]: On master: BEGIN
[0m18:54:49.648865 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:54:49.659894 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:54:49.660428 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:49.660747 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:54:49.677277 [debug] [MainThread]: SQL status: SELECT 11 in 0.02 seconds
[0m18:54:49.679013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fd849c5-59dd-4351-97a1-8c17074ed92c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9af5d20>]}
[0m18:54:49.679420 [debug] [MainThread]: On master: ROLLBACK
[0m18:54:49.679783 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:49.680008 [debug] [MainThread]: On master: BEGIN
[0m18:54:49.680361 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:54:49.680702 [debug] [MainThread]: On master: COMMIT
[0m18:54:49.680923 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:49.681104 [debug] [MainThread]: On master: COMMIT
[0m18:54:49.681370 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:54:49.681577 [debug] [MainThread]: On master: Close
[0m18:54:49.681992 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:54:49.682331 [info ] [MainThread]: 
[0m18:54:49.686178 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:54:49.686310 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:54:49.686668 [info ] [Thread-1 (]: 1 of 9 START test below_depletion_level_tests_below_depletion_level_ ........... [RUN]
[0m18:54:49.686974 [info ] [Thread-2 (]: 2 of 9 START test new_arrival_stock_depletion_test_hot_upsell_ ................. [RUN]
[0m18:54:49.687419 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:54:49.687823 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:54:49.688095 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:54:49.688316 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:54:49.688585 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:54:49.688870 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:54:49.692778 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:54:49.696719 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:54:49.700404 [debug] [Thread-2 (]: finished collecting timing info
[0m18:54:49.700565 [debug] [Thread-1 (]: finished collecting timing info
[0m18:54:49.700686 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:54:49.700901 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:54:49.715114 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:54:49.716810 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:54:49.719099 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:54:49.719279 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:54:49.719515 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m18:54:49.719774 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m18:54:49.720004 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:54:49.720223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:54:49.727078 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:54:49.727770 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:54:49.727882 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:54:49.728254 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:54:49.728832 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m18:54:49.729081 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT DISTINCT rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, 
                        (ruv.msrp - rupu.price) AS profit_margin
        FROM "postgres"."public"."rugs_usa_variant" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        /* joining on model as none of these should show. doing an inner join for this purpose to test */
        JOIN "postgres"."public"."hot_upsell" model on model.name = rup.name and model.variant = ruv.variant and model.size = rupu.size and model.shape = rupu.shape and model.type = rupu.type
        ORDER BY profit_margin DESC
    )
    SELECT 
        count(*) as errors
    FROM test_data
    having count(*) > 0

      
    ) dbt_internal_test
[0m18:54:49.816437 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.09 seconds
[0m18:54:49.820015 [debug] [Thread-1 (]: finished collecting timing info
[0m18:54:49.820531 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m18:54:49.821273 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m18:54:49.822144 [info ] [Thread-1 (]: 1 of 9 PASS below_depletion_level_tests_below_depletion_level_ ................. [[32mPASS[0m in 0.13s]
[0m18:54:49.823501 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:54:49.824332 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:54:49.825328 [info ] [Thread-1 (]: 3 of 9 START test not_null_below_depletion_level_name .......................... [RUN]
[0m18:54:49.826134 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:54:49.826412 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:54:49.826883 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:54:49.834102 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:54:49.836027 [debug] [Thread-1 (]: finished collecting timing info
[0m18:54:49.836509 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:54:49.838491 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:54:49.841015 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:54:49.841477 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m18:54:49.841958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:54:49.850983 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:54:49.851530 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:54:49.851979 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m18:54:49.855532 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:54:49.857148 [debug] [Thread-1 (]: finished collecting timing info
[0m18:54:49.857668 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m18:54:49.858237 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m18:54:49.858765 [info ] [Thread-1 (]: 3 of 9 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.03s]
[0m18:54:49.859281 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:54:49.859885 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:54:49.860305 [info ] [Thread-1 (]: 4 of 9 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m18:54:49.860790 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:54:49.861122 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:54:49.861482 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:54:49.865453 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:54:49.867207 [debug] [Thread-1 (]: finished collecting timing info
[0m18:54:49.867553 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:54:49.869700 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:54:49.871562 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:54:49.871922 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m18:54:49.872678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:54:49.880201 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:54:49.881001 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:54:49.881467 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m18:54:49.887584 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:54:49.889572 [debug] [Thread-1 (]: finished collecting timing info
[0m18:54:49.890143 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m18:54:49.890737 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m18:54:49.891266 [info ] [Thread-1 (]: 4 of 9 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.03s]
[0m18:54:49.891868 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:54:49.892443 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:54:49.892854 [info ] [Thread-1 (]: 5 of 9 START test not_null_hot_upsell_name ..................................... [RUN]
[0m18:54:49.893448 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:54:49.893957 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:54:49.894451 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:54:49.898079 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:54:49.899527 [debug] [Thread-1 (]: finished collecting timing info
[0m18:54:49.899895 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:54:49.901802 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:54:49.903598 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:54:49.903820 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m18:54:49.903975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:54:49.911877 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:54:49.912256 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:54:49.912449 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m18:54:49.916707 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:54:49.918505 [debug] [Thread-1 (]: finished collecting timing info
[0m18:54:49.918871 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m18:54:49.919140 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m18:54:49.919547 [info ] [Thread-1 (]: 5 of 9 PASS not_null_hot_upsell_name ........................................... [[32mPASS[0m in 0.03s]
[0m18:54:49.920140 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:54:49.920546 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:54:49.920885 [info ] [Thread-1 (]: 6 of 9 START test not_null_hot_upsell_variant .................................. [RUN]
[0m18:54:49.921289 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:54:49.921478 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:54:49.921649 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:54:49.925926 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:54:49.927446 [debug] [Thread-1 (]: finished collecting timing info
[0m18:54:49.927666 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:54:49.929429 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:54:49.930619 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:54:49.930834 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m18:54:49.931243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:54:49.938010 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:54:49.957830 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:54:49.959683 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m18:54:49.966503 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:54:49.967916 [debug] [Thread-1 (]: finished collecting timing info
[0m18:54:49.968142 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m18:54:49.968590 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m18:54:49.969195 [info ] [Thread-1 (]: 6 of 9 PASS not_null_hot_upsell_variant ........................................ [[32mPASS[0m in 0.05s]
[0m18:54:49.969951 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:54:49.970661 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90
[0m18:54:49.971149 [info ] [Thread-1 (]: 7 of 9 START test not_null_rugs_usa_variant_product_name ....................... [RUN]
[0m18:54:49.971499 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90"
[0m18:54:49.971823 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90
[0m18:54:49.972374 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90
[0m18:54:49.975643 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90"
[0m18:54:49.978362 [debug] [Thread-1 (]: finished collecting timing info
[0m18:54:49.978730 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90
[0m18:54:49.980395 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90"
[0m18:54:49.982969 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90"
[0m18:54:49.983304 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90: BEGIN
[0m18:54:49.983591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:54:49.994160 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:54:49.994813 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90"
[0m18:54:49.995483 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_name
from "postgres"."public"."rugs_usa_variant"
where product_name is null



      
    ) dbt_internal_test
[0m18:54:49.997328 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "product_name" does not exist
LINE 13: select product_name
                ^

[0m18:54:49.997670 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90: ROLLBACK
[0m18:54:49.998215 [debug] [Thread-1 (]: finished collecting timing info
[0m18:54:49.998571 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90: Close
[0m18:54:49.999105 [debug] [Thread-1 (]: Database Error in test not_null_rugs_usa_variant_product_name (models/priority_order/priority_order_tests.yml)
  column "product_name" does not exist
  LINE 13: select product_name
                  ^
  compiled SQL at target/run/jaffle_shop/models/priority_order/priority_order_tests.yml/not_null_rugs_usa_variant_product_name.sql
[0m18:54:49.999704 [error] [Thread-1 (]: 7 of 9 ERROR not_null_rugs_usa_variant_product_name ............................ [[31mERROR[0m in 0.03s]
[0m18:54:50.000136 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90
[0m18:54:50.000472 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402
[0m18:54:50.000802 [info ] [Thread-1 (]: 8 of 9 START test not_null_rugs_usa_variant_variant ............................ [RUN]
[0m18:54:50.001234 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"
[0m18:54:50.001630 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402
[0m18:54:50.002084 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402
[0m18:54:50.005408 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"
[0m18:54:50.009075 [debug] [Thread-1 (]: finished collecting timing info
[0m18:54:50.009350 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402
[0m18:54:50.011087 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"
[0m18:54:50.013551 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"
[0m18:54:50.013758 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402: BEGIN
[0m18:54:50.013937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:54:50.021113 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:54:50.021482 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"
[0m18:54:50.021669 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."rugs_usa_variant"
where variant is null



      
    ) dbt_internal_test
[0m18:54:50.024749 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:54:50.026305 [debug] [Thread-1 (]: finished collecting timing info
[0m18:54:50.026577 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402: ROLLBACK
[0m18:54:50.026844 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402: Close
[0m18:54:50.027431 [info ] [Thread-1 (]: 8 of 9 PASS not_null_rugs_usa_variant_variant .................................. [[32mPASS[0m in 0.03s]
[0m18:54:50.027837 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402
[0m18:54:50.028364 [debug] [Thread-1 (]: Began running node test.jaffle_shop.profit_priority_order.2c7ed8e7dd
[0m18:54:50.028657 [info ] [Thread-1 (]: 9 of 9 START test profit_priority_order ........................................ [RUN]
[0m18:54:50.029259 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.profit_priority_order.2c7ed8e7dd"
[0m18:54:50.029565 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.profit_priority_order.2c7ed8e7dd
[0m18:54:50.030068 [debug] [Thread-1 (]: Compiling test.jaffle_shop.profit_priority_order.2c7ed8e7dd
[0m18:54:50.034340 [debug] [Thread-1 (]: finished collecting timing info
[0m18:54:50.035049 [debug] [Thread-1 (]: Compilation Error in test profit_priority_order (models/priority_order/priority_order_tests.yml)
  'test_test' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:54:50.035454 [error] [Thread-1 (]: 9 of 9 ERROR profit_priority_order ............................................. [[31mERROR[0m in 0.01s]
[0m18:54:50.035790 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.profit_priority_order.2c7ed8e7dd


============================== 2024-07-14 18:56:45.619534 | 3322f818-deb0-4299-bd11-699e931637d8 ==============================
[0m18:56:45.619963 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:56:45.622559 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m18:56:45.623162 [debug] [MainThread]: Tracking: tracking
[0m18:56:45.644554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c15d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c14c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c17e80>]}
[0m18:56:45.778014 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:56:45.778896 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/priority_order/priority_order.sql
[0m18:56:45.818160 [debug] [MainThread]: 1699: static parser successfully parsed priority_order/priority_order.sql
[0m18:56:45.865405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3322f818-deb0-4299-bd11-699e931637d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a14250>]}
[0m18:56:45.884136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3322f818-deb0-4299-bd11-699e931637d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89cc1c0>]}
[0m18:56:45.884851 [info ] [MainThread]: Found 4 models, 9 tests, 2 snapshots, 0 analyses, 259 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:56:45.885359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3322f818-deb0-4299-bd11-699e931637d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89cc100>]}
[0m18:56:45.887490 [info ] [MainThread]: 
[0m18:56:45.888138 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:56:45.892911 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m18:56:45.904146 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:56:45.904484 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:56:45.904725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:56:45.969121 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
[0m18:56:45.969837 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:56:45.970103 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:56:45.982953 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.01 seconds
[0m18:56:45.984919 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:56:45.985342 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:56:45.990400 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:45.990724 [debug] [MainThread]: On master: BEGIN
[0m18:56:45.990960 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:56:46.011915 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m18:56:46.012357 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:46.012644 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:56:46.032296 [debug] [MainThread]: SQL status: SELECT 11 in 0.02 seconds
[0m18:56:46.033881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3322f818-deb0-4299-bd11-699e931637d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba6e00>]}
[0m18:56:46.034223 [debug] [MainThread]: On master: ROLLBACK
[0m18:56:46.034479 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:46.034670 [debug] [MainThread]: On master: BEGIN
[0m18:56:46.034992 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:56:46.035230 [debug] [MainThread]: On master: COMMIT
[0m18:56:46.035480 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:46.035634 [debug] [MainThread]: On master: COMMIT
[0m18:56:46.035859 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:56:46.036043 [debug] [MainThread]: On master: Close
[0m18:56:46.036389 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:56:46.036663 [info ] [MainThread]: 
[0m18:56:46.052899 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:56:46.053107 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:56:46.053609 [info ] [Thread-1 (]: 1 of 9 START test below_depletion_level_tests_below_depletion_level_ ........... [RUN]
[0m18:56:46.053993 [info ] [Thread-2 (]: 2 of 9 START test new_arrival_stock_depletion_test_hot_upsell_ ................. [RUN]
[0m18:56:46.054530 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:56:46.055249 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:56:46.055617 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:56:46.055852 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:56:46.056117 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:56:46.056324 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:56:46.063271 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:56:46.074395 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:56:46.077507 [debug] [Thread-1 (]: finished collecting timing info
[0m18:56:46.077712 [debug] [Thread-2 (]: finished collecting timing info
[0m18:56:46.078052 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:56:46.078404 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:56:46.098955 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:56:46.101317 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:56:46.103457 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:56:46.103817 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:56:46.104071 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m18:56:46.104293 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m18:56:46.104496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:56:46.104714 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:56:46.113810 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:56:46.114881 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:56:46.115381 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT DISTINCT rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, 
                        (ruv.msrp - rupu.price) AS profit_margin
        FROM "postgres"."public"."rugs_usa_variant" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        /* joining on model as none of these should show. doing an inner join for this purpose to test */
        JOIN "postgres"."public"."hot_upsell" model on model.name = rup.name and model.variant = ruv.variant and model.size = rupu.size and model.shape = rupu.shape and model.type = rupu.type
        ORDER BY profit_margin DESC
    )
    SELECT 
        count(*) as errors
    FROM test_data
    having count(*) > 0

      
    ) dbt_internal_test
[0m18:56:46.123262 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m18:56:46.123859 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:56:46.124240 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m18:56:46.154077 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m18:56:46.157418 [debug] [Thread-1 (]: finished collecting timing info
[0m18:56:46.157858 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m18:56:46.158277 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m18:56:46.158878 [info ] [Thread-1 (]: 1 of 9 PASS below_depletion_level_tests_below_depletion_level_ ................. [[32mPASS[0m in 0.10s]
[0m18:56:46.159687 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:56:46.160392 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:56:46.160748 [info ] [Thread-1 (]: 3 of 9 START test not_null_below_depletion_level_name .......................... [RUN]
[0m18:56:46.161395 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:56:46.161789 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:56:46.162100 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:56:46.170806 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:56:46.172476 [debug] [Thread-1 (]: finished collecting timing info
[0m18:56:46.172839 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:56:46.174789 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:56:46.176149 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:56:46.176389 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m18:56:46.176604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:56:46.202710 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m18:56:46.203226 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:56:46.203472 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m18:56:46.210509 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:56:46.212169 [debug] [Thread-1 (]: finished collecting timing info
[0m18:56:46.212527 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m18:56:46.212930 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m18:56:46.213433 [info ] [Thread-1 (]: 3 of 9 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.05s]
[0m18:56:46.214138 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:56:46.214852 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:56:46.215292 [info ] [Thread-1 (]: 4 of 9 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m18:56:46.215835 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:56:46.216311 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:56:46.216554 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:56:46.222534 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:56:46.225762 [debug] [Thread-1 (]: finished collecting timing info
[0m18:56:46.226701 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:56:46.232101 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:56:46.233981 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:56:46.234469 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m18:56:46.234879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:56:46.244304 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:56:46.245195 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:56:46.245497 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m18:56:46.252344 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:56:46.254189 [debug] [Thread-1 (]: finished collecting timing info
[0m18:56:46.254521 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m18:56:46.254862 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m18:56:46.255301 [info ] [Thread-1 (]: 4 of 9 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.04s]
[0m18:56:46.255786 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:56:46.256275 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:56:46.256600 [info ] [Thread-1 (]: 5 of 9 START test not_null_hot_upsell_name ..................................... [RUN]
[0m18:56:46.257057 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:56:46.257323 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:56:46.257548 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:56:46.261257 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:56:46.262428 [debug] [Thread-1 (]: finished collecting timing info
[0m18:56:46.262661 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:56:46.264834 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:56:46.265908 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:56:46.266126 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m18:56:46.266338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:56:46.273276 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:56:46.273935 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:56:46.274278 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m18:56:46.279669 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:56:46.281097 [debug] [Thread-1 (]: finished collecting timing info
[0m18:56:46.281363 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m18:56:46.281652 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m18:56:46.282104 [info ] [Thread-1 (]: 5 of 9 PASS not_null_hot_upsell_name ........................................... [[32mPASS[0m in 0.03s]
[0m18:56:46.282542 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:56:46.283177 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:56:46.283516 [info ] [Thread-1 (]: 6 of 9 START test not_null_hot_upsell_variant .................................. [RUN]
[0m18:56:46.283982 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:56:46.284207 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:56:46.284429 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:56:46.288158 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:56:46.289385 [debug] [Thread-1 (]: finished collecting timing info
[0m18:56:46.289638 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:56:46.291268 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:56:46.292253 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:56:46.292477 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m18:56:46.292684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:56:46.315131 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m18:56:46.315608 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:56:46.315848 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m18:56:46.326571 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:56:46.328080 [debug] [Thread-1 (]: finished collecting timing info
[0m18:56:46.328348 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m18:56:46.328667 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m18:56:46.329098 [info ] [Thread-1 (]: 6 of 9 PASS not_null_hot_upsell_variant ........................................ [[32mPASS[0m in 0.05s]
[0m18:56:46.329543 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:56:46.330004 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90
[0m18:56:46.330291 [info ] [Thread-1 (]: 7 of 9 START test not_null_rugs_usa_variant_product_name ....................... [RUN]
[0m18:56:46.330719 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90"
[0m18:56:46.330961 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90
[0m18:56:46.331180 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90
[0m18:56:46.334533 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90"
[0m18:56:46.335739 [debug] [Thread-1 (]: finished collecting timing info
[0m18:56:46.335990 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90
[0m18:56:46.337681 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90"
[0m18:56:46.338889 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90"
[0m18:56:46.339120 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90: BEGIN
[0m18:56:46.339368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:56:46.346760 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:56:46.347395 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90"
[0m18:56:46.347822 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_name
from "postgres"."public"."rugs_usa_variant"
where product_name is null



      
    ) dbt_internal_test
[0m18:56:46.348930 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "product_name" does not exist
LINE 13: select product_name
                ^

[0m18:56:46.349209 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90: ROLLBACK
[0m18:56:46.349601 [debug] [Thread-1 (]: finished collecting timing info
[0m18:56:46.349817 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90: Close
[0m18:56:46.350283 [debug] [Thread-1 (]: Database Error in test not_null_rugs_usa_variant_product_name (models/priority_order/priority_order_tests.yml)
  column "product_name" does not exist
  LINE 13: select product_name
                  ^
  compiled SQL at target/run/jaffle_shop/models/priority_order/priority_order_tests.yml/not_null_rugs_usa_variant_product_name.sql
[0m18:56:46.350603 [error] [Thread-1 (]: 7 of 9 ERROR not_null_rugs_usa_variant_product_name ............................ [[31mERROR[0m in 0.02s]
[0m18:56:46.351003 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90
[0m18:56:46.351368 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402
[0m18:56:46.351731 [info ] [Thread-1 (]: 8 of 9 START test not_null_rugs_usa_variant_variant ............................ [RUN]
[0m18:56:46.352223 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"
[0m18:56:46.352515 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402
[0m18:56:46.352753 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402
[0m18:56:46.357259 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"
[0m18:56:46.358272 [debug] [Thread-1 (]: finished collecting timing info
[0m18:56:46.358501 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402
[0m18:56:46.360087 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"
[0m18:56:46.361061 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"
[0m18:56:46.361286 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402: BEGIN
[0m18:56:46.361498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:56:46.380704 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m18:56:46.381136 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"
[0m18:56:46.381362 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."rugs_usa_variant"
where variant is null



      
    ) dbt_internal_test
[0m18:56:46.387315 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:56:46.389678 [debug] [Thread-1 (]: finished collecting timing info
[0m18:56:46.390092 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402: ROLLBACK
[0m18:56:46.390441 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402: Close
[0m18:56:46.391158 [info ] [Thread-1 (]: 8 of 9 PASS not_null_rugs_usa_variant_variant .................................. [[32mPASS[0m in 0.04s]
[0m18:56:46.392012 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402
[0m18:56:46.392530 [debug] [Thread-1 (]: Began running node test.jaffle_shop.profit_priority_order.2c7ed8e7dd
[0m18:56:46.392858 [info ] [Thread-1 (]: 9 of 9 START test profit_priority_order ........................................ [RUN]
[0m18:56:46.393317 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.profit_priority_order.2c7ed8e7dd"
[0m18:56:46.393604 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.profit_priority_order.2c7ed8e7dd
[0m18:56:46.393832 [debug] [Thread-1 (]: Compiling test.jaffle_shop.profit_priority_order.2c7ed8e7dd
[0m18:56:46.398967 [debug] [Thread-1 (]: finished collecting timing info
[0m18:56:46.399514 [debug] [Thread-1 (]: Compilation Error in test profit_priority_order (models/priority_order/priority_order_tests.yml)
  'test_test' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:56:46.399840 [error] [Thread-1 (]: 9 of 9 ERROR profit_priority_order ............................................. [[31mERROR[0m in 0.01s]
[0m18:56:46.400242 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.profit_priority_order.2c7ed8e7dd
[0m18:57:07.049142 [debug] [Thread-2 (]: SQL status: SELECT 1 in 137.32 seconds
[0m18:57:07.069394 [debug] [Thread-2 (]: finished collecting timing info
[0m18:57:07.070668 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m18:57:07.076683 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m18:57:07.082335 [error] [Thread-2 (]: 2 of 9 FAIL 1 new_arrival_stock_depletion_test_hot_upsell_ ..................... [[31mFAIL 1[0m in 137.39s]
[0m18:57:07.084710 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:57:07.092914 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:57:07.093876 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:07.094204 [debug] [MainThread]: On master: BEGIN
[0m18:57:07.094462 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:57:07.108382 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:57:07.109292 [debug] [MainThread]: On master: COMMIT
[0m18:57:07.109799 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:07.110150 [debug] [MainThread]: On master: COMMIT
[0m18:57:07.110676 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:57:07.111127 [debug] [MainThread]: On master: Close
[0m18:57:07.112470 [info ] [MainThread]: 
[0m18:57:07.113000 [info ] [MainThread]: Finished running 9 tests in 0 hours 2 minutes and 17.56 seconds (137.56s).
[0m18:57:07.113404 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:57:07.113686 [debug] [MainThread]: Connection 'test.jaffle_shop.profit_priority_order.2c7ed8e7dd' was properly closed.
[0m18:57:07.113975 [debug] [MainThread]: Connection 'test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38' was properly closed.
[0m18:57:07.125154 [info ] [MainThread]: 
[0m18:57:07.125632 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m18:57:07.126030 [info ] [MainThread]: 
[0m18:57:07.126388 [error] [MainThread]: [33mDatabase Error in test not_null_rugs_usa_variant_product_name (models/priority_order/priority_order_tests.yml)[0m
[0m18:57:07.126705 [error] [MainThread]:   column "product_name" does not exist
[0m18:57:07.126955 [error] [MainThread]:   LINE 13: select product_name
[0m18:57:07.127186 [error] [MainThread]:                   ^
[0m18:57:07.127443 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/priority_order/priority_order_tests.yml/not_null_rugs_usa_variant_product_name.sql
[0m18:57:07.127707 [info ] [MainThread]: 
[0m18:57:07.127975 [error] [MainThread]: [33mCompilation Error in test profit_priority_order (models/priority_order/priority_order_tests.yml)[0m
[0m18:57:07.128225 [error] [MainThread]:   'test_test' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:57:07.128469 [info ] [MainThread]: 
[0m18:57:07.128744 [error] [MainThread]: [31mFailure in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)[0m
[0m18:57:07.129101 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:57:07.129495 [info ] [MainThread]: 
[0m18:57:07.130172 [info ] [MainThread]:   compiled SQL at target/compiled/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m18:57:07.128763 [info ] [MainThread]: 
[0m18:57:07.129010 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=3 SKIP=0 TOTAL=9
[0m18:57:07.129783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9aac2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9aac2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bb1c60>]}


============================== 2024-07-14 18:57:11.320884 | 336e978d-7d5a-460e-a7db-7a3246ae3ac4 ==============================
[0m18:57:11.321441 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:57:11.335286 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m18:57:11.335793 [debug] [MainThread]: Tracking: tracking
[0m18:57:11.360197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2dd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2cc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2fe80>]}
[0m18:57:11.439733 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:57:11.440621 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:57:11.454087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '336e978d-7d5a-460e-a7db-7a3246ae3ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bba980>]}
[0m18:57:11.467364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '336e978d-7d5a-460e-a7db-7a3246ae3ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae4a30>]}
[0m18:57:11.467909 [info ] [MainThread]: Found 4 models, 9 tests, 2 snapshots, 0 analyses, 259 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:57:11.468285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '336e978d-7d5a-460e-a7db-7a3246ae3ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae4ac0>]}
[0m18:57:11.470933 [info ] [MainThread]: 
[0m18:57:11.471597 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:57:11.475462 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m18:57:11.485299 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:57:11.485791 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:57:11.486080 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:11.537374 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m18:57:11.537947 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:57:11.538253 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:57:11.542976 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m18:57:11.545139 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:57:11.545597 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:57:11.550977 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:11.551442 [debug] [MainThread]: On master: BEGIN
[0m18:57:11.551702 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:57:11.560903 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:57:11.561341 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:11.561587 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:57:11.566266 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m18:57:11.568055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '336e978d-7d5a-460e-a7db-7a3246ae3ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c5a620>]}
[0m18:57:11.568512 [debug] [MainThread]: On master: ROLLBACK
[0m18:57:11.568908 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:11.569162 [debug] [MainThread]: On master: BEGIN
[0m18:57:11.569584 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:57:11.569907 [debug] [MainThread]: On master: COMMIT
[0m18:57:11.570162 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:11.570392 [debug] [MainThread]: On master: COMMIT
[0m18:57:11.570715 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:57:11.570951 [debug] [MainThread]: On master: Close
[0m18:57:11.571399 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:57:11.571743 [info ] [MainThread]: 
[0m18:57:11.576788 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:57:11.576963 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:57:11.577278 [info ] [Thread-1 (]: 1 of 9 START test below_depletion_level_tests_below_depletion_level_ ........... [RUN]
[0m18:57:11.577621 [info ] [Thread-2 (]: 2 of 9 START test new_arrival_stock_depletion_test_hot_upsell_ ................. [RUN]
[0m18:57:11.578116 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:57:11.578523 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:57:11.578799 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:57:11.579020 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:57:11.579276 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:57:11.579488 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:57:11.588961 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:57:11.593944 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:57:11.595998 [debug] [Thread-1 (]: finished collecting timing info
[0m18:57:11.596128 [debug] [Thread-2 (]: finished collecting timing info
[0m18:57:11.596379 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:57:11.596648 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:57:11.612187 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:57:11.614423 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:57:11.617339 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:57:11.617569 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:57:11.617841 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m18:57:11.618092 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m18:57:11.618366 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:57:11.618666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:11.627713 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:57:11.627982 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:57:11.628763 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:57:11.629265 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:57:11.629520 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT DISTINCT rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, 
                        (ruv.msrp - rupu.price) AS profit_margin
        FROM "postgres"."public"."rugs_usa_variant" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        /* joining on model as none of these should show. doing an inner join for this purpose to test */
        JOIN "postgres"."public"."hot_upsell" model on model.name = rup.name and model.variant = ruv.variant and model.size = rupu.size and model.shape = rupu.shape and model.type = rupu.type
        ORDER BY profit_margin DESC
    )
    SELECT 
        count(*) as errors
    FROM test_data
    having count(*) > 0

      
    ) dbt_internal_test
[0m18:57:11.629739 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m18:57:11.641275 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:57:11.644124 [debug] [Thread-1 (]: finished collecting timing info
[0m18:57:11.644534 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m18:57:11.644955 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m18:57:11.645494 [info ] [Thread-1 (]: 1 of 9 PASS below_depletion_level_tests_below_depletion_level_ ................. [[32mPASS[0m in 0.07s]
[0m18:57:11.646551 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:57:11.646877 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:57:11.647194 [info ] [Thread-1 (]: 3 of 9 START test not_null_below_depletion_level_name .......................... [RUN]
[0m18:57:11.647688 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:57:11.647971 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:57:11.648313 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:57:11.655299 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:57:11.656439 [debug] [Thread-1 (]: finished collecting timing info
[0m18:57:11.656698 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:57:11.658484 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:57:11.660090 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:57:11.660439 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m18:57:11.660664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:11.690138 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m18:57:11.690861 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:57:11.691179 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m18:57:11.700475 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:57:11.702667 [debug] [Thread-1 (]: finished collecting timing info
[0m18:57:11.703251 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m18:57:11.703740 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m18:57:11.704317 [info ] [Thread-1 (]: 3 of 9 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.06s]
[0m18:57:11.704937 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:57:11.705399 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:57:11.705700 [info ] [Thread-1 (]: 4 of 9 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m18:57:11.706182 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:57:11.706409 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:57:11.706629 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:57:11.710386 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:57:11.711392 [debug] [Thread-1 (]: finished collecting timing info
[0m18:57:11.711636 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:57:11.714336 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:57:11.715385 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:57:11.715613 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m18:57:11.715821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:11.726383 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:57:11.726871 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:57:11.727118 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m18:57:11.734873 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:57:11.736426 [debug] [Thread-1 (]: finished collecting timing info
[0m18:57:11.736713 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m18:57:11.737027 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m18:57:11.737549 [info ] [Thread-1 (]: 4 of 9 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.03s]
[0m18:57:11.738187 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:57:11.738519 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:57:11.738792 [info ] [Thread-1 (]: 5 of 9 START test not_null_hot_upsell_name ..................................... [RUN]
[0m18:57:11.739244 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:57:11.739508 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:57:11.739735 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:57:11.743342 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:57:11.744242 [debug] [Thread-1 (]: finished collecting timing info
[0m18:57:11.744484 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:57:11.746129 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:57:11.746944 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:57:11.747281 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m18:57:11.747527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:11.766578 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m18:57:11.767235 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:57:11.767491 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m18:57:11.772801 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:57:11.774695 [debug] [Thread-1 (]: finished collecting timing info
[0m18:57:11.775129 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m18:57:11.775624 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m18:57:11.776161 [info ] [Thread-1 (]: 5 of 9 PASS not_null_hot_upsell_name ........................................... [[32mPASS[0m in 0.04s]
[0m18:57:11.776631 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:57:11.776994 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:57:11.777368 [info ] [Thread-1 (]: 6 of 9 START test not_null_hot_upsell_variant .................................. [RUN]
[0m18:57:11.777826 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:57:11.778058 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:57:11.778380 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:57:11.783694 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:57:11.784761 [debug] [Thread-1 (]: finished collecting timing info
[0m18:57:11.785016 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:57:11.786729 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:57:11.787527 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:57:11.787731 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m18:57:11.787937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:11.794579 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:57:11.794995 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:57:11.795262 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m18:57:11.802866 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:57:11.804367 [debug] [Thread-1 (]: finished collecting timing info
[0m18:57:11.804640 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m18:57:11.804956 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m18:57:11.805394 [info ] [Thread-1 (]: 6 of 9 PASS not_null_hot_upsell_variant ........................................ [[32mPASS[0m in 0.03s]
[0m18:57:11.805838 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:57:11.806179 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90
[0m18:57:11.806492 [info ] [Thread-1 (]: 7 of 9 START test not_null_rugs_usa_variant_product_name ....................... [RUN]
[0m18:57:11.806965 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90"
[0m18:57:11.807221 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90
[0m18:57:11.807449 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90
[0m18:57:11.810711 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90"
[0m18:57:11.812086 [debug] [Thread-1 (]: finished collecting timing info
[0m18:57:11.812348 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90
[0m18:57:11.813998 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90"
[0m18:57:11.815525 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90"
[0m18:57:11.815843 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90: BEGIN
[0m18:57:11.816089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:11.823009 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:57:11.823579 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90"
[0m18:57:11.823881 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_name
from "postgres"."public"."rugs_usa_variant"
where product_name is null



      
    ) dbt_internal_test
[0m18:57:11.824924 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "product_name" does not exist
LINE 13: select product_name
                ^

[0m18:57:11.825239 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90: ROLLBACK
[0m18:57:11.825844 [debug] [Thread-1 (]: finished collecting timing info
[0m18:57:11.826109 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90: Close
[0m18:57:11.826577 [debug] [Thread-1 (]: Database Error in test not_null_rugs_usa_variant_product_name (models/priority_order/priority_order_tests.yml)
  column "product_name" does not exist
  LINE 13: select product_name
                  ^
  compiled SQL at target/run/jaffle_shop/models/priority_order/priority_order_tests.yml/not_null_rugs_usa_variant_product_name.sql
[0m18:57:11.826936 [error] [Thread-1 (]: 7 of 9 ERROR not_null_rugs_usa_variant_product_name ............................ [[31mERROR[0m in 0.02s]
[0m18:57:11.827383 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_rugs_usa_variant_product_name.d986b52e90
[0m18:57:11.827641 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402
[0m18:57:11.828003 [info ] [Thread-1 (]: 8 of 9 START test not_null_rugs_usa_variant_variant ............................ [RUN]
[0m18:57:11.828537 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"
[0m18:57:11.828780 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402
[0m18:57:11.829006 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402
[0m18:57:11.832495 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"
[0m18:57:11.833565 [debug] [Thread-1 (]: finished collecting timing info
[0m18:57:11.833802 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402
[0m18:57:11.835820 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"
[0m18:57:11.836682 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"
[0m18:57:11.836895 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402: BEGIN
[0m18:57:11.837110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:11.845961 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:57:11.846466 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"
[0m18:57:11.846682 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."rugs_usa_variant"
where variant is null



      
    ) dbt_internal_test
[0m18:57:11.849887 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:57:11.851355 [debug] [Thread-1 (]: finished collecting timing info
[0m18:57:11.851614 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402: ROLLBACK
[0m18:57:11.851915 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402: Close
[0m18:57:11.852378 [info ] [Thread-1 (]: 8 of 9 PASS not_null_rugs_usa_variant_variant .................................. [[32mPASS[0m in 0.02s]
[0m18:57:11.852893 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402
[0m18:57:11.853296 [debug] [Thread-1 (]: Began running node test.jaffle_shop.profit_priority_order.2c7ed8e7dd
[0m18:57:11.853575 [info ] [Thread-1 (]: 9 of 9 START test profit_priority_order ........................................ [RUN]
[0m18:57:11.853986 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.profit_priority_order.2c7ed8e7dd"
[0m18:57:11.854227 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.profit_priority_order.2c7ed8e7dd
[0m18:57:11.854439 [debug] [Thread-1 (]: Compiling test.jaffle_shop.profit_priority_order.2c7ed8e7dd
[0m18:57:11.858235 [debug] [Thread-1 (]: finished collecting timing info
[0m18:57:11.858678 [debug] [Thread-1 (]: Compilation Error in test profit_priority_order (models/priority_order/priority_order_tests.yml)
  'test_test' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:57:11.859226 [error] [Thread-1 (]: 9 of 9 ERROR profit_priority_order ............................................. [[31mERROR[0m in 0.01s]
[0m18:57:11.859799 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.profit_priority_order.2c7ed8e7dd


============================== 2024-07-14 18:58:05.522904 | cbc62f53-b8a7-4100-94a0-463c19f7764a ==============================
[0m18:58:05.523244 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:58:05.549497 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m18:58:05.549981 [debug] [MainThread]: Tracking: tracking
[0m18:58:05.568324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2bf70>]}
[0m18:58:05.638291 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:58:05.639145 [debug] [MainThread]: Partial parsing: update schema file: jaffle_shop://models/priority_order/priority_order_tests.yml
[0m18:58:05.648142 [warn ] [MainThread]: [[33mWARNING[0m]: 'rugs_usa_variant' is a seed node, but it is specified in the models section of
models/priority_order/priority_order_tests.yml. To fix this error, place the
`rugs_usa_variant` specification under the seeds key instead.
[0m18:58:05.686890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbc62f53-b8a7-4100-94a0-463c19f7764a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a21a20>]}
[0m18:58:05.701553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbc62f53-b8a7-4100-94a0-463c19f7764a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba6f50>]}
[0m18:58:05.702029 [info ] [MainThread]: Found 4 models, 9 tests, 2 snapshots, 0 analyses, 259 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:58:05.702413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbc62f53-b8a7-4100-94a0-463c19f7764a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba7fd0>]}
[0m18:58:05.704834 [info ] [MainThread]: 
[0m18:58:05.705645 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:58:05.709400 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m18:58:05.719686 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:58:05.720072 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:58:05.720347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:05.772204 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m18:58:05.772711 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:58:05.772955 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:58:05.778497 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.01 seconds
[0m18:58:05.780315 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:58:05.780721 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:58:05.785570 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:05.785908 [debug] [MainThread]: On master: BEGIN
[0m18:58:05.786151 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:58:05.796019 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:58:05.796520 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:05.796745 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:58:05.806944 [debug] [MainThread]: SQL status: SELECT 11 in 0.01 seconds
[0m18:58:05.808499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbc62f53-b8a7-4100-94a0-463c19f7764a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba7f10>]}
[0m18:58:05.808881 [debug] [MainThread]: On master: ROLLBACK
[0m18:58:05.809203 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:05.809413 [debug] [MainThread]: On master: BEGIN
[0m18:58:05.809788 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:58:05.810161 [debug] [MainThread]: On master: COMMIT
[0m18:58:05.810358 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:05.810553 [debug] [MainThread]: On master: COMMIT
[0m18:58:05.810821 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:58:05.811029 [debug] [MainThread]: On master: Close
[0m18:58:05.811416 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:58:05.811806 [info ] [MainThread]: 
[0m18:58:05.817263 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:58:05.817519 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:58:05.818046 [info ] [Thread-1 (]: 1 of 9 START test below_depletion_level_tests_below_depletion_level_ ........... [RUN]
[0m18:58:05.818555 [info ] [Thread-2 (]: 2 of 9 START test new_arrival_stock_depletion_test_hot_upsell_ ................. [RUN]
[0m18:58:05.819199 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:58:05.819976 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:58:05.820593 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:58:05.820975 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:58:05.821355 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:58:05.821711 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:58:05.826249 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:58:05.830519 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:58:05.832870 [debug] [Thread-1 (]: finished collecting timing info
[0m18:58:05.833091 [debug] [Thread-2 (]: finished collecting timing info
[0m18:58:05.833236 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:58:05.833487 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:58:05.849526 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:58:05.852163 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:58:05.854476 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:58:05.854606 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:58:05.854830 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m18:58:05.855084 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m18:58:05.855336 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:05.855618 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:58:05.869626 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:58:05.870403 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m18:58:05.870751 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m18:58:05.871096 [debug] [Thread-2 (]: SQL status: BEGIN in 0.02 seconds
[0m18:58:05.871621 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m18:58:05.871962 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT DISTINCT rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, 
                        (ruv.msrp - rupu.price) AS profit_margin
        FROM "postgres"."public"."rugs_usa_variant" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        /* joining on model as none of these should show. doing an inner join for this purpose to test */
        JOIN "postgres"."public"."hot_upsell" model on model.name = rup.name and model.variant = ruv.variant and model.size = rupu.size and model.shape = rupu.shape and model.type = rupu.type
        ORDER BY profit_margin DESC
    )
    SELECT 
        count(*) as errors
    FROM test_data
    having count(*) > 0

      
    ) dbt_internal_test
[0m18:58:05.883015 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:58:05.885944 [debug] [Thread-1 (]: finished collecting timing info
[0m18:58:05.886515 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m18:58:05.887016 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m18:58:05.887601 [info ] [Thread-1 (]: 1 of 9 PASS below_depletion_level_tests_below_depletion_level_ ................. [[32mPASS[0m in 0.07s]
[0m18:58:05.888574 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m18:58:05.889191 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:58:05.889691 [info ] [Thread-1 (]: 3 of 9 START test not_null_below_depletion_level_name .......................... [RUN]
[0m18:58:05.890288 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:58:05.890743 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:58:05.890991 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:58:05.903114 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:58:05.905958 [debug] [Thread-1 (]: finished collecting timing info
[0m18:58:05.906518 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:58:05.912340 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:58:05.916913 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:58:05.918771 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m18:58:05.919840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:05.929881 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:58:05.930594 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m18:58:05.930939 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m18:58:05.934578 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:58:05.936092 [debug] [Thread-1 (]: finished collecting timing info
[0m18:58:05.936412 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m18:58:05.936778 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m18:58:05.937275 [info ] [Thread-1 (]: 3 of 9 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.05s]
[0m18:58:05.938274 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m18:58:05.938992 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:58:05.939533 [info ] [Thread-1 (]: 4 of 9 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m18:58:05.940146 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:58:05.940568 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:58:05.940909 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:58:05.944776 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:58:05.946567 [debug] [Thread-1 (]: finished collecting timing info
[0m18:58:05.946934 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:58:05.949125 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:58:05.950710 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:58:05.951047 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m18:58:05.951362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:05.962374 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:58:05.963028 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m18:58:05.963510 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m18:58:05.977353 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:58:05.978879 [debug] [Thread-1 (]: finished collecting timing info
[0m18:58:05.979277 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m18:58:05.979923 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m18:58:05.980776 [info ] [Thread-1 (]: 4 of 9 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.04s]
[0m18:58:05.981654 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m18:58:05.982308 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:58:05.982721 [info ] [Thread-1 (]: 5 of 9 START test not_null_hot_upsell_name ..................................... [RUN]
[0m18:58:05.983391 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:58:05.983915 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:58:05.984211 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:58:05.987545 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:58:05.989001 [debug] [Thread-1 (]: finished collecting timing info
[0m18:58:05.989276 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:58:05.990973 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:58:05.992287 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:58:05.992555 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m18:58:05.992789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:06.003958 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:58:06.004655 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m18:58:06.005007 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m18:58:06.011568 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:58:06.013076 [debug] [Thread-1 (]: finished collecting timing info
[0m18:58:06.013371 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m18:58:06.013771 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m18:58:06.014266 [info ] [Thread-1 (]: 5 of 9 PASS not_null_hot_upsell_name ........................................... [[32mPASS[0m in 0.03s]
[0m18:58:06.015069 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m18:58:06.015561 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:58:06.015869 [info ] [Thread-1 (]: 6 of 9 START test not_null_hot_upsell_variant .................................. [RUN]
[0m18:58:06.016453 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:58:06.016821 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:58:06.017145 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:58:06.021001 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:58:06.022660 [debug] [Thread-1 (]: finished collecting timing info
[0m18:58:06.023013 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:58:06.025024 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:58:06.026596 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:58:06.026927 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m18:58:06.027201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:06.038341 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:58:06.038944 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m18:58:06.039368 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m18:58:06.047823 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m18:58:06.049581 [debug] [Thread-1 (]: finished collecting timing info
[0m18:58:06.050015 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m18:58:06.050543 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m18:58:06.051088 [info ] [Thread-1 (]: 6 of 9 PASS not_null_hot_upsell_variant ........................................ [[32mPASS[0m in 0.03s]
[0m18:58:06.051792 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m18:58:06.052296 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5
[0m18:58:06.052696 [info ] [Thread-1 (]: 7 of 9 START test not_null_rugs_usa_variant_name ............................... [RUN]
[0m18:58:06.053307 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5"
[0m18:58:06.053738 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5
[0m18:58:06.054019 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5
[0m18:58:06.057877 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5"
[0m18:58:06.059745 [debug] [Thread-1 (]: finished collecting timing info
[0m18:58:06.060098 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5
[0m18:58:06.062988 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5"
[0m18:58:06.064820 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5"
[0m18:58:06.065158 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5: BEGIN
[0m18:58:06.065400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:06.075031 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:58:06.075680 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5"
[0m18:58:06.075946 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."rugs_usa_variant"
where name is null



      
    ) dbt_internal_test
[0m18:58:06.077324 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "name" does not exist
LINE 13: select name
                ^

[0m18:58:06.077812 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5: ROLLBACK
[0m18:58:06.078332 [debug] [Thread-1 (]: finished collecting timing info
[0m18:58:06.078592 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5: Close
[0m18:58:06.079129 [debug] [Thread-1 (]: Database Error in test not_null_rugs_usa_variant_name (models/priority_order/priority_order_tests.yml)
  column "name" does not exist
  LINE 13: select name
                  ^
  compiled SQL at target/run/jaffle_shop/models/priority_order/priority_order_tests.yml/not_null_rugs_usa_variant_name.sql
[0m18:58:06.079713 [error] [Thread-1 (]: 7 of 9 ERROR not_null_rugs_usa_variant_name .................................... [[31mERROR[0m in 0.03s]
[0m18:58:06.080344 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5
[0m18:58:06.080826 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402
[0m18:58:06.081373 [info ] [Thread-1 (]: 8 of 9 START test not_null_rugs_usa_variant_variant ............................ [RUN]
[0m18:58:06.081863 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"
[0m18:58:06.082300 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402
[0m18:58:06.082545 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402
[0m18:58:06.086195 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"
[0m18:58:06.087568 [debug] [Thread-1 (]: finished collecting timing info
[0m18:58:06.087848 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402
[0m18:58:06.089629 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"
[0m18:58:06.090939 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"
[0m18:58:06.091231 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402: BEGIN
[0m18:58:06.091543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:06.107456 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m18:58:06.108270 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"
[0m18:58:06.108650 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."rugs_usa_variant"
where variant is null



      
    ) dbt_internal_test
[0m18:58:06.113026 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:58:06.114611 [debug] [Thread-1 (]: finished collecting timing info
[0m18:58:06.114964 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402: ROLLBACK
[0m18:58:06.115382 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402: Close
[0m18:58:06.115916 [info ] [Thread-1 (]: 8 of 9 PASS not_null_rugs_usa_variant_variant .................................. [[32mPASS[0m in 0.03s]
[0m18:58:06.116785 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402
[0m18:58:06.117328 [debug] [Thread-1 (]: Began running node test.jaffle_shop.profit_priority_order.2c7ed8e7dd
[0m18:58:06.117663 [info ] [Thread-1 (]: 9 of 9 START test profit_priority_order ........................................ [RUN]
[0m18:58:06.118222 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.profit_priority_order.2c7ed8e7dd"
[0m18:58:06.118624 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.profit_priority_order.2c7ed8e7dd
[0m18:58:06.118918 [debug] [Thread-1 (]: Compiling test.jaffle_shop.profit_priority_order.2c7ed8e7dd
[0m18:58:06.123467 [debug] [Thread-1 (]: finished collecting timing info
[0m18:58:06.123959 [debug] [Thread-1 (]: Compilation Error in test profit_priority_order (models/priority_order/priority_order_tests.yml)
  'test_test' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:58:06.124354 [error] [Thread-1 (]: 9 of 9 ERROR profit_priority_order ............................................. [[31mERROR[0m in 0.01s]
[0m18:58:06.124812 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.profit_priority_order.2c7ed8e7dd


============================== 2024-07-14 18:59:17.607851 | 4c8e3783-75e3-415a-96fb-3381a6448ea6 ==============================
[0m18:59:17.609502 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:59:17.617583 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:59:17.618461 [debug] [MainThread]: Tracking: tracking
[0m18:59:17.642569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2a2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c28190>]}
[0m18:59:17.740715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:59:17.742213 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/priority_order/priority_order.sql
[0m18:59:17.796114 [debug] [MainThread]: 1699: static parser successfully parsed priority_order/priority_order.sql
[0m18:59:17.827292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c8e3783-75e3-415a-96fb-3381a6448ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a10100>]}
[0m18:59:17.842905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c8e3783-75e3-415a-96fb-3381a6448ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba71c0>]}
[0m18:59:17.843865 [info ] [MainThread]: Found 4 models, 9 tests, 2 snapshots, 0 analyses, 259 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:59:17.844533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c8e3783-75e3-415a-96fb-3381a6448ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba7940>]}
[0m18:59:17.848207 [info ] [MainThread]: 
[0m18:59:17.849495 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:59:17.852826 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m18:59:17.868649 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:59:17.869258 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:59:17.869743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:59:17.944328 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.07 seconds
[0m18:59:17.946715 [debug] [ThreadPool]: On list_postgres: Close
[0m18:59:17.950644 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m18:59:17.957001 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:59:17.957456 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:59:17.957858 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:59:17.967256 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:59:17.968052 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:59:17.968488 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:59:17.973935 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.01 seconds
[0m18:59:17.975608 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:59:17.976187 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:59:17.982037 [debug] [MainThread]: Using postgres connection "master"
[0m18:59:17.982400 [debug] [MainThread]: On master: BEGIN
[0m18:59:17.982677 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:59:17.991114 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:59:17.991843 [debug] [MainThread]: Using postgres connection "master"
[0m18:59:17.992153 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:59:18.002561 [debug] [MainThread]: SQL status: SELECT 11 in 0.01 seconds
[0m18:59:18.004408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c8e3783-75e3-415a-96fb-3381a6448ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a21870>]}
[0m18:59:18.004832 [debug] [MainThread]: On master: ROLLBACK
[0m18:59:18.005200 [debug] [MainThread]: Using postgres connection "master"
[0m18:59:18.005466 [debug] [MainThread]: On master: BEGIN
[0m18:59:18.005953 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:59:18.006794 [debug] [MainThread]: On master: COMMIT
[0m18:59:18.007082 [debug] [MainThread]: Using postgres connection "master"
[0m18:59:18.007344 [debug] [MainThread]: On master: COMMIT
[0m18:59:18.007757 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:59:18.008182 [debug] [MainThread]: On master: Close
[0m18:59:18.008857 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:59:18.010323 [info ] [MainThread]: 
[0m18:59:18.027287 [debug] [Thread-1 (]: Began running node model.jaffle_shop.below_depletion_level
[0m18:59:18.027747 [debug] [Thread-2 (]: Began running node model.jaffle_shop.hot_upsell
[0m18:59:18.028265 [info ] [Thread-1 (]: 1 of 4 START view model public.below_depletion_level ........................... [RUN]
[0m18:59:18.028820 [info ] [Thread-2 (]: 2 of 4 START view model public.hot_upsell ...................................... [RUN]
[0m18:59:18.029686 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.below_depletion_level"
[0m18:59:18.030588 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.hot_upsell"
[0m18:59:18.031117 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.below_depletion_level
[0m18:59:18.031550 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.hot_upsell
[0m18:59:18.031972 [debug] [Thread-1 (]: Compiling model.jaffle_shop.below_depletion_level
[0m18:59:18.032366 [debug] [Thread-2 (]: Compiling model.jaffle_shop.hot_upsell
[0m18:59:18.036998 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.below_depletion_level"
[0m18:59:18.042621 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.hot_upsell"
[0m18:59:18.046404 [debug] [Thread-2 (]: finished collecting timing info
[0m18:59:18.046601 [debug] [Thread-1 (]: finished collecting timing info
[0m18:59:18.046960 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.hot_upsell
[0m18:59:18.047383 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.below_depletion_level
[0m18:59:18.133434 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.hot_upsell"
[0m18:59:18.134514 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.below_depletion_level"
[0m18:59:18.138539 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m18:59:18.138715 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m18:59:18.139104 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: BEGIN
[0m18:59:18.139501 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: BEGIN
[0m18:59:18.139873 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:59:18.140241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:18.152543 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:59:18.154167 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m18:59:18.154976 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */

  create view "postgres"."public"."below_depletion_level__dbt_tmp" as (
    select distinct name, ruv.variant, ruv.actual_size, ruv.weave_cat, ruv.size_grp, ruv.shape, ruv.weight, ruv.stock_level, ruv.depletion_level
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where coalesce(stock_level, 0) < coalesce(depletion_level, 0)
  );
[0m18:59:18.154345 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m18:59:18.155920 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m18:59:18.156810 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */

  create view "postgres"."public"."hot_upsell__dbt_tmp" as (
    select distinct rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, (ruv.msrp - rupu.price) as profit_margin
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_pads_upsell" rupu on rupu.p_id = ruv.pid and rupu.variant = ruv.variant 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where new_arrival = 'Y' and stock_level < coalesce(depletion_level, 0) and rupu.stock is not null
order by profit_margin desc
  );
[0m18:59:18.168766 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m18:59:18.169074 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m18:59:18.175491 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m18:59:18.178188 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m18:59:18.178658 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level" rename to "below_depletion_level__dbt_backup"
[0m18:59:18.179066 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
alter table "postgres"."public"."hot_upsell" rename to "hot_upsell__dbt_backup"
[0m18:59:18.180680 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:59:18.183100 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m18:59:18.183542 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level__dbt_tmp" rename to "below_depletion_level"
[0m18:59:18.184311 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:59:18.205730 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m18:59:18.206271 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m18:59:18.206648 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m18:59:18.210153 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:59:18.215755 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m18:59:18.216204 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
drop view if exists "postgres"."public"."below_depletion_level__dbt_backup" cascade
[0m18:59:18.221424 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:59:18.222915 [debug] [Thread-1 (]: finished collecting timing info
[0m18:59:18.223363 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: Close
[0m18:59:18.224315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c8e3783-75e3-415a-96fb-3381a6448ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7b3a0>]}
[0m18:59:18.225223 [info ] [Thread-1 (]: 1 of 4 OK created view model public.below_depletion_level ...................... [[32mCREATE VIEW[0m in 0.19s]
[0m18:59:18.226097 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.below_depletion_level
[0m18:59:18.226556 [debug] [Thread-1 (]: Began running node model.jaffle_shop.underselling_product_specs
[0m18:59:18.227402 [info ] [Thread-1 (]: 3 of 4 START view model public.underselling_product_specs ...................... [RUN]
[0m18:59:18.228187 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.underselling_product_specs"
[0m18:59:18.228753 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.underselling_product_specs
[0m18:59:18.229123 [debug] [Thread-1 (]: Compiling model.jaffle_shop.underselling_product_specs
[0m18:59:18.232437 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.underselling_product_specs"
[0m18:59:18.234442 [debug] [Thread-1 (]: finished collecting timing info
[0m18:59:18.234868 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.underselling_product_specs
[0m18:59:18.238655 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.underselling_product_specs"
[0m18:59:18.240502 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m18:59:18.240886 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: BEGIN
[0m18:59:18.241266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:18.250703 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:59:18.251292 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m18:59:18.251747 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */

  create view "postgres"."public"."underselling_product_specs__dbt_tmp" as (
    select distinct rup.name, rucm.color_value, ruv.actual_size, ruv.weave_cat, ruv.size_grp, ruv.shape, (ruv.stock_level - ruv.depletion_level) as stock_depletion_ratio
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_color_map" rucm on rucm.color_id = ruv.pid 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
where stock_level > coalesce(depletion_level, 0) and depletion_level <> 0 
and stock_level is not null and stock_level <> 0 and new_arrival = 'N' and status = 'In_stock'
order by stock_depletion_ratio desc limit 10
  );
[0m18:59:18.260819 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m18:59:18.264941 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m18:59:18.265532 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
alter table "postgres"."public"."underselling_product_specs" rename to "underselling_product_specs__dbt_backup"
[0m18:59:18.266773 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:59:18.269183 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m18:59:18.269590 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
alter table "postgres"."public"."underselling_product_specs__dbt_tmp" rename to "underselling_product_specs"
[0m18:59:18.270348 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:59:18.271916 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: COMMIT
[0m18:59:18.272329 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m18:59:18.272715 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: COMMIT
[0m18:59:18.274111 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:59:18.277119 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m18:59:18.277611 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
drop view if exists "postgres"."public"."underselling_product_specs__dbt_backup" cascade
[0m18:59:18.280124 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:59:18.281444 [debug] [Thread-1 (]: finished collecting timing info
[0m18:59:18.281880 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: Close
[0m18:59:18.282531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c8e3783-75e3-415a-96fb-3381a6448ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff80ec880>]}
[0m18:59:18.283669 [info ] [Thread-1 (]: 3 of 4 OK created view model public.underselling_product_specs ................. [[32mCREATE VIEW[0m in 0.05s]
[0m18:59:18.284297 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.underselling_product_specs
[0m18:59:18.284993 [debug] [Thread-1 (]: Began running node model.jaffle_shop.priority_order
[0m18:59:18.285532 [info ] [Thread-1 (]: 4 of 4 START view model public.priority_order .................................. [RUN]
[0m18:59:18.286164 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.priority_order"
[0m18:59:18.286661 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.priority_order
[0m18:59:18.287034 [debug] [Thread-1 (]: Compiling model.jaffle_shop.priority_order
[0m18:59:18.290820 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.priority_order"
[0m18:59:18.292967 [debug] [Thread-1 (]: finished collecting timing info
[0m18:59:18.293387 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.priority_order
[0m18:59:18.297061 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.priority_order"
[0m18:59:18.298784 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m18:59:18.299177 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: BEGIN
[0m18:59:18.299596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:18.309799 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:59:18.310751 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m18:59:18.311178 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */

  create view "postgres"."public"."priority_order__dbt_tmp" as (
    select distinct rup.name, ruv.variant, ruv.actual_size, ruv.weave_cat, (msrp - price) as profit 
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
join "postgres"."public"."below_depletion_level" bdl on bdl.name = rup.name and bdl.variant = ruv.variant
order by profit desc
  );
[0m18:59:18.314768 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:59:18.317549 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m18:59:18.317957 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
alter table "postgres"."public"."priority_order__dbt_tmp" rename to "priority_order"
[0m18:59:18.319078 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:59:18.320606 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: COMMIT
[0m18:59:18.321000 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m18:59:18.321360 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: COMMIT
[0m18:59:18.322581 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:59:18.324497 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m18:59:18.324924 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
drop view if exists "postgres"."public"."priority_order__dbt_backup" cascade
[0m18:59:18.325744 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:59:18.327684 [debug] [Thread-1 (]: finished collecting timing info
[0m18:59:18.328110 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: Close
[0m18:59:18.328814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c8e3783-75e3-415a-96fb-3381a6448ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b99300>]}
[0m18:59:18.329680 [info ] [Thread-1 (]: 4 of 4 OK created view model public.priority_order ............................. [[32mCREATE VIEW[0m in 0.04s]
[0m18:59:18.330427 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.priority_order
[0m18:59:25.312760 [debug] [Thread-2 (]: SQL status: SELECT 1 in 159.19 seconds
[0m18:59:25.340900 [debug] [Thread-2 (]: finished collecting timing info
[0m18:59:25.342686 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m18:59:25.344419 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m18:59:25.347105 [error] [Thread-2 (]: 2 of 9 FAIL 1 new_arrival_stock_depletion_test_hot_upsell_ ..................... [[31mFAIL 1[0m in 159.29s]
[0m18:59:25.351304 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:59:25.360560 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:59:25.361439 [debug] [MainThread]: Using postgres connection "master"
[0m18:59:25.361803 [debug] [MainThread]: On master: BEGIN
[0m18:59:25.362169 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:59:25.376256 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:59:25.377248 [debug] [MainThread]: On master: COMMIT
[0m18:59:25.377686 [debug] [MainThread]: Using postgres connection "master"
[0m18:59:25.378055 [debug] [MainThread]: On master: COMMIT
[0m18:59:25.378594 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:59:25.378987 [debug] [MainThread]: On master: Close
[0m18:59:25.380711 [info ] [MainThread]: 
[0m18:59:25.381493 [info ] [MainThread]: Finished running 9 tests in 0 hours 2 minutes and 39.49 seconds (159.49s).
[0m18:59:25.382043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:59:25.382419 [debug] [MainThread]: Connection 'test.jaffle_shop.profit_priority_order.2c7ed8e7dd' was properly closed.
[0m18:59:25.382806 [debug] [MainThread]: Connection 'test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38' was properly closed.
[0m18:59:25.399651 [info ] [MainThread]: 
[0m18:59:25.400281 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m18:59:25.400866 [info ] [MainThread]: 
[0m18:59:25.401408 [error] [MainThread]: [33mDatabase Error in test not_null_rugs_usa_variant_product_name (models/priority_order/priority_order_tests.yml)[0m
[0m18:59:25.401954 [error] [MainThread]:   column "product_name" does not exist
[0m18:59:25.402321 [error] [MainThread]:   LINE 13: select product_name
[0m18:59:25.402675 [error] [MainThread]:                   ^
[0m18:59:25.402996 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/priority_order/priority_order_tests.yml/not_null_rugs_usa_variant_product_name.sql
[0m18:59:25.403365 [info ] [MainThread]: 
[0m18:59:25.403709 [error] [MainThread]: [33mCompilation Error in test profit_priority_order (models/priority_order/priority_order_tests.yml)[0m
[0m18:59:25.404020 [error] [MainThread]:   'test_test' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:59:25.404335 [info ] [MainThread]: 
[0m18:59:25.404701 [error] [MainThread]: [31mFailure in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)[0m
[0m18:59:25.405032 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:59:25.405350 [info ] [MainThread]: 
[0m18:59:25.405744 [info ] [MainThread]:   compiled SQL at target/compiled/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m18:59:25.406172 [info ] [MainThread]: 
[0m18:59:25.407026 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=3 SKIP=0 TOTAL=9
[0m18:59:25.408236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1cf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8aac730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b98ca0>]}
[0m18:59:52.940753 [debug] [Thread-2 (]: SQL status: SELECT 1 in 161.31 seconds
[0m18:59:52.976274 [debug] [Thread-2 (]: finished collecting timing info
[0m18:59:52.977032 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m18:59:52.977997 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m18:59:52.979563 [error] [Thread-2 (]: 2 of 9 FAIL 1 new_arrival_stock_depletion_test_hot_upsell_ ..................... [[31mFAIL 1[0m in 161.40s]
[0m18:59:52.981083 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m18:59:52.987804 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:59:52.988313 [debug] [MainThread]: Using postgres connection "master"
[0m18:59:52.988568 [debug] [MainThread]: On master: BEGIN
[0m18:59:52.988796 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:59:52.996921 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:59:52.997375 [debug] [MainThread]: On master: COMMIT
[0m18:59:52.997597 [debug] [MainThread]: Using postgres connection "master"
[0m18:59:52.997810 [debug] [MainThread]: On master: COMMIT
[0m18:59:52.998104 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:59:52.998376 [debug] [MainThread]: On master: Close
[0m18:59:53.000966 [info ] [MainThread]: 
[0m18:59:53.001964 [info ] [MainThread]: Finished running 9 tests in 0 hours 2 minutes and 41.53 seconds (161.53s).
[0m18:59:53.002660 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:59:53.002958 [debug] [MainThread]: Connection 'test.jaffle_shop.profit_priority_order.2c7ed8e7dd' was properly closed.
[0m18:59:53.003263 [debug] [MainThread]: Connection 'test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38' was properly closed.
[0m18:59:53.030046 [info ] [MainThread]: 
[0m18:59:53.030491 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m18:59:53.030963 [info ] [MainThread]: 
[0m18:59:53.031322 [error] [MainThread]: [33mDatabase Error in test not_null_rugs_usa_variant_product_name (models/priority_order/priority_order_tests.yml)[0m
[0m18:59:53.031641 [error] [MainThread]:   column "product_name" does not exist
[0m18:59:53.031921 [error] [MainThread]:   LINE 13: select product_name
[0m18:59:53.032219 [error] [MainThread]:                   ^
[0m18:59:53.032468 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/priority_order/priority_order_tests.yml/not_null_rugs_usa_variant_product_name.sql
[0m18:59:53.032806 [info ] [MainThread]: 
[0m18:59:53.033075 [error] [MainThread]: [33mCompilation Error in test profit_priority_order (models/priority_order/priority_order_tests.yml)[0m
[0m18:59:53.033379 [error] [MainThread]:   'test_test' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:59:53.033650 [info ] [MainThread]: 
[0m18:59:53.033995 [error] [MainThread]: [31mFailure in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)[0m
[0m18:59:53.034287 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:59:53.034556 [info ] [MainThread]: 
[0m18:59:53.034834 [info ] [MainThread]:   compiled SQL at target/compiled/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m18:59:53.035152 [info ] [MainThread]: 
[0m18:59:53.035443 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=3 SKIP=0 TOTAL=9
[0m18:59:53.036279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a09d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a08b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bb0ee0>]}


============================== 2024-07-14 19:00:00.561221 | 19083272-0172-4be3-9db3-2377e94dbdea ==============================
[0m19:00:00.561542 [info ] [MainThread]: Running with dbt=1.2.0
[0m19:00:00.566470 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:00:00.567032 [debug] [MainThread]: Tracking: tracking
[0m19:00:00.583853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c15d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c14c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c17e80>]}
[0m19:00:00.643861 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:00:00.644307 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:00:00.651287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19083272-0172-4be3-9db3-2377e94dbdea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bba9e0>]}
[0m19:00:00.663310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19083272-0172-4be3-9db3-2377e94dbdea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae4a90>]}
[0m19:00:00.663834 [info ] [MainThread]: Found 4 models, 9 tests, 2 snapshots, 0 analyses, 259 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:00:00.664221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19083272-0172-4be3-9db3-2377e94dbdea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae4b20>]}
[0m19:00:00.666556 [info ] [MainThread]: 
[0m19:00:00.667351 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:00:00.670405 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m19:00:00.679530 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:00:00.679909 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:00:00.680266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:00.730970 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m19:00:00.731536 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:00:00.731869 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:00:00.736005 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m19:00:00.738014 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:00:00.738518 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:00:00.743993 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:00.744386 [debug] [MainThread]: On master: BEGIN
[0m19:00:00.744656 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:00:00.752048 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m19:00:00.752404 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:00.752655 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:00:00.757881 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m19:00:00.759560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19083272-0172-4be3-9db3-2377e94dbdea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c5d420>]}
[0m19:00:00.760045 [debug] [MainThread]: On master: ROLLBACK
[0m19:00:00.760409 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:00.760658 [debug] [MainThread]: On master: BEGIN
[0m19:00:00.761091 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:00:00.761439 [debug] [MainThread]: On master: COMMIT
[0m19:00:00.761678 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:00.761921 [debug] [MainThread]: On master: COMMIT
[0m19:00:00.762266 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:00:00.762541 [debug] [MainThread]: On master: Close
[0m19:00:00.762984 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:00:00.763311 [info ] [MainThread]: 
[0m19:00:00.767417 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:00:00.767587 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:00:00.767901 [info ] [Thread-1 (]: 1 of 9 START test below_depletion_level_tests_below_depletion_level_ ........... [RUN]
[0m19:00:00.768251 [info ] [Thread-2 (]: 2 of 9 START test new_arrival_stock_depletion_test_hot_upsell_ ................. [RUN]
[0m19:00:00.768740 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:00:00.769196 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:00:00.769516 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:00:00.769776 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:00:00.770015 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:00:00.770234 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:00:00.779273 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:00:00.783871 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:00:00.786809 [debug] [Thread-1 (]: finished collecting timing info
[0m19:00:00.786928 [debug] [Thread-2 (]: finished collecting timing info
[0m19:00:00.787175 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:00:00.787423 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:00:00.803698 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:00:00.805326 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:00:00.807324 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:00:00.807452 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:00:00.807659 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m19:00:00.807884 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m19:00:00.808094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:00.808321 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:00:00.815724 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:00:00.815982 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m19:00:00.816291 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:00:00.816534 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:00:00.816801 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m19:00:00.817033 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT DISTINCT rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, 
                        (ruv.msrp - rupu.price) AS profit_margin
        FROM "postgres"."public"."rugs_usa_variant" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        /* joining on model as none of these should show. doing an inner join for this purpose to test */
        JOIN "postgres"."public"."hot_upsell" model on model.name = rup.name and model.variant = ruv.variant and model.size = rupu.size and model.shape = rupu.shape and model.type = rupu.type
        ORDER BY profit_margin DESC
    )
    SELECT 
        count(*) as errors
    FROM test_data
    having count(*) > 0

      
    ) dbt_internal_test
[0m19:00:00.829760 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:00:00.832292 [debug] [Thread-1 (]: finished collecting timing info
[0m19:00:00.832617 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m19:00:00.832974 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m19:00:00.833458 [info ] [Thread-1 (]: 1 of 9 PASS below_depletion_level_tests_below_depletion_level_ ................. [[32mPASS[0m in 0.06s]
[0m19:00:00.834101 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:00:00.834554 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:00:00.834881 [info ] [Thread-1 (]: 3 of 9 START test not_null_below_depletion_level_name .......................... [RUN]
[0m19:00:00.835338 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:00:00.835638 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:00:00.835902 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:00:00.841979 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:00:00.843439 [debug] [Thread-1 (]: finished collecting timing info
[0m19:00:00.843701 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:00:00.845353 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:00:00.846418 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:00:00.846682 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m19:00:00.846891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:00.853508 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:00:00.853907 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:00:00.854124 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m19:00:00.856739 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:00:00.858291 [debug] [Thread-1 (]: finished collecting timing info
[0m19:00:00.858565 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m19:00:00.858864 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m19:00:00.859294 [info ] [Thread-1 (]: 3 of 9 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.02s]
[0m19:00:00.859757 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:00:00.860170 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:00:00.860591 [info ] [Thread-1 (]: 4 of 9 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m19:00:00.861050 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:00:00.861325 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:00:00.861547 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:00:00.865337 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:00:00.866566 [debug] [Thread-1 (]: finished collecting timing info
[0m19:00:00.866932 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:00:00.868986 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:00:00.869987 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:00:00.870202 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m19:00:00.870391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:00.876802 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:00:00.877186 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:00:00.877416 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m19:00:00.883148 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:00:00.884763 [debug] [Thread-1 (]: finished collecting timing info
[0m19:00:00.885234 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m19:00:00.885597 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m19:00:00.886092 [info ] [Thread-1 (]: 4 of 9 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.03s]
[0m19:00:00.886750 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:00:00.887228 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:00:00.887522 [info ] [Thread-1 (]: 5 of 9 START test not_null_hot_upsell_name ..................................... [RUN]
[0m19:00:00.888017 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:00:00.888369 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:00:00.888585 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:00:00.892085 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:00:00.894195 [debug] [Thread-1 (]: finished collecting timing info
[0m19:00:00.894511 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:00:00.896450 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:00:00.898287 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:00:00.898556 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m19:00:00.898764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:00.906310 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:00:00.906696 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:00:00.906952 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m19:00:44.081976 [debug] [Thread-2 (]: SQL status: SELECT 1 in 158.21 seconds
[0m19:00:44.101364 [debug] [Thread-2 (]: finished collecting timing info
[0m19:00:44.102584 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m19:00:44.106776 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m19:00:44.112088 [error] [Thread-2 (]: 2 of 9 FAIL 1 new_arrival_stock_depletion_test_hot_upsell_ ..................... [[31mFAIL 1[0m in 158.29s]
[0m19:00:44.114253 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:00:44.112391 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 85.93 seconds
[0m19:00:44.123557 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:00:44.124304 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:44.124623 [debug] [MainThread]: On master: BEGIN
[0m19:00:44.124920 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:00:44.128776 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m19:00:44.129572 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
alter table "postgres"."public"."hot_upsell__dbt_tmp" rename to "hot_upsell"
[0m19:00:44.131816 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:00:44.134354 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: COMMIT
[0m19:00:44.134836 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m19:00:44.135116 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: COMMIT
[0m19:00:44.136683 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:00:44.140547 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m19:00:44.141639 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m19:00:44.142012 [debug] [MainThread]: On master: COMMIT
[0m19:00:44.142238 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
drop view if exists "postgres"."public"."hot_upsell__dbt_backup" cascade
[0m19:00:44.142727 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:44.146267 [debug] [MainThread]: On master: COMMIT
[0m19:00:44.146744 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:00:44.147466 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:00:44.148260 [debug] [MainThread]: On master: Close
[0m19:00:44.149630 [debug] [Thread-2 (]: finished collecting timing info
[0m19:00:44.146902 [debug] [Thread-1 (]: SQL status: SELECT 1 in 43.24 seconds
[0m19:00:44.150630 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: Close
[0m19:00:44.150960 [info ] [MainThread]: 
[0m19:00:44.153013 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c8e3783-75e3-415a-96fb-3381a6448ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8a86470>]}
[0m19:00:44.154773 [info ] [MainThread]: Finished running 9 tests in 0 hours 2 minutes and 38.44 seconds (158.44s).
[0m19:00:44.156301 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:44.155818 [info ] [Thread-2 (]: 2 of 4 OK created view model public.hot_upsell ................................. [[32mCREATE VIEW[0m in 86.12s]
[0m19:00:44.156789 [debug] [MainThread]: Connection 'test.jaffle_shop.profit_priority_order.2c7ed8e7dd' was properly closed.
[0m19:00:44.157702 [debug] [MainThread]: Connection 'test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38' was properly closed.
[0m19:00:44.159741 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.hot_upsell
[0m19:00:44.170735 [debug] [Thread-1 (]: finished collecting timing info
[0m19:00:44.173537 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m19:00:44.175190 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m19:00:44.181198 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:00:44.182622 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:44.183992 [debug] [MainThread]: On master: BEGIN
[0m19:00:44.183822 [info ] [Thread-1 (]: 5 of 9 PASS not_null_hot_upsell_name ........................................... [[32mPASS[0m in 43.29s]
[0m19:00:44.184535 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:00:44.191340 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:00:44.195020 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:00:44.198672 [info ] [Thread-1 (]: 6 of 9 START test not_null_hot_upsell_variant .................................. [RUN]
[0m19:00:44.199535 [info ] [MainThread]: 
[0m19:00:44.200193 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m19:00:44.200370 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:00:44.200993 [info ] [MainThread]: 
[0m19:00:44.201552 [error] [MainThread]: [33mDatabase Error in test not_null_rugs_usa_variant_name (models/priority_order/priority_order_tests.yml)[0m
[0m19:00:44.202157 [error] [MainThread]:   column "name" does not exist
[0m19:00:44.201515 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:00:44.202604 [error] [MainThread]:   LINE 13: select name
[0m19:00:44.202941 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:00:44.203060 [error] [MainThread]:                   ^
[0m19:00:44.203812 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/priority_order/priority_order_tests.yml/not_null_rugs_usa_variant_name.sql
[0m19:00:44.205257 [info ] [MainThread]: 
[0m19:00:44.206089 [error] [MainThread]: [33mCompilation Error in test profit_priority_order (models/priority_order/priority_order_tests.yml)[0m
[0m19:00:44.206929 [error] [MainThread]:   'test_test' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:00:44.206642 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m19:00:44.207553 [info ] [MainThread]: 
[0m19:00:44.208148 [debug] [MainThread]: On master: COMMIT
[0m19:00:44.208926 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:44.209454 [error] [MainThread]: [31mFailure in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)[0m
[0m19:00:44.211285 [debug] [MainThread]: On master: COMMIT
[0m19:00:44.214162 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m19:00:44.215884 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:00:44.216439 [info ] [MainThread]: 
[0m19:00:44.218304 [debug] [MainThread]: On master: Close
[0m19:00:44.218956 [info ] [MainThread]:   compiled SQL at target/compiled/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m19:00:44.220454 [info ] [MainThread]: 
[0m19:00:44.221061 [info ] [MainThread]: 
[0m19:00:44.221697 [info ] [MainThread]: Finished running 4 view models in 0 hours 1 minutes and 26.37 seconds (86.37s).
[0m19:00:44.221753 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:00:44.222211 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=3 SKIP=0 TOTAL=9
[0m19:00:44.222494 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:44.223072 [debug] [MainThread]: Connection 'model.jaffle_shop.priority_order' was properly closed.
[0m19:00:44.223540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff98f7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff98c4670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff98c4160>]}
[0m19:00:44.224278 [debug] [MainThread]: Connection 'model.jaffle_shop.hot_upsell' was properly closed.
[0m19:00:44.224988 [debug] [Thread-1 (]: finished collecting timing info
[0m19:00:44.225460 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:00:44.228384 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:00:44.230974 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:00:44.231471 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m19:00:44.231838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:44.246761 [info ] [MainThread]: 
[0m19:00:44.250418 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:00:44.251471 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m19:00:44.252704 [info ] [MainThread]: 
[0m19:00:44.252974 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:00:44.253595 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:00:44.253775 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m19:00:44.257288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff80a77f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8114e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff81158a0>]}
[0m19:00:44.269287 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:00:44.272574 [debug] [Thread-1 (]: finished collecting timing info
[0m19:00:44.273118 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m19:00:44.273644 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m19:00:44.274429 [info ] [Thread-1 (]: 6 of 9 PASS not_null_hot_upsell_variant ........................................ [[32mPASS[0m in 0.07s]
[0m19:00:44.275648 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:00:44.278569 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5
[0m19:00:44.279431 [info ] [Thread-1 (]: 7 of 9 START test not_null_rugs_usa_variant_name ............................... [RUN]
[0m19:00:44.280323 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5"
[0m19:00:44.281099 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5
[0m19:00:44.281575 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5
[0m19:00:44.287093 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5"
[0m19:00:44.289680 [debug] [Thread-1 (]: finished collecting timing info
[0m19:00:44.290106 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5
[0m19:00:44.292011 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5"
[0m19:00:44.293544 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5"
[0m19:00:44.293804 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5: BEGIN
[0m19:00:44.294147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:44.301793 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:00:44.302290 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5"
[0m19:00:44.302528 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."rugs_usa_variant"
where name is null



      
    ) dbt_internal_test
[0m19:00:44.304233 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "name" does not exist
LINE 13: select name
                ^

[0m19:00:44.304612 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5: ROLLBACK
[0m19:00:44.305271 [debug] [Thread-1 (]: finished collecting timing info
[0m19:00:44.305519 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5: Close
[0m19:00:44.306148 [debug] [Thread-1 (]: Database Error in test not_null_rugs_usa_variant_name (models/priority_order/priority_order_tests.yml)
  column "name" does not exist
  LINE 13: select name
                  ^
  compiled SQL at target/run/jaffle_shop/models/priority_order/priority_order_tests.yml/not_null_rugs_usa_variant_name.sql
[0m19:00:44.306571 [error] [Thread-1 (]: 7 of 9 ERROR not_null_rugs_usa_variant_name .................................... [[31mERROR[0m in 0.03s]
[0m19:00:44.307024 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5
[0m19:00:44.307397 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402
[0m19:00:44.307813 [info ] [Thread-1 (]: 8 of 9 START test not_null_rugs_usa_variant_variant ............................ [RUN]
[0m19:00:44.308218 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"
[0m19:00:44.308469 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402
[0m19:00:44.308658 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402
[0m19:00:44.312113 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"
[0m19:00:44.313586 [debug] [Thread-1 (]: finished collecting timing info
[0m19:00:44.313825 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402
[0m19:00:44.315519 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"
[0m19:00:44.316537 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"
[0m19:00:44.316744 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402: BEGIN
[0m19:00:44.317004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:44.325647 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:00:44.326142 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"
[0m19:00:44.326397 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."rugs_usa_variant"
where variant is null



      
    ) dbt_internal_test
[0m19:00:44.329447 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:00:44.330902 [debug] [Thread-1 (]: finished collecting timing info
[0m19:00:44.331185 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402: ROLLBACK
[0m19:00:44.331487 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402: Close
[0m19:00:44.331918 [info ] [Thread-1 (]: 8 of 9 PASS not_null_rugs_usa_variant_variant .................................. [[32mPASS[0m in 0.02s]
[0m19:00:44.332360 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402
[0m19:00:44.332793 [debug] [Thread-1 (]: Began running node test.jaffle_shop.profit_priority_order.2c7ed8e7dd
[0m19:00:44.333084 [info ] [Thread-1 (]: 9 of 9 START test profit_priority_order ........................................ [RUN]
[0m19:00:44.333482 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.profit_priority_order.2c7ed8e7dd"
[0m19:00:44.333721 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.profit_priority_order.2c7ed8e7dd
[0m19:00:44.333930 [debug] [Thread-1 (]: Compiling test.jaffle_shop.profit_priority_order.2c7ed8e7dd
[0m19:00:44.339200 [debug] [Thread-1 (]: finished collecting timing info
[0m19:00:44.339715 [debug] [Thread-1 (]: Compilation Error in test profit_priority_order (models/priority_order/priority_order_tests.yml)
  'test_test' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:00:44.340065 [error] [Thread-1 (]: 9 of 9 ERROR profit_priority_order ............................................. [[31mERROR[0m in 0.01s]
[0m19:00:44.340513 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.profit_priority_order.2c7ed8e7dd


============================== 2024-07-14 19:00:47.837025 | 100e4a99-b188-442b-a840-5e56986391f3 ==============================
[0m19:00:47.837398 [info ] [MainThread]: Running with dbt=1.2.0
[0m19:00:47.862175 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:00:47.862754 [debug] [MainThread]: Tracking: tracking
[0m19:00:47.885419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b280>]}
[0m19:00:47.944108 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:00:47.944560 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:00:47.951130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '100e4a99-b188-442b-a840-5e56986391f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bbaa10>]}
[0m19:00:47.961915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '100e4a99-b188-442b-a840-5e56986391f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae4ac0>]}
[0m19:00:47.962329 [info ] [MainThread]: Found 4 models, 9 tests, 2 snapshots, 0 analyses, 259 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:00:47.962648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '100e4a99-b188-442b-a840-5e56986391f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae4b50>]}
[0m19:00:47.964635 [info ] [MainThread]: 
[0m19:00:47.965266 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:00:47.968163 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m19:00:47.978206 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:00:47.978567 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:00:47.978809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:48.038791 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
[0m19:00:48.039497 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:00:48.039767 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:00:48.045015 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m19:00:48.047170 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:00:48.047613 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:00:48.052865 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:48.053273 [debug] [MainThread]: On master: BEGIN
[0m19:00:48.053521 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:00:48.061357 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m19:00:48.061810 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:48.062094 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:00:48.067240 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m19:00:48.068962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '100e4a99-b188-442b-a840-5e56986391f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c5d3f0>]}
[0m19:00:48.069410 [debug] [MainThread]: On master: ROLLBACK
[0m19:00:48.069793 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:48.070040 [debug] [MainThread]: On master: BEGIN
[0m19:00:48.070410 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:00:48.070790 [debug] [MainThread]: On master: COMMIT
[0m19:00:48.071037 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:48.071269 [debug] [MainThread]: On master: COMMIT
[0m19:00:48.071557 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:00:48.071774 [debug] [MainThread]: On master: Close
[0m19:00:48.072188 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:00:48.072529 [info ] [MainThread]: 
[0m19:00:48.077147 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:00:48.077347 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:00:48.077703 [info ] [Thread-1 (]: 1 of 9 START test below_depletion_level_tests_below_depletion_level_ ........... [RUN]
[0m19:00:48.078058 [info ] [Thread-2 (]: 2 of 9 START test new_arrival_stock_depletion_test_hot_upsell_ ................. [RUN]
[0m19:00:48.078591 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:00:48.079074 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:00:48.079421 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:00:48.079666 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:00:48.079954 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:00:48.080202 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:00:48.097547 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:00:48.129687 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:00:48.133270 [debug] [Thread-2 (]: finished collecting timing info
[0m19:00:48.133459 [debug] [Thread-1 (]: finished collecting timing info
[0m19:00:48.133752 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:00:48.134040 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:00:48.151908 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:00:48.153570 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:00:48.155932 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:00:48.156110 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:00:48.156346 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m19:00:48.156622 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m19:00:48.156870 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:00:48.157160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:48.164916 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:00:48.165489 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:00:48.165658 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m19:00:48.165916 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m19:00:48.166179 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:00:48.166914 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT DISTINCT rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, 
                        (ruv.msrp - rupu.price) AS profit_margin
        FROM "postgres"."public"."rugs_usa_variant" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        /* joining on model as none of these should show. doing an inner join for this purpose to test */
        JOIN "postgres"."public"."hot_upsell" model on model.name = rup.name and model.variant = ruv.variant and model.size = rupu.size and model.shape = rupu.shape and model.type = rupu.type
        ORDER BY profit_margin DESC
    )
    SELECT 
        count(*) as errors
    FROM test_data
    having count(*) > 0

      
    ) dbt_internal_test
[0m19:00:48.174273 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:00:48.177403 [debug] [Thread-1 (]: finished collecting timing info
[0m19:00:48.177810 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m19:00:48.178223 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m19:00:48.178791 [info ] [Thread-1 (]: 1 of 9 PASS below_depletion_level_tests_below_depletion_level_ ................. [[32mPASS[0m in 0.10s]
[0m19:00:48.180020 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:00:48.180492 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:00:48.180852 [info ] [Thread-1 (]: 3 of 9 START test not_null_below_depletion_level_name .......................... [RUN]
[0m19:00:48.181460 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:00:48.181734 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:00:48.182012 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:00:48.189347 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:00:48.190789 [debug] [Thread-1 (]: finished collecting timing info
[0m19:00:48.191107 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:00:48.193008 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:00:48.194280 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:00:48.194518 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m19:00:48.194718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:48.210324 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m19:00:48.211735 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:00:48.212653 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m19:00:48.216663 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:00:48.219855 [debug] [Thread-1 (]: finished collecting timing info
[0m19:00:48.220431 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m19:00:48.220907 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m19:00:48.221615 [info ] [Thread-1 (]: 3 of 9 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.04s]
[0m19:00:48.223051 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:00:48.223481 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:00:48.223945 [info ] [Thread-1 (]: 4 of 9 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m19:00:48.224587 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:00:48.224906 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:00:48.225255 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:00:48.231689 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:00:48.234332 [debug] [Thread-1 (]: finished collecting timing info
[0m19:00:48.234882 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:00:48.237060 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:00:48.238361 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:00:48.238602 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m19:00:48.238812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:48.254171 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m19:00:48.256944 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:00:48.257527 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m19:00:48.267275 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:00:48.269113 [debug] [Thread-1 (]: finished collecting timing info
[0m19:00:48.269552 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m19:00:48.270174 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m19:00:48.270803 [info ] [Thread-1 (]: 4 of 9 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.05s]
[0m19:00:48.271410 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:00:48.271800 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:00:48.272177 [info ] [Thread-1 (]: 5 of 9 START test not_null_hot_upsell_name ..................................... [RUN]
[0m19:00:48.272681 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:00:48.272997 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:00:48.273186 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:00:48.276981 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:00:48.278240 [debug] [Thread-1 (]: finished collecting timing info
[0m19:00:48.278439 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:00:48.280143 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:00:48.281415 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:00:48.281616 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m19:00:48.281756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:48.288919 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:00:48.290014 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:00:48.290297 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m19:00:48.294593 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:00:48.296035 [debug] [Thread-1 (]: finished collecting timing info
[0m19:00:48.296279 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m19:00:48.296538 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m19:00:48.296911 [info ] [Thread-1 (]: 5 of 9 PASS not_null_hot_upsell_name ........................................... [[32mPASS[0m in 0.02s]
[0m19:00:48.297383 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:00:48.297718 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:00:48.298088 [info ] [Thread-1 (]: 6 of 9 START test not_null_hot_upsell_variant .................................. [RUN]
[0m19:00:48.298679 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:00:48.299034 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:00:48.299209 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:00:48.303434 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:00:48.304327 [debug] [Thread-1 (]: finished collecting timing info
[0m19:00:48.304529 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:00:48.306256 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:00:48.307306 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:00:48.307514 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m19:00:48.307686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:48.319003 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:00:48.319603 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:00:48.319939 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m19:00:48.328582 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:00:48.330591 [debug] [Thread-1 (]: finished collecting timing info
[0m19:00:48.331032 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m19:00:48.331475 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m19:00:48.332062 [info ] [Thread-1 (]: 6 of 9 PASS not_null_hot_upsell_variant ........................................ [[32mPASS[0m in 0.03s]
[0m19:00:48.332630 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:00:48.333052 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5
[0m19:00:48.333378 [info ] [Thread-1 (]: 7 of 9 START test not_null_rugs_usa_variant_name ............................... [RUN]
[0m19:00:48.333808 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5"
[0m19:00:48.334053 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5
[0m19:00:48.334302 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5
[0m19:00:48.337985 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5"
[0m19:00:48.338937 [debug] [Thread-1 (]: finished collecting timing info
[0m19:00:48.339177 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5
[0m19:00:48.340991 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5"
[0m19:00:48.342525 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5"
[0m19:00:48.342818 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5: BEGIN
[0m19:00:48.343028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:48.350426 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:00:48.350911 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5"
[0m19:00:48.351183 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."rugs_usa_variant"
where name is null



      
    ) dbt_internal_test
[0m19:00:48.352370 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "name" does not exist
LINE 13: select name
                ^

[0m19:00:48.353053 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5: ROLLBACK
[0m19:00:48.353758 [debug] [Thread-1 (]: finished collecting timing info
[0m19:00:48.354096 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5: Close
[0m19:00:48.354623 [debug] [Thread-1 (]: Database Error in test not_null_rugs_usa_variant_name (models/priority_order/priority_order_tests.yml)
  column "name" does not exist
  LINE 13: select name
                  ^
  compiled SQL at target/run/jaffle_shop/models/priority_order/priority_order_tests.yml/not_null_rugs_usa_variant_name.sql
[0m19:00:48.355564 [error] [Thread-1 (]: 7 of 9 ERROR not_null_rugs_usa_variant_name .................................... [[31mERROR[0m in 0.02s]
[0m19:00:48.356474 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5
[0m19:00:48.356868 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402
[0m19:00:48.357643 [info ] [Thread-1 (]: 8 of 9 START test not_null_rugs_usa_variant_variant ............................ [RUN]
[0m19:00:48.358269 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"
[0m19:00:48.358591 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402
[0m19:00:48.358844 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402
[0m19:00:48.366216 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"
[0m19:00:48.369050 [debug] [Thread-1 (]: finished collecting timing info
[0m19:00:48.370452 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402
[0m19:00:48.373421 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"
[0m19:00:48.375008 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"
[0m19:00:48.375423 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402: BEGIN
[0m19:00:48.375707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:48.383168 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:00:48.383660 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"
[0m19:00:48.383888 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."rugs_usa_variant"
where variant is null



      
    ) dbt_internal_test
[0m19:00:48.387136 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:00:48.388826 [debug] [Thread-1 (]: finished collecting timing info
[0m19:00:48.389147 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402: ROLLBACK
[0m19:00:48.389507 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402: Close
[0m19:00:48.389978 [info ] [Thread-1 (]: 8 of 9 PASS not_null_rugs_usa_variant_variant .................................. [[32mPASS[0m in 0.03s]
[0m19:00:48.390496 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402
[0m19:00:48.390936 [debug] [Thread-1 (]: Began running node test.jaffle_shop.profit_priority_order.2c7ed8e7dd
[0m19:00:48.391271 [info ] [Thread-1 (]: 9 of 9 START test profit_priority_order ........................................ [RUN]
[0m19:00:48.391756 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.profit_priority_order.2c7ed8e7dd"
[0m19:00:48.392054 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.profit_priority_order.2c7ed8e7dd
[0m19:00:48.392303 [debug] [Thread-1 (]: Compiling test.jaffle_shop.profit_priority_order.2c7ed8e7dd
[0m19:00:48.396501 [debug] [Thread-1 (]: finished collecting timing info
[0m19:00:48.396949 [debug] [Thread-1 (]: Compilation Error in test profit_priority_order (models/priority_order/priority_order_tests.yml)
  'test_test' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:00:48.397270 [error] [Thread-1 (]: 9 of 9 ERROR profit_priority_order ............................................. [[31mERROR[0m in 0.01s]
[0m19:00:48.397635 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.profit_priority_order.2c7ed8e7dd
[0m19:03:20.685110 [debug] [Thread-2 (]: SQL status: SELECT 1 in 199.87 seconds
[0m19:03:20.723013 [debug] [Thread-2 (]: finished collecting timing info
[0m19:03:20.723758 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m19:03:20.724641 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m19:03:20.736740 [error] [Thread-2 (]: 2 of 9 FAIL 1 new_arrival_stock_depletion_test_hot_upsell_ ..................... [[31mFAIL 1[0m in 199.97s]
[0m19:03:20.740954 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:03:20.752588 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:03:20.753129 [debug] [MainThread]: Using postgres connection "master"
[0m19:03:20.753402 [debug] [MainThread]: On master: BEGIN
[0m19:03:20.753667 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:03:20.763505 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m19:03:20.764256 [debug] [MainThread]: On master: COMMIT
[0m19:03:20.764539 [debug] [MainThread]: Using postgres connection "master"
[0m19:03:20.764784 [debug] [MainThread]: On master: COMMIT
[0m19:03:20.765202 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:03:20.765488 [debug] [MainThread]: On master: Close
[0m19:03:20.767551 [info ] [MainThread]: 
[0m19:03:20.768128 [info ] [MainThread]: Finished running 9 tests in 0 hours 3 minutes and 20.10 seconds (200.10s).
[0m19:03:20.768776 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:03:20.769204 [debug] [MainThread]: Connection 'test.jaffle_shop.profit_priority_order.2c7ed8e7dd' was properly closed.
[0m19:03:20.769433 [debug] [MainThread]: Connection 'test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38' was properly closed.
[0m19:03:20.782434 [info ] [MainThread]: 
[0m19:03:20.782857 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m19:03:20.783523 [info ] [MainThread]: 
[0m19:03:20.784228 [error] [MainThread]: [33mDatabase Error in test not_null_rugs_usa_variant_name (models/priority_order/priority_order_tests.yml)[0m
[0m19:03:20.784575 [error] [MainThread]:   column "name" does not exist
[0m19:03:20.785006 [error] [MainThread]:   LINE 13: select name
[0m19:03:20.785470 [error] [MainThread]:                   ^
[0m19:03:20.785873 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/priority_order/priority_order_tests.yml/not_null_rugs_usa_variant_name.sql
[0m19:03:20.786315 [info ] [MainThread]: 
[0m19:03:20.786759 [error] [MainThread]: [33mCompilation Error in test profit_priority_order (models/priority_order/priority_order_tests.yml)[0m
[0m19:03:20.787113 [error] [MainThread]:   'test_test' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:03:20.787502 [info ] [MainThread]: 
[0m19:03:20.787995 [error] [MainThread]: [31mFailure in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)[0m
[0m19:03:20.788413 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m19:03:20.788821 [info ] [MainThread]: 
[0m19:03:20.789174 [info ] [MainThread]:   compiled SQL at target/compiled/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m19:03:20.789799 [info ] [MainThread]: 
[0m19:03:20.790100 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=3 SKIP=0 TOTAL=9
[0m19:03:20.791309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99fdd80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99fcb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bb2320>]}
[0m19:03:24.536513 [debug] [Thread-2 (]: SQL status: SELECT 1 in 156.37 seconds
[0m19:03:24.588836 [debug] [Thread-2 (]: finished collecting timing info
[0m19:03:24.590536 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m19:03:24.592312 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m19:03:24.595965 [error] [Thread-2 (]: 2 of 9 FAIL 1 new_arrival_stock_depletion_test_hot_upsell_ ..................... [[31mFAIL 1[0m in 156.52s]
[0m19:03:24.599689 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:03:24.613079 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:03:24.614015 [debug] [MainThread]: Using postgres connection "master"
[0m19:03:24.614304 [debug] [MainThread]: On master: BEGIN
[0m19:03:24.614726 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:03:24.630127 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m19:03:24.630737 [debug] [MainThread]: On master: COMMIT
[0m19:03:24.630998 [debug] [MainThread]: Using postgres connection "master"
[0m19:03:24.631260 [debug] [MainThread]: On master: COMMIT
[0m19:03:24.631576 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:03:24.631804 [debug] [MainThread]: On master: Close
[0m19:03:24.633199 [info ] [MainThread]: 
[0m19:03:24.633587 [info ] [MainThread]: Finished running 9 tests in 0 hours 2 minutes and 36.67 seconds (156.67s).
[0m19:03:24.633896 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:03:24.634119 [debug] [MainThread]: Connection 'test.jaffle_shop.profit_priority_order.2c7ed8e7dd' was properly closed.
[0m19:03:24.634316 [debug] [MainThread]: Connection 'test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38' was properly closed.
[0m19:03:24.652529 [info ] [MainThread]: 
[0m19:03:24.652957 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m19:03:24.653343 [info ] [MainThread]: 
[0m19:03:24.653636 [error] [MainThread]: [33mDatabase Error in test not_null_rugs_usa_variant_name (models/priority_order/priority_order_tests.yml)[0m
[0m19:03:24.653925 [error] [MainThread]:   column "name" does not exist
[0m19:03:24.654188 [error] [MainThread]:   LINE 13: select name
[0m19:03:24.654450 [error] [MainThread]:                   ^
[0m19:03:24.654701 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/priority_order/priority_order_tests.yml/not_null_rugs_usa_variant_name.sql
[0m19:03:24.654942 [info ] [MainThread]: 
[0m19:03:24.655186 [error] [MainThread]: [33mCompilation Error in test profit_priority_order (models/priority_order/priority_order_tests.yml)[0m
[0m19:03:24.655416 [error] [MainThread]:   'test_test' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:03:24.655639 [info ] [MainThread]: 
[0m19:03:24.655950 [error] [MainThread]: [31mFailure in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)[0m
[0m19:03:24.656239 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m19:03:24.656471 [info ] [MainThread]: 
[0m19:03:24.656723 [info ] [MainThread]:   compiled SQL at target/compiled/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m19:03:24.656988 [info ] [MainThread]: 
[0m19:03:24.657279 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=3 SKIP=0 TOTAL=9
[0m19:03:24.658969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a7f760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a7f790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99fd9f0>]}


============================== 2024-07-14 19:06:24.670524 | edb94e5b-9733-4e81-a84a-af1f70eb1a80 ==============================
[0m19:06:24.670831 [info ] [MainThread]: Running with dbt=1.2.0
[0m19:06:24.693203 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:06:24.693734 [debug] [MainThread]: Tracking: tracking
[0m19:06:24.709137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1c760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1c4f0>]}
[0m19:06:24.779492 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m19:06:24.780044 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://macros/priority_order_test.sql
[0m19:06:24.780458 [debug] [MainThread]: Partial parsing: update schema file: jaffle_shop://models/priority_order/priority_order_tests.yml
[0m19:06:24.780726 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://macros/priority_orders.sql
[0m19:06:24.780965 [debug] [MainThread]: Parsing macros/priority_order_test.sql
[0m19:06:24.790523 [warn ] [MainThread]: [[33mWARNING[0m]: 'rugs_usa_variant' is a seed node, but it is specified in the models section of
models/priority_order/priority_order_tests.yml. To fix this error, place the
`rugs_usa_variant` specification under the seeds key instead.
[0m19:06:24.822839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edb94e5b-9733-4e81-a84a-af1f70eb1a80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99ff580>]}
[0m19:06:24.833391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edb94e5b-9733-4e81-a84a-af1f70eb1a80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7b100>]}
[0m19:06:24.833839 [info ] [MainThread]: Found 4 models, 9 tests, 2 snapshots, 0 analyses, 259 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:06:24.834172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edb94e5b-9733-4e81-a84a-af1f70eb1a80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b6de10>]}
[0m19:06:24.835996 [info ] [MainThread]: 
[0m19:06:24.836638 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:06:24.839295 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m19:06:24.847661 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:06:24.848077 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:06:24.848338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:06:24.892595 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m19:06:24.893100 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:06:24.893359 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:06:24.897993 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m19:06:24.899838 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:06:24.900238 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:06:24.904729 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:24.905027 [debug] [MainThread]: On master: BEGIN
[0m19:06:24.905264 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:06:24.913072 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m19:06:24.913498 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:24.913736 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:06:24.919795 [debug] [MainThread]: SQL status: SELECT 11 in 0.01 seconds
[0m19:06:24.921166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edb94e5b-9733-4e81-a84a-af1f70eb1a80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b6de10>]}
[0m19:06:24.921538 [debug] [MainThread]: On master: ROLLBACK
[0m19:06:24.921834 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:24.922043 [debug] [MainThread]: On master: BEGIN
[0m19:06:24.922366 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:06:24.922659 [debug] [MainThread]: On master: COMMIT
[0m19:06:24.922892 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:24.923122 [debug] [MainThread]: On master: COMMIT
[0m19:06:24.923427 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:06:24.923684 [debug] [MainThread]: On master: Close
[0m19:06:24.924117 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:06:24.924444 [info ] [MainThread]: 
[0m19:06:24.928475 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:06:24.928618 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:06:24.929036 [info ] [Thread-1 (]: 1 of 9 START test below_depletion_level_tests_below_depletion_level_ ........... [RUN]
[0m19:06:24.929364 [info ] [Thread-2 (]: 2 of 9 START test new_arrival_stock_depletion_test_hot_upsell_ ................. [RUN]
[0m19:06:24.929856 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:06:24.930351 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:06:24.930737 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:06:24.930988 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:06:24.931246 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:06:24.931483 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:06:24.935004 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:06:24.939028 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:06:24.941537 [debug] [Thread-2 (]: finished collecting timing info
[0m19:06:24.941639 [debug] [Thread-1 (]: finished collecting timing info
[0m19:06:24.941859 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:06:24.942098 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:06:24.958528 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:06:24.960394 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:06:24.962989 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:06:24.963145 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:06:24.963360 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m19:06:24.963614 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m19:06:24.963869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:06:24.964115 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:06:24.972669 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m19:06:24.972952 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:06:24.973279 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:06:24.973662 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:06:24.973934 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT DISTINCT rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, 
                        (ruv.msrp - rupu.price) AS profit_margin
        FROM "postgres"."public"."rugs_usa_variant" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        /* joining on model as none of these should show. doing an inner join for this purpose to test */
        JOIN "postgres"."public"."hot_upsell" model on model.name = rup.name and model.variant = ruv.variant and model.size = rupu.size and model.shape = rupu.shape and model.type = rupu.type
        ORDER BY profit_margin DESC
    )
    SELECT 
        count(*) as errors
    FROM test_data
    having count(*) > 0

      
    ) dbt_internal_test
[0m19:06:24.974211 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m19:06:24.994626 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m19:06:24.998053 [debug] [Thread-1 (]: finished collecting timing info
[0m19:06:24.998507 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m19:06:24.998922 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m19:06:24.999571 [info ] [Thread-1 (]: 1 of 9 PASS below_depletion_level_tests_below_depletion_level_ ................. [[32mPASS[0m in 0.07s]
[0m19:06:25.000526 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:06:25.001195 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:06:25.001589 [info ] [Thread-1 (]: 3 of 9 START test not_null_below_depletion_level_name .......................... [RUN]
[0m19:06:25.002068 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:06:25.002429 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:06:25.002676 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:06:25.010383 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:06:25.012185 [debug] [Thread-1 (]: finished collecting timing info
[0m19:06:25.012487 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:06:25.014825 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:06:25.016965 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:06:25.017410 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m19:06:25.017724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:06:25.029655 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:06:25.030359 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:06:25.030618 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m19:06:25.034166 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:06:25.035715 [debug] [Thread-1 (]: finished collecting timing info
[0m19:06:25.035960 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m19:06:25.036235 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m19:06:25.036671 [info ] [Thread-1 (]: 3 of 9 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.03s]
[0m19:06:25.037365 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:06:25.037794 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:06:25.038093 [info ] [Thread-1 (]: 4 of 9 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m19:06:25.038494 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:06:25.038717 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:06:25.038886 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:06:25.042405 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:06:25.043662 [debug] [Thread-1 (]: finished collecting timing info
[0m19:06:25.043934 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:06:25.045731 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:06:25.046603 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:06:25.046784 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m19:06:25.046939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:06:25.053402 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:06:25.053807 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:06:25.054038 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m19:06:25.059691 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:06:25.061179 [debug] [Thread-1 (]: finished collecting timing info
[0m19:06:25.061535 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m19:06:25.061838 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m19:06:25.062265 [info ] [Thread-1 (]: 4 of 9 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.02s]
[0m19:06:25.062712 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:06:25.063132 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:06:25.063382 [info ] [Thread-1 (]: 5 of 9 START test not_null_hot_upsell_name ..................................... [RUN]
[0m19:06:25.063835 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:06:25.064102 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:06:25.064287 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:06:25.067573 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:06:25.069100 [debug] [Thread-1 (]: finished collecting timing info
[0m19:06:25.069348 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:06:25.071212 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:06:25.073218 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:06:25.073865 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m19:06:25.074621 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:06:25.088178 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:06:25.088806 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:06:25.089106 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m19:06:25.096352 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:06:25.098499 [debug] [Thread-1 (]: finished collecting timing info
[0m19:06:25.099027 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m19:06:25.099529 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m19:06:25.100326 [info ] [Thread-1 (]: 5 of 9 PASS not_null_hot_upsell_name ........................................... [[32mPASS[0m in 0.04s]
[0m19:06:25.102028 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:06:25.102712 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:06:25.103126 [info ] [Thread-1 (]: 6 of 9 START test not_null_hot_upsell_variant .................................. [RUN]
[0m19:06:25.103688 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:06:25.104203 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:06:25.105201 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:06:25.110841 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:06:25.112617 [debug] [Thread-1 (]: finished collecting timing info
[0m19:06:25.113003 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:06:25.116105 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:06:25.117572 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:06:25.117927 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m19:06:25.118146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:06:25.126557 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:06:25.128170 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:06:25.129131 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m19:06:25.141181 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:06:25.143069 [debug] [Thread-1 (]: finished collecting timing info
[0m19:06:25.143505 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m19:06:25.143929 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m19:06:25.144552 [info ] [Thread-1 (]: 6 of 9 PASS not_null_hot_upsell_variant ........................................ [[32mPASS[0m in 0.04s]
[0m19:06:25.145201 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:06:25.145608 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5
[0m19:06:25.145987 [info ] [Thread-1 (]: 7 of 9 START test not_null_rugs_usa_variant_name ............................... [RUN]
[0m19:06:25.146438 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5"
[0m19:06:25.146634 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5
[0m19:06:25.146805 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5
[0m19:06:25.150988 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5"
[0m19:06:25.152638 [debug] [Thread-1 (]: finished collecting timing info
[0m19:06:25.152826 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5
[0m19:06:25.154390 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5"
[0m19:06:25.155335 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5"
[0m19:06:25.155518 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5: BEGIN
[0m19:06:25.155667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:06:25.162567 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:06:25.163043 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5"
[0m19:06:25.163256 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."rugs_usa_variant"
where name is null



      
    ) dbt_internal_test
[0m19:06:25.164313 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "name" does not exist
LINE 13: select name
                ^

[0m19:06:25.164605 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5: ROLLBACK
[0m19:06:25.165023 [debug] [Thread-1 (]: finished collecting timing info
[0m19:06:25.165221 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5: Close
[0m19:06:25.165606 [debug] [Thread-1 (]: Database Error in test not_null_rugs_usa_variant_name (models/priority_order/priority_order_tests.yml)
  column "name" does not exist
  LINE 13: select name
                  ^
  compiled SQL at target/run/jaffle_shop/models/priority_order/priority_order_tests.yml/not_null_rugs_usa_variant_name.sql
[0m19:06:25.165931 [error] [Thread-1 (]: 7 of 9 ERROR not_null_rugs_usa_variant_name .................................... [[31mERROR[0m in 0.02s]
[0m19:06:25.166331 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_rugs_usa_variant_name.293a63dab5
[0m19:06:25.166630 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402
[0m19:06:25.166868 [info ] [Thread-1 (]: 8 of 9 START test not_null_rugs_usa_variant_variant ............................ [RUN]
[0m19:06:25.167208 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"
[0m19:06:25.167382 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402
[0m19:06:25.167565 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402
[0m19:06:25.171022 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"
[0m19:06:25.171938 [debug] [Thread-1 (]: finished collecting timing info
[0m19:06:25.172126 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402
[0m19:06:25.173645 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"
[0m19:06:25.174606 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"
[0m19:06:25.174852 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402: BEGIN
[0m19:06:25.175028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:06:25.184386 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:06:25.185509 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"
[0m19:06:25.185952 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."rugs_usa_variant"
where variant is null



      
    ) dbt_internal_test
[0m19:06:25.189770 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:06:25.193105 [debug] [Thread-1 (]: finished collecting timing info
[0m19:06:25.193345 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402: ROLLBACK
[0m19:06:25.193596 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402: Close
[0m19:06:25.193958 [info ] [Thread-1 (]: 8 of 9 PASS not_null_rugs_usa_variant_variant .................................. [[32mPASS[0m in 0.03s]
[0m19:06:25.194322 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_rugs_usa_variant_variant.dbaf626402
[0m19:06:25.194728 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_rugs_usa_variant_profit.83e405779f
[0m19:06:25.195019 [info ] [Thread-1 (]: 9 of 9 START test not_rugs_usa_variant_profit .................................. [RUN]
[0m19:06:25.195398 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_rugs_usa_variant_profit.83e405779f"
[0m19:06:25.195622 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_rugs_usa_variant_profit.83e405779f
[0m19:06:25.195783 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_rugs_usa_variant_profit.83e405779f
[0m19:06:25.199462 [debug] [Thread-1 (]: finished collecting timing info
[0m19:06:25.199973 [debug] [Thread-1 (]: Compilation Error in test not_rugs_usa_variant_profit (models/priority_order/priority_order_tests.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:06:25.200436 [error] [Thread-1 (]: 9 of 9 ERROR not_rugs_usa_variant_profit ....................................... [[31mERROR[0m in 0.01s]
[0m19:06:25.200858 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_rugs_usa_variant_profit.83e405779f
[0m19:08:41.487779 [debug] [Thread-2 (]: SQL status: SELECT 1 in 136.51 seconds
[0m19:08:41.501013 [debug] [Thread-2 (]: finished collecting timing info
[0m19:08:41.502902 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m19:08:41.503964 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m19:08:41.515207 [error] [Thread-2 (]: 2 of 9 FAIL 1 new_arrival_stock_depletion_test_hot_upsell_ ..................... [[31mFAIL 1[0m in 136.58s]
[0m19:08:41.519246 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:08:41.529109 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:08:41.529746 [debug] [MainThread]: Using postgres connection "master"
[0m19:08:41.530025 [debug] [MainThread]: On master: BEGIN
[0m19:08:41.530286 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:08:41.545918 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m19:08:41.546627 [debug] [MainThread]: On master: COMMIT
[0m19:08:41.546979 [debug] [MainThread]: Using postgres connection "master"
[0m19:08:41.547258 [debug] [MainThread]: On master: COMMIT
[0m19:08:41.547946 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:08:41.548679 [debug] [MainThread]: On master: Close
[0m19:08:41.550776 [info ] [MainThread]: 
[0m19:08:41.551376 [info ] [MainThread]: Finished running 9 tests in 0 hours 2 minutes and 16.71 seconds (136.71s).
[0m19:08:41.551865 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:08:41.552157 [debug] [MainThread]: Connection 'test.jaffle_shop.not_rugs_usa_variant_profit.83e405779f' was properly closed.
[0m19:08:41.552427 [debug] [MainThread]: Connection 'test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38' was properly closed.
[0m19:08:41.567212 [info ] [MainThread]: 
[0m19:08:41.567694 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m19:08:41.568081 [info ] [MainThread]: 
[0m19:08:41.568404 [error] [MainThread]: [33mDatabase Error in test not_null_rugs_usa_variant_name (models/priority_order/priority_order_tests.yml)[0m
[0m19:08:41.568682 [error] [MainThread]:   column "name" does not exist
[0m19:08:41.568945 [error] [MainThread]:   LINE 13: select name
[0m19:08:41.569201 [error] [MainThread]:                   ^
[0m19:08:41.569524 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/priority_order/priority_order_tests.yml/not_null_rugs_usa_variant_name.sql
[0m19:08:41.569821 [info ] [MainThread]: 
[0m19:08:41.570066 [error] [MainThread]: [33mCompilation Error in test not_rugs_usa_variant_profit (models/priority_order/priority_order_tests.yml)[0m
[0m19:08:41.570314 [error] [MainThread]:   'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:08:41.570578 [info ] [MainThread]: 
[0m19:08:41.570884 [error] [MainThread]: [31mFailure in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)[0m
[0m19:08:41.571175 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m19:08:41.571453 [info ] [MainThread]: 
[0m19:08:41.571736 [info ] [MainThread]:   compiled SQL at target/compiled/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m19:08:41.572058 [info ] [MainThread]: 
[0m19:08:41.572548 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=3 SKIP=0 TOTAL=9
[0m19:08:41.577827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a6c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bab190>]}


============================== 2024-07-14 19:09:15.772751 | d64da408-d7f4-4a82-91f3-cd5a8c767615 ==============================
[0m19:09:15.773101 [info ] [MainThread]: Running with dbt=1.2.0
[0m19:09:15.797087 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:09:15.797355 [debug] [MainThread]: Tracking: tracking
[0m19:09:15.814546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2af50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b220>]}
[0m19:09:15.865377 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:09:15.866072 [debug] [MainThread]: Partial parsing: update schema file: jaffle_shop://models/priority_order/priority_order_tests.yml
[0m19:09:15.906145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd64da408-d7f4-4a82-91f3-cd5a8c767615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a21ab0>]}
[0m19:09:15.918306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd64da408-d7f4-4a82-91f3-cd5a8c767615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba7190>]}
[0m19:09:15.918731 [info ] [MainThread]: Found 4 models, 9 tests, 2 snapshots, 0 analyses, 259 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:09:15.919023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd64da408-d7f4-4a82-91f3-cd5a8c767615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba7310>]}
[0m19:09:15.920974 [info ] [MainThread]: 
[0m19:09:15.921813 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:09:15.925303 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m19:09:15.933789 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:09:15.934121 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:09:15.934359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:09:15.981060 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m19:09:15.981594 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:09:15.981862 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:09:15.987412 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.01 seconds
[0m19:09:15.989174 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:09:15.989592 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:09:15.994095 [debug] [MainThread]: Using postgres connection "master"
[0m19:09:15.994383 [debug] [MainThread]: On master: BEGIN
[0m19:09:15.994550 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:09:16.001469 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m19:09:16.001793 [debug] [MainThread]: Using postgres connection "master"
[0m19:09:16.001984 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:09:16.007350 [debug] [MainThread]: SQL status: SELECT 11 in 0.01 seconds
[0m19:09:16.008728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd64da408-d7f4-4a82-91f3-cd5a8c767615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba7550>]}
[0m19:09:16.009046 [debug] [MainThread]: On master: ROLLBACK
[0m19:09:16.009305 [debug] [MainThread]: Using postgres connection "master"
[0m19:09:16.009472 [debug] [MainThread]: On master: BEGIN
[0m19:09:16.009726 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:09:16.009968 [debug] [MainThread]: On master: COMMIT
[0m19:09:16.010116 [debug] [MainThread]: Using postgres connection "master"
[0m19:09:16.010243 [debug] [MainThread]: On master: COMMIT
[0m19:09:16.010424 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:09:16.010580 [debug] [MainThread]: On master: Close
[0m19:09:16.010966 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:09:16.011222 [info ] [MainThread]: 
[0m19:09:16.020342 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:09:16.020546 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:09:16.020988 [info ] [Thread-1 (]: 1 of 9 START test below_depletion_level_tests_below_depletion_level_ ........... [RUN]
[0m19:09:16.021319 [info ] [Thread-2 (]: 2 of 9 START test new_arrival_stock_depletion_test_hot_upsell_ ................. [RUN]
[0m19:09:16.021842 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:09:16.022374 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:09:16.022896 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:09:16.023147 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:09:16.023391 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:09:16.023619 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:09:16.028677 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:09:16.033493 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:09:16.036784 [debug] [Thread-2 (]: finished collecting timing info
[0m19:09:16.036947 [debug] [Thread-1 (]: finished collecting timing info
[0m19:09:16.037216 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:09:16.037513 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:09:16.052357 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:09:16.054669 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:09:16.056191 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:09:16.056310 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:09:16.056510 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m19:09:16.056751 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m19:09:16.056986 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:09:16.057218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:16.063894 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:09:16.064275 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:09:16.064382 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m19:09:16.064601 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m19:09:16.064821 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:09:16.065202 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT DISTINCT rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, 
                        (ruv.msrp - rupu.price) AS profit_margin
        FROM "postgres"."public"."rugs_usa_variant" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        /* joining on model as none of these should show. doing an inner join for this purpose to test */
        JOIN "postgres"."public"."hot_upsell" model on model.name = rup.name and model.variant = ruv.variant and model.size = rupu.size and model.shape = rupu.shape and model.type = rupu.type
        ORDER BY profit_margin DESC
    )
    SELECT 
        count(*) as errors
    FROM test_data
    having count(*) > 0

      
    ) dbt_internal_test
[0m19:09:16.087609 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m19:09:16.091028 [debug] [Thread-1 (]: finished collecting timing info
[0m19:09:16.091971 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m19:09:16.093221 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m19:09:16.095493 [info ] [Thread-1 (]: 1 of 9 PASS below_depletion_level_tests_below_depletion_level_ ................. [[32mPASS[0m in 0.07s]
[0m19:09:16.098993 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:09:16.100607 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:09:16.102422 [info ] [Thread-1 (]: 3 of 9 START test not_null_below_depletion_level_name .......................... [RUN]
[0m19:09:16.104039 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:09:16.104773 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:09:16.105156 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:09:16.113814 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:09:16.115753 [debug] [Thread-1 (]: finished collecting timing info
[0m19:09:16.116109 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:09:16.118205 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:09:16.119254 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:09:16.119495 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m19:09:16.119696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:16.130119 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:09:16.130613 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:09:16.130814 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m19:09:16.134097 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:09:16.135665 [debug] [Thread-1 (]: finished collecting timing info
[0m19:09:16.136017 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m19:09:16.136415 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m19:09:16.137018 [info ] [Thread-1 (]: 3 of 9 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.03s]
[0m19:09:16.137752 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:09:16.138169 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:09:16.138470 [info ] [Thread-1 (]: 4 of 9 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m19:09:16.138942 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:09:16.139217 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:09:16.139475 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:09:16.142685 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:09:16.143957 [debug] [Thread-1 (]: finished collecting timing info
[0m19:09:16.144417 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:09:16.146069 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:09:16.147265 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:09:16.147501 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m19:09:16.147701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:16.157314 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:09:16.157782 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:09:16.158013 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m19:09:16.164183 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:09:16.165637 [debug] [Thread-1 (]: finished collecting timing info
[0m19:09:16.165864 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m19:09:16.166115 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m19:09:16.166494 [info ] [Thread-1 (]: 4 of 9 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.03s]
[0m19:09:16.166864 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:09:16.167258 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:09:16.167539 [info ] [Thread-1 (]: 5 of 9 START test not_null_hot_upsell_name ..................................... [RUN]
[0m19:09:16.167908 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:09:16.168154 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:09:16.168336 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:09:16.172535 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:09:16.173860 [debug] [Thread-1 (]: finished collecting timing info
[0m19:09:16.174112 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:09:16.175817 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:09:16.176513 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:09:16.176680 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m19:09:16.176833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:16.183380 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:09:16.184118 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:09:16.184980 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m19:09:16.188993 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:09:16.190601 [debug] [Thread-1 (]: finished collecting timing info
[0m19:09:16.190867 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m19:09:16.191303 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m19:09:16.192308 [info ] [Thread-1 (]: 5 of 9 PASS not_null_hot_upsell_name ........................................... [[32mPASS[0m in 0.02s]
[0m19:09:16.192783 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:09:16.193097 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:09:16.193348 [info ] [Thread-1 (]: 6 of 9 START test not_null_hot_upsell_variant .................................. [RUN]
[0m19:09:16.193744 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:09:16.193949 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:09:16.194153 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:09:16.197707 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:09:16.199432 [debug] [Thread-1 (]: finished collecting timing info
[0m19:09:16.199726 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:09:16.201416 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:09:16.202170 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:09:16.202350 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m19:09:16.202525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:16.210398 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:09:16.210838 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:09:16.211081 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m19:09:16.218663 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:09:16.220138 [debug] [Thread-1 (]: finished collecting timing info
[0m19:09:16.220359 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m19:09:16.220690 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m19:09:16.221120 [info ] [Thread-1 (]: 6 of 9 PASS not_null_hot_upsell_variant ........................................ [[32mPASS[0m in 0.03s]
[0m19:09:16.221614 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:09:16.222206 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:09:16.222590 [info ] [Thread-1 (]: 7 of 9 START test not_null_priority_order_name ................................. [RUN]
[0m19:09:16.223211 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:09:16.223442 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:09:16.223675 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:09:16.227110 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:09:16.228766 [debug] [Thread-1 (]: finished collecting timing info
[0m19:09:16.228958 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:09:16.231560 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:09:16.232663 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:09:16.232863 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: BEGIN
[0m19:09:16.233035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:16.239786 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:09:16.240204 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:09:16.240478 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_name.6c35449027"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."priority_order"
where name is null



      
    ) dbt_internal_test
[0m19:09:16.245019 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:09:16.246515 [debug] [Thread-1 (]: finished collecting timing info
[0m19:09:16.246778 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: ROLLBACK
[0m19:09:16.247071 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: Close
[0m19:09:16.247515 [info ] [Thread-1 (]: 7 of 9 PASS not_null_priority_order_name ....................................... [[32mPASS[0m in 0.02s]
[0m19:09:16.248140 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:09:16.248462 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:09:16.248725 [info ] [Thread-1 (]: 8 of 9 START test not_null_priority_order_variant .............................. [RUN]
[0m19:09:16.249061 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:09:16.249264 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:09:16.249424 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:09:16.252441 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:09:16.253850 [debug] [Thread-1 (]: finished collecting timing info
[0m19:09:16.254133 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:09:16.256844 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:09:16.257913 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:09:16.258112 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: BEGIN
[0m19:09:16.258341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:16.267410 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:09:16.267981 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:09:16.268390 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."priority_order"
where variant is null



      
    ) dbt_internal_test
[0m19:09:16.276345 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:09:16.277970 [debug] [Thread-1 (]: finished collecting timing info
[0m19:09:16.278264 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: ROLLBACK
[0m19:09:16.278600 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: Close
[0m19:09:16.279157 [info ] [Thread-1 (]: 8 of 9 PASS not_null_priority_order_variant .................................... [[32mPASS[0m in 0.03s]
[0m19:09:16.279674 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:09:16.280196 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_priority_order_profit.54310c92a2
[0m19:09:16.280478 [info ] [Thread-1 (]: 9 of 9 START test not_priority_order_profit .................................... [RUN]
[0m19:09:16.281400 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_priority_order_profit.54310c92a2"
[0m19:09:16.281714 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_priority_order_profit.54310c92a2
[0m19:09:16.281905 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_priority_order_profit.54310c92a2
[0m19:09:16.286363 [debug] [Thread-1 (]: finished collecting timing info
[0m19:09:16.287027 [debug] [Thread-1 (]: Compilation Error in test not_priority_order_profit (models/priority_order/priority_order_tests.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:09:16.287562 [error] [Thread-1 (]: 9 of 9 ERROR not_priority_order_profit ......................................... [[31mERROR[0m in 0.01s]
[0m19:09:16.288168 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_priority_order_profit.54310c92a2


============================== 2024-07-14 19:11:00.905873 | 85a482d0-58ce-4fd4-981c-4c34cb20a4eb ==============================
[0m19:11:00.906194 [info ] [MainThread]: Running with dbt=1.2.0
[0m19:11:00.908488 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:11:00.909180 [debug] [MainThread]: Tracking: tracking
[0m19:11:00.929629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2a2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2a410>]}
[0m19:11:00.997322 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:11:00.998165 [debug] [MainThread]: Partial parsing: update schema file: jaffle_shop://models/priority_order/priority_order_tests.yml
[0m19:11:01.036558 [debug] [MainThread]: 1699: static parser successfully parsed priority_order/priority_order.sql
[0m19:11:01.076353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85a482d0-58ce-4fd4-981c-4c34cb20a4eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b9b850>]}
[0m19:11:01.089185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85a482d0-58ce-4fd4-981c-4c34cb20a4eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1e290>]}
[0m19:11:01.089604 [info ] [MainThread]: Found 4 models, 9 tests, 2 snapshots, 0 analyses, 259 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:11:01.089940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85a482d0-58ce-4fd4-981c-4c34cb20a4eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1f130>]}
[0m19:11:01.091920 [info ] [MainThread]: 
[0m19:11:01.092510 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:11:01.094904 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m19:11:01.103974 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:11:01.104510 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:11:01.104824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:01.149335 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m19:11:01.149873 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:11:01.150146 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:11:01.159389 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.01 seconds
[0m19:11:01.161268 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:11:01.161696 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:11:01.166224 [debug] [MainThread]: Using postgres connection "master"
[0m19:11:01.166551 [debug] [MainThread]: On master: BEGIN
[0m19:11:01.166793 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:11:01.173551 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m19:11:01.173955 [debug] [MainThread]: Using postgres connection "master"
[0m19:11:01.174209 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:11:01.184485 [debug] [MainThread]: SQL status: SELECT 11 in 0.01 seconds
[0m19:11:01.186092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85a482d0-58ce-4fd4-981c-4c34cb20a4eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2a3b0>]}
[0m19:11:01.186496 [debug] [MainThread]: On master: ROLLBACK
[0m19:11:01.186846 [debug] [MainThread]: Using postgres connection "master"
[0m19:11:01.187061 [debug] [MainThread]: On master: BEGIN
[0m19:11:01.187452 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:11:01.187751 [debug] [MainThread]: On master: COMMIT
[0m19:11:01.187971 [debug] [MainThread]: Using postgres connection "master"
[0m19:11:01.188181 [debug] [MainThread]: On master: COMMIT
[0m19:11:01.188480 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:11:01.188711 [debug] [MainThread]: On master: Close
[0m19:11:01.189156 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:11:01.189463 [info ] [MainThread]: 
[0m19:11:01.194956 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:11:01.195215 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:11:01.195805 [info ] [Thread-1 (]: 1 of 9 START test below_depletion_level_tests_below_depletion_level_ ........... [RUN]
[0m19:11:01.196436 [info ] [Thread-2 (]: 2 of 9 START test new_arrival_stock_depletion_test_hot_upsell_ ................. [RUN]
[0m19:11:01.197567 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:11:01.198966 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:11:01.199479 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:11:01.199753 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:11:01.200011 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:11:01.200228 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:11:01.208146 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:11:01.213391 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:11:01.216440 [debug] [Thread-2 (]: finished collecting timing info
[0m19:11:01.216606 [debug] [Thread-1 (]: finished collecting timing info
[0m19:11:01.216886 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:11:01.217123 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:11:01.233313 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:11:01.235468 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:11:01.238603 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:11:01.238887 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:11:01.239276 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m19:11:01.239678 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m19:11:01.239968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:01.240237 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:11:01.249824 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m19:11:01.250318 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:11:01.250624 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT DISTINCT rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, 
                        (ruv.msrp - rupu.price) AS profit_margin
        FROM "postgres"."public"."rugs_usa_variant" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        /* joining on model as none of these should show. doing an inner join for this purpose to test */
        JOIN "postgres"."public"."hot_upsell" model on model.name = rup.name and model.variant = ruv.variant and model.size = rupu.size and model.shape = rupu.shape and model.type = rupu.type
        ORDER BY profit_margin DESC
    )
    SELECT 
        count(*) as errors
    FROM test_data
    having count(*) > 0

      
    ) dbt_internal_test
[0m19:11:01.250779 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:11:01.251164 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:11:01.251312 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m19:11:01.274165 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m19:11:01.278492 [debug] [Thread-1 (]: finished collecting timing info
[0m19:11:01.278831 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m19:11:01.279139 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m19:11:01.279671 [info ] [Thread-1 (]: 1 of 9 PASS below_depletion_level_tests_below_depletion_level_ ................. [[32mPASS[0m in 0.08s]
[0m19:11:01.280507 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:11:01.281255 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:11:01.281637 [info ] [Thread-1 (]: 3 of 9 START test not_null_below_depletion_level_name .......................... [RUN]
[0m19:11:01.282125 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:11:01.282363 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:11:01.282560 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:11:01.290748 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:11:01.295055 [debug] [Thread-1 (]: finished collecting timing info
[0m19:11:01.295929 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:11:01.298885 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:11:01.301343 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:11:01.303365 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m19:11:01.304550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:01.320069 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m19:11:01.320986 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:11:01.321339 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m19:11:01.326107 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:11:01.328988 [debug] [Thread-1 (]: finished collecting timing info
[0m19:11:01.329504 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m19:11:01.329980 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m19:11:01.330709 [info ] [Thread-1 (]: 3 of 9 PASS not_null_below_depletion_level_name ................................ [[32mPASS[0m in 0.05s]
[0m19:11:01.332055 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:11:01.332597 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:11:01.332938 [info ] [Thread-1 (]: 4 of 9 START test not_null_below_depletion_level_variant ....................... [RUN]
[0m19:11:01.333398 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:11:01.333733 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:11:01.334048 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:11:01.338181 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:11:01.339519 [debug] [Thread-1 (]: finished collecting timing info
[0m19:11:01.339806 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:11:01.341646 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:11:01.342657 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:11:01.342907 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m19:11:01.343149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:01.351930 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:11:01.352415 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:11:01.352706 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m19:11:01.359574 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:11:01.361542 [debug] [Thread-1 (]: finished collecting timing info
[0m19:11:01.362158 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m19:11:01.363235 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m19:11:01.364254 [info ] [Thread-1 (]: 4 of 9 PASS not_null_below_depletion_level_variant ............................. [[32mPASS[0m in 0.03s]
[0m19:11:01.365327 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:11:01.366113 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:11:01.366603 [info ] [Thread-1 (]: 5 of 9 START test not_null_hot_upsell_name ..................................... [RUN]
[0m19:11:01.367241 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:11:01.367716 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:11:01.368007 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:11:01.371934 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:11:01.374012 [debug] [Thread-1 (]: finished collecting timing info
[0m19:11:01.374429 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:11:01.376456 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:11:01.378029 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:11:01.378359 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m19:11:01.378657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:01.388947 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:11:01.389605 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:11:01.390131 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m19:11:01.396249 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:11:01.397913 [debug] [Thread-1 (]: finished collecting timing info
[0m19:11:01.398249 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m19:11:01.398684 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m19:11:01.399192 [info ] [Thread-1 (]: 5 of 9 PASS not_null_hot_upsell_name ........................................... [[32mPASS[0m in 0.03s]
[0m19:11:01.399732 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:11:01.400341 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:11:01.400657 [info ] [Thread-1 (]: 6 of 9 START test not_null_hot_upsell_variant .................................. [RUN]
[0m19:11:01.401110 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:11:01.401465 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:11:01.401756 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:11:01.406340 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:11:01.407517 [debug] [Thread-1 (]: finished collecting timing info
[0m19:11:01.407831 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:11:01.409703 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:11:01.410813 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:11:01.411035 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m19:11:01.411250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:01.426488 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m19:11:01.427571 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:11:01.427970 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m19:11:01.438093 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:11:01.440092 [debug] [Thread-1 (]: finished collecting timing info
[0m19:11:01.440586 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m19:11:01.441070 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m19:11:01.441712 [info ] [Thread-1 (]: 6 of 9 PASS not_null_hot_upsell_variant ........................................ [[32mPASS[0m in 0.04s]
[0m19:11:01.442472 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:11:01.443507 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:11:01.444023 [info ] [Thread-1 (]: 7 of 9 START test not_null_priority_order_name ................................. [RUN]
[0m19:11:01.444694 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:11:01.445348 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:11:01.445807 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:11:01.449825 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:11:01.453430 [debug] [Thread-1 (]: finished collecting timing info
[0m19:11:01.453962 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:11:01.456449 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:11:01.458161 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:11:01.458575 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: BEGIN
[0m19:11:01.458950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:01.470145 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:11:01.472879 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:11:01.474036 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_name.6c35449027"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."priority_order"
where name is null



      
    ) dbt_internal_test
[0m19:11:01.480204 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:11:01.481779 [debug] [Thread-1 (]: finished collecting timing info
[0m19:11:01.482086 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: ROLLBACK
[0m19:11:01.482412 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: Close
[0m19:11:01.482912 [info ] [Thread-1 (]: 7 of 9 PASS not_null_priority_order_name ....................................... [[32mPASS[0m in 0.04s]
[0m19:11:01.483423 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:11:01.483968 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:11:01.484255 [info ] [Thread-1 (]: 8 of 9 START test not_null_priority_order_profit ............................... [RUN]
[0m19:11:01.484726 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:11:01.485108 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:11:01.485339 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:11:01.488667 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:11:01.489579 [debug] [Thread-1 (]: finished collecting timing info
[0m19:11:01.489821 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:11:01.491495 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:11:01.492726 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:11:01.492943 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: BEGIN
[0m19:11:01.493152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:01.508028 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:11:01.509232 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:11:01.509714 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_profit.229518def8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select profit
from "postgres"."public"."priority_order"
where profit is null



      
    ) dbt_internal_test
[0m19:11:01.524069 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:11:01.525969 [debug] [Thread-1 (]: finished collecting timing info
[0m19:11:01.526286 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: ROLLBACK
[0m19:11:01.526696 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: Close
[0m19:11:01.527325 [info ] [Thread-1 (]: 8 of 9 PASS not_null_priority_order_profit ..................................... [[32mPASS[0m in 0.04s]
[0m19:11:01.528138 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:11:01.528782 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:11:01.529090 [info ] [Thread-1 (]: 9 of 9 START test not_null_priority_order_variant .............................. [RUN]
[0m19:11:01.529575 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:11:01.529923 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:11:01.530158 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:11:01.533919 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:11:01.535038 [debug] [Thread-1 (]: finished collecting timing info
[0m19:11:01.535275 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:11:01.536991 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:11:01.538084 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:11:01.538303 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: BEGIN
[0m19:11:01.538507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:01.545964 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:11:01.546505 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:11:01.546817 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."priority_order"
where variant is null



      
    ) dbt_internal_test
[0m19:11:01.552131 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:11:01.553885 [debug] [Thread-1 (]: finished collecting timing info
[0m19:11:01.554151 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: ROLLBACK
[0m19:11:01.554462 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: Close
[0m19:11:01.554893 [info ] [Thread-1 (]: 9 of 9 PASS not_null_priority_order_variant .................................... [[32mPASS[0m in 0.03s]
[0m19:11:01.555366 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:11:36.540447 [debug] [Thread-2 (]: SQL status: SELECT 1 in 140.47 seconds
[0m19:11:36.554936 [debug] [Thread-2 (]: finished collecting timing info
[0m19:11:36.555711 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m19:11:36.556616 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m19:11:36.559010 [error] [Thread-2 (]: 2 of 9 FAIL 1 new_arrival_stock_depletion_test_hot_upsell_ ..................... [[31mFAIL 1[0m in 140.54s]
[0m19:11:36.560835 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:11:36.567474 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:11:36.567937 [debug] [MainThread]: Using postgres connection "master"
[0m19:11:36.568114 [debug] [MainThread]: On master: BEGIN
[0m19:11:36.568277 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:11:36.578211 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m19:11:36.578757 [debug] [MainThread]: On master: COMMIT
[0m19:11:36.579062 [debug] [MainThread]: Using postgres connection "master"
[0m19:11:36.579241 [debug] [MainThread]: On master: COMMIT
[0m19:11:36.579461 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:11:36.579708 [debug] [MainThread]: On master: Close
[0m19:11:36.580934 [info ] [MainThread]: 
[0m19:11:36.581324 [info ] [MainThread]: Finished running 9 tests in 0 hours 2 minutes and 20.66 seconds (140.66s).
[0m19:11:36.581638 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:11:36.581850 [debug] [MainThread]: Connection 'test.jaffle_shop.not_priority_order_profit.54310c92a2' was properly closed.
[0m19:11:36.581998 [debug] [MainThread]: Connection 'test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38' was properly closed.
[0m19:11:36.614147 [info ] [MainThread]: 
[0m19:11:36.614557 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:11:36.614943 [info ] [MainThread]: 
[0m19:11:36.615190 [error] [MainThread]: [33mCompilation Error in test not_priority_order_profit (models/priority_order/priority_order_tests.yml)[0m
[0m19:11:36.615420 [error] [MainThread]:   'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:11:36.615660 [info ] [MainThread]: 
[0m19:11:36.615906 [error] [MainThread]: [31mFailure in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)[0m
[0m19:11:36.616127 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m19:11:36.616303 [info ] [MainThread]: 
[0m19:11:36.616569 [info ] [MainThread]:   compiled SQL at target/compiled/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m19:11:36.616814 [info ] [MainThread]: 
[0m19:11:36.617042 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
[0m19:11:36.617839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff98e1ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a94730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff98c4580>]}
[0m19:13:24.136366 [debug] [Thread-2 (]: SQL status: SELECT 1 in 142.88 seconds
[0m19:13:24.174871 [debug] [Thread-2 (]: finished collecting timing info
[0m19:13:24.175842 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m19:13:24.177212 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m19:13:24.180129 [error] [Thread-2 (]: 2 of 9 FAIL 1 new_arrival_stock_depletion_test_hot_upsell_ ..................... [[31mFAIL 1[0m in 142.98s]
[0m19:13:24.182775 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:13:24.205947 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:13:24.207697 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:24.208793 [debug] [MainThread]: On master: BEGIN
[0m19:13:24.209179 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:13:24.224132 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m19:13:24.225126 [debug] [MainThread]: On master: COMMIT
[0m19:13:24.225591 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:24.225889 [debug] [MainThread]: On master: COMMIT
[0m19:13:24.226354 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:13:24.226628 [debug] [MainThread]: On master: Close
[0m19:13:24.227976 [info ] [MainThread]: 
[0m19:13:24.228491 [info ] [MainThread]: Finished running 9 tests in 0 hours 2 minutes and 23.13 seconds (143.13s).
[0m19:13:24.228944 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:13:24.229551 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3' was properly closed.
[0m19:13:24.229862 [debug] [MainThread]: Connection 'test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38' was properly closed.
[0m19:13:24.244857 [info ] [MainThread]: 
[0m19:13:24.245280 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:13:24.245835 [info ] [MainThread]: 
[0m19:13:24.246206 [error] [MainThread]: [31mFailure in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)[0m
[0m19:13:24.246573 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m19:13:24.246872 [info ] [MainThread]: 
[0m19:13:24.247433 [info ] [MainThread]:   compiled SQL at target/compiled/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m19:13:24.247898 [info ] [MainThread]: 
[0m19:13:24.248439 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m19:13:24.254095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1cfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9babf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9aaf850>]}


============================== 2024-07-14 19:21:21.875174 | 4a2e6073-a7c9-4c3f-9392-308e387a12fd ==============================
[0m19:21:21.875485 [info ] [MainThread]: Running with dbt=1.2.0
[0m19:21:21.901453 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:21:21.901833 [debug] [MainThread]: Tracking: tracking
[0m19:21:21.918584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2afb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b250>]}
[0m19:21:21.978752 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 3 files added, 0 files changed.
[0m19:21:21.979289 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://macros/underselling_specs_test.sql
[0m19:21:21.979596 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/underselling_product_specs/underselling_product_specs.sql
[0m19:21:21.979910 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/underselling_product_specs/underselling_product_specs_tests.yml
[0m19:21:21.980148 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://models/underselling_product_specs.sql
[0m19:21:21.980372 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://macros/priority_order_test.sql
[0m19:21:21.980650 [debug] [MainThread]: Parsing macros/underselling_specs_test.sql
[0m19:21:22.019157 [debug] [MainThread]: 1699: static parser successfully parsed underselling_product_specs/underselling_product_specs.sql
[0m19:21:22.054363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a2e6073-a7c9-4c3f-9392-308e387a12fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99e0220>]}
[0m19:21:22.068572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a2e6073-a7c9-4c3f-9392-308e387a12fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b6dff0>]}
[0m19:21:22.069096 [info ] [MainThread]: Found 4 models, 12 tests, 2 snapshots, 0 analyses, 259 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:21:22.069555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a2e6073-a7c9-4c3f-9392-308e387a12fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c127d0>]}
[0m19:21:22.072141 [info ] [MainThread]: 
[0m19:21:22.072813 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:21:22.075005 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m19:21:22.083042 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:21:22.083360 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:21:22.083586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:21:22.140802 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
[0m19:21:22.142054 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:21:22.142569 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:21:22.158204 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.02 seconds
[0m19:21:22.160276 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:21:22.160832 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:21:22.165879 [debug] [MainThread]: Using postgres connection "master"
[0m19:21:22.166237 [debug] [MainThread]: On master: BEGIN
[0m19:21:22.166438 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:21:22.173427 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m19:21:22.173813 [debug] [MainThread]: Using postgres connection "master"
[0m19:21:22.174070 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:21:22.180630 [debug] [MainThread]: SQL status: SELECT 11 in 0.01 seconds
[0m19:21:22.182367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a2e6073-a7c9-4c3f-9392-308e387a12fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b250>]}
[0m19:21:22.182733 [debug] [MainThread]: On master: ROLLBACK
[0m19:21:22.183052 [debug] [MainThread]: Using postgres connection "master"
[0m19:21:22.183255 [debug] [MainThread]: On master: BEGIN
[0m19:21:22.183579 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:21:22.183825 [debug] [MainThread]: On master: COMMIT
[0m19:21:22.184060 [debug] [MainThread]: Using postgres connection "master"
[0m19:21:22.184249 [debug] [MainThread]: On master: COMMIT
[0m19:21:22.184508 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:21:22.184701 [debug] [MainThread]: On master: Close
[0m19:21:22.185069 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:21:22.185385 [info ] [MainThread]: 
[0m19:21:22.192784 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:21:22.192961 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:21:22.193245 [info ] [Thread-1 (]: 1 of 12 START test below_depletion_level_tests_below_depletion_level_ .......... [RUN]
[0m19:21:22.193564 [info ] [Thread-2 (]: 2 of 12 START test new_arrival_stock_depletion_test_hot_upsell_ ................ [RUN]
[0m19:21:22.194052 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:21:22.194584 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:21:22.194935 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:21:22.195168 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:21:22.195406 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:21:22.195634 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:21:22.208753 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:21:22.214031 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:21:22.217169 [debug] [Thread-1 (]: finished collecting timing info
[0m19:21:22.217269 [debug] [Thread-2 (]: finished collecting timing info
[0m19:21:22.217489 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:21:22.217741 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:21:22.232442 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:21:22.234152 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:21:22.236294 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:21:22.236407 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:21:22.236610 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m19:21:22.236819 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m19:21:22.237029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:21:22.237239 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:21:22.245896 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m19:21:22.246410 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:21:22.246677 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT DISTINCT rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, 
                        (ruv.msrp - rupu.price) AS profit_margin
        FROM "postgres"."public"."rugs_usa_variant" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        /* joining on model as none of these should show. doing an inner join for this purpose to test */
        JOIN "postgres"."public"."hot_upsell" model on model.name = rup.name and model.variant = ruv.variant and model.size = rupu.size and model.shape = rupu.shape and model.type = rupu.type
        ORDER BY profit_margin DESC
    )
    SELECT 
        count(*) as errors
    FROM test_data
    having count(*) > 0

      
    ) dbt_internal_test
[0m19:21:22.250613 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:21:22.251553 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:21:22.251881 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m19:21:22.285027 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m19:21:22.288124 [debug] [Thread-1 (]: finished collecting timing info
[0m19:21:22.288619 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m19:21:22.289015 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m19:21:22.289513 [info ] [Thread-1 (]: 1 of 12 PASS below_depletion_level_tests_below_depletion_level_ ................ [[32mPASS[0m in 0.10s]
[0m19:21:22.290254 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:21:22.290676 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:21:22.290991 [info ] [Thread-1 (]: 3 of 12 START test not_null_below_depletion_level_name ......................... [RUN]
[0m19:21:22.291424 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:21:22.291666 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:21:22.291888 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:21:22.297890 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:21:22.299029 [debug] [Thread-1 (]: finished collecting timing info
[0m19:21:22.299268 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:21:22.300993 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:21:22.302118 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:21:22.302334 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m19:21:22.302539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:21:22.309887 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:21:22.310424 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:21:22.310866 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m19:21:22.314113 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:21:22.315505 [debug] [Thread-1 (]: finished collecting timing info
[0m19:21:22.315776 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m19:21:22.316096 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m19:21:22.316524 [info ] [Thread-1 (]: 3 of 12 PASS not_null_below_depletion_level_name ............................... [[32mPASS[0m in 0.03s]
[0m19:21:22.316960 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:21:22.317288 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:21:22.317564 [info ] [Thread-1 (]: 4 of 12 START test not_null_below_depletion_level_variant ...................... [RUN]
[0m19:21:22.317974 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:21:22.318237 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:21:22.318454 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:21:22.321778 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:21:22.322916 [debug] [Thread-1 (]: finished collecting timing info
[0m19:21:22.323139 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:21:22.324823 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:21:22.325772 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:21:22.325987 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m19:21:22.326205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:21:22.332740 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:21:22.333237 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:21:22.333489 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m19:21:22.342261 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:21:22.344247 [debug] [Thread-1 (]: finished collecting timing info
[0m19:21:22.344544 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m19:21:22.345094 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m19:21:22.345535 [info ] [Thread-1 (]: 4 of 12 PASS not_null_below_depletion_level_variant ............................ [[32mPASS[0m in 0.03s]
[0m19:21:22.345997 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:21:22.346446 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:21:22.346727 [info ] [Thread-1 (]: 5 of 12 START test not_null_hot_upsell_name .................................... [RUN]
[0m19:21:22.347206 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:21:22.347446 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:21:22.347659 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:21:22.351073 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:21:22.352465 [debug] [Thread-1 (]: finished collecting timing info
[0m19:21:22.352706 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:21:22.355454 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:21:22.357169 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:21:22.357446 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m19:21:22.357687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:21:22.365760 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:21:22.366317 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:21:22.366563 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m19:21:22.372541 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:21:22.374378 [debug] [Thread-1 (]: finished collecting timing info
[0m19:21:22.374756 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m19:21:22.375131 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m19:21:22.375608 [info ] [Thread-1 (]: 5 of 12 PASS not_null_hot_upsell_name .......................................... [[32mPASS[0m in 0.03s]
[0m19:21:22.376212 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:21:22.376756 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:21:22.377149 [info ] [Thread-1 (]: 6 of 12 START test not_null_hot_upsell_variant ................................. [RUN]
[0m19:21:22.377626 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:21:22.377959 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:21:22.378172 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:21:22.381709 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:21:22.382999 [debug] [Thread-1 (]: finished collecting timing info
[0m19:21:22.383281 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:21:22.385160 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:21:22.386430 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:21:22.386683 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m19:21:22.386897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:21:22.396897 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:21:22.397371 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:21:22.397608 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m19:21:22.405921 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:21:22.408321 [debug] [Thread-1 (]: finished collecting timing info
[0m19:21:22.408720 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m19:21:22.409129 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m19:21:22.409907 [info ] [Thread-1 (]: 6 of 12 PASS not_null_hot_upsell_variant ....................................... [[32mPASS[0m in 0.03s]
[0m19:21:22.410617 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:21:22.411238 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:21:22.411527 [info ] [Thread-1 (]: 7 of 12 START test not_null_priority_order_name ................................ [RUN]
[0m19:21:22.412089 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:21:22.412564 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:21:22.412887 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:21:22.417044 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:21:22.419438 [debug] [Thread-1 (]: finished collecting timing info
[0m19:21:22.419757 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:21:22.423703 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:21:22.428939 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:21:22.429262 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: BEGIN
[0m19:21:22.429491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:21:22.440953 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:21:22.441434 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:21:22.441837 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_name.6c35449027"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."priority_order"
where name is null



      
    ) dbt_internal_test
[0m19:21:22.445917 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:21:22.447285 [debug] [Thread-1 (]: finished collecting timing info
[0m19:21:22.447550 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: ROLLBACK
[0m19:21:22.447858 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: Close
[0m19:21:22.448282 [info ] [Thread-1 (]: 7 of 12 PASS not_null_priority_order_name ...................................... [[32mPASS[0m in 0.04s]
[0m19:21:22.448965 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:21:22.449503 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:21:22.449810 [info ] [Thread-1 (]: 8 of 12 START test not_null_priority_order_profit .............................. [RUN]
[0m19:21:22.450281 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:21:22.450547 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:21:22.450770 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:21:22.454370 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:21:22.456073 [debug] [Thread-1 (]: finished collecting timing info
[0m19:21:22.456569 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:21:22.458433 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:21:22.460052 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:21:22.460251 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: BEGIN
[0m19:21:22.460532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:21:22.467940 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:21:22.468417 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:21:22.468644 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_profit.229518def8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select profit
from "postgres"."public"."priority_order"
where profit is null



      
    ) dbt_internal_test
[0m19:21:22.476058 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:21:22.477735 [debug] [Thread-1 (]: finished collecting timing info
[0m19:21:22.478227 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: ROLLBACK
[0m19:21:22.478607 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: Close
[0m19:21:22.479120 [info ] [Thread-1 (]: 8 of 12 PASS not_null_priority_order_profit .................................... [[32mPASS[0m in 0.03s]
[0m19:21:22.479716 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:21:22.480362 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:21:22.480689 [info ] [Thread-1 (]: 9 of 12 START test not_null_priority_order_variant ............................. [RUN]
[0m19:21:22.481217 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:21:22.481560 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:21:22.481891 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:21:22.486004 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:21:22.487710 [debug] [Thread-1 (]: finished collecting timing info
[0m19:21:22.488178 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:21:22.490474 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:21:22.492241 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:21:22.492821 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: BEGIN
[0m19:21:22.493210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:21:22.500363 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:21:22.500927 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:21:22.501159 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."priority_order"
where variant is null



      
    ) dbt_internal_test
[0m19:21:22.507586 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:21:22.509216 [debug] [Thread-1 (]: finished collecting timing info
[0m19:21:22.509556 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: ROLLBACK
[0m19:21:22.509982 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: Close
[0m19:21:22.510436 [info ] [Thread-1 (]: 9 of 12 PASS not_null_priority_order_variant ................................... [[32mPASS[0m in 0.03s]
[0m19:21:22.510994 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:21:22.511676 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:21:22.512029 [info ] [Thread-1 (]: 10 of 12 START test not_null_underselling_product_specs_name ................... [RUN]
[0m19:21:22.512517 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:21:22.512837 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:21:22.513153 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:21:22.516346 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:21:22.518008 [debug] [Thread-1 (]: finished collecting timing info
[0m19:21:22.518240 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:21:22.519933 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:21:22.521295 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:21:22.521497 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: BEGIN
[0m19:21:22.521700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:21:22.528765 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:21:22.529211 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:21:22.529438 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."underselling_product_specs"
where name is null



      
    ) dbt_internal_test
[0m19:21:22.557112 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m19:21:22.558618 [debug] [Thread-1 (]: finished collecting timing info
[0m19:21:22.559023 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: ROLLBACK
[0m19:21:22.559397 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: Close
[0m19:21:22.559863 [info ] [Thread-1 (]: 10 of 12 PASS not_null_underselling_product_specs_name ......................... [[32mPASS[0m in 0.05s]
[0m19:21:22.560320 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:21:22.560740 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_underselling_product_specs_stock_level.45e820c9d2
[0m19:21:22.561052 [info ] [Thread-1 (]: 11 of 12 START test not_null_underselling_product_specs_stock_level ............ [RUN]
[0m19:21:22.561499 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_level.45e820c9d2"
[0m19:21:22.561741 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_underselling_product_specs_stock_level.45e820c9d2
[0m19:21:22.561976 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_underselling_product_specs_stock_level.45e820c9d2
[0m19:21:22.566342 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_underselling_product_specs_stock_level.45e820c9d2"
[0m19:21:22.569014 [debug] [Thread-1 (]: finished collecting timing info
[0m19:21:22.569465 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_underselling_product_specs_stock_level.45e820c9d2
[0m19:21:22.573226 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_underselling_product_specs_stock_level.45e820c9d2"
[0m19:21:22.575223 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_level.45e820c9d2"
[0m19:21:22.575583 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_level.45e820c9d2: BEGIN
[0m19:21:22.575821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:21:22.583651 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:21:22.584391 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_level.45e820c9d2"
[0m19:21:22.584624 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_level.45e820c9d2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_underselling_product_specs_stock_level.45e820c9d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_level
from "postgres"."public"."underselling_product_specs"
where stock_level is null



      
    ) dbt_internal_test
[0m19:21:22.586479 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "stock_level" does not exist
LINE 13: select stock_level
                ^

[0m19:21:22.586884 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_level.45e820c9d2: ROLLBACK
[0m19:21:22.587494 [debug] [Thread-1 (]: finished collecting timing info
[0m19:21:22.587777 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_level.45e820c9d2: Close
[0m19:21:22.588346 [debug] [Thread-1 (]: Database Error in test not_null_underselling_product_specs_stock_level (models/underselling_product_specs/underselling_product_specs_tests.yml)
  column "stock_level" does not exist
  LINE 13: select stock_level
                  ^
  compiled SQL at target/run/jaffle_shop/models/underselling_product_specs/underselling_product_specs_tests.yml/not_null_underselling_product_specs_stock_level.sql
[0m19:21:22.588884 [error] [Thread-1 (]: 11 of 12 ERROR not_null_underselling_product_specs_stock_level ................. [[31mERROR[0m in 0.03s]
[0m19:21:22.589498 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_underselling_product_specs_stock_level.45e820c9d2
[0m19:21:22.589938 [debug] [Thread-1 (]: Began running node test.jaffle_shop.underselling_specs_test.fda95ee712
[0m19:21:22.590306 [info ] [Thread-1 (]: 12 of 12 START test underselling_specs_test .................................... [RUN]
[0m19:21:22.590795 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.underselling_specs_test.fda95ee712"
[0m19:21:22.591232 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.underselling_specs_test.fda95ee712
[0m19:21:22.591489 [debug] [Thread-1 (]: Compiling test.jaffle_shop.underselling_specs_test.fda95ee712
[0m19:21:22.595647 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.underselling_specs_test.fda95ee712"
[0m19:21:22.596863 [debug] [Thread-1 (]: finished collecting timing info
[0m19:21:22.597240 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.underselling_specs_test.fda95ee712
[0m19:21:22.599256 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.underselling_specs_test.fda95ee712"
[0m19:21:22.600284 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.underselling_specs_test.fda95ee712"
[0m19:21:22.600539 [debug] [Thread-1 (]: On test.jaffle_shop.underselling_specs_test.fda95ee712: BEGIN
[0m19:21:22.600749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:21:22.607902 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:21:22.608735 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.underselling_specs_test.fda95ee712"
[0m19:21:22.609176 [debug] [Thread-1 (]: On test.jaffle_shop.underselling_specs_test.fda95ee712: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.underselling_specs_test.fda95ee712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select 
from "postgres"."public"."underselling_product_specs"
where  is null



      
    ) dbt_internal_test
[0m19:21:22.609678 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "null"
LINE 15: where  is null
                   ^

[0m19:21:22.610238 [debug] [Thread-1 (]: On test.jaffle_shop.underselling_specs_test.fda95ee712: ROLLBACK
[0m19:21:22.610722 [debug] [Thread-1 (]: finished collecting timing info
[0m19:21:22.611049 [debug] [Thread-1 (]: On test.jaffle_shop.underselling_specs_test.fda95ee712: Close
[0m19:21:22.611608 [debug] [Thread-1 (]: Database Error in test underselling_specs_test (models/underselling_product_specs/underselling_product_specs_tests.yml)
  syntax error at or near "null"
  LINE 15: where  is null
                     ^
  compiled SQL at target/run/jaffle_shop/models/underselling_product_specs/underselling_product_specs_tests.yml/underselling_specs_test.sql
[0m19:21:22.612459 [error] [Thread-1 (]: 12 of 12 ERROR underselling_specs_test ......................................... [[31mERROR[0m in 0.02s]
[0m19:21:22.613035 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.underselling_specs_test.fda95ee712
[0m19:23:37.851432 [debug] [Thread-2 (]: SQL status: SELECT 1 in 135.6 seconds
[0m19:23:37.869052 [debug] [Thread-2 (]: finished collecting timing info
[0m19:23:37.869731 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m19:23:37.870677 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m19:23:37.873165 [error] [Thread-2 (]: 2 of 12 FAIL 1 new_arrival_stock_depletion_test_hot_upsell_ .................... [[31mFAIL 1[0m in 135.68s]
[0m19:23:37.875560 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:23:37.887034 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:23:37.889070 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:37.889682 [debug] [MainThread]: On master: BEGIN
[0m19:23:37.890179 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:23:37.911315 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m19:23:37.912014 [debug] [MainThread]: On master: COMMIT
[0m19:23:37.912324 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:37.912597 [debug] [MainThread]: On master: COMMIT
[0m19:23:37.912954 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:23:37.913208 [debug] [MainThread]: On master: Close
[0m19:23:37.914662 [info ] [MainThread]: 
[0m19:23:37.915147 [info ] [MainThread]: Finished running 12 tests in 0 hours 2 minutes and 15.84 seconds (135.84s).
[0m19:23:37.915573 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:23:37.915848 [debug] [MainThread]: Connection 'test.jaffle_shop.underselling_specs_test.fda95ee712' was properly closed.
[0m19:23:37.916065 [debug] [MainThread]: Connection 'test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38' was properly closed.
[0m19:23:37.930685 [info ] [MainThread]: 
[0m19:23:37.931136 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m19:23:37.931576 [info ] [MainThread]: 
[0m19:23:37.932024 [error] [MainThread]: [33mDatabase Error in test not_null_underselling_product_specs_stock_level (models/underselling_product_specs/underselling_product_specs_tests.yml)[0m
[0m19:23:37.932372 [error] [MainThread]:   column "stock_level" does not exist
[0m19:23:37.932694 [error] [MainThread]:   LINE 13: select stock_level
[0m19:23:37.933012 [error] [MainThread]:                   ^
[0m19:23:37.933357 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/underselling_product_specs/underselling_product_specs_tests.yml/not_null_underselling_product_specs_stock_level.sql
[0m19:23:37.933664 [info ] [MainThread]: 
[0m19:23:37.934013 [error] [MainThread]: [33mDatabase Error in test underselling_specs_test (models/underselling_product_specs/underselling_product_specs_tests.yml)[0m
[0m19:23:37.934314 [error] [MainThread]:   syntax error at or near "null"
[0m19:23:37.934619 [error] [MainThread]:   LINE 15: where  is null
[0m19:23:37.934953 [error] [MainThread]:                      ^
[0m19:23:37.935245 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/underselling_product_specs/underselling_product_specs_tests.yml/underselling_specs_test.sql
[0m19:23:37.935567 [info ] [MainThread]: 
[0m19:23:37.935934 [error] [MainThread]: [31mFailure in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)[0m
[0m19:23:37.936255 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m19:23:37.936555 [info ] [MainThread]: 
[0m19:23:37.936878 [info ] [MainThread]:   compiled SQL at target/compiled/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m19:23:37.937212 [info ] [MainThread]: 
[0m19:23:37.937560 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=3 SKIP=0 TOTAL=12
[0m19:23:37.938514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bb56f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bb74f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99e2920>]}


============================== 2024-07-14 19:26:21.886370 | 9b54bf37-a3dd-4bd5-81d2-da680e2374b3 ==============================
[0m19:26:21.886682 [info ] [MainThread]: Running with dbt=1.2.0
[0m19:26:21.912500 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:26:21.912984 [debug] [MainThread]: Tracking: tracking
[0m19:26:21.927700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2af50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b220>]}
[0m19:26:21.983177 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:26:21.983981 [debug] [MainThread]: Partial parsing: update schema file: jaffle_shop://models/underselling_product_specs/underselling_product_specs_tests.yml
[0m19:26:22.020922 [debug] [MainThread]: 1699: static parser successfully parsed underselling_product_specs/underselling_product_specs.sql
[0m19:26:22.061176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b54bf37-a3dd-4bd5-81d2-da680e2374b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bb3430>]}
[0m19:26:22.072300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b54bf37-a3dd-4bd5-81d2-da680e2374b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1fa60>]}
[0m19:26:22.072748 [info ] [MainThread]: Found 4 models, 12 tests, 2 snapshots, 0 analyses, 259 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:26:22.073125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b54bf37-a3dd-4bd5-81d2-da680e2374b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1f8b0>]}
[0m19:26:22.075567 [info ] [MainThread]: 
[0m19:26:22.076291 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:26:22.078682 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m19:26:22.088886 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:26:22.089362 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:26:22.089684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:22.141648 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m19:26:22.142171 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:26:22.142445 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:26:22.146622 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m19:26:22.148501 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:26:22.148938 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:26:22.153771 [debug] [MainThread]: Using postgres connection "master"
[0m19:26:22.154097 [debug] [MainThread]: On master: BEGIN
[0m19:26:22.154322 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:26:22.161955 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m19:26:22.162332 [debug] [MainThread]: Using postgres connection "master"
[0m19:26:22.162533 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:26:22.167154 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m19:26:22.168700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b54bf37-a3dd-4bd5-81d2-da680e2374b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b83c40>]}
[0m19:26:22.169150 [debug] [MainThread]: On master: ROLLBACK
[0m19:26:22.169485 [debug] [MainThread]: Using postgres connection "master"
[0m19:26:22.169723 [debug] [MainThread]: On master: BEGIN
[0m19:26:22.170119 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:26:22.170458 [debug] [MainThread]: On master: COMMIT
[0m19:26:22.170690 [debug] [MainThread]: Using postgres connection "master"
[0m19:26:22.170908 [debug] [MainThread]: On master: COMMIT
[0m19:26:22.171201 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:26:22.171418 [debug] [MainThread]: On master: Close
[0m19:26:22.171820 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:26:22.172143 [info ] [MainThread]: 
[0m19:26:22.176190 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:26:22.176378 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:26:22.176716 [info ] [Thread-1 (]: 1 of 12 START test below_depletion_level_tests_below_depletion_level_ .......... [RUN]
[0m19:26:22.177057 [info ] [Thread-2 (]: 2 of 12 START test new_arrival_stock_depletion_test_hot_upsell_ ................ [RUN]
[0m19:26:22.177546 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:26:22.178048 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:26:22.178437 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:26:22.178693 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:26:22.178953 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:26:22.179199 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:26:22.189232 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:26:22.198524 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:26:22.201637 [debug] [Thread-1 (]: finished collecting timing info
[0m19:26:22.201742 [debug] [Thread-2 (]: finished collecting timing info
[0m19:26:22.201996 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:26:22.202234 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:26:22.217659 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:26:22.219430 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:26:22.221663 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:26:22.221787 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:26:22.222003 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m19:26:22.222242 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m19:26:22.222487 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:26:22.222734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:26:22.229628 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m19:26:22.229776 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:26:22.230097 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:26:22.230333 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:26:22.230596 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT DISTINCT rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, 
                        (ruv.msrp - rupu.price) AS profit_margin
        FROM "postgres"."public"."rugs_usa_variant" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        /* joining on model as none of these should show. doing an inner join for this purpose to test */
        JOIN "postgres"."public"."hot_upsell" model on model.name = rup.name and model.variant = ruv.variant and model.size = rupu.size and model.shape = rupu.shape and model.type = rupu.type
        ORDER BY profit_margin DESC
    )
    SELECT 
        count(*) as errors
    FROM test_data
    having count(*) > 0

      
    ) dbt_internal_test
[0m19:26:22.230830 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m19:26:22.246459 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m19:26:22.249826 [debug] [Thread-1 (]: finished collecting timing info
[0m19:26:22.250157 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m19:26:22.250509 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m19:26:22.251023 [info ] [Thread-1 (]: 1 of 12 PASS below_depletion_level_tests_below_depletion_level_ ................ [[32mPASS[0m in 0.07s]
[0m19:26:22.251663 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:26:22.252077 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:26:22.252419 [info ] [Thread-1 (]: 3 of 12 START test not_null_below_depletion_level_name ......................... [RUN]
[0m19:26:22.252858 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:26:22.253128 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:26:22.253327 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:26:22.259399 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:26:22.261259 [debug] [Thread-1 (]: finished collecting timing info
[0m19:26:22.261518 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:26:22.263273 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:26:22.264459 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:26:22.264721 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m19:26:22.264926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:26:22.273986 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:26:22.274749 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:26:22.275033 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m19:26:22.284337 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:26:22.286130 [debug] [Thread-1 (]: finished collecting timing info
[0m19:26:22.286448 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m19:26:22.286862 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m19:26:22.287503 [info ] [Thread-1 (]: 3 of 12 PASS not_null_below_depletion_level_name ............................... [[32mPASS[0m in 0.03s]
[0m19:26:22.288093 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:26:22.288474 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:26:22.288845 [info ] [Thread-1 (]: 4 of 12 START test not_null_below_depletion_level_variant ...................... [RUN]
[0m19:26:22.289321 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:26:22.289634 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:26:22.289923 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:26:22.293308 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:26:22.294734 [debug] [Thread-1 (]: finished collecting timing info
[0m19:26:22.295006 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:26:22.296649 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:26:22.297681 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:26:22.297921 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m19:26:22.298140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:26:22.306299 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:26:22.307061 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:26:22.307405 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m19:26:22.313840 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:26:22.315477 [debug] [Thread-1 (]: finished collecting timing info
[0m19:26:22.316047 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m19:26:22.316593 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m19:26:22.317134 [info ] [Thread-1 (]: 4 of 12 PASS not_null_below_depletion_level_variant ............................ [[32mPASS[0m in 0.03s]
[0m19:26:22.317680 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:26:22.318118 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:26:22.318581 [info ] [Thread-1 (]: 5 of 12 START test not_null_hot_upsell_name .................................... [RUN]
[0m19:26:22.319166 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:26:22.319586 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:26:22.319842 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:26:22.323502 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:26:22.325638 [debug] [Thread-1 (]: finished collecting timing info
[0m19:26:22.326253 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:26:22.329300 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:26:22.330649 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:26:22.330946 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m19:26:22.331185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:26:22.337704 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:26:22.338174 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:26:22.338398 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m19:26:22.341801 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:26:22.343102 [debug] [Thread-1 (]: finished collecting timing info
[0m19:26:22.343359 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m19:26:22.343632 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m19:26:22.344057 [info ] [Thread-1 (]: 5 of 12 PASS not_null_hot_upsell_name .......................................... [[32mPASS[0m in 0.03s]
[0m19:26:22.344484 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:26:22.344869 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:26:22.345191 [info ] [Thread-1 (]: 6 of 12 START test not_null_hot_upsell_variant ................................. [RUN]
[0m19:26:22.345614 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:26:22.345894 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:26:22.346128 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:26:22.349204 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:26:22.350568 [debug] [Thread-1 (]: finished collecting timing info
[0m19:26:22.350843 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:26:22.352486 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:26:22.353804 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:26:22.354012 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m19:26:22.354221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:26:22.360949 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:26:22.361321 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:26:22.361629 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m19:26:22.369287 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:26:22.370837 [debug] [Thread-1 (]: finished collecting timing info
[0m19:26:22.371187 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m19:26:22.371581 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m19:26:22.372096 [info ] [Thread-1 (]: 6 of 12 PASS not_null_hot_upsell_variant ....................................... [[32mPASS[0m in 0.03s]
[0m19:26:22.372599 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:26:22.373168 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:26:22.373526 [info ] [Thread-1 (]: 7 of 12 START test not_null_priority_order_name ................................ [RUN]
[0m19:26:22.374118 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:26:22.374419 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:26:22.374659 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:26:22.377732 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:26:22.379301 [debug] [Thread-1 (]: finished collecting timing info
[0m19:26:22.379544 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:26:22.381132 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:26:22.382308 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:26:22.382512 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: BEGIN
[0m19:26:22.382712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:26:22.389234 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:26:22.389602 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:26:22.389829 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_name.6c35449027"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."priority_order"
where name is null



      
    ) dbt_internal_test
[0m19:26:22.393741 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:26:22.395112 [debug] [Thread-1 (]: finished collecting timing info
[0m19:26:22.395423 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: ROLLBACK
[0m19:26:22.395715 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: Close
[0m19:26:22.396148 [info ] [Thread-1 (]: 7 of 12 PASS not_null_priority_order_name ...................................... [[32mPASS[0m in 0.02s]
[0m19:26:22.396569 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:26:22.397001 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:26:22.397306 [info ] [Thread-1 (]: 8 of 12 START test not_null_priority_order_profit .............................. [RUN]
[0m19:26:22.397717 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:26:22.397985 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:26:22.398216 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:26:22.401358 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:26:22.402748 [debug] [Thread-1 (]: finished collecting timing info
[0m19:26:22.403027 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:26:22.404585 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:26:22.405485 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:26:22.405695 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: BEGIN
[0m19:26:22.405907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:26:22.412815 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:26:22.413283 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:26:22.413534 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_profit.229518def8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select profit
from "postgres"."public"."priority_order"
where profit is null



      
    ) dbt_internal_test
[0m19:26:22.420182 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:26:22.421671 [debug] [Thread-1 (]: finished collecting timing info
[0m19:26:22.421965 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: ROLLBACK
[0m19:26:22.422306 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: Close
[0m19:26:22.422739 [info ] [Thread-1 (]: 8 of 12 PASS not_null_priority_order_profit .................................... [[32mPASS[0m in 0.03s]
[0m19:26:22.423183 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:26:22.423622 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:26:22.423941 [info ] [Thread-1 (]: 9 of 12 START test not_null_priority_order_variant ............................. [RUN]
[0m19:26:22.424371 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:26:22.424626 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:26:22.424854 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:26:22.427917 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:26:22.429547 [debug] [Thread-1 (]: finished collecting timing info
[0m19:26:22.429785 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:26:22.431455 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:26:22.432428 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:26:22.432633 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: BEGIN
[0m19:26:22.432838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:26:22.439157 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:26:22.439516 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:26:22.439726 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."priority_order"
where variant is null



      
    ) dbt_internal_test
[0m19:26:22.444748 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:26:22.446181 [debug] [Thread-1 (]: finished collecting timing info
[0m19:26:22.446428 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: ROLLBACK
[0m19:26:22.446736 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: Close
[0m19:26:22.447182 [info ] [Thread-1 (]: 9 of 12 PASS not_null_priority_order_variant ................................... [[32mPASS[0m in 0.02s]
[0m19:26:22.447600 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:26:22.448042 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:26:22.448375 [info ] [Thread-1 (]: 10 of 12 START test not_null_underselling_product_specs_name ................... [RUN]
[0m19:26:22.448827 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:26:22.449117 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:26:22.449346 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:26:22.452491 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:26:22.454040 [debug] [Thread-1 (]: finished collecting timing info
[0m19:26:22.454283 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:26:22.455866 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:26:22.457009 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:26:22.457216 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: BEGIN
[0m19:26:22.457410 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:26:22.463660 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:26:22.464034 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:26:22.464259 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."underselling_product_specs"
where name is null



      
    ) dbt_internal_test
[0m19:26:22.487912 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m19:26:22.489449 [debug] [Thread-1 (]: finished collecting timing info
[0m19:26:22.489744 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: ROLLBACK
[0m19:26:22.490124 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: Close
[0m19:26:22.490577 [info ] [Thread-1 (]: 10 of 12 PASS not_null_underselling_product_specs_name ......................... [[32mPASS[0m in 0.04s]
[0m19:26:22.491087 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:26:22.491533 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:26:22.491849 [info ] [Thread-1 (]: 11 of 12 START test not_null_underselling_product_specs_stock_depletion_ratio .. [RUN]
[0m19:26:22.492311 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:26:22.492578 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:26:22.492809 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:26:22.496899 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:26:22.498020 [debug] [Thread-1 (]: finished collecting timing info
[0m19:26:22.498257 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:26:22.499759 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:26:22.500530 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:26:22.500745 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: BEGIN
[0m19:26:22.500961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:26:22.507118 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:26:22.507475 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:26:22.507685 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_depletion_ratio
from "postgres"."public"."underselling_product_specs"
where stock_depletion_ratio is null



      
    ) dbt_internal_test
[0m19:26:22.528460 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m19:26:22.529986 [debug] [Thread-1 (]: finished collecting timing info
[0m19:26:22.530289 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: ROLLBACK
[0m19:26:22.530621 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: Close
[0m19:26:22.531078 [info ] [Thread-1 (]: 11 of 12 PASS not_null_underselling_product_specs_stock_depletion_ratio ........ [[32mPASS[0m in 0.04s]
[0m19:26:22.531504 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:26:22.532047 [debug] [Thread-1 (]: Began running node test.jaffle_shop.underselling_specs_test.fda95ee712
[0m19:26:22.532357 [info ] [Thread-1 (]: 12 of 12 START test underselling_specs_test .................................... [RUN]
[0m19:26:22.532808 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.underselling_specs_test.fda95ee712"
[0m19:26:22.533083 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.underselling_specs_test.fda95ee712
[0m19:26:22.533329 [debug] [Thread-1 (]: Compiling test.jaffle_shop.underselling_specs_test.fda95ee712
[0m19:26:22.536537 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.underselling_specs_test.fda95ee712"
[0m19:26:22.537898 [debug] [Thread-1 (]: finished collecting timing info
[0m19:26:22.538123 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.underselling_specs_test.fda95ee712
[0m19:26:22.539714 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.underselling_specs_test.fda95ee712"
[0m19:26:22.540787 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.underselling_specs_test.fda95ee712"
[0m19:26:22.541035 [debug] [Thread-1 (]: On test.jaffle_shop.underselling_specs_test.fda95ee712: BEGIN
[0m19:26:22.541230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:26:22.547723 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:26:22.548105 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.underselling_specs_test.fda95ee712"
[0m19:26:22.548345 [debug] [Thread-1 (]: On test.jaffle_shop.underselling_specs_test.fda95ee712: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.underselling_specs_test.fda95ee712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select 
from "postgres"."public"."underselling_product_specs"
where  is null



      
    ) dbt_internal_test
[0m19:26:22.549225 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "null"
LINE 15: where  is null
                   ^

[0m19:26:22.549489 [debug] [Thread-1 (]: On test.jaffle_shop.underselling_specs_test.fda95ee712: ROLLBACK
[0m19:26:22.549988 [debug] [Thread-1 (]: finished collecting timing info
[0m19:26:22.550223 [debug] [Thread-1 (]: On test.jaffle_shop.underselling_specs_test.fda95ee712: Close
[0m19:26:22.550750 [debug] [Thread-1 (]: Database Error in test underselling_specs_test (models/underselling_product_specs/underselling_product_specs_tests.yml)
  syntax error at or near "null"
  LINE 15: where  is null
                     ^
  compiled SQL at target/run/jaffle_shop/models/underselling_product_specs/underselling_product_specs_tests.yml/underselling_specs_test.sql
[0m19:26:22.551128 [error] [Thread-1 (]: 12 of 12 ERROR underselling_specs_test ......................................... [[31mERROR[0m in 0.02s]
[0m19:26:22.551601 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.underselling_specs_test.fda95ee712
[0m19:28:36.650378 [debug] [Thread-2 (]: SQL status: SELECT 1 in 134.42 seconds
[0m19:28:36.664588 [debug] [Thread-2 (]: finished collecting timing info
[0m19:28:36.665198 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m19:28:36.665919 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m19:28:36.675352 [error] [Thread-2 (]: 2 of 12 FAIL 1 new_arrival_stock_depletion_test_hot_upsell_ .................... [[31mFAIL 1[0m in 134.50s]
[0m19:28:36.679188 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:28:36.697124 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:28:36.697895 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:36.698189 [debug] [MainThread]: On master: BEGIN
[0m19:28:36.698566 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:28:36.710746 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m19:28:36.711406 [debug] [MainThread]: On master: COMMIT
[0m19:28:36.711720 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:36.711970 [debug] [MainThread]: On master: COMMIT
[0m19:28:36.712361 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:28:36.712636 [debug] [MainThread]: On master: Close
[0m19:28:36.714125 [info ] [MainThread]: 
[0m19:28:36.714657 [info ] [MainThread]: Finished running 12 tests in 0 hours 2 minutes and 14.64 seconds (134.64s).
[0m19:28:36.715109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:28:36.715480 [debug] [MainThread]: Connection 'test.jaffle_shop.underselling_specs_test.fda95ee712' was properly closed.
[0m19:28:36.715693 [debug] [MainThread]: Connection 'test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38' was properly closed.
[0m19:28:36.729674 [info ] [MainThread]: 
[0m19:28:36.730152 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:28:36.730667 [info ] [MainThread]: 
[0m19:28:36.731064 [error] [MainThread]: [33mDatabase Error in test underselling_specs_test (models/underselling_product_specs/underselling_product_specs_tests.yml)[0m
[0m19:28:36.731474 [error] [MainThread]:   syntax error at or near "null"
[0m19:28:36.731820 [error] [MainThread]:   LINE 15: where  is null
[0m19:28:36.732179 [error] [MainThread]:                      ^
[0m19:28:36.732496 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/underselling_product_specs/underselling_product_specs_tests.yml/underselling_specs_test.sql
[0m19:28:36.732829 [info ] [MainThread]: 
[0m19:28:36.733194 [error] [MainThread]: [31mFailure in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)[0m
[0m19:28:36.733541 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m19:28:36.733841 [info ] [MainThread]: 
[0m19:28:36.734185 [info ] [MainThread]:   compiled SQL at target/compiled/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m19:28:36.734582 [info ] [MainThread]: 
[0m19:28:36.734903 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=2 SKIP=0 TOTAL=12
[0m19:28:36.735885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1c880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99e1780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99e9bd0>]}


============================== 2024-07-14 19:28:40.184593 | 86402d0b-d345-4c0b-b810-95922ddbecd9 ==============================
[0m19:28:40.184909 [info ] [MainThread]: Running with dbt=1.2.0
[0m19:28:40.214277 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:28:40.214853 [debug] [MainThread]: Tracking: tracking
[0m19:28:40.229776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2dd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2cc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2fe80>]}
[0m19:28:40.289041 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:28:40.289778 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://macros/underselling_specs_test.sql
[0m19:28:40.290127 [debug] [MainThread]: Parsing macros/underselling_specs_test.sql
[0m19:28:40.309155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86402d0b-d345-4c0b-b810-95922ddbecd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99f00d0>]}
[0m19:28:40.325760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86402d0b-d345-4c0b-b810-95922ddbecd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae5480>]}
[0m19:28:40.326497 [info ] [MainThread]: Found 4 models, 12 tests, 2 snapshots, 0 analyses, 259 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:28:40.327071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86402d0b-d345-4c0b-b810-95922ddbecd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b72440>]}
[0m19:28:40.331287 [info ] [MainThread]: 
[0m19:28:40.332612 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:28:40.336056 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m19:28:40.344618 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:28:40.344932 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:28:40.345187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:40.391956 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m19:28:40.392509 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:28:40.392761 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:28:40.396852 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m19:28:40.398817 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:28:40.399246 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:28:40.403981 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:40.404301 [debug] [MainThread]: On master: BEGIN
[0m19:28:40.404535 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:28:40.411294 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m19:28:40.411654 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:40.411847 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:28:40.416158 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m19:28:40.417516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86402d0b-d345-4c0b-b810-95922ddbecd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b83e80>]}
[0m19:28:40.417851 [debug] [MainThread]: On master: ROLLBACK
[0m19:28:40.418152 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:40.418415 [debug] [MainThread]: On master: BEGIN
[0m19:28:40.418823 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:28:40.419091 [debug] [MainThread]: On master: COMMIT
[0m19:28:40.419330 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:40.419573 [debug] [MainThread]: On master: COMMIT
[0m19:28:40.419862 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:28:40.420093 [debug] [MainThread]: On master: Close
[0m19:28:40.420509 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:28:40.420836 [info ] [MainThread]: 
[0m19:28:40.425085 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:28:40.425253 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:28:40.425556 [info ] [Thread-1 (]: 1 of 12 START test below_depletion_level_tests_below_depletion_level_ .......... [RUN]
[0m19:28:40.425916 [info ] [Thread-2 (]: 2 of 12 START test new_arrival_stock_depletion_test_hot_upsell_ ................ [RUN]
[0m19:28:40.426447 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:28:40.426938 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:28:40.427393 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:28:40.427680 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:28:40.427960 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:28:40.428199 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:28:40.435466 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:28:40.439931 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:28:40.442691 [debug] [Thread-1 (]: finished collecting timing info
[0m19:28:40.442803 [debug] [Thread-2 (]: finished collecting timing info
[0m19:28:40.443346 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:28:40.443600 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:28:40.459802 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:28:40.461553 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:28:40.465085 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:28:40.465384 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:28:40.465681 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m19:28:40.465987 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m19:28:40.466223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:40.466484 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:28:40.473517 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m19:28:40.473721 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:28:40.473976 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:28:40.474238 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:28:40.474486 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT DISTINCT rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, 
                        (ruv.msrp - rupu.price) AS profit_margin
        FROM "postgres"."public"."rugs_usa_variant" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        /* joining on model as none of these should show. doing an inner join for this purpose to test */
        JOIN "postgres"."public"."hot_upsell" model on model.name = rup.name and model.variant = ruv.variant and model.size = rupu.size and model.shape = rupu.shape and model.type = rupu.type
        ORDER BY profit_margin DESC
    )
    SELECT 
        count(*) as errors
    FROM test_data
    having count(*) > 0

      
    ) dbt_internal_test
[0m19:28:40.474707 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m19:28:40.494050 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m19:28:40.498298 [debug] [Thread-1 (]: finished collecting timing info
[0m19:28:40.498831 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m19:28:40.499330 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m19:28:40.500149 [info ] [Thread-1 (]: 1 of 12 PASS below_depletion_level_tests_below_depletion_level_ ................ [[32mPASS[0m in 0.07s]
[0m19:28:40.501334 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:28:40.501862 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:28:40.502333 [info ] [Thread-1 (]: 3 of 12 START test not_null_below_depletion_level_name ......................... [RUN]
[0m19:28:40.502908 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:28:40.503263 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:28:40.503566 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:28:40.513084 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:28:40.515008 [debug] [Thread-1 (]: finished collecting timing info
[0m19:28:40.515486 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:28:40.517532 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:28:40.519112 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:28:40.519408 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m19:28:40.519647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:40.527543 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:28:40.528111 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:28:40.528429 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m19:28:40.532066 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:28:40.533745 [debug] [Thread-1 (]: finished collecting timing info
[0m19:28:40.534073 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m19:28:40.534450 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m19:28:40.534938 [info ] [Thread-1 (]: 3 of 12 PASS not_null_below_depletion_level_name ............................... [[32mPASS[0m in 0.03s]
[0m19:28:40.535424 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:28:40.535911 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:28:40.536241 [info ] [Thread-1 (]: 4 of 12 START test not_null_below_depletion_level_variant ...................... [RUN]
[0m19:28:40.536691 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:28:40.536982 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:28:40.537230 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:28:40.540700 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:28:40.541963 [debug] [Thread-1 (]: finished collecting timing info
[0m19:28:40.542190 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:28:40.543887 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:28:40.544767 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:28:40.544970 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m19:28:40.545190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:40.552115 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:28:40.552593 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:28:40.552831 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m19:28:40.558659 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:28:40.560167 [debug] [Thread-1 (]: finished collecting timing info
[0m19:28:40.560460 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m19:28:40.560765 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m19:28:40.561182 [info ] [Thread-1 (]: 4 of 12 PASS not_null_below_depletion_level_variant ............................ [[32mPASS[0m in 0.02s]
[0m19:28:40.561619 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:28:40.562064 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:28:40.562353 [info ] [Thread-1 (]: 5 of 12 START test not_null_hot_upsell_name .................................... [RUN]
[0m19:28:40.562815 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:28:40.563130 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:28:40.563411 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:28:40.566659 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:28:40.568009 [debug] [Thread-1 (]: finished collecting timing info
[0m19:28:40.568291 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:28:40.570003 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:28:40.571059 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:28:40.571330 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m19:28:40.571530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:40.581625 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:28:40.582529 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:28:40.582849 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m19:28:40.586986 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:28:40.589081 [debug] [Thread-1 (]: finished collecting timing info
[0m19:28:40.589451 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m19:28:40.589816 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m19:28:40.590376 [info ] [Thread-1 (]: 5 of 12 PASS not_null_hot_upsell_name .......................................... [[32mPASS[0m in 0.03s]
[0m19:28:40.591035 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:28:40.591608 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:28:40.592010 [info ] [Thread-1 (]: 6 of 12 START test not_null_hot_upsell_variant ................................. [RUN]
[0m19:28:40.592563 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:28:40.592875 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:28:40.593122 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:28:40.597165 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:28:40.598842 [debug] [Thread-1 (]: finished collecting timing info
[0m19:28:40.599176 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:28:40.601250 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:28:40.602404 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:28:40.602651 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m19:28:40.602852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:40.613346 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:28:40.614157 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:28:40.614589 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m19:28:40.625277 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:28:40.628144 [debug] [Thread-1 (]: finished collecting timing info
[0m19:28:40.628635 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m19:28:40.629103 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m19:28:40.629826 [info ] [Thread-1 (]: 6 of 12 PASS not_null_hot_upsell_variant ....................................... [[32mPASS[0m in 0.04s]
[0m19:28:40.630944 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:28:40.631603 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:28:40.632080 [info ] [Thread-1 (]: 7 of 12 START test not_null_priority_order_name ................................ [RUN]
[0m19:28:40.632832 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:28:40.633555 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:28:40.633847 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:28:40.638858 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:28:40.640786 [debug] [Thread-1 (]: finished collecting timing info
[0m19:28:40.641218 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:28:40.643199 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:28:40.644790 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:28:40.645006 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: BEGIN
[0m19:28:40.645219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:40.652598 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:28:40.653118 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:28:40.653425 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_name.6c35449027"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."priority_order"
where name is null



      
    ) dbt_internal_test
[0m19:28:40.657647 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:28:40.659041 [debug] [Thread-1 (]: finished collecting timing info
[0m19:28:40.659377 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: ROLLBACK
[0m19:28:40.659706 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: Close
[0m19:28:40.660166 [info ] [Thread-1 (]: 7 of 12 PASS not_null_priority_order_name ...................................... [[32mPASS[0m in 0.03s]
[0m19:28:40.660876 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:28:40.661321 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:28:40.661612 [info ] [Thread-1 (]: 8 of 12 START test not_null_priority_order_profit .............................. [RUN]
[0m19:28:40.662043 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:28:40.662336 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:28:40.662566 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:28:40.665674 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:28:40.666834 [debug] [Thread-1 (]: finished collecting timing info
[0m19:28:40.667055 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:28:40.669671 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:28:40.671125 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:28:40.671328 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: BEGIN
[0m19:28:40.671595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:40.678943 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:28:40.679443 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:28:40.680086 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_profit.229518def8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select profit
from "postgres"."public"."priority_order"
where profit is null



      
    ) dbt_internal_test
[0m19:28:40.686459 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:28:40.688060 [debug] [Thread-1 (]: finished collecting timing info
[0m19:28:40.688365 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: ROLLBACK
[0m19:28:40.688719 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: Close
[0m19:28:40.689163 [info ] [Thread-1 (]: 8 of 12 PASS not_null_priority_order_profit .................................... [[32mPASS[0m in 0.03s]
[0m19:28:40.689638 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:28:40.690100 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:28:40.690419 [info ] [Thread-1 (]: 9 of 12 START test not_null_priority_order_variant ............................. [RUN]
[0m19:28:40.690862 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:28:40.691118 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:28:40.691382 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:28:40.694640 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:28:40.695921 [debug] [Thread-1 (]: finished collecting timing info
[0m19:28:40.696165 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:28:40.697798 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:28:40.698840 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:28:40.699045 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: BEGIN
[0m19:28:40.699232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:40.705772 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:28:40.706131 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:28:40.706368 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."priority_order"
where variant is null



      
    ) dbt_internal_test
[0m19:28:40.712150 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:28:40.713592 [debug] [Thread-1 (]: finished collecting timing info
[0m19:28:40.713884 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: ROLLBACK
[0m19:28:40.714227 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: Close
[0m19:28:40.714661 [info ] [Thread-1 (]: 9 of 12 PASS not_null_priority_order_variant ................................... [[32mPASS[0m in 0.02s]
[0m19:28:40.715094 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:28:40.715605 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:28:40.715901 [info ] [Thread-1 (]: 10 of 12 START test not_null_underselling_product_specs_name ................... [RUN]
[0m19:28:40.716336 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:28:40.716614 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:28:40.716838 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:28:40.719936 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:28:40.721524 [debug] [Thread-1 (]: finished collecting timing info
[0m19:28:40.721767 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:28:40.723332 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:28:40.724393 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:28:40.724605 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: BEGIN
[0m19:28:40.724817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:40.731260 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:28:40.731614 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:28:40.731841 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."underselling_product_specs"
where name is null



      
    ) dbt_internal_test
[0m19:28:40.754818 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m19:28:40.756721 [debug] [Thread-1 (]: finished collecting timing info
[0m19:28:40.757113 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: ROLLBACK
[0m19:28:40.757542 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: Close
[0m19:28:40.758184 [info ] [Thread-1 (]: 10 of 12 PASS not_null_underselling_product_specs_name ......................... [[32mPASS[0m in 0.04s]
[0m19:28:40.759072 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:28:40.759956 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:28:40.760460 [info ] [Thread-1 (]: 11 of 12 START test not_null_underselling_product_specs_stock_depletion_ratio .. [RUN]
[0m19:28:40.761269 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:28:40.762127 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:28:40.762586 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:28:40.767833 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:28:40.769261 [debug] [Thread-1 (]: finished collecting timing info
[0m19:28:40.769533 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:28:40.771373 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:28:40.773134 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:28:40.773453 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: BEGIN
[0m19:28:40.773653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:40.781110 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:28:40.781587 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:28:40.781868 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_depletion_ratio
from "postgres"."public"."underselling_product_specs"
where stock_depletion_ratio is null



      
    ) dbt_internal_test
[0m19:28:40.802917 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m19:28:40.804405 [debug] [Thread-1 (]: finished collecting timing info
[0m19:28:40.805462 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: ROLLBACK
[0m19:28:40.807343 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: Close
[0m19:28:40.807850 [info ] [Thread-1 (]: 11 of 12 PASS not_null_underselling_product_specs_stock_depletion_ratio ........ [[32mPASS[0m in 0.05s]
[0m19:28:40.808342 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:28:40.809030 [debug] [Thread-1 (]: Began running node test.jaffle_shop.underselling_specs_test.fda95ee712
[0m19:28:40.809448 [info ] [Thread-1 (]: 12 of 12 START test underselling_specs_test .................................... [RUN]
[0m19:28:40.809929 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.underselling_specs_test.fda95ee712"
[0m19:28:40.810382 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.underselling_specs_test.fda95ee712
[0m19:28:40.810624 [debug] [Thread-1 (]: Compiling test.jaffle_shop.underselling_specs_test.fda95ee712
[0m19:28:40.813787 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.underselling_specs_test.fda95ee712"
[0m19:28:40.815107 [debug] [Thread-1 (]: finished collecting timing info
[0m19:28:40.815362 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.underselling_specs_test.fda95ee712
[0m19:28:40.816960 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.underselling_specs_test.fda95ee712"
[0m19:28:40.818161 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.underselling_specs_test.fda95ee712"
[0m19:28:40.818483 [debug] [Thread-1 (]: On test.jaffle_shop.underselling_specs_test.fda95ee712: BEGIN
[0m19:28:40.818679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:40.825019 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:28:40.825381 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.underselling_specs_test.fda95ee712"
[0m19:28:40.825628 [debug] [Thread-1 (]: On test.jaffle_shop.underselling_specs_test.fda95ee712: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.underselling_specs_test.fda95ee712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select 
from "postgres"."public"."underselling_product_specs"
where  is null



      
    ) dbt_internal_test
[0m19:28:40.826724 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "null"
LINE 15: where  is null
                   ^

[0m19:28:40.826989 [debug] [Thread-1 (]: On test.jaffle_shop.underselling_specs_test.fda95ee712: ROLLBACK
[0m19:28:40.827520 [debug] [Thread-1 (]: finished collecting timing info
[0m19:28:40.827756 [debug] [Thread-1 (]: On test.jaffle_shop.underselling_specs_test.fda95ee712: Close
[0m19:28:40.828223 [debug] [Thread-1 (]: Database Error in test underselling_specs_test (models/underselling_product_specs/underselling_product_specs_tests.yml)
  syntax error at or near "null"
  LINE 15: where  is null
                     ^
  compiled SQL at target/run/jaffle_shop/models/underselling_product_specs/underselling_product_specs_tests.yml/underselling_specs_test.sql
[0m19:28:40.828652 [error] [Thread-1 (]: 12 of 12 ERROR underselling_specs_test ......................................... [[31mERROR[0m in 0.02s]
[0m19:28:40.829088 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.underselling_specs_test.fda95ee712
[0m19:30:53.221226 [debug] [Thread-2 (]: SQL status: SELECT 1 in 132.75 seconds
[0m19:30:53.257271 [debug] [Thread-2 (]: finished collecting timing info
[0m19:30:53.257951 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m19:30:53.258940 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m19:30:53.261042 [error] [Thread-2 (]: 2 of 12 FAIL 1 new_arrival_stock_depletion_test_hot_upsell_ .................... [[31mFAIL 1[0m in 132.83s]
[0m19:30:53.263161 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:30:53.269724 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:30:53.270229 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:53.270489 [debug] [MainThread]: On master: BEGIN
[0m19:30:53.270739 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:30:53.281271 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m19:30:53.281750 [debug] [MainThread]: On master: COMMIT
[0m19:30:53.282014 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:53.282243 [debug] [MainThread]: On master: COMMIT
[0m19:30:53.282580 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:30:53.282859 [debug] [MainThread]: On master: Close
[0m19:30:53.283980 [info ] [MainThread]: 
[0m19:30:53.284397 [info ] [MainThread]: Finished running 12 tests in 0 hours 2 minutes and 12.95 seconds (132.95s).
[0m19:30:53.284772 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:30:53.285019 [debug] [MainThread]: Connection 'test.jaffle_shop.underselling_specs_test.fda95ee712' was properly closed.
[0m19:30:53.285244 [debug] [MainThread]: Connection 'test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38' was properly closed.
[0m19:30:53.312568 [info ] [MainThread]: 
[0m19:30:53.313115 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:30:53.314081 [info ] [MainThread]: 
[0m19:30:53.314762 [error] [MainThread]: [33mDatabase Error in test underselling_specs_test (models/underselling_product_specs/underselling_product_specs_tests.yml)[0m
[0m19:30:53.315301 [error] [MainThread]:   syntax error at or near "null"
[0m19:30:53.316137 [error] [MainThread]:   LINE 15: where  is null
[0m19:30:53.316965 [error] [MainThread]:                      ^
[0m19:30:53.317370 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/underselling_product_specs/underselling_product_specs_tests.yml/underselling_specs_test.sql
[0m19:30:53.317722 [info ] [MainThread]: 
[0m19:30:53.318114 [error] [MainThread]: [31mFailure in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)[0m
[0m19:30:53.318480 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m19:30:53.318858 [info ] [MainThread]: 
[0m19:30:53.319184 [info ] [MainThread]:   compiled SQL at target/compiled/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m19:30:53.319549 [info ] [MainThread]: 
[0m19:30:53.319836 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=2 SKIP=0 TOTAL=12
[0m19:30:53.320924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a82170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a83cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a81780>]}


============================== 2024-07-14 19:38:00.271847 | 5dd30050-dcf5-47be-bec7-d3fe4a3d556c ==============================
[0m19:38:00.272284 [info ] [MainThread]: Running with dbt=1.2.0
[0m19:38:00.298081 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:38:00.298842 [debug] [MainThread]: Tracking: tracking
[0m19:38:00.317991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2a2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c282e0>]}
[0m19:38:00.524086 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:38:00.524550 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:38:00.531660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dd30050-dcf5-47be-bec7-d3fe4a3d556c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99d00d0>]}
[0m19:38:00.545976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dd30050-dcf5-47be-bec7-d3fe4a3d556c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae5360>]}
[0m19:38:00.546916 [info ] [MainThread]: Found 4 models, 12 tests, 2 snapshots, 0 analyses, 259 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:38:00.547579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dd30050-dcf5-47be-bec7-d3fe4a3d556c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae52a0>]}
[0m19:38:00.556872 [info ] [MainThread]: 
[0m19:38:00.558936 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:38:00.565909 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m19:38:00.579972 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:38:00.580613 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:38:00.580968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:38:00.653895 [debug] [ThreadPool]: SQL status: BEGIN in 0.07 seconds
[0m19:38:00.654715 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:38:00.655625 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:38:00.663498 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.01 seconds
[0m19:38:00.667569 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:38:00.668249 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:38:00.676389 [debug] [MainThread]: Using postgres connection "master"
[0m19:38:00.677123 [debug] [MainThread]: On master: BEGIN
[0m19:38:00.677475 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:38:00.693627 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m19:38:00.694209 [debug] [MainThread]: Using postgres connection "master"
[0m19:38:00.694550 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:38:00.700240 [debug] [MainThread]: SQL status: SELECT 11 in 0.01 seconds
[0m19:38:00.703073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dd30050-dcf5-47be-bec7-d3fe4a3d556c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b83b80>]}
[0m19:38:00.704931 [debug] [MainThread]: On master: ROLLBACK
[0m19:38:00.705549 [debug] [MainThread]: Using postgres connection "master"
[0m19:38:00.705861 [debug] [MainThread]: On master: BEGIN
[0m19:38:00.706579 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:38:00.707645 [debug] [MainThread]: On master: COMMIT
[0m19:38:00.708364 [debug] [MainThread]: Using postgres connection "master"
[0m19:38:00.708655 [debug] [MainThread]: On master: COMMIT
[0m19:38:00.709091 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:38:00.709355 [debug] [MainThread]: On master: Close
[0m19:38:00.712501 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:38:00.713799 [info ] [MainThread]: 
[0m19:38:00.724860 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:38:00.725089 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:38:00.725491 [info ] [Thread-1 (]: 1 of 12 START test below_depletion_level_tests_below_depletion_level_ .......... [RUN]
[0m19:38:00.725890 [info ] [Thread-2 (]: 2 of 12 START test new_arrival_stock_depletion_test_hot_upsell_ ................ [RUN]
[0m19:38:00.726489 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:38:00.727261 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:38:00.727784 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:38:00.728075 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:38:00.728460 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:38:00.728717 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:38:00.737505 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:38:00.742554 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:38:00.746391 [debug] [Thread-1 (]: finished collecting timing info
[0m19:38:00.746644 [debug] [Thread-2 (]: finished collecting timing info
[0m19:38:00.746950 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:38:00.747280 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:38:00.764985 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:38:00.766774 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:38:00.769111 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:38:00.769239 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:38:00.769520 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m19:38:00.769908 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m19:38:00.770225 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:38:00.770615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:00.778997 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m19:38:00.779280 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:38:00.779653 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:38:00.780033 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:38:00.780554 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT DISTINCT rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, 
                        (ruv.msrp - rupu.price) AS profit_margin
        FROM "postgres"."public"."rugs_usa_variant" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        /* joining on model as none of these should show. doing an inner join for this purpose to test */
        JOIN "postgres"."public"."hot_upsell" model on model.name = rup.name and model.variant = ruv.variant and model.size = rupu.size and model.shape = rupu.shape and model.type = rupu.type
        ORDER BY profit_margin DESC
    )
    SELECT 
        count(*) as errors
    FROM test_data
    having count(*) > 0

      
    ) dbt_internal_test
[0m19:38:00.780826 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m19:38:00.807478 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m19:38:00.811457 [debug] [Thread-1 (]: finished collecting timing info
[0m19:38:00.811913 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m19:38:00.812306 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m19:38:00.812936 [info ] [Thread-1 (]: 1 of 12 PASS below_depletion_level_tests_below_depletion_level_ ................ [[32mPASS[0m in 0.09s]
[0m19:38:00.813740 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:38:00.814134 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:38:00.814512 [info ] [Thread-1 (]: 3 of 12 START test not_null_below_depletion_level_name ......................... [RUN]
[0m19:38:00.815039 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:38:00.815332 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:38:00.815587 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:38:00.823102 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:38:00.825605 [debug] [Thread-1 (]: finished collecting timing info
[0m19:38:00.826244 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:38:00.828355 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:38:00.830089 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:38:00.830402 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m19:38:00.830638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:00.838457 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:38:00.839146 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:38:00.839547 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m19:38:00.843762 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:38:00.845694 [debug] [Thread-1 (]: finished collecting timing info
[0m19:38:00.846068 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m19:38:00.846567 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m19:38:00.847418 [info ] [Thread-1 (]: 3 of 12 PASS not_null_below_depletion_level_name ............................... [[32mPASS[0m in 0.03s]
[0m19:38:00.848232 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:38:00.849078 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:38:00.849572 [info ] [Thread-1 (]: 4 of 12 START test not_null_below_depletion_level_variant ...................... [RUN]
[0m19:38:00.850327 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:38:00.850749 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:38:00.851049 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:38:00.856458 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:38:00.858331 [debug] [Thread-1 (]: finished collecting timing info
[0m19:38:00.858663 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:38:00.860847 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:38:00.862505 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:38:00.862779 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m19:38:00.862999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:00.870491 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:38:00.871440 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:38:00.871779 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m19:38:00.877918 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:38:00.879801 [debug] [Thread-1 (]: finished collecting timing info
[0m19:38:00.880134 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m19:38:00.880522 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m19:38:00.881030 [info ] [Thread-1 (]: 4 of 12 PASS not_null_below_depletion_level_variant ............................ [[32mPASS[0m in 0.03s]
[0m19:38:00.881510 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:38:00.881937 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:38:00.882213 [info ] [Thread-1 (]: 5 of 12 START test not_null_hot_upsell_name .................................... [RUN]
[0m19:38:00.882646 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:38:00.882913 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:38:00.883121 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:38:00.886383 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:38:00.887508 [debug] [Thread-1 (]: finished collecting timing info
[0m19:38:00.887783 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:38:00.890691 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:38:00.891917 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:38:00.892134 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m19:38:00.892388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:00.900097 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:38:00.900631 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:38:00.900874 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m19:38:00.905166 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:38:00.906755 [debug] [Thread-1 (]: finished collecting timing info
[0m19:38:00.907017 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m19:38:00.907300 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m19:38:00.907739 [info ] [Thread-1 (]: 5 of 12 PASS not_null_hot_upsell_name .......................................... [[32mPASS[0m in 0.03s]
[0m19:38:00.908187 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:38:00.908668 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:38:00.908935 [info ] [Thread-1 (]: 6 of 12 START test not_null_hot_upsell_variant ................................. [RUN]
[0m19:38:00.909383 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:38:00.909639 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:38:00.909856 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:38:00.913056 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:38:00.914227 [debug] [Thread-1 (]: finished collecting timing info
[0m19:38:00.914454 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:38:00.916044 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:38:00.916953 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:38:00.917161 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m19:38:00.917359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:00.924238 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:38:00.924818 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:38:00.925259 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m19:38:00.934343 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:38:00.936083 [debug] [Thread-1 (]: finished collecting timing info
[0m19:38:00.936533 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m19:38:00.936910 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m19:38:00.937503 [info ] [Thread-1 (]: 6 of 12 PASS not_null_hot_upsell_variant ....................................... [[32mPASS[0m in 0.03s]
[0m19:38:00.938146 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:38:00.938758 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:38:00.939045 [info ] [Thread-1 (]: 7 of 12 START test not_null_priority_order_name ................................ [RUN]
[0m19:38:00.939515 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:38:00.939898 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:38:00.940124 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:38:00.944174 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:38:00.946265 [debug] [Thread-1 (]: finished collecting timing info
[0m19:38:00.946567 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:38:00.948453 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:38:00.949895 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:38:00.950140 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: BEGIN
[0m19:38:00.950387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:00.958096 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:38:00.958672 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:38:00.958912 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_name.6c35449027"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."priority_order"
where name is null



      
    ) dbt_internal_test
[0m19:38:00.963066 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:38:00.964723 [debug] [Thread-1 (]: finished collecting timing info
[0m19:38:00.965046 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: ROLLBACK
[0m19:38:00.965448 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: Close
[0m19:38:00.966305 [info ] [Thread-1 (]: 7 of 12 PASS not_null_priority_order_name ...................................... [[32mPASS[0m in 0.03s]
[0m19:38:00.966926 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:38:00.967426 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:38:00.967719 [info ] [Thread-1 (]: 8 of 12 START test not_null_priority_order_profit .............................. [RUN]
[0m19:38:00.968176 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:38:00.968437 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:38:00.968649 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:38:00.971886 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:38:00.973097 [debug] [Thread-1 (]: finished collecting timing info
[0m19:38:00.973392 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:38:00.975214 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:38:00.976368 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:38:00.976612 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: BEGIN
[0m19:38:00.976837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:00.983822 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:38:00.984239 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:38:00.984514 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_profit.229518def8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select profit
from "postgres"."public"."priority_order"
where profit is null



      
    ) dbt_internal_test
[0m19:38:00.992324 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:38:00.993797 [debug] [Thread-1 (]: finished collecting timing info
[0m19:38:00.994065 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: ROLLBACK
[0m19:38:00.994390 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: Close
[0m19:38:00.994830 [info ] [Thread-1 (]: 8 of 12 PASS not_null_priority_order_profit .................................... [[32mPASS[0m in 0.03s]
[0m19:38:00.995781 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:38:00.996134 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:38:00.996422 [info ] [Thread-1 (]: 9 of 12 START test not_null_priority_order_variant ............................. [RUN]
[0m19:38:00.996835 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:38:00.997078 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:38:00.997321 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:38:01.000872 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:38:01.002054 [debug] [Thread-1 (]: finished collecting timing info
[0m19:38:01.002286 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:38:01.003979 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:38:01.005259 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:38:01.005519 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: BEGIN
[0m19:38:01.005720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:01.012768 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:38:01.013232 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:38:01.013665 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."priority_order"
where variant is null



      
    ) dbt_internal_test
[0m19:38:01.023349 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:38:01.025485 [debug] [Thread-1 (]: finished collecting timing info
[0m19:38:01.025877 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: ROLLBACK
[0m19:38:01.026381 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: Close
[0m19:38:01.026986 [info ] [Thread-1 (]: 9 of 12 PASS not_null_priority_order_variant ................................... [[32mPASS[0m in 0.03s]
[0m19:38:01.027861 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:38:01.028698 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:38:01.029038 [info ] [Thread-1 (]: 10 of 12 START test not_null_underselling_product_specs_name ................... [RUN]
[0m19:38:01.029703 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:38:01.030152 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:38:01.030444 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:38:01.040667 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:38:01.044274 [debug] [Thread-1 (]: finished collecting timing info
[0m19:38:01.045070 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:38:01.051708 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:38:01.058007 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:38:01.058896 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: BEGIN
[0m19:38:01.060605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:01.073299 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:38:01.074155 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:38:01.074599 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."underselling_product_specs"
where name is null



      
    ) dbt_internal_test
[0m19:38:01.115330 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.04 seconds
[0m19:38:01.118339 [debug] [Thread-1 (]: finished collecting timing info
[0m19:38:01.119647 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: ROLLBACK
[0m19:38:01.127909 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: Close
[0m19:38:01.138671 [info ] [Thread-1 (]: 10 of 12 PASS not_null_underselling_product_specs_name ......................... [[32mPASS[0m in 0.11s]
[0m19:38:01.145156 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:38:01.148099 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:38:01.155390 [info ] [Thread-1 (]: 11 of 12 START test not_null_underselling_product_specs_stock_depletion_ratio .. [RUN]
[0m19:38:01.157157 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:38:01.161000 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:38:01.176507 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:38:01.223244 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:38:01.224817 [debug] [Thread-1 (]: finished collecting timing info
[0m19:38:01.225165 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:38:01.227399 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:38:01.230025 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:38:01.230392 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: BEGIN
[0m19:38:01.230701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:01.240318 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:38:01.240876 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:38:01.241149 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_depletion_ratio
from "postgres"."public"."underselling_product_specs"
where stock_depletion_ratio is null



      
    ) dbt_internal_test
[0m19:38:01.287960 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.05 seconds
[0m19:38:01.290186 [debug] [Thread-1 (]: finished collecting timing info
[0m19:38:01.290583 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: ROLLBACK
[0m19:38:01.291053 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: Close
[0m19:38:01.291694 [info ] [Thread-1 (]: 11 of 12 PASS not_null_underselling_product_specs_stock_depletion_ratio ........ [[32mPASS[0m in 0.14s]
[0m19:38:01.292479 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:38:01.292978 [debug] [Thread-1 (]: Began running node test.jaffle_shop.underselling_specs_test.fda95ee712
[0m19:38:01.293292 [info ] [Thread-1 (]: 12 of 12 START test underselling_specs_test .................................... [RUN]
[0m19:38:01.293802 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.underselling_specs_test.fda95ee712"
[0m19:38:01.294034 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.underselling_specs_test.fda95ee712
[0m19:38:01.294273 [debug] [Thread-1 (]: Compiling test.jaffle_shop.underselling_specs_test.fda95ee712
[0m19:38:01.298181 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.underselling_specs_test.fda95ee712"
[0m19:38:01.300217 [debug] [Thread-1 (]: finished collecting timing info
[0m19:38:01.300639 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.underselling_specs_test.fda95ee712
[0m19:38:01.302870 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.underselling_specs_test.fda95ee712"
[0m19:38:01.304643 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.underselling_specs_test.fda95ee712"
[0m19:38:01.304938 [debug] [Thread-1 (]: On test.jaffle_shop.underselling_specs_test.fda95ee712: BEGIN
[0m19:38:01.305150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:01.313319 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:38:01.313789 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.underselling_specs_test.fda95ee712"
[0m19:38:01.314020 [debug] [Thread-1 (]: On test.jaffle_shop.underselling_specs_test.fda95ee712: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.underselling_specs_test.fda95ee712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select 
from "postgres"."public"."underselling_product_specs"
where  is null



      
    ) dbt_internal_test
[0m19:38:01.315261 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "null"
LINE 15: where  is null
                   ^

[0m19:38:01.315535 [debug] [Thread-1 (]: On test.jaffle_shop.underselling_specs_test.fda95ee712: ROLLBACK
[0m19:38:01.316007 [debug] [Thread-1 (]: finished collecting timing info
[0m19:38:01.317657 [debug] [Thread-1 (]: On test.jaffle_shop.underselling_specs_test.fda95ee712: Close
[0m19:38:01.318172 [debug] [Thread-1 (]: Database Error in test underselling_specs_test (models/underselling_product_specs/underselling_product_specs_tests.yml)
  syntax error at or near "null"
  LINE 15: where  is null
                     ^
  compiled SQL at target/run/jaffle_shop/models/underselling_product_specs/underselling_product_specs_tests.yml/underselling_specs_test.sql
[0m19:38:01.318663 [error] [Thread-1 (]: 12 of 12 ERROR underselling_specs_test ......................................... [[31mERROR[0m in 0.02s]
[0m19:38:01.319138 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.underselling_specs_test.fda95ee712
[0m19:52:36.693701 [debug] [Thread-2 (]: SQL status: SELECT 1 in 875.91 seconds
[0m19:52:36.712242 [debug] [Thread-2 (]: finished collecting timing info
[0m19:52:36.713091 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m19:52:36.714506 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m19:52:36.716808 [error] [Thread-2 (]: 2 of 12 FAIL 1 new_arrival_stock_depletion_test_hot_upsell_ .................... [[31mFAIL 1[0m in 875.99s]
[0m19:52:36.719642 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:52:36.739496 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:52:36.740167 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:36.740429 [debug] [MainThread]: On master: BEGIN
[0m19:52:36.740695 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:52:36.754190 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m19:52:36.754819 [debug] [MainThread]: On master: COMMIT
[0m19:52:36.755169 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:36.755424 [debug] [MainThread]: On master: COMMIT
[0m19:52:36.755770 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:52:36.756011 [debug] [MainThread]: On master: Close
[0m19:52:36.757809 [info ] [MainThread]: 
[0m19:52:36.758344 [info ] [MainThread]: Finished running 12 tests in 0 hours 14 minutes and 36.20 seconds (876.20s).
[0m19:52:36.758698 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:52:36.758911 [debug] [MainThread]: Connection 'test.jaffle_shop.underselling_specs_test.fda95ee712' was properly closed.
[0m19:52:36.759120 [debug] [MainThread]: Connection 'test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38' was properly closed.
[0m19:52:36.778184 [info ] [MainThread]: 
[0m19:52:36.778640 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:52:36.778991 [info ] [MainThread]: 
[0m19:52:36.779321 [error] [MainThread]: [33mDatabase Error in test underselling_specs_test (models/underselling_product_specs/underselling_product_specs_tests.yml)[0m
[0m19:52:36.779663 [error] [MainThread]:   syntax error at or near "null"
[0m19:52:36.779913 [error] [MainThread]:   LINE 15: where  is null
[0m19:52:36.780166 [error] [MainThread]:                      ^
[0m19:52:36.780429 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/underselling_product_specs/underselling_product_specs_tests.yml/underselling_specs_test.sql
[0m19:52:36.780680 [info ] [MainThread]: 
[0m19:52:36.780982 [error] [MainThread]: [31mFailure in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)[0m
[0m19:52:36.781284 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m19:52:36.781547 [info ] [MainThread]: 
[0m19:52:36.781811 [info ] [MainThread]:   compiled SQL at target/compiled/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m19:52:36.782095 [info ] [MainThread]: 
[0m19:52:36.782353 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=2 SKIP=0 TOTAL=12
[0m19:52:36.784496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae52d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a19810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a18250>]}


============================== 2024-07-14 19:52:42.479356 | af74972e-2112-4c41-9aac-07ff86cf18e3 ==============================
[0m19:52:42.479659 [info ] [MainThread]: Running with dbt=1.2.0
[0m19:52:42.506135 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:52:42.506551 [debug] [MainThread]: Tracking: tracking
[0m19:52:42.522127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c15d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c14c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c15930>]}
[0m19:52:42.581625 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:52:42.582324 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://macros/underselling_specs_test.sql
[0m19:52:42.583766 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://macros/upsell_test.sql
[0m19:52:42.584072 [debug] [MainThread]: Parsing macros/underselling_specs_test.sql
[0m19:52:42.586113 [debug] [MainThread]: Parsing macros/upsell_test.sql
[0m19:52:42.626788 [debug] [MainThread]: 1699: static parser successfully parsed hot_upsell/hot_upsell.sql
[0m19:52:42.669900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af74972e-2112-4c41-9aac-07ff86cf18e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a13ee0>]}
[0m19:52:42.680067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af74972e-2112-4c41-9aac-07ff86cf18e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b722c0>]}
[0m19:52:42.680481 [info ] [MainThread]: Found 4 models, 12 tests, 2 snapshots, 0 analyses, 259 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:52:42.680805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af74972e-2112-4c41-9aac-07ff86cf18e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b722f0>]}
[0m19:52:42.682787 [info ] [MainThread]: 
[0m19:52:42.683383 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:52:42.685541 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m19:52:42.693446 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:52:42.693748 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:52:42.693977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:52:42.747337 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m19:52:42.747929 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:52:42.748241 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:52:42.755753 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.01 seconds
[0m19:52:42.758247 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:52:42.758949 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:52:42.765500 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:42.766096 [debug] [MainThread]: On master: BEGIN
[0m19:52:42.766411 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:52:42.775269 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m19:52:42.775925 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:42.776193 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:52:42.781825 [debug] [MainThread]: SQL status: SELECT 11 in 0.01 seconds
[0m19:52:42.784063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af74972e-2112-4c41-9aac-07ff86cf18e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c15c60>]}
[0m19:52:42.784542 [debug] [MainThread]: On master: ROLLBACK
[0m19:52:42.784907 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:42.785148 [debug] [MainThread]: On master: BEGIN
[0m19:52:42.785546 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:52:42.785966 [debug] [MainThread]: On master: COMMIT
[0m19:52:42.786215 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:42.786434 [debug] [MainThread]: On master: COMMIT
[0m19:52:42.786739 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:52:42.786967 [debug] [MainThread]: On master: Close
[0m19:52:42.787441 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:52:42.787785 [info ] [MainThread]: 
[0m19:52:42.800390 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:52:42.800609 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:52:42.800975 [info ] [Thread-1 (]: 1 of 12 START test below_depletion_level_tests_below_depletion_level_ .......... [RUN]
[0m19:52:42.801429 [info ] [Thread-2 (]: 2 of 12 START test new_arrival_stock_depletion_test_hot_upsell_ ................ [RUN]
[0m19:52:42.802097 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:52:42.802841 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:52:42.803509 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:52:42.804308 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:52:42.805965 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:52:42.808140 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:52:42.821253 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:52:42.828324 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:52:42.837760 [debug] [Thread-1 (]: finished collecting timing info
[0m19:52:42.838696 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:52:42.839418 [debug] [Thread-2 (]: finished collecting timing info
[0m19:52:42.875502 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:52:42.876207 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:52:42.878216 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:52:42.880520 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:52:42.880692 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:52:42.880918 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m19:52:42.881165 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m19:52:42.881389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:42.881635 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:52:42.950703 [debug] [Thread-1 (]: SQL status: BEGIN in 0.07 seconds
[0m19:52:42.951888 [debug] [Thread-2 (]: SQL status: BEGIN in 0.07 seconds
[0m19:52:42.953023 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:52:42.953818 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:52:42.954652 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m19:52:42.962137 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT DISTINCT rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, 
                        (ruv.msrp - rupu.price) AS profit_margin
        FROM "postgres"."public"."rugs_usa_variant" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        /* joining on model as none of these should show. doing an inner join for this purpose to test */
        JOIN "postgres"."public"."hot_upsell" model on model.name = rup.name and model.variant = ruv.variant and model.size = rupu.size and model.shape = rupu.shape and model.type = rupu.type
        ORDER BY profit_margin DESC
    )
    SELECT 
        * as errors
    FROM test_data
    having count(*) > 0

      
    ) dbt_internal_test
[0m19:52:43.016320 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "as"
LINE 19:         * as errors
                   ^

[0m19:52:43.035926 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m19:52:43.047338 [debug] [Thread-2 (]: finished collecting timing info
[0m19:52:43.048832 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m19:52:43.079931 [debug] [Thread-2 (]: Database Error in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)
  syntax error at or near "as"
  LINE 19:         * as errors
                     ^
  compiled SQL at target/run/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m19:52:43.133597 [error] [Thread-2 (]: 2 of 12 ERROR new_arrival_stock_depletion_test_hot_upsell_ ..................... [[31mERROR[0m in 0.33s]
[0m19:52:43.137265 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:52:43.138870 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:52:43.141640 [info ] [Thread-2 (]: 3 of 12 START test not_null_below_depletion_level_name ......................... [RUN]
[0m19:52:43.143959 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:52:43.146645 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:52:43.182151 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:52:43.208620 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:52:43.208940 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.24 seconds
[0m19:52:43.215048 [debug] [Thread-1 (]: finished collecting timing info
[0m19:52:43.215491 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m19:52:43.215802 [debug] [Thread-2 (]: finished collecting timing info
[0m19:52:43.216089 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m19:52:43.216199 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:52:43.216744 [info ] [Thread-1 (]: 1 of 12 PASS below_depletion_level_tests_below_depletion_level_ ................ [[32mPASS[0m in 0.41s]
[0m19:52:43.219529 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:52:43.220085 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:52:43.221382 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:52:43.221899 [info ] [Thread-1 (]: 4 of 12 START test not_null_below_depletion_level_variant ...................... [RUN]
[0m19:52:43.222266 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:52:43.222723 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:52:43.224269 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m19:52:43.224534 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:52:43.224800 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:52:43.225072 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:52:43.229417 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:52:43.231302 [debug] [Thread-1 (]: finished collecting timing info
[0m19:52:43.231839 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:52:43.233884 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:52:43.234369 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m19:52:43.234833 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:52:43.235064 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m19:52:43.235281 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:52:43.239236 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m19:52:43.239530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:43.240543 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:52:43.242107 [debug] [Thread-2 (]: finished collecting timing info
[0m19:52:43.242787 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m19:52:43.243405 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m19:52:43.244710 [info ] [Thread-2 (]: 3 of 12 PASS not_null_below_depletion_level_name ............................... [[32mPASS[0m in 0.10s]
[0m19:52:43.246587 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:52:43.247064 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:52:43.247702 [info ] [Thread-2 (]: 5 of 12 START test not_null_hot_upsell_name .................................... [RUN]
[0m19:52:43.248454 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:52:43.249610 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:52:43.249964 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:52:43.250158 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:52:43.257100 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:52:43.257681 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:52:43.258636 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m19:52:43.259494 [debug] [Thread-2 (]: finished collecting timing info
[0m19:52:43.260122 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:52:43.263545 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:52:43.265575 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:52:43.266942 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m19:52:43.267219 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:52:43.267919 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:52:43.270504 [debug] [Thread-1 (]: finished collecting timing info
[0m19:52:43.271391 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m19:52:43.271839 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m19:52:43.272558 [info ] [Thread-1 (]: 4 of 12 PASS not_null_below_depletion_level_variant ............................ [[32mPASS[0m in 0.05s]
[0m19:52:43.274490 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:52:43.275073 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:52:43.276262 [info ] [Thread-1 (]: 6 of 12 START test not_null_hot_upsell_variant ................................. [RUN]
[0m19:52:43.277105 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:52:43.278501 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:52:43.279363 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m19:52:43.279621 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:52:43.280295 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:52:43.284311 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:52:43.284817 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m19:52:43.286903 [debug] [Thread-1 (]: finished collecting timing info
[0m19:52:43.287546 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:52:43.291996 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:52:43.294850 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:52:43.295401 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m19:52:43.295565 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:52:43.295823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:43.297650 [debug] [Thread-2 (]: finished collecting timing info
[0m19:52:43.298741 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m19:52:43.299627 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m19:52:43.300374 [info ] [Thread-2 (]: 5 of 12 PASS not_null_hot_upsell_name .......................................... [[32mPASS[0m in 0.05s]
[0m19:52:43.302392 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:52:43.303563 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:52:43.303913 [info ] [Thread-2 (]: 7 of 12 START test not_null_priority_order_name ................................ [RUN]
[0m19:52:43.304439 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:52:43.304975 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:52:43.305609 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:52:43.309310 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:52:43.309736 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:52:43.310144 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:52:43.310804 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m19:52:43.311210 [debug] [Thread-2 (]: finished collecting timing info
[0m19:52:43.311485 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:52:43.313392 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:52:43.314744 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:52:43.314978 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: BEGIN
[0m19:52:43.315261 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:52:43.318265 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:52:43.319658 [debug] [Thread-1 (]: finished collecting timing info
[0m19:52:43.319923 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m19:52:43.320196 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m19:52:43.320627 [info ] [Thread-1 (]: 6 of 12 PASS not_null_hot_upsell_variant ....................................... [[32mPASS[0m in 0.04s]
[0m19:52:43.321407 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:52:43.321892 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:52:43.322202 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m19:52:43.322348 [info ] [Thread-1 (]: 8 of 12 START test not_null_priority_order_profit .............................. [RUN]
[0m19:52:43.322582 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:52:43.323021 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:52:43.323222 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_name.6c35449027"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."priority_order"
where name is null



      
    ) dbt_internal_test
[0m19:52:43.323438 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:52:43.323826 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:52:43.327603 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:52:43.328141 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:52:43.330531 [debug] [Thread-2 (]: finished collecting timing info
[0m19:52:43.330998 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: ROLLBACK
[0m19:52:43.331108 [debug] [Thread-1 (]: finished collecting timing info
[0m19:52:43.331535 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:52:43.331629 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: Close
[0m19:52:43.333605 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:52:43.334356 [info ] [Thread-2 (]: 7 of 12 PASS not_null_priority_order_name ...................................... [[32mPASS[0m in 0.03s]
[0m19:52:43.335565 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:52:43.336158 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:52:43.336539 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:52:43.336707 [info ] [Thread-2 (]: 9 of 12 START test not_null_priority_order_variant ............................. [RUN]
[0m19:52:43.337072 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: BEGIN
[0m19:52:43.337799 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:52:43.338367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:43.338725 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:52:43.339575 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:52:43.343896 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:52:43.345330 [debug] [Thread-2 (]: finished collecting timing info
[0m19:52:43.345587 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:52:43.347426 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:52:43.347801 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:52:43.348341 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:52:43.348565 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_profit.229518def8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select profit
from "postgres"."public"."priority_order"
where profit is null



      
    ) dbt_internal_test
[0m19:52:43.348777 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:52:43.349134 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: BEGIN
[0m19:52:43.349340 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:52:43.354754 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:52:43.356384 [debug] [Thread-1 (]: finished collecting timing info
[0m19:52:43.356690 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m19:52:43.356813 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: ROLLBACK
[0m19:52:43.357074 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:52:43.357382 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: Close
[0m19:52:43.357459 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."priority_order"
where variant is null



      
    ) dbt_internal_test
[0m19:52:43.357878 [info ] [Thread-1 (]: 8 of 12 PASS not_null_priority_order_profit .................................... [[32mPASS[0m in 0.03s]
[0m19:52:43.358445 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:52:43.358843 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:52:43.359123 [info ] [Thread-1 (]: 10 of 12 START test not_null_underselling_product_specs_name ................... [RUN]
[0m19:52:43.359601 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:52:43.359822 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:52:43.360022 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:52:43.364364 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:52:43.364547 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:52:43.366143 [debug] [Thread-2 (]: finished collecting timing info
[0m19:52:43.366461 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: ROLLBACK
[0m19:52:43.366723 [debug] [Thread-1 (]: finished collecting timing info
[0m19:52:43.366976 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: Close
[0m19:52:43.367095 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:52:43.367725 [info ] [Thread-2 (]: 9 of 12 PASS not_null_priority_order_variant ................................... [[32mPASS[0m in 0.03s]
[0m19:52:43.369561 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:52:43.369993 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:52:43.370850 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:52:43.371153 [info ] [Thread-2 (]: 11 of 12 START test not_null_underselling_product_specs_stock_depletion_ratio .. [RUN]
[0m19:52:43.371409 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:52:43.371710 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:52:43.371898 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: BEGIN
[0m19:52:43.372141 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:52:43.372343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:43.372556 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:52:43.375966 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:52:43.377169 [debug] [Thread-2 (]: finished collecting timing info
[0m19:52:43.377619 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:52:43.379399 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:52:43.379724 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:52:43.380502 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:52:43.380925 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."underselling_product_specs"
where name is null



      
    ) dbt_internal_test
[0m19:52:43.381067 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:52:43.381411 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: BEGIN
[0m19:52:43.381619 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:52:43.388347 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m19:52:43.388754 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:52:43.388995 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_depletion_ratio
from "postgres"."public"."underselling_product_specs"
where stock_depletion_ratio is null



      
    ) dbt_internal_test
[0m19:52:43.411392 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m19:52:43.412915 [debug] [Thread-1 (]: finished collecting timing info
[0m19:52:43.413217 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: ROLLBACK
[0m19:52:43.413515 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: Close
[0m19:52:43.413974 [info ] [Thread-1 (]: 10 of 12 PASS not_null_underselling_product_specs_name ......................... [[32mPASS[0m in 0.05s]
[0m19:52:43.414434 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:52:43.414854 [debug] [Thread-1 (]: Began running node test.jaffle_shop.underselling_specs_test.fda95ee712
[0m19:52:43.415222 [info ] [Thread-1 (]: 12 of 12 START test underselling_specs_test .................................... [RUN]
[0m19:52:43.415678 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.underselling_specs_test.fda95ee712"
[0m19:52:43.415946 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.underselling_specs_test.fda95ee712
[0m19:52:43.416208 [debug] [Thread-1 (]: Compiling test.jaffle_shop.underselling_specs_test.fda95ee712
[0m19:52:43.419371 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.underselling_specs_test.fda95ee712"
[0m19:52:43.420638 [debug] [Thread-1 (]: finished collecting timing info
[0m19:52:43.421006 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.underselling_specs_test.fda95ee712
[0m19:52:43.422773 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.underselling_specs_test.fda95ee712"
[0m19:52:43.423009 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.03 seconds
[0m19:52:43.424668 [debug] [Thread-2 (]: finished collecting timing info
[0m19:52:43.424927 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: ROLLBACK
[0m19:52:43.426264 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.underselling_specs_test.fda95ee712"
[0m19:52:43.426469 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: Close
[0m19:52:43.426553 [debug] [Thread-1 (]: On test.jaffle_shop.underselling_specs_test.fda95ee712: BEGIN
[0m19:52:43.426980 [info ] [Thread-2 (]: 11 of 12 PASS not_null_underselling_product_specs_stock_depletion_ratio ........ [[32mPASS[0m in 0.06s]
[0m19:52:43.427225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:43.427627 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:52:43.433973 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:52:43.434388 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.underselling_specs_test.fda95ee712"
[0m19:52:43.434650 [debug] [Thread-1 (]: On test.jaffle_shop.underselling_specs_test.fda95ee712: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.underselling_specs_test.fda95ee712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select 
from "postgres"."public"."underselling_product_specs"
where  is null



      
    ) dbt_internal_test
[0m19:52:43.435056 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "null"
LINE 15: where  is null
                   ^

[0m19:52:43.435375 [debug] [Thread-1 (]: On test.jaffle_shop.underselling_specs_test.fda95ee712: ROLLBACK
[0m19:52:43.435747 [debug] [Thread-1 (]: finished collecting timing info
[0m19:52:43.435976 [debug] [Thread-1 (]: On test.jaffle_shop.underselling_specs_test.fda95ee712: Close
[0m19:52:43.436377 [debug] [Thread-1 (]: Database Error in test underselling_specs_test (models/underselling_product_specs/underselling_product_specs_tests.yml)
  syntax error at or near "null"
  LINE 15: where  is null
                     ^
  compiled SQL at target/run/jaffle_shop/models/underselling_product_specs/underselling_product_specs_tests.yml/underselling_specs_test.sql
[0m19:52:43.436958 [error] [Thread-1 (]: 12 of 12 ERROR underselling_specs_test ......................................... [[31mERROR[0m in 0.02s]
[0m19:52:43.437352 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.underselling_specs_test.fda95ee712
[0m19:52:43.440639 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:52:43.441434 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:43.441653 [debug] [MainThread]: On master: BEGIN
[0m19:52:43.441856 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:52:43.448507 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m19:52:43.448904 [debug] [MainThread]: On master: COMMIT
[0m19:52:43.449136 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:43.449372 [debug] [MainThread]: On master: COMMIT
[0m19:52:43.449660 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:52:43.449884 [debug] [MainThread]: On master: Close
[0m19:52:43.450843 [info ] [MainThread]: 
[0m19:52:43.451217 [info ] [MainThread]: Finished running 12 tests in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m19:52:43.451572 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:52:43.451832 [debug] [MainThread]: Connection 'test.jaffle_shop.underselling_specs_test.fda95ee712' was properly closed.
[0m19:52:43.452052 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785' was properly closed.
[0m19:52:43.460014 [info ] [MainThread]: 
[0m19:52:43.460382 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:52:43.460762 [info ] [MainThread]: 
[0m19:52:43.461113 [error] [MainThread]: [33mDatabase Error in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)[0m
[0m19:52:43.461403 [error] [MainThread]:   syntax error at or near "as"
[0m19:52:43.461717 [error] [MainThread]:   LINE 19:         * as errors
[0m19:52:43.461987 [error] [MainThread]:                      ^
[0m19:52:43.462249 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m19:52:43.462489 [info ] [MainThread]: 
[0m19:52:43.462737 [error] [MainThread]: [33mDatabase Error in test underselling_specs_test (models/underselling_product_specs/underselling_product_specs_tests.yml)[0m
[0m19:52:43.463032 [error] [MainThread]:   syntax error at or near "null"
[0m19:52:43.463287 [error] [MainThread]:   LINE 15: where  is null
[0m19:52:43.463536 [error] [MainThread]:                      ^
[0m19:52:43.463775 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/underselling_product_specs/underselling_product_specs_tests.yml/underselling_specs_test.sql
[0m19:52:43.464059 [info ] [MainThread]: 
[0m19:52:43.464362 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=2 SKIP=0 TOTAL=12
[0m19:52:43.465075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b72470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c59f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff88fb010>]}


============================== 2024-07-14 19:53:06.004068 | e8316914-2265-4b4e-8899-e5a193d6fec5 ==============================
[0m19:53:06.004375 [info ] [MainThread]: Running with dbt=1.2.0
[0m19:53:06.009913 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:53:06.010295 [debug] [MainThread]: Tracking: tracking
[0m19:53:06.026134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c17760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c17370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c16ef0>]}
[0m19:53:06.077597 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:53:06.078319 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://macros/upsell_test.sql
[0m19:53:06.078608 [debug] [MainThread]: Parsing macros/upsell_test.sql
[0m19:53:06.119520 [debug] [MainThread]: 1699: static parser successfully parsed hot_upsell/hot_upsell.sql
[0m19:53:06.160533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8316914-2265-4b4e-8899-e5a193d6fec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a1fee0>]}
[0m19:53:06.170747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8316914-2265-4b4e-8899-e5a193d6fec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bbc370>]}
[0m19:53:06.171164 [info ] [MainThread]: Found 4 models, 12 tests, 2 snapshots, 0 analyses, 259 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:53:06.171523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8316914-2265-4b4e-8899-e5a193d6fec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99c9870>]}
[0m19:53:06.173593 [info ] [MainThread]: 
[0m19:53:06.174188 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:53:06.176333 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m19:53:06.184709 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:53:06.185037 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:53:06.185263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:06.229315 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m19:53:06.229816 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:53:06.230064 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:53:06.234591 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m19:53:06.236297 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:53:06.236677 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:53:06.241201 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:06.241519 [debug] [MainThread]: On master: BEGIN
[0m19:53:06.241762 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:53:06.249360 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m19:53:06.249818 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:06.250092 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:53:06.258787 [debug] [MainThread]: SQL status: SELECT 11 in 0.01 seconds
[0m19:53:06.260649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8316914-2265-4b4e-8899-e5a193d6fec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a75ba0>]}
[0m19:53:06.261051 [debug] [MainThread]: On master: ROLLBACK
[0m19:53:06.261370 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:06.261585 [debug] [MainThread]: On master: BEGIN
[0m19:53:06.262121 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:53:06.262389 [debug] [MainThread]: On master: COMMIT
[0m19:53:06.262606 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:06.263005 [debug] [MainThread]: On master: COMMIT
[0m19:53:06.263275 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:53:06.263472 [debug] [MainThread]: On master: Close
[0m19:53:06.264039 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:53:06.264884 [info ] [MainThread]: 
[0m19:53:06.268829 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:53:06.268980 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:53:06.269246 [info ] [Thread-1 (]: 1 of 12 START test below_depletion_level_tests_below_depletion_level_ .......... [RUN]
[0m19:53:06.269584 [info ] [Thread-2 (]: 2 of 12 START test new_arrival_stock_depletion_test_hot_upsell_ ................ [RUN]
[0m19:53:06.270077 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:53:06.270536 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:53:06.270879 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:53:06.271124 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:53:06.271378 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:53:06.271669 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:53:06.275793 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:53:06.278674 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:53:06.280208 [debug] [Thread-1 (]: finished collecting timing info
[0m19:53:06.280422 [debug] [Thread-2 (]: finished collecting timing info
[0m19:53:06.280549 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:53:06.280810 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:53:06.294467 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:53:06.296173 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:53:06.297462 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:53:06.297584 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:53:06.297768 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m19:53:06.297986 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m19:53:06.298188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:06.298384 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:53:06.305272 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m19:53:06.305634 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:53:06.305753 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:53:06.306000 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:53:06.306217 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT DISTINCT rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, 
                        (ruv.msrp - rupu.price) AS profit_margin
        FROM "postgres"."public"."rugs_usa_variant" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        /* joining on model as none of these should show. doing an inner join for this purpose to test */
        JOIN "postgres"."public"."hot_upsell" model on model.name = rup.name and model.variant = ruv.variant and model.size = rupu.size and model.shape = rupu.shape and model.type = rupu.type
        ORDER BY profit_margin DESC
    )
    SELECT 
        *
    FROM test_data
    having count(*) > 0

      
    ) dbt_internal_test
[0m19:53:06.306408 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m19:53:06.309393 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "test_data.name" must appear in the GROUP BY clause or be used in an aggregate function
LINE 19:         *
                 ^

[0m19:53:06.309821 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m19:53:06.310329 [debug] [Thread-2 (]: finished collecting timing info
[0m19:53:06.310586 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m19:53:06.311135 [debug] [Thread-2 (]: Database Error in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)
  column "test_data.name" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 19:         *
                   ^
  compiled SQL at target/run/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m19:53:06.311938 [error] [Thread-2 (]: 2 of 12 ERROR new_arrival_stock_depletion_test_hot_upsell_ ..................... [[31mERROR[0m in 0.04s]
[0m19:53:06.312540 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:53:06.312908 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:53:06.313234 [info ] [Thread-2 (]: 3 of 12 START test not_null_below_depletion_level_name ......................... [RUN]
[0m19:53:06.313708 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:53:06.313955 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:53:06.314182 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:53:06.320821 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:53:06.321003 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:53:06.323370 [debug] [Thread-1 (]: finished collecting timing info
[0m19:53:06.323659 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m19:53:06.323868 [debug] [Thread-2 (]: finished collecting timing info
[0m19:53:06.324046 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m19:53:06.324151 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:53:06.324547 [info ] [Thread-1 (]: 1 of 12 PASS below_depletion_level_tests_below_depletion_level_ ................ [[32mPASS[0m in 0.05s]
[0m19:53:06.326210 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:53:06.326629 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:53:06.327148 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:53:06.327464 [info ] [Thread-1 (]: 4 of 12 START test not_null_below_depletion_level_variant ...................... [RUN]
[0m19:53:06.327701 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:53:06.327967 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:53:06.328185 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m19:53:06.328399 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:53:06.328629 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:53:06.328868 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:53:06.332328 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:53:06.333641 [debug] [Thread-1 (]: finished collecting timing info
[0m19:53:06.334029 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:53:06.336056 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:53:06.336428 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m19:53:06.336889 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:53:06.337128 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m19:53:06.337394 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:53:06.337639 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m19:53:06.337838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:06.342223 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:53:06.343631 [debug] [Thread-2 (]: finished collecting timing info
[0m19:53:06.344336 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m19:53:06.344463 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:53:06.345536 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m19:53:06.345672 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:53:06.346191 [info ] [Thread-2 (]: 3 of 12 PASS not_null_below_depletion_level_name ............................... [[32mPASS[0m in 0.03s]
[0m19:53:06.346446 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m19:53:06.346988 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:53:06.350825 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:53:06.351221 [info ] [Thread-2 (]: 5 of 12 START test not_null_hot_upsell_name .................................... [RUN]
[0m19:53:06.351765 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:53:06.352142 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:53:06.352449 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:53:06.356785 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:53:06.356979 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:53:06.358708 [debug] [Thread-1 (]: finished collecting timing info
[0m19:53:06.359032 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m19:53:06.359118 [debug] [Thread-2 (]: finished collecting timing info
[0m19:53:06.359465 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m19:53:06.359568 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:53:06.360014 [info ] [Thread-1 (]: 4 of 12 PASS not_null_below_depletion_level_variant ............................ [[32mPASS[0m in 0.03s]
[0m19:53:06.362578 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:53:06.363137 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:53:06.363787 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:53:06.364188 [info ] [Thread-1 (]: 6 of 12 START test not_null_hot_upsell_variant ................................. [RUN]
[0m19:53:06.364312 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:53:06.364705 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:53:06.364939 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m19:53:06.365176 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:53:06.365373 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:53:06.365585 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:53:06.369094 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:53:06.370353 [debug] [Thread-1 (]: finished collecting timing info
[0m19:53:06.370606 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:53:06.372272 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:53:06.372677 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m19:53:06.373013 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:53:06.373226 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:53:06.373412 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m19:53:06.373625 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m19:53:06.374014 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:06.377631 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:53:06.378986 [debug] [Thread-2 (]: finished collecting timing info
[0m19:53:06.379247 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m19:53:06.379512 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m19:53:06.380460 [info ] [Thread-2 (]: 5 of 12 PASS not_null_hot_upsell_name .......................................... [[32mPASS[0m in 0.03s]
[0m19:53:06.380596 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:53:06.381034 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:53:06.381355 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:53:06.381712 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:53:06.382149 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m19:53:06.382391 [info ] [Thread-2 (]: 7 of 12 START test not_null_priority_order_name ................................ [RUN]
[0m19:53:06.386962 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:53:06.387209 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:53:06.387372 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:53:06.390819 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:53:06.390982 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:53:06.392407 [debug] [Thread-1 (]: finished collecting timing info
[0m19:53:06.392760 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m19:53:06.392964 [debug] [Thread-2 (]: finished collecting timing info
[0m19:53:06.393305 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m19:53:06.393401 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:53:06.393831 [info ] [Thread-1 (]: 6 of 12 PASS not_null_hot_upsell_variant ....................................... [[32mPASS[0m in 0.03s]
[0m19:53:06.396266 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:53:06.396725 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:53:06.397330 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:53:06.397616 [info ] [Thread-1 (]: 8 of 12 START test not_null_priority_order_profit .............................. [RUN]
[0m19:53:06.397843 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:53:06.398229 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:53:06.398425 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: BEGIN
[0m19:53:06.398654 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:53:06.398876 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:53:06.399085 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:53:06.402733 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:53:06.403998 [debug] [Thread-1 (]: finished collecting timing info
[0m19:53:06.404258 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:53:06.405922 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:53:06.406273 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m19:53:06.406578 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:53:06.406884 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_name.6c35449027"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."priority_order"
where name is null



      
    ) dbt_internal_test
[0m19:53:06.407010 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:53:06.407395 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: BEGIN
[0m19:53:06.407597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:06.411164 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:53:06.412560 [debug] [Thread-2 (]: finished collecting timing info
[0m19:53:06.412824 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: ROLLBACK
[0m19:53:06.413106 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: Close
[0m19:53:06.413505 [info ] [Thread-2 (]: 7 of 12 PASS not_null_priority_order_name ...................................... [[32mPASS[0m in 0.03s]
[0m19:53:06.413938 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:53:06.414378 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:53:06.414784 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:53:06.414908 [info ] [Thread-2 (]: 9 of 12 START test not_null_priority_order_variant ............................. [RUN]
[0m19:53:06.415226 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:53:06.415721 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:53:06.415970 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_profit.229518def8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select profit
from "postgres"."public"."priority_order"
where profit is null



      
    ) dbt_internal_test
[0m19:53:06.416193 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:53:06.416589 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:53:06.419883 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:53:06.420822 [debug] [Thread-2 (]: finished collecting timing info
[0m19:53:06.421066 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:53:06.422798 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:53:06.422917 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:53:06.424355 [debug] [Thread-1 (]: finished collecting timing info
[0m19:53:06.424619 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: ROLLBACK
[0m19:53:06.424869 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:53:06.425044 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: Close
[0m19:53:06.425126 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: BEGIN
[0m19:53:06.425515 [info ] [Thread-1 (]: 8 of 12 PASS not_null_priority_order_profit .................................... [[32mPASS[0m in 0.03s]
[0m19:53:06.425735 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:53:06.426123 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:53:06.427296 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:53:06.427588 [info ] [Thread-1 (]: 10 of 12 START test not_null_underselling_product_specs_name ................... [RUN]
[0m19:53:06.428034 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:53:06.431650 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:53:06.431960 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:53:06.436154 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:53:06.436523 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m19:53:06.436892 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:53:06.437089 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."priority_order"
where variant is null



      
    ) dbt_internal_test
[0m19:53:06.437446 [debug] [Thread-1 (]: finished collecting timing info
[0m19:53:06.437753 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:53:06.439416 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:53:06.440339 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:53:06.440559 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: BEGIN
[0m19:53:06.440761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:06.442712 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:53:06.444068 [debug] [Thread-2 (]: finished collecting timing info
[0m19:53:06.444270 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: ROLLBACK
[0m19:53:06.444521 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: Close
[0m19:53:06.444889 [info ] [Thread-2 (]: 9 of 12 PASS not_null_priority_order_variant ................................... [[32mPASS[0m in 0.03s]
[0m19:53:06.445264 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:53:06.445747 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:53:06.446011 [info ] [Thread-2 (]: 11 of 12 START test not_null_underselling_product_specs_stock_depletion_ratio .. [RUN]
[0m19:53:06.446412 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:53:06.446668 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:53:06.446892 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:53:06.450375 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:53:06.450763 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:53:06.451201 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:53:06.451462 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."underselling_product_specs"
where name is null



      
    ) dbt_internal_test
[0m19:53:06.451673 [debug] [Thread-2 (]: finished collecting timing info
[0m19:53:06.455750 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:53:06.457515 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:53:06.458312 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:53:06.458526 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: BEGIN
[0m19:53:06.458693 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:53:06.465259 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m19:53:06.465655 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:53:06.465835 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_depletion_ratio
from "postgres"."public"."underselling_product_specs"
where stock_depletion_ratio is null



      
    ) dbt_internal_test
[0m19:53:06.475014 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m19:53:06.476487 [debug] [Thread-1 (]: finished collecting timing info
[0m19:53:06.477221 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: ROLLBACK
[0m19:53:06.477680 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: Close
[0m19:53:06.478964 [info ] [Thread-1 (]: 10 of 12 PASS not_null_underselling_product_specs_name ......................... [[32mPASS[0m in 0.05s]
[0m19:53:06.480036 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:53:06.480399 [debug] [Thread-1 (]: Began running node test.jaffle_shop.underselling_specs_test.fda95ee712
[0m19:53:06.480757 [info ] [Thread-1 (]: 12 of 12 START test underselling_specs_test .................................... [RUN]
[0m19:53:06.481214 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.underselling_specs_test.fda95ee712"
[0m19:53:06.481489 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.underselling_specs_test.fda95ee712
[0m19:53:06.481753 [debug] [Thread-1 (]: Compiling test.jaffle_shop.underselling_specs_test.fda95ee712
[0m19:53:06.484870 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.underselling_specs_test.fda95ee712"
[0m19:53:06.486175 [debug] [Thread-1 (]: finished collecting timing info
[0m19:53:06.486625 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.underselling_specs_test.fda95ee712
[0m19:53:06.488353 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.underselling_specs_test.fda95ee712"
[0m19:53:06.488495 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.02 seconds
[0m19:53:06.490284 [debug] [Thread-2 (]: finished collecting timing info
[0m19:53:06.490546 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: ROLLBACK
[0m19:53:06.490767 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.underselling_specs_test.fda95ee712"
[0m19:53:06.490961 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: Close
[0m19:53:06.491042 [debug] [Thread-1 (]: On test.jaffle_shop.underselling_specs_test.fda95ee712: BEGIN
[0m19:53:06.491444 [info ] [Thread-2 (]: 11 of 12 PASS not_null_underselling_product_specs_stock_depletion_ratio ........ [[32mPASS[0m in 0.05s]
[0m19:53:06.491677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:06.492060 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:53:06.499487 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:53:06.499915 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.underselling_specs_test.fda95ee712"
[0m19:53:06.500208 [debug] [Thread-1 (]: On test.jaffle_shop.underselling_specs_test.fda95ee712: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.underselling_specs_test.fda95ee712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select 
from "postgres"."public"."underselling_product_specs"
where  is null



      
    ) dbt_internal_test
[0m19:53:06.500592 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "null"
LINE 15: where  is null
                   ^

[0m19:53:06.500853 [debug] [Thread-1 (]: On test.jaffle_shop.underselling_specs_test.fda95ee712: ROLLBACK
[0m19:53:06.501178 [debug] [Thread-1 (]: finished collecting timing info
[0m19:53:06.501394 [debug] [Thread-1 (]: On test.jaffle_shop.underselling_specs_test.fda95ee712: Close
[0m19:53:06.501801 [debug] [Thread-1 (]: Database Error in test underselling_specs_test (models/underselling_product_specs/underselling_product_specs_tests.yml)
  syntax error at or near "null"
  LINE 15: where  is null
                     ^
  compiled SQL at target/run/jaffle_shop/models/underselling_product_specs/underselling_product_specs_tests.yml/underselling_specs_test.sql
[0m19:53:06.502125 [error] [Thread-1 (]: 12 of 12 ERROR underselling_specs_test ......................................... [[31mERROR[0m in 0.02s]
[0m19:53:06.502537 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.underselling_specs_test.fda95ee712
[0m19:53:06.504391 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:53:06.504661 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:06.504869 [debug] [MainThread]: On master: BEGIN
[0m19:53:06.505081 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:53:06.512728 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m19:53:06.513111 [debug] [MainThread]: On master: COMMIT
[0m19:53:06.513328 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:06.513516 [debug] [MainThread]: On master: COMMIT
[0m19:53:06.513809 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:53:06.514034 [debug] [MainThread]: On master: Close
[0m19:53:06.514678 [info ] [MainThread]: 
[0m19:53:06.514985 [info ] [MainThread]: Finished running 12 tests in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m19:53:06.515272 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:53:06.515491 [debug] [MainThread]: Connection 'test.jaffle_shop.underselling_specs_test.fda95ee712' was properly closed.
[0m19:53:06.515683 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785' was properly closed.
[0m19:53:06.522601 [info ] [MainThread]: 
[0m19:53:06.522919 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:53:06.523266 [info ] [MainThread]: 
[0m19:53:06.523631 [error] [MainThread]: [33mDatabase Error in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)[0m
[0m19:53:06.524016 [error] [MainThread]:   column "test_data.name" must appear in the GROUP BY clause or be used in an aggregate function
[0m19:53:06.524310 [error] [MainThread]:   LINE 19:         *
[0m19:53:06.524612 [error] [MainThread]:                    ^
[0m19:53:06.524881 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m19:53:06.525211 [info ] [MainThread]: 
[0m19:53:06.525493 [error] [MainThread]: [33mDatabase Error in test underselling_specs_test (models/underselling_product_specs/underselling_product_specs_tests.yml)[0m
[0m19:53:06.525795 [error] [MainThread]:   syntax error at or near "null"
[0m19:53:06.526066 [error] [MainThread]:   LINE 15: where  is null
[0m19:53:06.526336 [error] [MainThread]:                      ^
[0m19:53:06.526610 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/underselling_product_specs/underselling_product_specs_tests.yml/underselling_specs_test.sql
[0m19:53:06.526916 [info ] [MainThread]: 
[0m19:53:06.527177 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=2 SKIP=0 TOTAL=12
[0m19:53:06.527548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b72470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b83ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff88f4c40>]}


============================== 2024-07-14 19:54:40.544564 | 2a0876a5-04e4-4632-ae43-e07365b7e275 ==============================
[0m19:54:40.544864 [info ] [MainThread]: Running with dbt=1.2.0
[0m19:54:40.573471 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:54:40.573835 [debug] [MainThread]: Tracking: tracking
[0m19:54:40.589851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c15d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c14c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c15c00>]}
[0m19:54:40.644141 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:54:40.645013 [debug] [MainThread]: Partial parsing: update schema file: jaffle_shop://models/underselling_product_specs/underselling_product_specs_tests.yml
[0m19:54:40.682205 [debug] [MainThread]: 1699: static parser successfully parsed underselling_product_specs/underselling_product_specs.sql
[0m19:54:40.722508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a0876a5-04e4-4632-ae43-e07365b7e275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bafee0>]}
[0m19:54:40.739587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a0876a5-04e4-4632-ae43-e07365b7e275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1cf70>]}
[0m19:54:40.740038 [info ] [MainThread]: Found 4 models, 12 tests, 2 snapshots, 0 analyses, 259 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:54:40.740407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a0876a5-04e4-4632-ae43-e07365b7e275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1f130>]}
[0m19:54:40.742968 [info ] [MainThread]: 
[0m19:54:40.743778 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:54:40.746100 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m19:54:40.753865 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:54:40.754153 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:54:40.754376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:54:40.797843 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m19:54:40.798351 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:54:40.798627 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:54:40.802465 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m19:54:40.804170 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:54:40.804574 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:54:40.809133 [debug] [MainThread]: Using postgres connection "master"
[0m19:54:40.809427 [debug] [MainThread]: On master: BEGIN
[0m19:54:40.809608 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:54:40.816208 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m19:54:40.816556 [debug] [MainThread]: Using postgres connection "master"
[0m19:54:40.816759 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:54:40.821226 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m19:54:40.822731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a0876a5-04e4-4632-ae43-e07365b7e275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b83a90>]}
[0m19:54:40.823056 [debug] [MainThread]: On master: ROLLBACK
[0m19:54:40.823666 [debug] [MainThread]: Using postgres connection "master"
[0m19:54:40.823830 [debug] [MainThread]: On master: BEGIN
[0m19:54:40.824165 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:54:40.824518 [debug] [MainThread]: On master: COMMIT
[0m19:54:40.824800 [debug] [MainThread]: Using postgres connection "master"
[0m19:54:40.824966 [debug] [MainThread]: On master: COMMIT
[0m19:54:40.825238 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:54:40.825473 [debug] [MainThread]: On master: Close
[0m19:54:40.825872 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:54:40.826193 [info ] [MainThread]: 
[0m19:54:40.830438 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:54:40.830592 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:54:40.830868 [info ] [Thread-1 (]: 1 of 12 START test below_depletion_level_tests_below_depletion_level_ .......... [RUN]
[0m19:54:40.831204 [info ] [Thread-2 (]: 2 of 12 START test new_arrival_stock_depletion_test_hot_upsell_ ................ [RUN]
[0m19:54:40.831677 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:54:40.832187 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:54:40.832568 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:54:40.832810 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:54:40.833075 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:54:40.833331 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:54:40.836803 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:54:40.841529 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:54:40.844270 [debug] [Thread-1 (]: finished collecting timing info
[0m19:54:40.844589 [debug] [Thread-2 (]: finished collecting timing info
[0m19:54:40.844740 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:54:40.845092 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:54:40.860225 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:54:40.861945 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:54:40.864408 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:54:40.864587 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:54:40.864816 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m19:54:40.865072 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m19:54:40.865322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:54:40.865629 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:54:40.874234 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:54:40.875693 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:54:40.876440 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m19:54:40.878734 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m19:54:40.879201 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:54:40.879462 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT DISTINCT rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, 
                        (ruv.msrp - rupu.price) AS profit_margin
        FROM "postgres"."public"."rugs_usa_variant" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        /* joining on model as none of these should show. doing an inner join for this purpose to test */
        JOIN "postgres"."public"."hot_upsell" model on model.name = rup.name and model.variant = ruv.variant and model.size = rupu.size and model.shape = rupu.shape and model.type = rupu.type
        ORDER BY profit_margin DESC
    )
    SELECT 
        *
    FROM test_data
    having count(*) > 0

      
    ) dbt_internal_test
[0m19:54:40.881606 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "test_data.name" must appear in the GROUP BY clause or be used in an aggregate function
LINE 19:         *
                 ^

[0m19:54:40.881961 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m19:54:40.882448 [debug] [Thread-2 (]: finished collecting timing info
[0m19:54:40.882700 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m19:54:40.883197 [debug] [Thread-2 (]: Database Error in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)
  column "test_data.name" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 19:         *
                   ^
  compiled SQL at target/run/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m19:54:40.883614 [error] [Thread-2 (]: 2 of 12 ERROR new_arrival_stock_depletion_test_hot_upsell_ ..................... [[31mERROR[0m in 0.05s]
[0m19:54:40.884240 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:54:40.884609 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:54:40.884965 [info ] [Thread-2 (]: 3 of 12 START test not_null_below_depletion_level_name ......................... [RUN]
[0m19:54:40.885480 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:54:40.885788 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:54:40.886042 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:54:40.892132 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:54:40.892319 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m19:54:40.895192 [debug] [Thread-1 (]: finished collecting timing info
[0m19:54:40.895479 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m19:54:40.895678 [debug] [Thread-2 (]: finished collecting timing info
[0m19:54:40.895875 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m19:54:40.895975 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:54:40.896381 [info ] [Thread-1 (]: 1 of 12 PASS below_depletion_level_tests_below_depletion_level_ ................ [[32mPASS[0m in 0.06s]
[0m19:54:40.897991 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:54:40.898413 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:54:40.899236 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:54:40.899567 [info ] [Thread-1 (]: 4 of 12 START test not_null_below_depletion_level_variant ...................... [RUN]
[0m19:54:40.899813 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:54:40.900103 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:54:40.900303 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m19:54:40.900523 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:54:40.900716 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:54:40.900920 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:54:40.904360 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:54:40.905630 [debug] [Thread-1 (]: finished collecting timing info
[0m19:54:40.905872 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:54:40.907502 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:54:40.907850 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m19:54:40.908322 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:54:40.908548 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m19:54:40.908675 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:54:40.909028 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m19:54:40.909277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:54:40.914475 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:54:40.916510 [debug] [Thread-2 (]: finished collecting timing info
[0m19:54:40.916847 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:54:40.916974 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m19:54:40.917387 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:54:40.917694 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m19:54:40.917784 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m19:54:40.918227 [info ] [Thread-2 (]: 3 of 12 PASS not_null_below_depletion_level_name ............................... [[32mPASS[0m in 0.03s]
[0m19:54:40.922470 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:54:40.922906 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:54:40.923206 [info ] [Thread-2 (]: 5 of 12 START test not_null_hot_upsell_name .................................... [RUN]
[0m19:54:40.923724 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:54:40.924023 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:54:40.924290 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:54:40.924403 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:54:40.925627 [debug] [Thread-1 (]: finished collecting timing info
[0m19:54:40.929865 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:54:40.930201 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m19:54:40.931156 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m19:54:40.931499 [debug] [Thread-2 (]: finished collecting timing info
[0m19:54:40.931714 [info ] [Thread-1 (]: 4 of 12 PASS not_null_below_depletion_level_variant ............................ [[32mPASS[0m in 0.03s]
[0m19:54:40.932442 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:54:40.932823 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:54:40.934404 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:54:40.934698 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:54:40.935478 [info ] [Thread-1 (]: 6 of 12 START test not_null_hot_upsell_variant ................................. [RUN]
[0m19:54:40.935861 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:54:40.936085 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:54:40.936197 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:54:40.936409 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m19:54:40.936615 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:54:40.936804 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:54:40.939550 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:54:40.941074 [debug] [Thread-1 (]: finished collecting timing info
[0m19:54:40.941349 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:54:40.943089 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:54:40.944330 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:54:40.944543 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m19:54:40.944751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:54:40.946441 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m19:54:40.946739 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:54:40.946959 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m19:54:40.950386 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:54:40.951706 [debug] [Thread-2 (]: finished collecting timing info
[0m19:54:40.951998 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m19:54:40.952098 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:54:40.952379 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m19:54:40.952467 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:54:40.952881 [info ] [Thread-2 (]: 5 of 12 PASS not_null_hot_upsell_name .......................................... [[32mPASS[0m in 0.03s]
[0m19:54:40.953094 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m19:54:40.953521 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:54:40.953951 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:54:40.954251 [info ] [Thread-2 (]: 7 of 12 START test not_null_priority_order_name ................................ [RUN]
[0m19:54:40.954683 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:54:40.955223 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:54:40.955498 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:54:40.959140 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:54:40.960518 [debug] [Thread-2 (]: finished collecting timing info
[0m19:54:40.960758 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:54:40.960914 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:54:40.962445 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:54:40.963616 [debug] [Thread-1 (]: finished collecting timing info
[0m19:54:40.964103 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m19:54:40.964712 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m19:54:40.964943 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:54:40.965213 [info ] [Thread-1 (]: 6 of 12 PASS not_null_hot_upsell_variant ....................................... [[32mPASS[0m in 0.03s]
[0m19:54:40.965419 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: BEGIN
[0m19:54:40.965788 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:54:40.966021 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:54:40.966301 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:54:40.966866 [info ] [Thread-1 (]: 8 of 12 START test not_null_priority_order_profit .............................. [RUN]
[0m19:54:40.967329 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:54:40.967583 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:54:40.967814 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:54:40.970876 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:54:40.972410 [debug] [Thread-1 (]: finished collecting timing info
[0m19:54:40.972679 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:54:40.974435 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:54:40.974591 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m19:54:40.975215 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:54:40.975441 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_name.6c35449027"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."priority_order"
where name is null



      
    ) dbt_internal_test
[0m19:54:40.975646 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:54:40.975985 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: BEGIN
[0m19:54:40.976193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:54:40.979264 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:54:40.980587 [debug] [Thread-2 (]: finished collecting timing info
[0m19:54:40.980850 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: ROLLBACK
[0m19:54:40.981137 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: Close
[0m19:54:40.981602 [info ] [Thread-2 (]: 7 of 12 PASS not_null_priority_order_name ...................................... [[32mPASS[0m in 0.03s]
[0m19:54:40.982027 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:54:40.982483 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:54:40.982573 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:54:40.982914 [info ] [Thread-2 (]: 9 of 12 START test not_null_priority_order_variant ............................. [RUN]
[0m19:54:40.983260 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:54:40.983746 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:54:40.983930 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_profit.229518def8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select profit
from "postgres"."public"."priority_order"
where profit is null



      
    ) dbt_internal_test
[0m19:54:40.984229 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:54:40.984637 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:54:40.988031 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:54:40.989376 [debug] [Thread-2 (]: finished collecting timing info
[0m19:54:40.989658 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:54:40.991411 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:54:40.991540 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:54:40.993069 [debug] [Thread-1 (]: finished collecting timing info
[0m19:54:40.993363 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: ROLLBACK
[0m19:54:40.993558 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:54:40.993838 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: Close
[0m19:54:40.993916 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: BEGIN
[0m19:54:40.994305 [info ] [Thread-1 (]: 8 of 12 PASS not_null_priority_order_profit .................................... [[32mPASS[0m in 0.03s]
[0m19:54:40.994524 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:54:40.994921 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:54:40.995588 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:54:40.996089 [info ] [Thread-1 (]: 10 of 12 START test not_null_underselling_product_specs_name ................... [RUN]
[0m19:54:40.996542 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:54:40.996776 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:54:40.996990 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:54:41.000254 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:54:41.001737 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m19:54:41.002230 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:54:41.002467 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."priority_order"
where variant is null



      
    ) dbt_internal_test
[0m19:54:41.002667 [debug] [Thread-1 (]: finished collecting timing info
[0m19:54:41.006266 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:54:41.009032 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:54:41.009198 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:54:41.010798 [debug] [Thread-2 (]: finished collecting timing info
[0m19:54:41.011065 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: ROLLBACK
[0m19:54:41.011259 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:54:41.011553 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: Close
[0m19:54:41.011631 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: BEGIN
[0m19:54:41.012011 [info ] [Thread-2 (]: 9 of 12 PASS not_null_priority_order_variant ................................... [[32mPASS[0m in 0.03s]
[0m19:54:41.012808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:54:41.013250 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:54:41.014040 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:54:41.014547 [info ] [Thread-2 (]: 11 of 12 START test not_null_underselling_product_specs_stock_depletion_ratio .. [RUN]
[0m19:54:41.015038 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:54:41.015299 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:54:41.015514 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:54:41.018607 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:54:41.020006 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:54:41.020301 [debug] [Thread-2 (]: finished collecting timing info
[0m19:54:41.020393 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:54:41.020637 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:54:41.020840 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."underselling_product_specs"
where name is null



      
    ) dbt_internal_test
[0m19:54:41.022431 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:54:41.027059 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:54:41.027285 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: BEGIN
[0m19:54:41.027704 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:54:41.036399 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m19:54:41.037994 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:54:41.038595 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_depletion_ratio
from "postgres"."public"."underselling_product_specs"
where stock_depletion_ratio is null



      
    ) dbt_internal_test
[0m19:54:41.051916 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m19:54:41.053539 [debug] [Thread-1 (]: finished collecting timing info
[0m19:54:41.053853 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: ROLLBACK
[0m19:54:41.054194 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: Close
[0m19:54:41.054675 [info ] [Thread-1 (]: 10 of 12 PASS not_null_underselling_product_specs_name ......................... [[32mPASS[0m in 0.06s]
[0m19:54:41.055949 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:54:41.056314 [debug] [Thread-1 (]: Began running node test.jaffle_shop.underselling_specs_test.116f77a6eb
[0m19:54:41.056601 [info ] [Thread-1 (]: 12 of 12 START test underselling_specs_test .................................... [RUN]
[0m19:54:41.057066 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.underselling_specs_test.116f77a6eb"
[0m19:54:41.057298 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.underselling_specs_test.116f77a6eb
[0m19:54:41.057522 [debug] [Thread-1 (]: Compiling test.jaffle_shop.underselling_specs_test.116f77a6eb
[0m19:54:41.061599 [debug] [Thread-1 (]: finished collecting timing info
[0m19:54:41.062363 [debug] [Thread-1 (]: Compilation Error in test underselling_specs_test (models/underselling_product_specs/underselling_product_specs_tests.yml)
  'test_custom' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:54:41.062734 [error] [Thread-1 (]: 12 of 12 ERROR underselling_specs_test ......................................... [[31mERROR[0m in 0.01s]
[0m19:54:41.063488 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.underselling_specs_test.116f77a6eb
[0m19:54:41.066413 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.03 seconds
[0m19:54:41.067703 [debug] [Thread-2 (]: finished collecting timing info
[0m19:54:41.067955 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: ROLLBACK
[0m19:54:41.068286 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: Close
[0m19:54:41.068691 [info ] [Thread-2 (]: 11 of 12 PASS not_null_underselling_product_specs_stock_depletion_ratio ........ [[32mPASS[0m in 0.05s]
[0m19:54:41.069096 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:54:41.070936 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:54:41.071257 [debug] [MainThread]: Using postgres connection "master"
[0m19:54:41.071460 [debug] [MainThread]: On master: BEGIN
[0m19:54:41.071803 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:54:41.078023 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m19:54:41.078434 [debug] [MainThread]: On master: COMMIT
[0m19:54:41.078816 [debug] [MainThread]: Using postgres connection "master"
[0m19:54:41.079114 [debug] [MainThread]: On master: COMMIT
[0m19:54:41.080844 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:54:41.081747 [debug] [MainThread]: On master: Close
[0m19:54:41.082791 [info ] [MainThread]: 
[0m19:54:41.083874 [info ] [MainThread]: Finished running 12 tests in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m19:54:41.085739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:54:41.086744 [debug] [MainThread]: Connection 'test.jaffle_shop.underselling_specs_test.116f77a6eb' was properly closed.
[0m19:54:41.087390 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785' was properly closed.
[0m19:54:41.097340 [info ] [MainThread]: 
[0m19:54:41.097931 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:54:41.098897 [info ] [MainThread]: 
[0m19:54:41.099417 [error] [MainThread]: [33mDatabase Error in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)[0m
[0m19:54:41.099767 [error] [MainThread]:   column "test_data.name" must appear in the GROUP BY clause or be used in an aggregate function
[0m19:54:41.100119 [error] [MainThread]:   LINE 19:         *
[0m19:54:41.100462 [error] [MainThread]:                    ^
[0m19:54:41.100774 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m19:54:41.101077 [info ] [MainThread]: 
[0m19:54:41.101357 [error] [MainThread]: [33mCompilation Error in test underselling_specs_test (models/underselling_product_specs/underselling_product_specs_tests.yml)[0m
[0m19:54:41.101755 [error] [MainThread]:   'test_custom' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:54:41.102043 [info ] [MainThread]: 
[0m19:54:41.102366 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=2 SKIP=0 TOTAL=12
[0m19:54:41.102780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1d330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9baf100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99e2950>]}


============================== 2024-07-14 19:55:48.025499 | a898eb7c-a3b9-4171-81b8-35b96f538ee0 ==============================
[0m19:55:48.025817 [info ] [MainThread]: Running with dbt=1.2.0
[0m19:55:48.053238 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:55:48.053750 [debug] [MainThread]: Tracking: tracking
[0m19:55:48.068422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2afb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b250>]}
[0m19:55:48.122440 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:55:48.123073 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://macros/underselling_specs_test.sql
[0m19:55:48.123530 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://macros/upsell_test.sql
[0m19:55:48.123808 [debug] [MainThread]: Parsing macros/underselling_specs_test.sql
[0m19:55:48.125669 [debug] [MainThread]: Parsing macros/upsell_test.sql
[0m19:55:48.163558 [debug] [MainThread]: 1699: static parser successfully parsed hot_upsell/hot_upsell.sql
[0m19:55:48.205096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a898eb7c-a3b9-4171-81b8-35b96f538ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a13ee0>]}
[0m19:55:48.217962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a898eb7c-a3b9-4171-81b8-35b96f538ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b72440>]}
[0m19:55:48.218429 [info ] [MainThread]: Found 4 models, 12 tests, 2 snapshots, 0 analyses, 259 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:55:48.218844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a898eb7c-a3b9-4171-81b8-35b96f538ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b72470>]}
[0m19:55:48.221181 [info ] [MainThread]: 
[0m19:55:48.221898 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:55:48.224174 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m19:55:48.232890 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:55:48.233401 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:55:48.233676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:48.276957 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m19:55:48.277598 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:55:48.277864 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:55:48.281858 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m19:55:48.283548 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:55:48.283955 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:55:48.288387 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:48.288721 [debug] [MainThread]: On master: BEGIN
[0m19:55:48.288942 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:55:48.295404 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m19:55:48.295797 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:48.296039 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:55:48.300636 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m19:55:48.302361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a898eb7c-a3b9-4171-81b8-35b96f538ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a79c00>]}
[0m19:55:48.302738 [debug] [MainThread]: On master: ROLLBACK
[0m19:55:48.303052 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:48.303267 [debug] [MainThread]: On master: BEGIN
[0m19:55:48.303651 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:55:48.303932 [debug] [MainThread]: On master: COMMIT
[0m19:55:48.304150 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:48.304369 [debug] [MainThread]: On master: COMMIT
[0m19:55:48.304668 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:55:48.304901 [debug] [MainThread]: On master: Close
[0m19:55:48.305284 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:55:48.305594 [info ] [MainThread]: 
[0m19:55:48.309473 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:55:48.309631 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:55:48.309887 [info ] [Thread-1 (]: 1 of 12 START test below_depletion_level_tests_below_depletion_level_ .......... [RUN]
[0m19:55:48.310221 [info ] [Thread-2 (]: 2 of 12 START test new_arrival_stock_depletion_test_hot_upsell_ ................ [RUN]
[0m19:55:48.310685 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:55:48.311148 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:55:48.311505 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:55:48.311778 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:55:48.312044 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:55:48.312283 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:55:48.315717 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:55:48.318334 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:55:48.320235 [debug] [Thread-1 (]: finished collecting timing info
[0m19:55:48.320326 [debug] [Thread-2 (]: finished collecting timing info
[0m19:55:48.320541 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:55:48.320816 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:55:48.334421 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:55:48.336061 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:55:48.337895 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:55:48.338147 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:55:48.338232 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m19:55:48.338545 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m19:55:48.338818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:55:48.339052 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:55:48.346428 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:55:48.346975 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:55:48.347268 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m19:55:48.347781 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m19:55:48.348157 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:55:48.348417 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT *
        FROM "postgres"."public"."rugs_usa_variant" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        /* joining on model as none of these should show. doing an inner join for this purpose to test */
        JOIN "postgres"."public"."hot_upsell" model on model.name = rup.name and model.variant = ruv.variant and model.size = rupu.size and model.shape = rupu.shape and model.type = rupu.type
    )
    SELECT 
        *
    FROM test_data
    having count(*) > 0

      
    ) dbt_internal_test
[0m19:55:48.351386 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "test_data.pid" must appear in the GROUP BY clause or be used in an aggregate function
LINE 17:         *
                 ^

[0m19:55:48.351837 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m19:55:48.352385 [debug] [Thread-2 (]: finished collecting timing info
[0m19:55:48.352673 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m19:55:48.353187 [debug] [Thread-2 (]: Database Error in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)
  column "test_data.pid" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 17:         *
                   ^
  compiled SQL at target/run/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m19:55:48.353592 [error] [Thread-2 (]: 2 of 12 ERROR new_arrival_stock_depletion_test_hot_upsell_ ..................... [[31mERROR[0m in 0.04s]
[0m19:55:48.354260 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:55:48.354670 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:55:48.355108 [info ] [Thread-2 (]: 3 of 12 START test not_null_below_depletion_level_name ......................... [RUN]
[0m19:55:48.355640 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:55:48.355921 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:55:48.356194 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:55:48.362628 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:55:48.363905 [debug] [Thread-2 (]: finished collecting timing info
[0m19:55:48.364181 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:55:48.364367 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m19:55:48.365869 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:55:48.367829 [debug] [Thread-1 (]: finished collecting timing info
[0m19:55:48.368705 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m19:55:48.369041 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m19:55:48.369165 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:55:48.369577 [info ] [Thread-1 (]: 1 of 12 PASS below_depletion_level_tests_below_depletion_level_ ................ [[32mPASS[0m in 0.06s]
[0m19:55:48.369801 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m19:55:48.370223 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:55:48.370518 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:55:48.370904 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:55:48.371501 [info ] [Thread-1 (]: 4 of 12 START test not_null_below_depletion_level_variant ...................... [RUN]
[0m19:55:48.372073 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:55:48.372420 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:55:48.372689 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:55:48.376496 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:55:48.377742 [debug] [Thread-1 (]: finished collecting timing info
[0m19:55:48.378047 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:55:48.379996 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:55:48.380147 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m19:55:48.380720 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:55:48.380949 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m19:55:48.381181 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:55:48.381460 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m19:55:48.381678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:55:48.385944 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:55:48.387313 [debug] [Thread-2 (]: finished collecting timing info
[0m19:55:48.387585 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m19:55:48.387909 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m19:55:48.388515 [info ] [Thread-2 (]: 3 of 12 PASS not_null_below_depletion_level_name ............................... [[32mPASS[0m in 0.03s]
[0m19:55:48.388703 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:55:48.389280 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:55:48.389496 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:55:48.389800 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:55:48.390047 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m19:55:48.390297 [info ] [Thread-2 (]: 5 of 12 START test not_null_hot_upsell_name .................................... [RUN]
[0m19:55:48.391055 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:55:48.391333 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:55:48.391541 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:55:48.395764 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:55:48.396162 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:55:48.397862 [debug] [Thread-1 (]: finished collecting timing info
[0m19:55:48.398169 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m19:55:48.398412 [debug] [Thread-2 (]: finished collecting timing info
[0m19:55:48.398618 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m19:55:48.398764 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:55:48.399146 [info ] [Thread-1 (]: 4 of 12 PASS not_null_below_depletion_level_variant ............................ [[32mPASS[0m in 0.03s]
[0m19:55:48.400827 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:55:48.401201 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:55:48.401743 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:55:48.401983 [info ] [Thread-1 (]: 6 of 12 START test not_null_hot_upsell_variant ................................. [RUN]
[0m19:55:48.402370 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:55:48.402614 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:55:48.402814 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m19:55:48.402984 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:55:48.403177 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:55:48.403364 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:55:48.406753 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:55:48.407653 [debug] [Thread-1 (]: finished collecting timing info
[0m19:55:48.407885 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:55:48.409731 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:55:48.410190 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m19:55:48.410496 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:55:48.410866 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:55:48.410947 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m19:55:48.411155 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m19:55:48.411512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:55:48.414778 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:55:48.416088 [debug] [Thread-2 (]: finished collecting timing info
[0m19:55:48.416341 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m19:55:48.416632 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m19:55:48.417041 [info ] [Thread-2 (]: 5 of 12 PASS not_null_hot_upsell_name .......................................... [[32mPASS[0m in 0.03s]
[0m19:55:48.417467 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:55:48.417905 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:55:48.418167 [info ] [Thread-2 (]: 7 of 12 START test not_null_priority_order_name ................................ [RUN]
[0m19:55:48.418649 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:55:48.418743 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:55:48.418948 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:55:48.419158 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:55:48.419366 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:55:48.419558 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m19:55:48.422797 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:55:48.424179 [debug] [Thread-2 (]: finished collecting timing info
[0m19:55:48.424464 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:55:48.426242 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:55:48.427361 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:55:48.427583 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: BEGIN
[0m19:55:48.427795 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:55:48.429966 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:55:48.431624 [debug] [Thread-1 (]: finished collecting timing info
[0m19:55:48.431881 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m19:55:48.432177 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m19:55:48.432575 [info ] [Thread-1 (]: 6 of 12 PASS not_null_hot_upsell_variant ....................................... [[32mPASS[0m in 0.03s]
[0m19:55:48.433008 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:55:48.433431 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:55:48.433732 [info ] [Thread-1 (]: 8 of 12 START test not_null_priority_order_profit .............................. [RUN]
[0m19:55:48.434155 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:55:48.434406 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:55:48.434704 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:55:48.434805 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m19:55:48.438118 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:55:48.438422 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:55:48.438981 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_name.6c35449027"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."priority_order"
where name is null



      
    ) dbt_internal_test
[0m19:55:48.439398 [debug] [Thread-1 (]: finished collecting timing info
[0m19:55:48.439644 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:55:48.441373 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:55:48.442183 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:55:48.442395 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: BEGIN
[0m19:55:48.442609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:55:48.442968 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:55:48.444242 [debug] [Thread-2 (]: finished collecting timing info
[0m19:55:48.444496 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: ROLLBACK
[0m19:55:48.444778 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: Close
[0m19:55:48.445157 [info ] [Thread-2 (]: 7 of 12 PASS not_null_priority_order_name ...................................... [[32mPASS[0m in 0.03s]
[0m19:55:48.445533 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:55:48.445923 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:55:48.446169 [info ] [Thread-2 (]: 9 of 12 START test not_null_priority_order_variant ............................. [RUN]
[0m19:55:48.446557 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:55:48.446884 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:55:48.447075 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:55:48.450139 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:55:48.450487 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:55:48.451064 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:55:48.451306 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_profit.229518def8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select profit
from "postgres"."public"."priority_order"
where profit is null



      
    ) dbt_internal_test
[0m19:55:48.451608 [debug] [Thread-2 (]: finished collecting timing info
[0m19:55:48.451870 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:55:48.453621 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:55:48.454435 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:55:48.454647 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: BEGIN
[0m19:55:48.454837 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:55:48.457477 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:55:48.458845 [debug] [Thread-1 (]: finished collecting timing info
[0m19:55:48.459046 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: ROLLBACK
[0m19:55:48.459268 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: Close
[0m19:55:48.459611 [info ] [Thread-1 (]: 8 of 12 PASS not_null_priority_order_profit .................................... [[32mPASS[0m in 0.03s]
[0m19:55:48.459986 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:55:48.460325 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:55:48.460621 [info ] [Thread-1 (]: 10 of 12 START test not_null_underselling_product_specs_name ................... [RUN]
[0m19:55:48.461071 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:55:48.461357 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:55:48.461441 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m19:55:48.461674 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:55:48.461905 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:55:48.465947 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:55:48.466241 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."priority_order"
where variant is null



      
    ) dbt_internal_test
[0m19:55:48.467365 [debug] [Thread-1 (]: finished collecting timing info
[0m19:55:48.467636 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:55:48.469307 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:55:48.470372 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:55:48.470608 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: BEGIN
[0m19:55:48.470869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:55:48.471751 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:55:48.473077 [debug] [Thread-2 (]: finished collecting timing info
[0m19:55:48.473359 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: ROLLBACK
[0m19:55:48.473643 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: Close
[0m19:55:48.474051 [info ] [Thread-2 (]: 9 of 12 PASS not_null_priority_order_variant ................................... [[32mPASS[0m in 0.03s]
[0m19:55:48.474448 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:55:48.474900 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:55:48.475163 [info ] [Thread-2 (]: 11 of 12 START test not_null_underselling_product_specs_stock_depletion_ratio .. [RUN]
[0m19:55:48.475609 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:55:48.475898 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:55:48.476106 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:55:48.479836 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:55:48.480185 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:55:48.480619 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:55:48.480843 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."underselling_product_specs"
where name is null



      
    ) dbt_internal_test
[0m19:55:48.481078 [debug] [Thread-2 (]: finished collecting timing info
[0m19:55:48.481339 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:55:48.483092 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:55:48.483973 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:55:48.484207 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: BEGIN
[0m19:55:48.484408 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:55:48.490942 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m19:55:48.491362 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:55:48.491703 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_depletion_ratio
from "postgres"."public"."underselling_product_specs"
where stock_depletion_ratio is null



      
    ) dbt_internal_test
[0m19:55:48.504170 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m19:55:48.505686 [debug] [Thread-1 (]: finished collecting timing info
[0m19:55:48.505989 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: ROLLBACK
[0m19:55:48.506333 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: Close
[0m19:55:48.506794 [info ] [Thread-1 (]: 10 of 12 PASS not_null_underselling_product_specs_name ......................... [[32mPASS[0m in 0.05s]
[0m19:55:48.507225 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:55:48.507656 [debug] [Thread-1 (]: Began running node test.jaffle_shop.underselling_specs_test.116f77a6eb
[0m19:55:48.507956 [info ] [Thread-1 (]: 12 of 12 START test underselling_specs_test .................................... [RUN]
[0m19:55:48.508382 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.underselling_specs_test.116f77a6eb"
[0m19:55:48.508695 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.underselling_specs_test.116f77a6eb
[0m19:55:48.508934 [debug] [Thread-1 (]: Compiling test.jaffle_shop.underselling_specs_test.116f77a6eb
[0m19:55:48.512515 [debug] [Thread-1 (]: finished collecting timing info
[0m19:55:48.512906 [debug] [Thread-1 (]: Compilation Error in test underselling_specs_test (models/underselling_product_specs/underselling_product_specs_tests.yml)
  'test_custom' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:55:48.513208 [error] [Thread-1 (]: 12 of 12 ERROR underselling_specs_test ......................................... [[31mERROR[0m in 0.00s]
[0m19:55:48.513584 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.underselling_specs_test.116f77a6eb
[0m19:55:48.514070 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.02 seconds
[0m19:55:48.515270 [debug] [Thread-2 (]: finished collecting timing info
[0m19:55:48.515519 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: ROLLBACK
[0m19:55:48.515849 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: Close
[0m19:55:48.516267 [info ] [Thread-2 (]: 11 of 12 PASS not_null_underselling_product_specs_stock_depletion_ratio ........ [[32mPASS[0m in 0.04s]
[0m19:55:48.516669 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:55:48.518436 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:55:48.518739 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:48.518960 [debug] [MainThread]: On master: BEGIN
[0m19:55:48.519168 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:55:48.525233 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m19:55:48.525577 [debug] [MainThread]: On master: COMMIT
[0m19:55:48.525817 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:48.526035 [debug] [MainThread]: On master: COMMIT
[0m19:55:48.526322 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:55:48.526552 [debug] [MainThread]: On master: Close
[0m19:55:48.527167 [info ] [MainThread]: 
[0m19:55:48.527482 [info ] [MainThread]: Finished running 12 tests in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m19:55:48.527874 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:55:48.528161 [debug] [MainThread]: Connection 'test.jaffle_shop.underselling_specs_test.116f77a6eb' was properly closed.
[0m19:55:48.528422 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785' was properly closed.
[0m19:55:48.534949 [info ] [MainThread]: 
[0m19:55:48.535265 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:55:48.535658 [info ] [MainThread]: 
[0m19:55:48.536007 [error] [MainThread]: [33mDatabase Error in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)[0m
[0m19:55:48.536320 [error] [MainThread]:   column "test_data.pid" must appear in the GROUP BY clause or be used in an aggregate function
[0m19:55:48.536602 [error] [MainThread]:   LINE 17:         *
[0m19:55:48.536897 [error] [MainThread]:                    ^
[0m19:55:48.537218 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m19:55:48.537483 [info ] [MainThread]: 
[0m19:55:48.537790 [error] [MainThread]: [33mCompilation Error in test underselling_specs_test (models/underselling_product_specs/underselling_product_specs_tests.yml)[0m
[0m19:55:48.538050 [error] [MainThread]:   'test_custom' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:55:48.538355 [info ] [MainThread]: 
[0m19:55:48.538631 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=2 SKIP=0 TOTAL=12
[0m19:55:48.539012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b72410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9aad1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae68c0>]}


============================== 2024-07-14 19:56:55.681439 | 571dc8d1-0dae-464e-97b0-5b21b0cd94a5 ==============================
[0m19:56:55.681758 [info ] [MainThread]: Running with dbt=1.2.0
[0m19:56:55.710563 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:56:55.711081 [debug] [MainThread]: Tracking: tracking
[0m19:56:55.726345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c0e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c0f5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c0e8f0>]}
[0m19:56:55.781369 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:56:55.783245 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://macros/underselling_specs_test.sql
[0m19:56:55.783649 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://macros/upsell_test.sql
[0m19:56:55.783891 [debug] [MainThread]: Parsing macros/underselling_specs_test.sql
[0m19:56:55.785841 [debug] [MainThread]: Parsing macros/upsell_test.sql
[0m19:56:55.824978 [debug] [MainThread]: 1699: static parser successfully parsed hot_upsell/hot_upsell.sql
[0m19:56:55.868160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '571dc8d1-0dae-464e-97b0-5b21b0cd94a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a1bee0>]}
[0m19:56:55.878536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '571dc8d1-0dae-464e-97b0-5b21b0cd94a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b723b0>]}
[0m19:56:55.878974 [info ] [MainThread]: Found 4 models, 12 tests, 2 snapshots, 0 analyses, 259 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:56:55.879304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '571dc8d1-0dae-464e-97b0-5b21b0cd94a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b723e0>]}
[0m19:56:55.881355 [info ] [MainThread]: 
[0m19:56:55.881970 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:56:55.884103 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m19:56:55.892138 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:56:55.892451 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:56:55.892677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:55.936129 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m19:56:55.936637 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:56:55.936885 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:56:55.941073 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m19:56:55.942857 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:56:55.943275 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:56:55.947705 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:55.948054 [debug] [MainThread]: On master: BEGIN
[0m19:56:55.948293 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:56:55.954739 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m19:56:55.955127 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:55.955356 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:56:55.960035 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m19:56:55.961820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '571dc8d1-0dae-464e-97b0-5b21b0cd94a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c0e5c0>]}
[0m19:56:55.962182 [debug] [MainThread]: On master: ROLLBACK
[0m19:56:55.962492 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:55.962724 [debug] [MainThread]: On master: BEGIN
[0m19:56:55.963152 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:56:55.963490 [debug] [MainThread]: On master: COMMIT
[0m19:56:55.963721 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:55.963978 [debug] [MainThread]: On master: COMMIT
[0m19:56:55.964274 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:56:55.964508 [debug] [MainThread]: On master: Close
[0m19:56:55.964914 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:56:55.965248 [info ] [MainThread]: 
[0m19:56:55.969061 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:56:55.969199 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:56:55.969459 [info ] [Thread-1 (]: 1 of 12 START test below_depletion_level_tests_below_depletion_level_ .......... [RUN]
[0m19:56:55.969769 [info ] [Thread-2 (]: 2 of 12 START test new_arrival_stock_depletion_test_hot_upsell_ ................ [RUN]
[0m19:56:55.970261 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:56:55.970697 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:56:55.971100 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:56:55.971351 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:56:55.971620 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:56:55.971870 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:56:55.975346 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:56:55.978087 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:56:55.980302 [debug] [Thread-1 (]: finished collecting timing info
[0m19:56:55.980513 [debug] [Thread-2 (]: finished collecting timing info
[0m19:56:55.980615 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:56:55.980843 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:56:55.995669 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:56:55.997452 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:56:55.999328 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:56:55.999554 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:56:55.999644 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m19:56:55.999879 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m19:56:56.000107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:56.000330 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:56:56.008131 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m19:56:56.008696 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m19:56:56.008814 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:56:56.009119 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."rugs_usa_variant" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        /* joining on model as none of these should show. doing an inner join for this purpose to test */
        JOIN "postgres"."public"."hot_upsell" model on model.name = rup.name and model.variant = ruv.variant and model.size = rupu.size and model.shape = rupu.shape and model.type = rupu.type
    )
    SELECT 
        errors
    FROM test_data
    where errors > 0

      
    ) dbt_internal_test
[0m19:56:56.010005 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m19:56:56.010483 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m19:56:56.026011 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m19:56:56.029142 [debug] [Thread-1 (]: finished collecting timing info
[0m19:56:56.029564 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m19:56:56.029994 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m19:56:56.030594 [info ] [Thread-1 (]: 1 of 12 PASS below_depletion_level_tests_below_depletion_level_ ................ [[32mPASS[0m in 0.06s]
[0m19:56:56.032520 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m19:56:56.033040 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:56:56.033386 [info ] [Thread-1 (]: 3 of 12 START test not_null_below_depletion_level_name ......................... [RUN]
[0m19:56:56.033925 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:56:56.034245 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:56:56.034530 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:56:56.041405 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:56:56.042999 [debug] [Thread-1 (]: finished collecting timing info
[0m19:56:56.043286 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:56:56.045177 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:56:56.046411 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:56:56.046608 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m19:56:56.046811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:56.054637 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:56:56.055196 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m19:56:56.055442 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m19:56:56.059032 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:56:56.060703 [debug] [Thread-1 (]: finished collecting timing info
[0m19:56:56.061017 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m19:56:56.061358 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m19:56:56.061817 [info ] [Thread-1 (]: 3 of 12 PASS not_null_below_depletion_level_name ............................... [[32mPASS[0m in 0.03s]
[0m19:56:56.062257 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m19:56:56.062706 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:56:56.063036 [info ] [Thread-1 (]: 4 of 12 START test not_null_below_depletion_level_variant ...................... [RUN]
[0m19:56:56.063481 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:56:56.063740 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:56:56.063994 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:56:56.067468 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:56:56.068604 [debug] [Thread-1 (]: finished collecting timing info
[0m19:56:56.068842 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:56:56.070536 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:56:56.071608 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:56:56.071832 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m19:56:56.072049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:56.079737 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:56:56.080306 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m19:56:56.081270 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m19:56:56.087081 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:56:56.088867 [debug] [Thread-1 (]: finished collecting timing info
[0m19:56:56.089175 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m19:56:56.090228 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m19:56:56.090810 [info ] [Thread-1 (]: 4 of 12 PASS not_null_below_depletion_level_variant ............................ [[32mPASS[0m in 0.03s]
[0m19:56:56.091390 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m19:56:56.091890 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:56:56.092209 [info ] [Thread-1 (]: 5 of 12 START test not_null_hot_upsell_name .................................... [RUN]
[0m19:56:56.092672 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:56:56.092965 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:56:56.093196 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:56:56.097542 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:56:56.099234 [debug] [Thread-1 (]: finished collecting timing info
[0m19:56:56.099815 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:56:56.101831 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:56:56.103869 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:56:56.104116 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m19:56:56.104325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:56.111498 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:56:56.111978 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m19:56:56.112305 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m19:56:56.116125 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:56:56.117697 [debug] [Thread-1 (]: finished collecting timing info
[0m19:56:56.117978 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m19:56:56.118253 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m19:56:56.118680 [info ] [Thread-1 (]: 5 of 12 PASS not_null_hot_upsell_name .......................................... [[32mPASS[0m in 0.03s]
[0m19:56:56.119153 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m19:56:56.119486 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:56:56.119761 [info ] [Thread-1 (]: 6 of 12 START test not_null_hot_upsell_variant ................................. [RUN]
[0m19:56:56.120253 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:56:56.120616 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:56:56.120844 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:56:56.124356 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:56:56.126084 [debug] [Thread-1 (]: finished collecting timing info
[0m19:56:56.126582 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:56:56.128800 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:56:56.129848 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:56:56.130068 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m19:56:56.130265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:56.138100 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:56:56.138689 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m19:56:56.139032 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m19:56:56.145872 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:56:56.147647 [debug] [Thread-1 (]: finished collecting timing info
[0m19:56:56.147949 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m19:56:56.148254 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m19:56:56.148732 [info ] [Thread-1 (]: 6 of 12 PASS not_null_hot_upsell_variant ....................................... [[32mPASS[0m in 0.03s]
[0m19:56:56.149261 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m19:56:56.149648 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:56:56.149977 [info ] [Thread-1 (]: 7 of 12 START test not_null_priority_order_name ................................ [RUN]
[0m19:56:56.150399 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:56:56.150623 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:56:56.150856 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:56:56.154831 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:56:56.156841 [debug] [Thread-1 (]: finished collecting timing info
[0m19:56:56.157159 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:56:56.159195 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:56:56.160880 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:56:56.161510 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: BEGIN
[0m19:56:56.161815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:56.172847 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:56:56.173383 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m19:56:56.173670 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_name.6c35449027"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."priority_order"
where name is null



      
    ) dbt_internal_test
[0m19:56:56.180165 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:56:56.181989 [debug] [Thread-1 (]: finished collecting timing info
[0m19:56:56.182346 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: ROLLBACK
[0m19:56:56.182708 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: Close
[0m19:56:56.183230 [info ] [Thread-1 (]: 7 of 12 PASS not_null_priority_order_name ...................................... [[32mPASS[0m in 0.03s]
[0m19:56:56.183739 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m19:56:56.184123 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:56:56.184397 [info ] [Thread-1 (]: 8 of 12 START test not_null_priority_order_profit .............................. [RUN]
[0m19:56:56.184807 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:56:56.185055 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:56:56.185264 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:56:56.188691 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:56:56.189771 [debug] [Thread-1 (]: finished collecting timing info
[0m19:56:56.190050 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:56:56.191830 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:56:56.192816 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:56:56.193027 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: BEGIN
[0m19:56:56.193231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:56.199955 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:56:56.200329 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m19:56:56.200556 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_profit.229518def8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select profit
from "postgres"."public"."priority_order"
where profit is null



      
    ) dbt_internal_test
[0m19:56:56.206839 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m19:56:56.208602 [debug] [Thread-1 (]: finished collecting timing info
[0m19:56:56.208964 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: ROLLBACK
[0m19:56:56.209335 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: Close
[0m19:56:56.209802 [info ] [Thread-1 (]: 8 of 12 PASS not_null_priority_order_profit .................................... [[32mPASS[0m in 0.03s]
[0m19:56:56.210249 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m19:56:56.210654 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:56:56.210983 [info ] [Thread-1 (]: 9 of 12 START test not_null_priority_order_variant ............................. [RUN]
[0m19:56:56.211400 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:56:56.211653 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:56:56.211873 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:56:56.215349 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:56:56.216553 [debug] [Thread-1 (]: finished collecting timing info
[0m19:56:56.216809 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:56:56.218450 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:56:56.219445 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:56:56.219644 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: BEGIN
[0m19:56:56.219842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:56.226282 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:56:56.226660 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m19:56:56.226880 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."priority_order"
where variant is null



      
    ) dbt_internal_test
[0m19:56:56.231816 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:56:56.233394 [debug] [Thread-1 (]: finished collecting timing info
[0m19:56:56.233694 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: ROLLBACK
[0m19:56:56.234002 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: Close
[0m19:56:56.234450 [info ] [Thread-1 (]: 9 of 12 PASS not_null_priority_order_variant ................................... [[32mPASS[0m in 0.02s]
[0m19:56:56.234917 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m19:56:56.235312 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:56:56.235569 [info ] [Thread-1 (]: 10 of 12 START test not_null_underselling_product_specs_name ................... [RUN]
[0m19:56:56.236019 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:56:56.236257 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:56:56.236456 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:56:56.240560 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:56:56.242100 [debug] [Thread-1 (]: finished collecting timing info
[0m19:56:56.242355 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:56:56.244070 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:56:56.245069 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:56:56.245271 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: BEGIN
[0m19:56:56.245497 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:56.251806 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:56:56.252151 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m19:56:56.252364 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."underselling_product_specs"
where name is null



      
    ) dbt_internal_test
[0m19:56:56.275930 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m19:56:56.277753 [debug] [Thread-1 (]: finished collecting timing info
[0m19:56:56.278063 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: ROLLBACK
[0m19:56:56.278411 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: Close
[0m19:56:56.278935 [info ] [Thread-1 (]: 10 of 12 PASS not_null_underselling_product_specs_name ......................... [[32mPASS[0m in 0.04s]
[0m19:56:56.279461 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m19:56:56.279900 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:56:56.280217 [info ] [Thread-1 (]: 11 of 12 START test not_null_underselling_product_specs_stock_depletion_ratio .. [RUN]
[0m19:56:56.280667 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:56:56.280953 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:56:56.281184 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:56:56.284611 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:56:56.286028 [debug] [Thread-1 (]: finished collecting timing info
[0m19:56:56.286282 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:56:56.287848 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:56:56.288944 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:56:56.289154 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: BEGIN
[0m19:56:56.289352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:56.295634 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:56:56.296003 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m19:56:56.296217 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_depletion_ratio
from "postgres"."public"."underselling_product_specs"
where stock_depletion_ratio is null



      
    ) dbt_internal_test
[0m19:56:56.317190 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m19:56:56.318874 [debug] [Thread-1 (]: finished collecting timing info
[0m19:56:56.319184 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: ROLLBACK
[0m19:56:56.319534 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: Close
[0m19:56:56.320037 [info ] [Thread-1 (]: 11 of 12 PASS not_null_underselling_product_specs_stock_depletion_ratio ........ [[32mPASS[0m in 0.04s]
[0m19:56:56.320528 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m19:56:56.321042 [debug] [Thread-1 (]: Began running node test.jaffle_shop.underselling_specs_test.116f77a6eb
[0m19:56:56.321357 [info ] [Thread-1 (]: 12 of 12 START test underselling_specs_test .................................... [RUN]
[0m19:56:56.321928 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.underselling_specs_test.116f77a6eb"
[0m19:56:56.322193 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.underselling_specs_test.116f77a6eb
[0m19:56:56.322428 [debug] [Thread-1 (]: Compiling test.jaffle_shop.underselling_specs_test.116f77a6eb
[0m19:56:56.326824 [debug] [Thread-1 (]: finished collecting timing info
[0m19:56:56.327340 [debug] [Thread-1 (]: Compilation Error in test underselling_specs_test (models/underselling_product_specs/underselling_product_specs_tests.yml)
  'test_custom' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:56:56.327673 [error] [Thread-1 (]: 12 of 12 ERROR underselling_specs_test ......................................... [[31mERROR[0m in 0.01s]
[0m19:56:56.328082 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.underselling_specs_test.116f77a6eb
[0m19:59:12.020015 [debug] [Thread-2 (]: SQL status: SELECT 1 in 136.01 seconds
[0m19:59:12.042576 [debug] [Thread-2 (]: finished collecting timing info
[0m19:59:12.043253 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m19:59:12.043999 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m19:59:12.046267 [error] [Thread-2 (]: 2 of 12 FAIL 1 new_arrival_stock_depletion_test_hot_upsell_ .................... [[31mFAIL 1[0m in 136.08s]
[0m19:59:12.048029 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m19:59:12.054499 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:59:12.054970 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:12.055216 [debug] [MainThread]: On master: BEGIN
[0m19:59:12.055462 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:59:12.065601 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m19:59:12.066293 [debug] [MainThread]: On master: COMMIT
[0m19:59:12.066584 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:12.066853 [debug] [MainThread]: On master: COMMIT
[0m19:59:12.067215 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:59:12.067477 [debug] [MainThread]: On master: Close
[0m19:59:12.068811 [info ] [MainThread]: 
[0m19:59:12.069297 [info ] [MainThread]: Finished running 12 tests in 0 hours 2 minutes and 16.19 seconds (136.19s).
[0m19:59:12.069755 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:59:12.070050 [debug] [MainThread]: Connection 'test.jaffle_shop.underselling_specs_test.116f77a6eb' was properly closed.
[0m19:59:12.070271 [debug] [MainThread]: Connection 'test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38' was properly closed.
[0m19:59:12.085200 [info ] [MainThread]: 
[0m19:59:12.085646 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:59:12.086128 [info ] [MainThread]: 
[0m19:59:12.086558 [error] [MainThread]: [33mCompilation Error in test underselling_specs_test (models/underselling_product_specs/underselling_product_specs_tests.yml)[0m
[0m19:59:12.086863 [error] [MainThread]:   'test_custom' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:59:12.087187 [info ] [MainThread]: 
[0m19:59:12.087531 [error] [MainThread]: [31mFailure in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)[0m
[0m19:59:12.087817 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m19:59:12.088101 [info ] [MainThread]: 
[0m19:59:12.088402 [info ] [MainThread]:   compiled SQL at target/compiled/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m19:59:12.088766 [info ] [MainThread]: 
[0m19:59:12.089153 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=2 SKIP=0 TOTAL=12
[0m19:59:12.090172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b72380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c59f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae5d80>]}


============================== 2024-07-14 20:00:49.630997 | 878c1689-9fcc-4f2c-a638-60bae8ccf687 ==============================
[0m20:00:49.631335 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:00:49.666908 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m20:00:49.667573 [debug] [MainThread]: Tracking: tracking
[0m20:00:49.688281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2afb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2bfd0>]}
[0m20:00:49.750835 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:00:49.751541 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://macros/underselling_specs_test.sql
[0m20:00:49.751925 [debug] [MainThread]: Parsing macros/underselling_specs_test.sql
[0m20:00:49.765687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '878c1689-9fcc-4f2c-a638-60bae8ccf687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99ec0d0>]}
[0m20:00:49.776612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '878c1689-9fcc-4f2c-a638-60bae8ccf687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae54e0>]}
[0m20:00:49.777042 [info ] [MainThread]: Found 4 models, 12 tests, 2 snapshots, 0 analyses, 259 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:00:49.777409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '878c1689-9fcc-4f2c-a638-60bae8ccf687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b723b0>]}
[0m20:00:49.779666 [info ] [MainThread]: 
[0m20:00:49.780333 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m20:00:49.783207 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m20:00:49.792150 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:00:49.792546 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:00:49.792848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:49.843518 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m20:00:49.844666 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:00:49.845030 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:00:49.850086 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m20:00:49.852133 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:00:49.852603 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:00:49.858286 [debug] [MainThread]: Using postgres connection "master"
[0m20:00:49.858687 [debug] [MainThread]: On master: BEGIN
[0m20:00:49.858978 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:00:49.865967 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m20:00:49.866393 [debug] [MainThread]: Using postgres connection "master"
[0m20:00:49.866640 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:00:49.871292 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m20:00:49.872870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '878c1689-9fcc-4f2c-a638-60bae8ccf687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b83b80>]}
[0m20:00:49.873321 [debug] [MainThread]: On master: ROLLBACK
[0m20:00:49.873690 [debug] [MainThread]: Using postgres connection "master"
[0m20:00:49.873923 [debug] [MainThread]: On master: BEGIN
[0m20:00:49.874283 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:00:49.874585 [debug] [MainThread]: On master: COMMIT
[0m20:00:49.874815 [debug] [MainThread]: Using postgres connection "master"
[0m20:00:49.875004 [debug] [MainThread]: On master: COMMIT
[0m20:00:49.875320 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:00:49.875571 [debug] [MainThread]: On master: Close
[0m20:00:49.876037 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:00:49.876394 [info ] [MainThread]: 
[0m20:00:49.881890 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m20:00:49.882089 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m20:00:49.882478 [info ] [Thread-1 (]: 1 of 12 START test below_depletion_level_tests_below_depletion_level_ .......... [RUN]
[0m20:00:49.882805 [info ] [Thread-2 (]: 2 of 12 START test new_arrival_stock_depletion_test_hot_upsell_ ................ [RUN]
[0m20:00:49.883314 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m20:00:49.883842 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m20:00:49.884266 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m20:00:49.884523 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m20:00:49.884748 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m20:00:49.884960 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m20:00:49.892946 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m20:00:49.897657 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m20:00:49.899951 [debug] [Thread-1 (]: finished collecting timing info
[0m20:00:49.900084 [debug] [Thread-2 (]: finished collecting timing info
[0m20:00:49.900327 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m20:00:49.900556 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m20:00:49.915441 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m20:00:49.917399 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m20:00:49.919228 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m20:00:49.919371 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m20:00:49.919591 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m20:00:49.919834 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m20:00:49.920048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:49.920277 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:00:49.927710 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:00:49.927949 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m20:00:49.928391 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m20:00:49.928671 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m20:00:49.929000 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m20:00:49.929257 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."rugs_usa_variant" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        /* joining on model as none of these should show. doing an inner join for this purpose to test */
        JOIN "postgres"."public"."hot_upsell" model on model.name = rup.name and model.variant = ruv.variant and model.size = rupu.size and model.shape = rupu.shape and model.type = rupu.type
    )
    SELECT 
        errors
    FROM test_data
    where errors > 0

      
    ) dbt_internal_test
[0m20:00:49.944170 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m20:00:49.946921 [debug] [Thread-1 (]: finished collecting timing info
[0m20:00:49.947327 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m20:00:49.947776 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m20:00:49.948351 [info ] [Thread-1 (]: 1 of 12 PASS below_depletion_level_tests_below_depletion_level_ ................ [[32mPASS[0m in 0.07s]
[0m20:00:49.949024 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m20:00:49.949515 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m20:00:49.949939 [info ] [Thread-1 (]: 3 of 12 START test not_null_below_depletion_level_name ......................... [RUN]
[0m20:00:49.950521 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m20:00:49.950881 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m20:00:49.951152 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m20:00:49.959351 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m20:00:49.960934 [debug] [Thread-1 (]: finished collecting timing info
[0m20:00:49.961291 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m20:00:49.963318 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m20:00:49.964493 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m20:00:49.964723 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m20:00:49.964996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:49.974377 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:00:49.974895 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m20:00:49.975154 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m20:00:49.978706 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:00:49.980326 [debug] [Thread-1 (]: finished collecting timing info
[0m20:00:49.980620 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m20:00:49.980966 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m20:00:49.981488 [info ] [Thread-1 (]: 3 of 12 PASS not_null_below_depletion_level_name ............................... [[32mPASS[0m in 0.03s]
[0m20:00:49.982082 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m20:00:49.982627 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m20:00:49.982968 [info ] [Thread-1 (]: 4 of 12 START test not_null_below_depletion_level_variant ...................... [RUN]
[0m20:00:49.983525 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m20:00:49.983814 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m20:00:49.984049 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m20:00:49.987279 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m20:00:49.988342 [debug] [Thread-1 (]: finished collecting timing info
[0m20:00:49.988609 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m20:00:49.990395 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m20:00:49.991239 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m20:00:49.991441 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m20:00:49.991628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:49.998856 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:00:49.999301 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m20:00:49.999536 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m20:00:50.005144 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m20:00:50.006724 [debug] [Thread-1 (]: finished collecting timing info
[0m20:00:50.007018 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m20:00:50.007395 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m20:00:50.007901 [info ] [Thread-1 (]: 4 of 12 PASS not_null_below_depletion_level_variant ............................ [[32mPASS[0m in 0.02s]
[0m20:00:50.008403 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m20:00:50.008878 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m20:00:50.009205 [info ] [Thread-1 (]: 5 of 12 START test not_null_hot_upsell_name .................................... [RUN]
[0m20:00:50.009638 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m20:00:50.009900 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m20:00:50.010129 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m20:00:50.013413 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m20:00:50.014421 [debug] [Thread-1 (]: finished collecting timing info
[0m20:00:50.014701 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m20:00:50.016666 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m20:00:50.017629 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m20:00:50.017887 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m20:00:50.018113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:50.025651 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:00:50.026055 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m20:00:50.026389 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m20:00:50.029883 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:00:50.031274 [debug] [Thread-1 (]: finished collecting timing info
[0m20:00:50.031562 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m20:00:50.031888 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m20:00:50.032347 [info ] [Thread-1 (]: 5 of 12 PASS not_null_hot_upsell_name .......................................... [[32mPASS[0m in 0.02s]
[0m20:00:50.032788 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m20:00:50.033219 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m20:00:50.033552 [info ] [Thread-1 (]: 6 of 12 START test not_null_hot_upsell_variant ................................. [RUN]
[0m20:00:50.033990 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m20:00:50.034245 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m20:00:50.034477 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m20:00:50.037791 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m20:00:50.038752 [debug] [Thread-1 (]: finished collecting timing info
[0m20:00:50.039003 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m20:00:50.040734 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m20:00:50.041874 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m20:00:50.042089 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m20:00:50.042295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:50.049696 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:00:50.050403 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m20:00:50.051009 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m20:00:50.058082 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m20:00:50.060086 [debug] [Thread-1 (]: finished collecting timing info
[0m20:00:50.060427 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m20:00:50.060776 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m20:00:50.061229 [info ] [Thread-1 (]: 6 of 12 PASS not_null_hot_upsell_variant ....................................... [[32mPASS[0m in 0.03s]
[0m20:00:50.061754 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m20:00:50.062231 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m20:00:50.062515 [info ] [Thread-1 (]: 7 of 12 START test not_null_priority_order_name ................................ [RUN]
[0m20:00:50.062895 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m20:00:50.063139 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m20:00:50.063347 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m20:00:50.066567 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m20:00:50.068187 [debug] [Thread-1 (]: finished collecting timing info
[0m20:00:50.068683 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m20:00:50.070426 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m20:00:50.071426 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m20:00:50.071841 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: BEGIN
[0m20:00:50.072071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:50.078782 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:00:50.079208 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m20:00:50.079553 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_name.6c35449027"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."priority_order"
where name is null



      
    ) dbt_internal_test
[0m20:00:50.083464 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:00:50.084899 [debug] [Thread-1 (]: finished collecting timing info
[0m20:00:50.085232 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: ROLLBACK
[0m20:00:50.085589 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: Close
[0m20:00:50.086013 [info ] [Thread-1 (]: 7 of 12 PASS not_null_priority_order_name ...................................... [[32mPASS[0m in 0.02s]
[0m20:00:50.086444 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m20:00:50.086967 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m20:00:50.087277 [info ] [Thread-1 (]: 8 of 12 START test not_null_priority_order_profit .............................. [RUN]
[0m20:00:50.087711 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m20:00:50.087932 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m20:00:50.088151 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m20:00:50.091421 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m20:00:50.092386 [debug] [Thread-1 (]: finished collecting timing info
[0m20:00:50.092603 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m20:00:50.095291 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m20:00:50.096358 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m20:00:50.096569 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: BEGIN
[0m20:00:50.096781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:50.103663 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:00:50.104133 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m20:00:50.104372 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_profit.229518def8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select profit
from "postgres"."public"."priority_order"
where profit is null



      
    ) dbt_internal_test
[0m20:00:50.110343 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m20:00:50.112299 [debug] [Thread-1 (]: finished collecting timing info
[0m20:00:50.112710 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: ROLLBACK
[0m20:00:50.113180 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: Close
[0m20:00:50.113890 [info ] [Thread-1 (]: 8 of 12 PASS not_null_priority_order_profit .................................... [[32mPASS[0m in 0.03s]
[0m20:00:50.114514 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m20:00:50.115030 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m20:00:50.115397 [info ] [Thread-1 (]: 9 of 12 START test not_null_priority_order_variant ............................. [RUN]
[0m20:00:50.115855 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m20:00:50.116138 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m20:00:50.116365 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m20:00:50.119674 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m20:00:50.120865 [debug] [Thread-1 (]: finished collecting timing info
[0m20:00:50.121117 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m20:00:50.122751 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m20:00:50.123612 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m20:00:50.123833 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: BEGIN
[0m20:00:50.124027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:50.131350 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:00:50.131964 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m20:00:50.132317 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."priority_order"
where variant is null



      
    ) dbt_internal_test
[0m20:00:50.137958 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m20:00:50.139776 [debug] [Thread-1 (]: finished collecting timing info
[0m20:00:50.140164 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: ROLLBACK
[0m20:00:50.140559 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: Close
[0m20:00:50.141088 [info ] [Thread-1 (]: 9 of 12 PASS not_null_priority_order_variant ................................... [[32mPASS[0m in 0.03s]
[0m20:00:50.141646 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m20:00:50.142283 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m20:00:50.142600 [info ] [Thread-1 (]: 10 of 12 START test not_null_underselling_product_specs_name ................... [RUN]
[0m20:00:50.143084 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m20:00:50.143456 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m20:00:50.143737 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m20:00:50.147360 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m20:00:50.148683 [debug] [Thread-1 (]: finished collecting timing info
[0m20:00:50.148999 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m20:00:50.150865 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m20:00:50.152169 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m20:00:50.152449 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: BEGIN
[0m20:00:50.152655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:50.159425 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:00:50.159837 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m20:00:50.160055 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."underselling_product_specs"
where name is null



      
    ) dbt_internal_test
[0m20:00:50.182728 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m20:00:50.184221 [debug] [Thread-1 (]: finished collecting timing info
[0m20:00:50.184509 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: ROLLBACK
[0m20:00:50.184857 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: Close
[0m20:00:50.185329 [info ] [Thread-1 (]: 10 of 12 PASS not_null_underselling_product_specs_name ......................... [[32mPASS[0m in 0.04s]
[0m20:00:50.185845 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m20:00:50.186416 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m20:00:50.186724 [info ] [Thread-1 (]: 11 of 12 START test not_null_underselling_product_specs_stock_depletion_ratio .. [RUN]
[0m20:00:50.187182 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m20:00:50.187446 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m20:00:50.187679 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m20:00:50.191064 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m20:00:50.192072 [debug] [Thread-1 (]: finished collecting timing info
[0m20:00:50.192356 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m20:00:50.193975 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m20:00:50.194920 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m20:00:50.195221 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: BEGIN
[0m20:00:50.195440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:50.202940 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:00:50.204645 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m20:00:50.205547 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_depletion_ratio
from "postgres"."public"."underselling_product_specs"
where stock_depletion_ratio is null



      
    ) dbt_internal_test
[0m20:00:50.230039 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m20:00:50.231695 [debug] [Thread-1 (]: finished collecting timing info
[0m20:00:50.231994 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: ROLLBACK
[0m20:00:50.232379 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: Close
[0m20:00:50.232940 [info ] [Thread-1 (]: 11 of 12 PASS not_null_underselling_product_specs_stock_depletion_ratio ........ [[32mPASS[0m in 0.05s]
[0m20:00:50.233603 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m20:00:50.234214 [debug] [Thread-1 (]: Began running node test.jaffle_shop.underselling_specs_test.116f77a6eb
[0m20:00:50.234700 [info ] [Thread-1 (]: 12 of 12 START test underselling_specs_test .................................... [RUN]
[0m20:00:50.235199 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.underselling_specs_test.116f77a6eb"
[0m20:00:50.235489 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.underselling_specs_test.116f77a6eb
[0m20:00:50.235740 [debug] [Thread-1 (]: Compiling test.jaffle_shop.underselling_specs_test.116f77a6eb
[0m20:00:50.239985 [debug] [Thread-1 (]: finished collecting timing info
[0m20:00:50.240537 [debug] [Thread-1 (]: Compilation Error in test underselling_specs_test (models/underselling_product_specs/underselling_product_specs_tests.yml)
  'test_custom' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:00:50.240897 [error] [Thread-1 (]: 12 of 12 ERROR underselling_specs_test ......................................... [[31mERROR[0m in 0.01s]
[0m20:00:50.241330 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.underselling_specs_test.116f77a6eb
[0m20:03:06.843733 [debug] [Thread-2 (]: SQL status: SELECT 1 in 136.91 seconds
[0m20:03:06.856635 [debug] [Thread-2 (]: finished collecting timing info
[0m20:03:06.857292 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m20:03:06.858278 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m20:03:06.863058 [error] [Thread-2 (]: 2 of 12 FAIL 1 new_arrival_stock_depletion_test_hot_upsell_ .................... [[31mFAIL 1[0m in 136.98s]
[0m20:03:06.869978 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m20:03:06.890892 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m20:03:06.891564 [debug] [MainThread]: Using postgres connection "master"
[0m20:03:06.891836 [debug] [MainThread]: On master: BEGIN
[0m20:03:06.892082 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:03:06.904793 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m20:03:06.905485 [debug] [MainThread]: On master: COMMIT
[0m20:03:06.905949 [debug] [MainThread]: Using postgres connection "master"
[0m20:03:06.906210 [debug] [MainThread]: On master: COMMIT
[0m20:03:06.906602 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:03:06.906856 [debug] [MainThread]: On master: Close
[0m20:03:06.908166 [info ] [MainThread]: 
[0m20:03:06.908657 [info ] [MainThread]: Finished running 12 tests in 0 hours 2 minutes and 17.13 seconds (137.13s).
[0m20:03:06.909110 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:03:06.909393 [debug] [MainThread]: Connection 'test.jaffle_shop.underselling_specs_test.116f77a6eb' was properly closed.
[0m20:03:06.909645 [debug] [MainThread]: Connection 'test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38' was properly closed.
[0m20:03:06.923340 [info ] [MainThread]: 
[0m20:03:06.923780 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:03:06.924157 [info ] [MainThread]: 
[0m20:03:06.924466 [error] [MainThread]: [33mCompilation Error in test underselling_specs_test (models/underselling_product_specs/underselling_product_specs_tests.yml)[0m
[0m20:03:06.924812 [error] [MainThread]:   'test_custom' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:03:06.925094 [info ] [MainThread]: 
[0m20:03:06.925372 [error] [MainThread]: [31mFailure in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)[0m
[0m20:03:06.925726 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:03:06.925997 [info ] [MainThread]: 
[0m20:03:06.926291 [info ] [MainThread]:   compiled SQL at target/compiled/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m20:03:06.926623 [info ] [MainThread]: 
[0m20:03:06.926909 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=2 SKIP=0 TOTAL=12
[0m20:03:06.927718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9abfb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9abfe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a687c0>]}


============================== 2024-07-14 20:03:50.032858 | d4ba3a60-da51-4a01-ae23-306218d59f04 ==============================
[0m20:03:50.033188 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:03:50.061490 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m20:03:50.062115 [debug] [MainThread]: Tracking: tracking
[0m20:03:50.077132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c0e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c0f5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c0c520>]}
[0m20:03:50.129691 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:03:50.130325 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://macros/underselling_specs_test.sql
[0m20:03:50.130614 [debug] [MainThread]: Parsing macros/underselling_specs_test.sql
[0m20:03:50.143524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4ba3a60-da51-4a01-ae23-306218d59f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99f00d0>]}
[0m20:03:50.154853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4ba3a60-da51-4a01-ae23-306218d59f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae5450>]}
[0m20:03:50.155370 [info ] [MainThread]: Found 4 models, 12 tests, 2 snapshots, 0 analyses, 259 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:03:50.155762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4ba3a60-da51-4a01-ae23-306218d59f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b72410>]}
[0m20:03:50.158100 [info ] [MainThread]: 
[0m20:03:50.158709 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m20:03:50.161436 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m20:03:50.169724 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:03:50.170015 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:03:50.170260 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:03:50.214117 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m20:03:50.214621 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:03:50.214874 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:03:50.218981 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m20:03:50.220794 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:03:50.221205 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:03:50.225634 [debug] [MainThread]: Using postgres connection "master"
[0m20:03:50.225983 [debug] [MainThread]: On master: BEGIN
[0m20:03:50.226224 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:03:50.233120 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m20:03:50.233496 [debug] [MainThread]: Using postgres connection "master"
[0m20:03:50.233739 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:03:50.238711 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m20:03:50.240070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4ba3a60-da51-4a01-ae23-306218d59f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b83af0>]}
[0m20:03:50.240422 [debug] [MainThread]: On master: ROLLBACK
[0m20:03:50.240747 [debug] [MainThread]: Using postgres connection "master"
[0m20:03:50.240980 [debug] [MainThread]: On master: BEGIN
[0m20:03:50.241350 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:03:50.241658 [debug] [MainThread]: On master: COMMIT
[0m20:03:50.241873 [debug] [MainThread]: Using postgres connection "master"
[0m20:03:50.242115 [debug] [MainThread]: On master: COMMIT
[0m20:03:50.242426 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:03:50.242653 [debug] [MainThread]: On master: Close
[0m20:03:50.243057 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:03:50.243361 [info ] [MainThread]: 
[0m20:03:50.247165 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m20:03:50.247309 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m20:03:50.247622 [info ] [Thread-1 (]: 1 of 12 START test below_depletion_level_tests_below_depletion_level_ .......... [RUN]
[0m20:03:50.247941 [info ] [Thread-2 (]: 2 of 12 START test new_arrival_stock_depletion_test_hot_upsell_ ................ [RUN]
[0m20:03:50.248416 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m20:03:50.248917 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m20:03:50.249287 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m20:03:50.249534 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m20:03:50.249788 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m20:03:50.250023 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m20:03:50.256907 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m20:03:50.261065 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m20:03:50.263457 [debug] [Thread-1 (]: finished collecting timing info
[0m20:03:50.263553 [debug] [Thread-2 (]: finished collecting timing info
[0m20:03:50.263775 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m20:03:50.264012 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m20:03:50.277723 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m20:03:50.279380 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m20:03:50.281167 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m20:03:50.281291 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m20:03:50.281496 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m20:03:50.281702 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m20:03:50.281898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:03:50.282137 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:03:50.289323 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m20:03:50.289491 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:03:50.289750 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m20:03:50.289984 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m20:03:50.290191 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."rugs_usa_variant" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        /* joining on model as none of these should show. doing an inner join for this purpose to test */
        JOIN "postgres"."public"."hot_upsell" model on model.name = rup.name and model.variant = ruv.variant and model.size = rupu.size and model.shape = rupu.shape and model.type = rupu.type
    )
    SELECT 
        errors
    FROM test_data
    where errors > 0

      
    ) dbt_internal_test
[0m20:03:50.290405 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m20:03:50.303292 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m20:03:50.305829 [debug] [Thread-1 (]: finished collecting timing info
[0m20:03:50.306174 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m20:03:50.306557 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m20:03:50.307052 [info ] [Thread-1 (]: 1 of 12 PASS below_depletion_level_tests_below_depletion_level_ ................ [[32mPASS[0m in 0.06s]
[0m20:03:50.307712 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m20:03:50.308226 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m20:03:50.308543 [info ] [Thread-1 (]: 3 of 12 START test not_null_below_depletion_level_name ......................... [RUN]
[0m20:03:50.309009 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m20:03:50.309300 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m20:03:50.309533 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m20:03:50.317072 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m20:03:50.318632 [debug] [Thread-1 (]: finished collecting timing info
[0m20:03:50.318914 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m20:03:50.320694 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m20:03:50.321892 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m20:03:50.322124 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m20:03:50.322333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:03:50.329899 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:03:50.330543 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m20:03:50.330813 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m20:03:50.344884 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m20:03:50.346540 [debug] [Thread-1 (]: finished collecting timing info
[0m20:03:50.346844 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m20:03:50.347212 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m20:03:50.347693 [info ] [Thread-1 (]: 3 of 12 PASS not_null_below_depletion_level_name ............................... [[32mPASS[0m in 0.04s]
[0m20:03:50.348245 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m20:03:50.348742 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m20:03:50.349097 [info ] [Thread-1 (]: 4 of 12 START test not_null_below_depletion_level_variant ...................... [RUN]
[0m20:03:50.349555 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m20:03:50.349834 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m20:03:50.350086 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m20:03:50.353763 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m20:03:50.355126 [debug] [Thread-1 (]: finished collecting timing info
[0m20:03:50.355401 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m20:03:50.357204 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m20:03:50.358323 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m20:03:50.358559 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m20:03:50.358754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:03:50.367104 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:03:50.367957 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m20:03:50.368328 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m20:03:50.374651 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m20:03:50.376188 [debug] [Thread-1 (]: finished collecting timing info
[0m20:03:50.376464 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m20:03:50.376797 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m20:03:50.377235 [info ] [Thread-1 (]: 4 of 12 PASS not_null_below_depletion_level_variant ............................ [[32mPASS[0m in 0.03s]
[0m20:03:50.378243 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m20:03:50.378651 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m20:03:50.378960 [info ] [Thread-1 (]: 5 of 12 START test not_null_hot_upsell_name .................................... [RUN]
[0m20:03:50.379463 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m20:03:50.379738 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m20:03:50.380047 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m20:03:50.383097 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m20:03:50.384404 [debug] [Thread-1 (]: finished collecting timing info
[0m20:03:50.384699 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m20:03:50.386400 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m20:03:50.387400 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m20:03:50.387609 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m20:03:50.387810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:03:50.397071 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:03:50.397522 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m20:03:50.397757 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m20:03:50.401427 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:03:50.403048 [debug] [Thread-1 (]: finished collecting timing info
[0m20:03:50.403336 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m20:03:50.403682 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m20:03:50.404131 [info ] [Thread-1 (]: 5 of 12 PASS not_null_hot_upsell_name .......................................... [[32mPASS[0m in 0.02s]
[0m20:03:50.404603 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m20:03:50.405158 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m20:03:50.405470 [info ] [Thread-1 (]: 6 of 12 START test not_null_hot_upsell_variant ................................. [RUN]
[0m20:03:50.405944 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m20:03:50.406237 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m20:03:50.406484 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m20:03:50.409946 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m20:03:50.411090 [debug] [Thread-1 (]: finished collecting timing info
[0m20:03:50.411358 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m20:03:50.412927 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m20:03:50.413803 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m20:03:50.414013 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m20:03:50.414202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:03:50.420998 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:03:50.421378 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m20:03:50.421623 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m20:03:50.428809 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m20:03:50.430270 [debug] [Thread-1 (]: finished collecting timing info
[0m20:03:50.430552 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m20:03:50.430884 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m20:03:50.431308 [info ] [Thread-1 (]: 6 of 12 PASS not_null_hot_upsell_variant ....................................... [[32mPASS[0m in 0.03s]
[0m20:03:50.431715 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m20:03:50.432214 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m20:03:50.432530 [info ] [Thread-1 (]: 7 of 12 START test not_null_priority_order_name ................................ [RUN]
[0m20:03:50.432960 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m20:03:50.433276 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m20:03:50.433503 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m20:03:50.436613 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m20:03:50.438153 [debug] [Thread-1 (]: finished collecting timing info
[0m20:03:50.438412 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m20:03:50.440022 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m20:03:50.441203 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m20:03:50.441403 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: BEGIN
[0m20:03:50.441584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:03:50.448229 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:03:50.448618 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m20:03:50.448850 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_name.6c35449027"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."priority_order"
where name is null



      
    ) dbt_internal_test
[0m20:03:50.453218 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:03:50.454684 [debug] [Thread-1 (]: finished collecting timing info
[0m20:03:50.454963 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: ROLLBACK
[0m20:03:50.455329 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: Close
[0m20:03:50.455789 [info ] [Thread-1 (]: 7 of 12 PASS not_null_priority_order_name ...................................... [[32mPASS[0m in 0.02s]
[0m20:03:50.456227 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m20:03:50.456595 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m20:03:50.456884 [info ] [Thread-1 (]: 8 of 12 START test not_null_priority_order_profit .............................. [RUN]
[0m20:03:50.457310 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m20:03:50.457600 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m20:03:50.457889 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m20:03:50.461027 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m20:03:50.462403 [debug] [Thread-1 (]: finished collecting timing info
[0m20:03:50.462656 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m20:03:50.465310 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m20:03:50.466519 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m20:03:50.466767 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: BEGIN
[0m20:03:50.466987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:03:50.474055 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:03:50.474711 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m20:03:50.474947 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_profit.229518def8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select profit
from "postgres"."public"."priority_order"
where profit is null



      
    ) dbt_internal_test
[0m20:03:50.481088 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m20:03:50.482613 [debug] [Thread-1 (]: finished collecting timing info
[0m20:03:50.482913 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: ROLLBACK
[0m20:03:50.483316 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: Close
[0m20:03:50.483768 [info ] [Thread-1 (]: 8 of 12 PASS not_null_priority_order_profit .................................... [[32mPASS[0m in 0.03s]
[0m20:03:50.484192 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m20:03:50.484557 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m20:03:50.484862 [info ] [Thread-1 (]: 9 of 12 START test not_null_priority_order_variant ............................. [RUN]
[0m20:03:50.485315 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m20:03:50.485668 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m20:03:50.486034 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m20:03:50.489331 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m20:03:50.490710 [debug] [Thread-1 (]: finished collecting timing info
[0m20:03:50.490967 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m20:03:50.492514 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m20:03:50.493342 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m20:03:50.493547 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: BEGIN
[0m20:03:50.493751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:03:50.500169 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:03:50.500589 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m20:03:50.500930 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."priority_order"
where variant is null



      
    ) dbt_internal_test
[0m20:03:50.505991 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:03:50.507395 [debug] [Thread-1 (]: finished collecting timing info
[0m20:03:50.507651 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: ROLLBACK
[0m20:03:50.507949 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: Close
[0m20:03:50.508362 [info ] [Thread-1 (]: 9 of 12 PASS not_null_priority_order_variant ................................... [[32mPASS[0m in 0.02s]
[0m20:03:50.508763 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m20:03:50.509203 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m20:03:50.509750 [info ] [Thread-1 (]: 10 of 12 START test not_null_underselling_product_specs_name ................... [RUN]
[0m20:03:50.510280 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m20:03:50.510640 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m20:03:50.510927 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m20:03:50.514064 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m20:03:50.515750 [debug] [Thread-1 (]: finished collecting timing info
[0m20:03:50.515994 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m20:03:50.517645 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m20:03:50.519052 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m20:03:50.519339 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: BEGIN
[0m20:03:50.519583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:03:50.526002 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:03:50.526420 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m20:03:50.526639 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."underselling_product_specs"
where name is null



      
    ) dbt_internal_test
[0m20:03:50.549722 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m20:03:50.551194 [debug] [Thread-1 (]: finished collecting timing info
[0m20:03:50.551485 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: ROLLBACK
[0m20:03:50.551841 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: Close
[0m20:03:50.552273 [info ] [Thread-1 (]: 10 of 12 PASS not_null_underselling_product_specs_name ......................... [[32mPASS[0m in 0.04s]
[0m20:03:50.552742 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m20:03:50.553251 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m20:03:50.553568 [info ] [Thread-1 (]: 11 of 12 START test not_null_underselling_product_specs_stock_depletion_ratio .. [RUN]
[0m20:03:50.554014 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m20:03:50.554335 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m20:03:50.554570 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m20:03:50.557746 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m20:03:50.558959 [debug] [Thread-1 (]: finished collecting timing info
[0m20:03:50.559234 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m20:03:50.560787 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m20:03:50.561955 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m20:03:50.562173 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: BEGIN
[0m20:03:50.562375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:03:50.569046 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:03:50.569589 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m20:03:50.569824 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_depletion_ratio
from "postgres"."public"."underselling_product_specs"
where stock_depletion_ratio is null



      
    ) dbt_internal_test
[0m20:03:50.590543 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m20:03:50.592061 [debug] [Thread-1 (]: finished collecting timing info
[0m20:03:50.592359 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: ROLLBACK
[0m20:03:50.592701 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: Close
[0m20:03:50.593153 [info ] [Thread-1 (]: 11 of 12 PASS not_null_underselling_product_specs_stock_depletion_ratio ........ [[32mPASS[0m in 0.04s]
[0m20:03:50.593572 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m20:03:50.594041 [debug] [Thread-1 (]: Began running node test.jaffle_shop.underselling_specs_test.116f77a6eb
[0m20:03:50.594351 [info ] [Thread-1 (]: 12 of 12 START test underselling_specs_test .................................... [RUN]
[0m20:03:50.594791 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.underselling_specs_test.116f77a6eb"
[0m20:03:50.595111 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.underselling_specs_test.116f77a6eb
[0m20:03:50.595350 [debug] [Thread-1 (]: Compiling test.jaffle_shop.underselling_specs_test.116f77a6eb
[0m20:03:50.599104 [debug] [Thread-1 (]: finished collecting timing info
[0m20:03:50.599565 [debug] [Thread-1 (]: Compilation Error in test underselling_specs_test (models/underselling_product_specs/underselling_product_specs_tests.yml)
  'test_custom' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:03:50.599932 [error] [Thread-1 (]: 12 of 12 ERROR underselling_specs_test ......................................... [[31mERROR[0m in 0.01s]
[0m20:03:50.600328 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.underselling_specs_test.116f77a6eb
[0m20:06:06.134122 [debug] [Thread-2 (]: SQL status: SELECT 1 in 135.84 seconds
[0m20:06:06.147905 [debug] [Thread-2 (]: finished collecting timing info
[0m20:06:06.151806 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m20:06:06.154938 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m20:06:06.161476 [error] [Thread-2 (]: 2 of 12 FAIL 1 new_arrival_stock_depletion_test_hot_upsell_ .................... [[31mFAIL 1[0m in 135.91s]
[0m20:06:06.164038 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m20:06:06.170799 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m20:06:06.171477 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:06.171767 [debug] [MainThread]: On master: BEGIN
[0m20:06:06.172072 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:06:06.182765 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m20:06:06.183591 [debug] [MainThread]: On master: COMMIT
[0m20:06:06.183933 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:06.184210 [debug] [MainThread]: On master: COMMIT
[0m20:06:06.184634 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:06:06.184925 [debug] [MainThread]: On master: Close
[0m20:06:06.186356 [info ] [MainThread]: 
[0m20:06:06.186934 [info ] [MainThread]: Finished running 12 tests in 0 hours 2 minutes and 16.03 seconds (136.03s).
[0m20:06:06.187404 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:06:06.187840 [debug] [MainThread]: Connection 'test.jaffle_shop.underselling_specs_test.116f77a6eb' was properly closed.
[0m20:06:06.188087 [debug] [MainThread]: Connection 'test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38' was properly closed.
[0m20:06:06.204404 [info ] [MainThread]: 
[0m20:06:06.204898 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:06:06.205566 [info ] [MainThread]: 
[0m20:06:06.205950 [error] [MainThread]: [33mCompilation Error in test underselling_specs_test (models/underselling_product_specs/underselling_product_specs_tests.yml)[0m
[0m20:06:06.206356 [error] [MainThread]:   'test_custom' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:06:06.206700 [info ] [MainThread]: 
[0m20:06:06.207072 [error] [MainThread]: [31mFailure in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)[0m
[0m20:06:06.207426 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:06:06.207798 [info ] [MainThread]: 
[0m20:06:06.208074 [info ] [MainThread]:   compiled SQL at target/compiled/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m20:06:06.208429 [info ] [MainThread]: 
[0m20:06:06.208761 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=2 SKIP=0 TOTAL=12
[0m20:06:06.209752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9abfeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9abfb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a6f3d0>]}


============================== 2024-07-14 20:07:25.326254 | 4028d13c-8dfc-40c4-9d7e-87487099ad14 ==============================
[0m20:07:25.326636 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:07:25.357700 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m20:07:25.358235 [debug] [MainThread]: Tracking: tracking
[0m20:07:25.374592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1c760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1ff70>]}
[0m20:07:25.431286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:07:25.431921 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://macros/underselling_specs_test.sql
[0m20:07:25.432196 [debug] [MainThread]: Parsing macros/underselling_specs_test.sql
[0m20:07:25.445747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4028d13c-8dfc-40c4-9d7e-87487099ad14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99f00d0>]}
[0m20:07:25.458599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4028d13c-8dfc-40c4-9d7e-87487099ad14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae54b0>]}
[0m20:07:25.459064 [info ] [MainThread]: Found 4 models, 12 tests, 2 snapshots, 0 analyses, 259 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:07:25.459417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4028d13c-8dfc-40c4-9d7e-87487099ad14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b72470>]}
[0m20:07:25.462069 [info ] [MainThread]: 
[0m20:07:25.462928 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m20:07:25.466460 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m20:07:25.475676 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:07:25.476045 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:07:25.476296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:25.522414 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m20:07:25.522937 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:07:25.523224 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:07:25.527668 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m20:07:25.529584 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:07:25.530019 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:07:25.534551 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:25.534939 [debug] [MainThread]: On master: BEGIN
[0m20:07:25.535174 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:07:25.542073 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m20:07:25.542483 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:25.542726 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:07:25.547281 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m20:07:25.548704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4028d13c-8dfc-40c4-9d7e-87487099ad14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b83eb0>]}
[0m20:07:25.549085 [debug] [MainThread]: On master: ROLLBACK
[0m20:07:25.549441 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:25.549666 [debug] [MainThread]: On master: BEGIN
[0m20:07:25.550063 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:07:25.550353 [debug] [MainThread]: On master: COMMIT
[0m20:07:25.550588 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:25.550798 [debug] [MainThread]: On master: COMMIT
[0m20:07:25.551094 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:07:25.551334 [debug] [MainThread]: On master: Close
[0m20:07:25.551724 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:07:25.552037 [info ] [MainThread]: 
[0m20:07:25.556545 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m20:07:25.556733 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m20:07:25.557036 [info ] [Thread-1 (]: 1 of 12 START test below_depletion_level_tests_below_depletion_level_ .......... [RUN]
[0m20:07:25.557401 [info ] [Thread-2 (]: 2 of 12 START test new_arrival_stock_depletion_test_hot_upsell_ ................ [RUN]
[0m20:07:25.557907 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m20:07:25.558552 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m20:07:25.559086 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m20:07:25.559482 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m20:07:25.559819 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m20:07:25.560079 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m20:07:25.567825 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m20:07:25.573588 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m20:07:25.578905 [debug] [Thread-1 (]: finished collecting timing info
[0m20:07:25.579685 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m20:07:25.593450 [debug] [Thread-2 (]: finished collecting timing info
[0m20:07:25.600605 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m20:07:25.601104 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m20:07:25.603497 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m20:07:25.605739 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m20:07:25.606349 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m20:07:25.606693 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m20:07:25.606783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:25.607053 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m20:07:25.607612 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:07:25.615019 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:07:25.615279 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m20:07:25.615664 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m20:07:25.616421 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m20:07:25.616918 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m20:07:25.617168 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."rugs_usa_variant" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        /* joining on model as none of these should show. doing an inner join for this purpose to test */
        JOIN "postgres"."public"."hot_upsell" model on model.name = rup.name and model.variant = ruv.variant and model.size = rupu.size and model.shape = rupu.shape and model.type = rupu.type
    )
    SELECT 
        errors
    FROM test_data
    where errors > 0

      
    ) dbt_internal_test
[0m20:07:25.631327 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m20:07:25.634339 [debug] [Thread-1 (]: finished collecting timing info
[0m20:07:25.634745 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m20:07:25.635150 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m20:07:25.635777 [info ] [Thread-1 (]: 1 of 12 PASS below_depletion_level_tests_below_depletion_level_ ................ [[32mPASS[0m in 0.08s]
[0m20:07:25.636710 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m20:07:25.637127 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m20:07:25.637543 [info ] [Thread-1 (]: 3 of 12 START test not_null_below_depletion_level_name ......................... [RUN]
[0m20:07:25.638087 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m20:07:25.638392 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m20:07:25.638663 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m20:07:25.647676 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m20:07:25.649558 [debug] [Thread-1 (]: finished collecting timing info
[0m20:07:25.649876 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m20:07:25.651744 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m20:07:25.652908 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m20:07:25.653146 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m20:07:25.653375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:25.661677 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:07:25.662423 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m20:07:25.662752 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m20:07:25.666603 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:07:25.668719 [debug] [Thread-1 (]: finished collecting timing info
[0m20:07:25.671406 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m20:07:25.672317 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m20:07:25.673482 [info ] [Thread-1 (]: 3 of 12 PASS not_null_below_depletion_level_name ............................... [[32mPASS[0m in 0.04s]
[0m20:07:25.674403 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m20:07:25.674847 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m20:07:25.675207 [info ] [Thread-1 (]: 4 of 12 START test not_null_below_depletion_level_variant ...................... [RUN]
[0m20:07:25.675680 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m20:07:25.675934 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m20:07:25.676677 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m20:07:25.682846 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m20:07:25.685619 [debug] [Thread-1 (]: finished collecting timing info
[0m20:07:25.686218 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m20:07:25.688201 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m20:07:25.689869 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m20:07:25.690165 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m20:07:25.690372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:25.699205 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:07:25.699720 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m20:07:25.699967 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m20:07:25.707227 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m20:07:25.709914 [debug] [Thread-1 (]: finished collecting timing info
[0m20:07:25.710338 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m20:07:25.710703 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m20:07:25.711148 [info ] [Thread-1 (]: 4 of 12 PASS not_null_below_depletion_level_variant ............................ [[32mPASS[0m in 0.04s]
[0m20:07:25.711583 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m20:07:25.712053 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m20:07:25.712366 [info ] [Thread-1 (]: 5 of 12 START test not_null_hot_upsell_name .................................... [RUN]
[0m20:07:25.712818 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m20:07:25.713166 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m20:07:25.713506 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m20:07:25.717725 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m20:07:25.719266 [debug] [Thread-1 (]: finished collecting timing info
[0m20:07:25.719533 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m20:07:25.721248 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m20:07:25.722250 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m20:07:25.722458 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m20:07:25.722702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:25.729439 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:07:25.730126 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m20:07:25.731234 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m20:07:25.736028 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:07:25.737714 [debug] [Thread-1 (]: finished collecting timing info
[0m20:07:25.738035 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m20:07:25.738393 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m20:07:25.738816 [info ] [Thread-1 (]: 5 of 12 PASS not_null_hot_upsell_name .......................................... [[32mPASS[0m in 0.03s]
[0m20:07:25.739302 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m20:07:25.739866 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m20:07:25.740171 [info ] [Thread-1 (]: 6 of 12 START test not_null_hot_upsell_variant ................................. [RUN]
[0m20:07:25.740664 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m20:07:25.741034 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m20:07:25.741474 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m20:07:25.744727 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m20:07:25.746253 [debug] [Thread-1 (]: finished collecting timing info
[0m20:07:25.746662 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m20:07:25.748933 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m20:07:25.750209 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m20:07:25.750432 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m20:07:25.750648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:25.757930 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:07:25.758737 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m20:07:25.758996 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m20:07:25.766383 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m20:07:25.767902 [debug] [Thread-1 (]: finished collecting timing info
[0m20:07:25.768451 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m20:07:25.768818 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m20:07:25.769307 [info ] [Thread-1 (]: 6 of 12 PASS not_null_hot_upsell_variant ....................................... [[32mPASS[0m in 0.03s]
[0m20:07:25.769807 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m20:07:25.770359 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m20:07:25.770738 [info ] [Thread-1 (]: 7 of 12 START test not_null_priority_order_name ................................ [RUN]
[0m20:07:25.771839 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m20:07:25.773495 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m20:07:25.773971 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m20:07:25.777307 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m20:07:25.781372 [debug] [Thread-1 (]: finished collecting timing info
[0m20:07:25.782167 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m20:07:25.785066 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m20:07:25.801638 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m20:07:25.802082 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: BEGIN
[0m20:07:25.802472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:25.810740 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:07:25.811578 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m20:07:25.812070 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_name.6c35449027"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."priority_order"
where name is null



      
    ) dbt_internal_test
[0m20:07:25.817663 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m20:07:25.824691 [debug] [Thread-1 (]: finished collecting timing info
[0m20:07:25.828041 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: ROLLBACK
[0m20:07:25.832585 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: Close
[0m20:07:25.833888 [info ] [Thread-1 (]: 7 of 12 PASS not_null_priority_order_name ...................................... [[32mPASS[0m in 0.06s]
[0m20:07:25.834599 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m20:07:25.837934 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m20:07:25.839476 [info ] [Thread-1 (]: 8 of 12 START test not_null_priority_order_profit .............................. [RUN]
[0m20:07:25.840168 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m20:07:25.840604 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m20:07:25.840893 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m20:07:25.846249 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m20:07:25.847915 [debug] [Thread-1 (]: finished collecting timing info
[0m20:07:25.848182 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m20:07:25.850874 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m20:07:25.852321 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m20:07:25.852812 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: BEGIN
[0m20:07:25.853243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:25.860809 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:07:25.861388 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m20:07:25.861643 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_profit.229518def8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select profit
from "postgres"."public"."priority_order"
where profit is null



      
    ) dbt_internal_test
[0m20:07:25.868492 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m20:07:25.870343 [debug] [Thread-1 (]: finished collecting timing info
[0m20:07:25.870725 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: ROLLBACK
[0m20:07:25.871131 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: Close
[0m20:07:25.871725 [info ] [Thread-1 (]: 8 of 12 PASS not_null_priority_order_profit .................................... [[32mPASS[0m in 0.03s]
[0m20:07:25.872318 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m20:07:25.872801 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m20:07:25.873209 [info ] [Thread-1 (]: 9 of 12 START test not_null_priority_order_variant ............................. [RUN]
[0m20:07:25.873760 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m20:07:25.874108 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m20:07:25.874412 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m20:07:25.878023 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m20:07:25.879632 [debug] [Thread-1 (]: finished collecting timing info
[0m20:07:25.880168 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m20:07:25.882479 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m20:07:25.884009 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m20:07:25.884493 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: BEGIN
[0m20:07:25.884994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:25.891763 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:07:25.892259 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m20:07:25.892492 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."priority_order"
where variant is null



      
    ) dbt_internal_test
[0m20:07:25.897517 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:07:25.898948 [debug] [Thread-1 (]: finished collecting timing info
[0m20:07:25.899235 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: ROLLBACK
[0m20:07:25.899578 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: Close
[0m20:07:25.900026 [info ] [Thread-1 (]: 9 of 12 PASS not_null_priority_order_variant ................................... [[32mPASS[0m in 0.03s]
[0m20:07:25.900531 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m20:07:25.900896 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m20:07:25.901291 [info ] [Thread-1 (]: 10 of 12 START test not_null_underselling_product_specs_name ................... [RUN]
[0m20:07:25.901857 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m20:07:25.902154 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m20:07:25.902419 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m20:07:25.905633 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m20:07:25.907126 [debug] [Thread-1 (]: finished collecting timing info
[0m20:07:25.907386 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m20:07:25.908981 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m20:07:25.910331 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m20:07:25.910555 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: BEGIN
[0m20:07:25.910765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:25.917799 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:07:25.918457 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m20:07:25.918732 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."underselling_product_specs"
where name is null



      
    ) dbt_internal_test
[0m20:07:25.943111 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m20:07:25.944947 [debug] [Thread-1 (]: finished collecting timing info
[0m20:07:25.945354 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: ROLLBACK
[0m20:07:25.945834 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: Close
[0m20:07:25.946622 [info ] [Thread-1 (]: 10 of 12 PASS not_null_underselling_product_specs_name ......................... [[32mPASS[0m in 0.04s]
[0m20:07:25.947625 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m20:07:25.948938 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m20:07:25.949509 [info ] [Thread-1 (]: 11 of 12 START test not_null_underselling_product_specs_stock_depletion_ratio .. [RUN]
[0m20:07:25.950190 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m20:07:25.950931 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m20:07:25.951486 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m20:07:25.955810 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m20:07:25.957645 [debug] [Thread-1 (]: finished collecting timing info
[0m20:07:25.958013 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m20:07:25.959773 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m20:07:25.961324 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m20:07:25.961548 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: BEGIN
[0m20:07:25.961760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:25.968464 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:07:25.968862 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m20:07:25.969103 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_depletion_ratio
from "postgres"."public"."underselling_product_specs"
where stock_depletion_ratio is null



      
    ) dbt_internal_test
[0m20:07:25.989839 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m20:07:25.991316 [debug] [Thread-1 (]: finished collecting timing info
[0m20:07:25.991606 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: ROLLBACK
[0m20:07:25.991945 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: Close
[0m20:07:25.992417 [info ] [Thread-1 (]: 11 of 12 PASS not_null_underselling_product_specs_stock_depletion_ratio ........ [[32mPASS[0m in 0.04s]
[0m20:07:25.992854 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m20:07:25.993221 [debug] [Thread-1 (]: Began running node test.jaffle_shop.underselling_specs_test.116f77a6eb
[0m20:07:25.993525 [info ] [Thread-1 (]: 12 of 12 START test underselling_specs_test .................................... [RUN]
[0m20:07:25.993958 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.underselling_specs_test.116f77a6eb"
[0m20:07:25.994247 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.underselling_specs_test.116f77a6eb
[0m20:07:25.994476 [debug] [Thread-1 (]: Compiling test.jaffle_shop.underselling_specs_test.116f77a6eb
[0m20:07:25.998455 [debug] [Thread-1 (]: finished collecting timing info
[0m20:07:25.998958 [debug] [Thread-1 (]: Compilation Error in test underselling_specs_test (models/underselling_product_specs/underselling_product_specs_tests.yml)
  'test_custom' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:07:25.999302 [error] [Thread-1 (]: 12 of 12 ERROR underselling_specs_test ......................................... [[31mERROR[0m in 0.01s]
[0m20:07:25.999719 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.underselling_specs_test.116f77a6eb
[0m20:09:41.374101 [debug] [Thread-2 (]: SQL status: SELECT 1 in 135.76 seconds
[0m20:09:41.387024 [debug] [Thread-2 (]: finished collecting timing info
[0m20:09:41.387770 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m20:09:41.388514 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m20:09:41.390541 [error] [Thread-2 (]: 2 of 12 FAIL 1 new_arrival_stock_depletion_test_hot_upsell_ .................... [[31mFAIL 1[0m in 135.83s]
[0m20:09:41.392391 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m20:09:41.398907 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m20:09:41.399383 [debug] [MainThread]: Using postgres connection "master"
[0m20:09:41.399656 [debug] [MainThread]: On master: BEGIN
[0m20:09:41.399923 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:09:41.408774 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m20:09:41.409214 [debug] [MainThread]: On master: COMMIT
[0m20:09:41.409479 [debug] [MainThread]: Using postgres connection "master"
[0m20:09:41.409707 [debug] [MainThread]: On master: COMMIT
[0m20:09:41.410037 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:09:41.410325 [debug] [MainThread]: On master: Close
[0m20:09:41.411400 [info ] [MainThread]: 
[0m20:09:41.411796 [info ] [MainThread]: Finished running 12 tests in 0 hours 2 minutes and 15.95 seconds (135.95s).
[0m20:09:41.412241 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:09:41.412526 [debug] [MainThread]: Connection 'test.jaffle_shop.underselling_specs_test.116f77a6eb' was properly closed.
[0m20:09:41.412753 [debug] [MainThread]: Connection 'test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38' was properly closed.
[0m20:09:41.440694 [info ] [MainThread]: 
[0m20:09:41.441132 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:09:41.441639 [info ] [MainThread]: 
[0m20:09:41.442014 [error] [MainThread]: [33mCompilation Error in test underselling_specs_test (models/underselling_product_specs/underselling_product_specs_tests.yml)[0m
[0m20:09:41.442310 [error] [MainThread]:   'test_custom' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:09:41.442651 [info ] [MainThread]: 
[0m20:09:41.443012 [error] [MainThread]: [31mFailure in test new_arrival_stock_depletion_test_hot_upsell_ (models/hot_upsell/hot_upsell_tests.yml)[0m
[0m20:09:41.443361 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:09:41.443666 [info ] [MainThread]: 
[0m20:09:41.444003 [info ] [MainThread]:   compiled SQL at target/compiled/jaffle_shop/models/hot_upsell/hot_upsell_tests.yml/new_arrival_stock_depletion_test_hot_upsell_.sql
[0m20:09:41.444339 [info ] [MainThread]: 
[0m20:09:41.444659 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=2 SKIP=0 TOTAL=12
[0m20:09:41.445608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ab7df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ab7dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a6d840>]}


============================== 2024-07-14 20:10:18.571320 | 04e14106-7519-4420-9a8b-3fcd06310896 ==============================
[0m20:10:18.571639 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:10:18.607884 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m20:10:18.608362 [debug] [MainThread]: Tracking: tracking
[0m20:10:18.623077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b280>]}
[0m20:10:18.682417 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:10:18.683165 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://macros/underselling_specs_test.sql
[0m20:10:18.683632 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://macros/upsell_test.sql
[0m20:10:18.683911 [debug] [MainThread]: Parsing macros/underselling_specs_test.sql
[0m20:10:18.686183 [debug] [MainThread]: Parsing macros/upsell_test.sql
[0m20:10:18.726676 [debug] [MainThread]: 1699: static parser successfully parsed hot_upsell/hot_upsell.sql
[0m20:10:18.770954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04e14106-7519-4420-9a8b-3fcd06310896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a13ee0>]}
[0m20:10:18.781558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04e14106-7519-4420-9a8b-3fcd06310896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b72320>]}
[0m20:10:18.781914 [info ] [MainThread]: Found 4 models, 12 tests, 2 snapshots, 0 analyses, 259 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:10:18.782228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04e14106-7519-4420-9a8b-3fcd06310896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b72350>]}
[0m20:10:18.784301 [info ] [MainThread]: 
[0m20:10:18.784878 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m20:10:18.787212 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m20:10:18.795926 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:10:18.796276 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:10:18.796505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:18.840352 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m20:10:18.840870 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:10:18.841141 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:10:18.845228 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m20:10:18.846933 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:10:18.847342 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:10:18.851742 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:18.852082 [debug] [MainThread]: On master: BEGIN
[0m20:10:18.852311 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:10:18.858788 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m20:10:18.859189 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:18.859434 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:10:18.864074 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m20:10:18.865827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04e14106-7519-4420-9a8b-3fcd06310896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a75bd0>]}
[0m20:10:18.866181 [debug] [MainThread]: On master: ROLLBACK
[0m20:10:18.866498 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:18.866743 [debug] [MainThread]: On master: BEGIN
[0m20:10:18.867124 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:10:18.867491 [debug] [MainThread]: On master: COMMIT
[0m20:10:18.867720 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:18.867930 [debug] [MainThread]: On master: COMMIT
[0m20:10:18.868240 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:10:18.868476 [debug] [MainThread]: On master: Close
[0m20:10:18.868861 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:10:18.869172 [info ] [MainThread]: 
[0m20:10:18.873197 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m20:10:18.873360 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m20:10:18.873663 [info ] [Thread-1 (]: 1 of 12 START test below_depletion_level_tests_below_depletion_level_ .......... [RUN]
[0m20:10:18.873974 [info ] [Thread-2 (]: 2 of 12 START test new_arrival_stock_depletion_test_hot_upsell_ ................ [RUN]
[0m20:10:18.874500 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m20:10:18.875008 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m20:10:18.875334 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m20:10:18.875591 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m20:10:18.875806 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m20:10:18.876045 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m20:10:18.879493 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m20:10:18.882197 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m20:10:18.884755 [debug] [Thread-1 (]: finished collecting timing info
[0m20:10:18.884968 [debug] [Thread-2 (]: finished collecting timing info
[0m20:10:18.885087 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m20:10:18.885329 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m20:10:18.900272 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m20:10:18.902379 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m20:10:18.904121 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m20:10:18.904319 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m20:10:18.904472 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m20:10:18.904690 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m20:10:18.904857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:18.905069 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:10:18.912349 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:10:18.912822 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m20:10:18.913005 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m20:10:18.913282 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m20:10:18.913496 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m20:10:18.913791 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."rugs_usa_variant" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        /* joining on model as none of these should show. doing an inner join for this purpose to test */
        JOIN "postgres"."public"."hot_upsell" model on model.name = rup.name and model.variant = ruv.variant and model.size = rupu.size and model.shape = rupu.shape and model.type = rupu.type
        where new_arrival <> 'Y' and stock_level >= coalesce(depletion_level, 0) and rupu.stock is null
    )
    SELECT 
        errors
    FROM test_data
    where errors > 0

      
    ) dbt_internal_test
[0m20:10:18.928411 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m20:10:18.931146 [debug] [Thread-1 (]: finished collecting timing info
[0m20:10:18.931538 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m20:10:18.931939 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m20:10:18.932469 [info ] [Thread-1 (]: 1 of 12 PASS below_depletion_level_tests_below_depletion_level_ ................ [[32mPASS[0m in 0.06s]
[0m20:10:18.933117 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m20:10:18.933664 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m20:10:18.933987 [info ] [Thread-1 (]: 3 of 12 START test not_null_below_depletion_level_name ......................... [RUN]
[0m20:10:18.934544 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m20:10:18.934832 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m20:10:18.935014 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m20:10:18.941451 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m20:10:18.943413 [debug] [Thread-1 (]: finished collecting timing info
[0m20:10:18.943665 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m20:10:18.945603 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m20:10:18.946780 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m20:10:18.946961 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m20:10:18.947158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:18.956776 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:10:18.958129 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m20:10:18.958636 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m20:10:18.967854 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m20:10:18.971096 [debug] [Thread-1 (]: finished collecting timing info
[0m20:10:18.971615 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m20:10:18.972190 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m20:10:18.972977 [info ] [Thread-1 (]: 3 of 12 PASS not_null_below_depletion_level_name ............................... [[32mPASS[0m in 0.04s]
[0m20:10:18.973973 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m20:10:18.975231 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m20:10:18.975826 [info ] [Thread-1 (]: 4 of 12 START test not_null_below_depletion_level_variant ...................... [RUN]
[0m20:10:18.977357 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m20:10:18.977947 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m20:10:18.978182 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m20:10:18.982568 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m20:10:18.984049 [debug] [Thread-1 (]: finished collecting timing info
[0m20:10:18.984310 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m20:10:18.986393 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m20:10:18.987527 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m20:10:18.987729 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m20:10:18.987922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:18.989202 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.07 seconds
[0m20:10:18.990999 [debug] [Thread-2 (]: finished collecting timing info
[0m20:10:18.991368 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m20:10:18.991772 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m20:10:18.995605 [info ] [Thread-2 (]: 2 of 12 PASS new_arrival_stock_depletion_test_hot_upsell_ ...................... [[32mPASS[0m in 0.12s]
[0m20:10:18.997259 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m20:10:18.997795 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m20:10:18.998263 [info ] [Thread-2 (]: 5 of 12 START test not_null_hot_upsell_name .................................... [RUN]
[0m20:10:18.998440 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:10:18.998971 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m20:10:18.999216 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m20:10:18.999457 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m20:10:18.999662 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m20:10:18.999866 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m20:10:19.004330 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m20:10:19.005334 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m20:10:19.006696 [debug] [Thread-1 (]: finished collecting timing info
[0m20:10:19.006927 [debug] [Thread-2 (]: finished collecting timing info
[0m20:10:19.007044 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m20:10:19.007310 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m20:10:19.007646 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m20:10:19.009200 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m20:10:19.009644 [info ] [Thread-1 (]: 4 of 12 PASS not_null_below_depletion_level_variant ............................ [[32mPASS[0m in 0.03s]
[0m20:10:19.010800 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m20:10:19.011345 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m20:10:19.011487 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m20:10:19.011756 [info ] [Thread-1 (]: 6 of 12 START test not_null_hot_upsell_variant ................................. [RUN]
[0m20:10:19.011998 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m20:10:19.012659 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m20:10:19.012894 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:10:19.013161 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m20:10:19.013654 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m20:10:19.017188 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m20:10:19.018292 [debug] [Thread-1 (]: finished collecting timing info
[0m20:10:19.018520 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m20:10:19.020180 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m20:10:19.020479 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m20:10:19.021146 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m20:10:19.021354 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m20:10:19.021747 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m20:10:19.025123 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m20:10:19.025339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:19.025827 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:10:19.027472 [debug] [Thread-2 (]: finished collecting timing info
[0m20:10:19.027882 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m20:10:19.028192 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m20:10:19.028611 [info ] [Thread-2 (]: 5 of 12 PASS not_null_hot_upsell_name .......................................... [[32mPASS[0m in 0.03s]
[0m20:10:19.029569 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m20:10:19.030273 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m20:10:19.030586 [info ] [Thread-2 (]: 7 of 12 START test not_null_priority_order_name ................................ [RUN]
[0m20:10:19.031038 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m20:10:19.031354 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m20:10:19.031553 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m20:10:19.034739 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m20:10:19.035081 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:10:19.035832 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m20:10:19.036048 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m20:10:19.036574 [debug] [Thread-2 (]: finished collecting timing info
[0m20:10:19.036971 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m20:10:19.039059 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m20:10:19.040658 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m20:10:19.040878 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: BEGIN
[0m20:10:19.041073 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:10:19.043951 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m20:10:19.045539 [debug] [Thread-1 (]: finished collecting timing info
[0m20:10:19.045824 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m20:10:19.046136 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m20:10:19.046561 [info ] [Thread-1 (]: 6 of 12 PASS not_null_hot_upsell_variant ....................................... [[32mPASS[0m in 0.03s]
[0m20:10:19.046986 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m20:10:19.047420 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m20:10:19.047678 [info ] [Thread-1 (]: 8 of 12 START test not_null_priority_order_profit .............................. [RUN]
[0m20:10:19.048131 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m20:10:19.048385 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m20:10:19.048609 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m20:10:19.051989 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m20:10:19.052416 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m20:10:19.053179 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m20:10:19.053573 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_name.6c35449027"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."priority_order"
where name is null



      
    ) dbt_internal_test
[0m20:10:19.053676 [debug] [Thread-1 (]: finished collecting timing info
[0m20:10:19.054049 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m20:10:19.055748 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m20:10:19.056926 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m20:10:19.057148 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: BEGIN
[0m20:10:19.057241 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:10:19.057424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:19.058588 [debug] [Thread-2 (]: finished collecting timing info
[0m20:10:19.059147 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: ROLLBACK
[0m20:10:19.059652 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: Close
[0m20:10:19.060193 [info ] [Thread-2 (]: 7 of 12 PASS not_null_priority_order_name ...................................... [[32mPASS[0m in 0.03s]
[0m20:10:19.060718 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m20:10:19.061151 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m20:10:19.061433 [info ] [Thread-2 (]: 9 of 12 START test not_null_priority_order_variant ............................. [RUN]
[0m20:10:19.061846 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m20:10:19.062052 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m20:10:19.062286 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m20:10:19.065814 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m20:10:19.066232 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:10:19.066877 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m20:10:19.067131 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_profit.229518def8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select profit
from "postgres"."public"."priority_order"
where profit is null



      
    ) dbt_internal_test
[0m20:10:19.067341 [debug] [Thread-2 (]: finished collecting timing info
[0m20:10:19.067607 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m20:10:19.069481 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m20:10:19.070498 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m20:10:19.070691 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: BEGIN
[0m20:10:19.070884 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:10:19.073311 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m20:10:19.074708 [debug] [Thread-1 (]: finished collecting timing info
[0m20:10:19.074967 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: ROLLBACK
[0m20:10:19.075242 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: Close
[0m20:10:19.075661 [info ] [Thread-1 (]: 8 of 12 PASS not_null_priority_order_profit .................................... [[32mPASS[0m in 0.03s]
[0m20:10:19.076119 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m20:10:19.076496 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m20:10:19.077506 [info ] [Thread-1 (]: 10 of 12 START test not_null_underselling_product_specs_name ................... [RUN]
[0m20:10:19.077617 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m20:10:19.078131 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m20:10:19.078346 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m20:10:19.078601 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m20:10:19.078854 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."priority_order"
where variant is null



      
    ) dbt_internal_test
[0m20:10:19.079204 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m20:10:19.087165 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m20:10:19.087359 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m20:10:19.089276 [debug] [Thread-2 (]: finished collecting timing info
[0m20:10:19.089626 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: ROLLBACK
[0m20:10:19.089904 [debug] [Thread-1 (]: finished collecting timing info
[0m20:10:19.090152 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: Close
[0m20:10:19.090387 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m20:10:19.090802 [info ] [Thread-2 (]: 9 of 12 PASS not_null_priority_order_variant ................................... [[32mPASS[0m in 0.03s]
[0m20:10:19.092989 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m20:10:19.093557 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m20:10:19.094140 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m20:10:19.094556 [info ] [Thread-2 (]: 11 of 12 START test not_null_underselling_product_specs_stock_depletion_ratio .. [RUN]
[0m20:10:19.094946 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m20:10:19.095202 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m20:10:19.095399 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: BEGIN
[0m20:10:19.095628 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m20:10:19.095826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:19.096046 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m20:10:19.100472 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m20:10:19.102814 [debug] [Thread-2 (]: finished collecting timing info
[0m20:10:19.103113 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m20:10:19.105011 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m20:10:19.105393 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:10:19.106516 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m20:10:19.106944 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m20:10:19.107036 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."underselling_product_specs"
where name is null



      
    ) dbt_internal_test
[0m20:10:19.107217 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: BEGIN
[0m20:10:19.107606 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:10:19.114486 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m20:10:19.114949 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m20:10:19.115260 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_depletion_ratio
from "postgres"."public"."underselling_product_specs"
where stock_depletion_ratio is null



      
    ) dbt_internal_test
[0m20:10:19.130721 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m20:10:19.132197 [debug] [Thread-1 (]: finished collecting timing info
[0m20:10:19.132472 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: ROLLBACK
[0m20:10:19.132828 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: Close
[0m20:10:19.135344 [info ] [Thread-1 (]: 10 of 12 PASS not_null_underselling_product_specs_name ......................... [[32mPASS[0m in 0.06s]
[0m20:10:19.135850 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m20:10:19.136339 [debug] [Thread-1 (]: Began running node test.jaffle_shop.underselling_specs_test.116f77a6eb
[0m20:10:19.136807 [info ] [Thread-1 (]: 12 of 12 START test underselling_specs_test .................................... [RUN]
[0m20:10:19.137901 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.02 seconds
[0m20:10:19.141001 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.underselling_specs_test.116f77a6eb"
[0m20:10:19.142291 [debug] [Thread-2 (]: finished collecting timing info
[0m20:10:19.142578 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.underselling_specs_test.116f77a6eb
[0m20:10:19.142830 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: ROLLBACK
[0m20:10:19.143097 [debug] [Thread-1 (]: Compiling test.jaffle_shop.underselling_specs_test.116f77a6eb
[0m20:10:19.143490 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: Close
[0m20:10:19.147463 [debug] [Thread-1 (]: finished collecting timing info
[0m20:10:19.147783 [info ] [Thread-2 (]: 11 of 12 PASS not_null_underselling_product_specs_stock_depletion_ratio ........ [[32mPASS[0m in 0.05s]
[0m20:10:19.148245 [debug] [Thread-1 (]: Compilation Error in test underselling_specs_test (models/underselling_product_specs/underselling_product_specs_tests.yml)
  'test_custom' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:10:19.148828 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m20:10:19.149217 [error] [Thread-1 (]: 12 of 12 ERROR underselling_specs_test ......................................... [[31mERROR[0m in 0.01s]
[0m20:10:19.149882 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.underselling_specs_test.116f77a6eb
[0m20:10:19.151762 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m20:10:19.152050 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:19.152274 [debug] [MainThread]: On master: BEGIN
[0m20:10:19.152494 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:10:19.158844 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m20:10:19.159284 [debug] [MainThread]: On master: COMMIT
[0m20:10:19.159515 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:19.159740 [debug] [MainThread]: On master: COMMIT
[0m20:10:19.160075 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:10:19.160351 [debug] [MainThread]: On master: Close
[0m20:10:19.161126 [info ] [MainThread]: 
[0m20:10:19.161475 [info ] [MainThread]: Finished running 12 tests in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m20:10:19.161879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:10:19.162154 [debug] [MainThread]: Connection 'test.jaffle_shop.underselling_specs_test.116f77a6eb' was properly closed.
[0m20:10:19.162359 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785' was properly closed.
[0m20:10:19.170057 [info ] [MainThread]: 
[0m20:10:19.170564 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:10:19.170984 [info ] [MainThread]: 
[0m20:10:19.171323 [error] [MainThread]: [33mCompilation Error in test underselling_specs_test (models/underselling_product_specs/underselling_product_specs_tests.yml)[0m
[0m20:10:19.171590 [error] [MainThread]:   'test_custom' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:10:19.171872 [info ] [MainThread]: 
[0m20:10:19.172182 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m20:10:19.172583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b724d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ab6cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae7bb0>]}


============================== 2024-07-14 20:15:23.135466 | 78cec6c5-56d0-460f-928e-2943dbf819c2 ==============================
[0m20:15:23.135770 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:15:23.165473 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m20:15:23.165866 [debug] [MainThread]: Tracking: tracking
[0m20:15:23.181211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c15d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c14c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c15930>]}
[0m20:15:23.236455 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:15:23.237201 [debug] [MainThread]: Partial parsing: update schema file: jaffle_shop://models/underselling_product_specs/underselling_product_specs_tests.yml
[0m20:15:23.277764 [debug] [MainThread]: 1699: static parser successfully parsed underselling_product_specs/underselling_product_specs.sql
[0m20:15:23.293520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba3f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99fb6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99fb850>]}


============================== 2024-07-14 20:15:49.445018 | 229afd08-6fa4-432f-8c8c-acdcb17904cb ==============================
[0m20:15:49.445323 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:15:49.450825 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m20:15:49.451141 [debug] [MainThread]: Tracking: tracking
[0m20:15:49.466952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c25510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c25120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c25270>]}
[0m20:15:49.522554 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:15:49.523306 [debug] [MainThread]: Partial parsing: update schema file: jaffle_shop://models/underselling_product_specs/underselling_product_specs_tests.yml
[0m20:15:49.559657 [debug] [MainThread]: 1699: static parser successfully parsed underselling_product_specs/underselling_product_specs.sql
[0m20:15:49.575992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba80a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99fb7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99fb790>]}


============================== 2024-07-14 20:16:23.888241 | 4cef55bc-7c30-4cf3-b171-c22b1e789aab ==============================
[0m20:16:23.888558 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:16:23.916923 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m20:16:23.917287 [debug] [MainThread]: Tracking: tracking
[0m20:16:23.931603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c15d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c14c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c17e80>]}
[0m20:16:23.980960 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:16:23.981812 [debug] [MainThread]: Partial parsing: update schema file: jaffle_shop://models/underselling_product_specs/underselling_product_specs_tests.yml
[0m20:16:24.018467 [debug] [MainThread]: 1699: static parser successfully parsed underselling_product_specs/underselling_product_specs.sql
[0m20:16:24.061637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4cef55bc-7c30-4cf3-b171-c22b1e789aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9baed40>]}
[0m20:16:24.072625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4cef55bc-7c30-4cf3-b171-c22b1e789aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c17e80>]}
[0m20:16:24.073056 [info ] [MainThread]: Found 4 models, 12 tests, 2 snapshots, 0 analyses, 259 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:16:24.073378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cef55bc-7c30-4cf3-b171-c22b1e789aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1ea40>]}
[0m20:16:24.075467 [info ] [MainThread]: 
[0m20:16:24.076107 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m20:16:24.078314 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m20:16:24.086755 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:16:24.087069 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:16:24.087291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:16:24.137412 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m20:16:24.138138 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:16:24.138464 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:16:24.144964 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.01 seconds
[0m20:16:24.146756 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:16:24.147180 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:16:24.152090 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:24.152443 [debug] [MainThread]: On master: BEGIN
[0m20:16:24.152654 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:16:24.160260 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m20:16:24.160792 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:24.161034 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:16:24.166005 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m20:16:24.167537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cef55bc-7c30-4cf3-b171-c22b1e789aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bad5d0>]}
[0m20:16:24.167924 [debug] [MainThread]: On master: ROLLBACK
[0m20:16:24.168275 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:24.168538 [debug] [MainThread]: On master: BEGIN
[0m20:16:24.168934 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:16:24.169260 [debug] [MainThread]: On master: COMMIT
[0m20:16:24.169513 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:24.169788 [debug] [MainThread]: On master: COMMIT
[0m20:16:24.170091 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:16:24.170319 [debug] [MainThread]: On master: Close
[0m20:16:24.170737 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:16:24.171070 [info ] [MainThread]: 
[0m20:16:24.175523 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m20:16:24.175692 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m20:16:24.175975 [info ] [Thread-1 (]: 1 of 12 START test below_depletion_level_tests_below_depletion_level_ .......... [RUN]
[0m20:16:24.176308 [info ] [Thread-2 (]: 2 of 12 START test new_arrival_stock_depletion_test_hot_upsell_ ................ [RUN]
[0m20:16:24.176816 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m20:16:24.177279 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m20:16:24.177664 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m20:16:24.177913 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m20:16:24.178182 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m20:16:24.178427 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m20:16:24.181973 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m20:16:24.186019 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m20:16:24.188924 [debug] [Thread-2 (]: finished collecting timing info
[0m20:16:24.189476 [debug] [Thread-1 (]: finished collecting timing info
[0m20:16:24.189814 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m20:16:24.190242 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m20:16:24.205152 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m20:16:24.206976 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m20:16:24.209220 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m20:16:24.209371 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m20:16:24.209599 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m20:16:24.209844 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m20:16:24.210070 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:16:24.210281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:24.217512 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:16:24.217879 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m20:16:24.218154 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m20:16:24.218403 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m20:16:24.218641 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m20:16:24.219019 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."rugs_usa_variant" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        /* joining on model as none of these should show. doing an inner join for this purpose to test */
        JOIN "postgres"."public"."hot_upsell" model on model.name = rup.name and model.variant = ruv.variant and model.size = rupu.size and model.shape = rupu.shape and model.type = rupu.type
        where new_arrival <> 'Y' and stock_level >= coalesce(depletion_level, 0) and rupu.stock is null
    )
    SELECT 
        errors
    FROM test_data
    where errors > 0

      
    ) dbt_internal_test
[0m20:16:24.240432 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m20:16:24.243293 [debug] [Thread-1 (]: finished collecting timing info
[0m20:16:24.243625 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m20:16:24.243961 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m20:16:24.244466 [info ] [Thread-1 (]: 1 of 12 PASS below_depletion_level_tests_below_depletion_level_ ................ [[32mPASS[0m in 0.07s]
[0m20:16:24.245715 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m20:16:24.246154 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m20:16:24.246453 [info ] [Thread-1 (]: 3 of 12 START test not_null_below_depletion_level_name ......................... [RUN]
[0m20:16:24.246961 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m20:16:24.247215 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m20:16:24.247434 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m20:16:24.253966 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m20:16:24.255529 [debug] [Thread-1 (]: finished collecting timing info
[0m20:16:24.255900 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m20:16:24.257842 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m20:16:24.259091 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m20:16:24.259323 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m20:16:24.259524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:24.272988 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:16:24.273560 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m20:16:24.273847 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m20:16:24.277702 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:16:24.279372 [debug] [Thread-1 (]: finished collecting timing info
[0m20:16:24.279676 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m20:16:24.280001 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m20:16:24.280495 [info ] [Thread-1 (]: 3 of 12 PASS not_null_below_depletion_level_name ............................... [[32mPASS[0m in 0.03s]
[0m20:16:24.281645 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m20:16:24.281975 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m20:16:24.282253 [info ] [Thread-1 (]: 4 of 12 START test not_null_below_depletion_level_variant ...................... [RUN]
[0m20:16:24.282739 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m20:16:24.282977 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m20:16:24.283197 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m20:16:24.286637 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m20:16:24.287929 [debug] [Thread-1 (]: finished collecting timing info
[0m20:16:24.288225 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m20:16:24.290019 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m20:16:24.290149 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.07 seconds
[0m20:16:24.291837 [debug] [Thread-2 (]: finished collecting timing info
[0m20:16:24.292085 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m20:16:24.292294 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m20:16:24.292608 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m20:16:24.292691 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m20:16:24.293108 [info ] [Thread-2 (]: 2 of 12 PASS new_arrival_stock_depletion_test_hot_upsell_ ...................... [[32mPASS[0m in 0.12s]
[0m20:16:24.293441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:24.293896 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m20:16:24.294613 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m20:16:24.294943 [info ] [Thread-2 (]: 5 of 12 START test not_null_hot_upsell_name .................................... [RUN]
[0m20:16:24.295467 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m20:16:24.295718 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m20:16:24.295939 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m20:16:24.299303 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m20:16:24.301251 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:16:24.301865 [debug] [Thread-2 (]: finished collecting timing info
[0m20:16:24.301990 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m20:16:24.302279 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m20:16:24.302524 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m20:16:24.305550 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m20:16:24.307120 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m20:16:24.307386 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m20:16:24.307624 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:16:24.311816 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m20:16:24.314250 [debug] [Thread-1 (]: finished collecting timing info
[0m20:16:24.315221 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m20:16:24.315383 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m20:16:24.315851 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m20:16:24.315945 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m20:16:24.316459 [info ] [Thread-1 (]: 4 of 12 PASS not_null_below_depletion_level_variant ............................ [[32mPASS[0m in 0.03s]
[0m20:16:24.316739 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m20:16:24.317192 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m20:16:24.320880 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:16:24.321088 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m20:16:24.322398 [debug] [Thread-2 (]: finished collecting timing info
[0m20:16:24.322689 [info ] [Thread-1 (]: 6 of 12 START test not_null_hot_upsell_variant ................................. [RUN]
[0m20:16:24.322962 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m20:16:24.323448 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m20:16:24.323928 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m20:16:24.324028 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m20:16:24.324430 [info ] [Thread-2 (]: 5 of 12 PASS not_null_hot_upsell_name .......................................... [[32mPASS[0m in 0.03s]
[0m20:16:24.325335 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m20:16:24.325753 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m20:16:24.329093 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m20:16:24.329459 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m20:16:24.330263 [info ] [Thread-2 (]: 7 of 12 START test not_null_priority_order_name ................................ [RUN]
[0m20:16:24.330766 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m20:16:24.331025 [debug] [Thread-1 (]: finished collecting timing info
[0m20:16:24.331124 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m20:16:24.331374 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m20:16:24.331616 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m20:16:24.333189 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m20:16:24.335931 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m20:16:24.337418 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m20:16:24.337645 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m20:16:24.337804 [debug] [Thread-2 (]: finished collecting timing info
[0m20:16:24.337982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:24.338209 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m20:16:24.340260 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m20:16:24.341712 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m20:16:24.341956 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: BEGIN
[0m20:16:24.342217 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:16:24.345106 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:16:24.345491 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m20:16:24.345747 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m20:16:24.349862 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m20:16:24.350189 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m20:16:24.350429 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_name.6c35449027"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."priority_order"
where name is null



      
    ) dbt_internal_test
[0m20:16:24.353160 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m20:16:24.354731 [debug] [Thread-1 (]: finished collecting timing info
[0m20:16:24.354847 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:16:24.355089 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m20:16:24.356145 [debug] [Thread-2 (]: finished collecting timing info
[0m20:16:24.356521 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m20:16:24.356624 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: ROLLBACK
[0m20:16:24.357075 [info ] [Thread-1 (]: 6 of 12 PASS not_null_hot_upsell_variant ....................................... [[32mPASS[0m in 0.03s]
[0m20:16:24.357430 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: Close
[0m20:16:24.357750 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m20:16:24.358128 [info ] [Thread-2 (]: 7 of 12 PASS not_null_priority_order_name ...................................... [[32mPASS[0m in 0.03s]
[0m20:16:24.358427 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m20:16:24.358878 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m20:16:24.359100 [info ] [Thread-1 (]: 8 of 12 START test not_null_priority_order_profit .............................. [RUN]
[0m20:16:24.359378 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m20:16:24.359870 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m20:16:24.360134 [info ] [Thread-2 (]: 9 of 12 START test not_null_priority_order_variant ............................. [RUN]
[0m20:16:24.360385 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m20:16:24.360819 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m20:16:24.361110 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m20:16:24.361372 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m20:16:24.364811 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m20:16:24.365126 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m20:16:24.368890 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m20:16:24.370208 [debug] [Thread-1 (]: finished collecting timing info
[0m20:16:24.371387 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m20:16:24.371689 [debug] [Thread-2 (]: finished collecting timing info
[0m20:16:24.373284 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m20:16:24.373588 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m20:16:24.375764 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m20:16:24.376755 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m20:16:24.376995 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: BEGIN
[0m20:16:24.377199 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m20:16:24.377280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:24.377544 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: BEGIN
[0m20:16:24.378188 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:16:24.384139 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:16:24.384470 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m20:16:24.384597 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m20:16:24.384852 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m20:16:24.385088 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_profit.229518def8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select profit
from "postgres"."public"."priority_order"
where profit is null



      
    ) dbt_internal_test
[0m20:16:24.385318 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."priority_order"
where variant is null



      
    ) dbt_internal_test
[0m20:16:24.390435 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:16:24.391915 [debug] [Thread-2 (]: finished collecting timing info
[0m20:16:24.392033 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m20:16:24.392278 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: ROLLBACK
[0m20:16:24.393335 [debug] [Thread-1 (]: finished collecting timing info
[0m20:16:24.393840 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: Close
[0m20:16:24.394185 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: ROLLBACK
[0m20:16:24.394719 [info ] [Thread-2 (]: 9 of 12 PASS not_null_priority_order_variant ................................... [[32mPASS[0m in 0.03s]
[0m20:16:24.395047 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: Close
[0m20:16:24.395351 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m20:16:24.395799 [info ] [Thread-1 (]: 8 of 12 PASS not_null_priority_order_profit .................................... [[32mPASS[0m in 0.04s]
[0m20:16:24.396105 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m20:16:24.396812 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m20:16:24.397258 [info ] [Thread-2 (]: 10 of 12 START test not_null_underselling_product_specs_name ................... [RUN]
[0m20:16:24.397560 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m20:16:24.398080 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m20:16:24.398356 [info ] [Thread-1 (]: 11 of 12 START test not_null_underselling_product_specs_stock_depletion_ratio .. [RUN]
[0m20:16:24.398642 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m20:16:24.399059 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m20:16:24.399337 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m20:16:24.399593 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m20:16:24.402756 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m20:16:24.403273 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m20:16:24.408001 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m20:16:24.408888 [debug] [Thread-2 (]: finished collecting timing info
[0m20:16:24.409981 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m20:16:24.411851 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m20:16:24.411970 [debug] [Thread-1 (]: finished collecting timing info
[0m20:16:24.412504 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m20:16:24.414687 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m20:16:24.415552 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m20:16:24.416833 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: BEGIN
[0m20:16:24.417112 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m20:16:24.417191 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:16:24.417417 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: BEGIN
[0m20:16:24.417914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:24.424033 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m20:16:24.424200 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:16:24.424514 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m20:16:24.424791 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m20:16:24.425066 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."underselling_product_specs"
where name is null



      
    ) dbt_internal_test
[0m20:16:24.425245 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_depletion_ratio
from "postgres"."public"."underselling_product_specs"
where stock_depletion_ratio is null



      
    ) dbt_internal_test
[0m20:16:24.448239 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m20:16:24.448453 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.02 seconds
[0m20:16:24.449831 [debug] [Thread-1 (]: finished collecting timing info
[0m20:16:24.450955 [debug] [Thread-2 (]: finished collecting timing info
[0m20:16:24.451203 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: ROLLBACK
[0m20:16:24.451458 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: ROLLBACK
[0m20:16:24.451831 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: Close
[0m20:16:24.452046 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: Close
[0m20:16:24.452362 [info ] [Thread-1 (]: 11 of 12 PASS not_null_underselling_product_specs_stock_depletion_ratio ........ [[32mPASS[0m in 0.05s]
[0m20:16:24.452792 [info ] [Thread-2 (]: 10 of 12 PASS not_null_underselling_product_specs_name ......................... [[32mPASS[0m in 0.05s]
[0m20:16:24.453231 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m20:16:24.453720 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m20:16:24.454078 [debug] [Thread-1 (]: Began running node test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0
[0m20:16:24.454596 [info ] [Thread-1 (]: 12 of 12 START test underselling_specs_test_underselling_product_specs_ ........ [RUN]
[0m20:16:24.455056 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0"
[0m20:16:24.455333 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0
[0m20:16:24.455579 [debug] [Thread-1 (]: Compiling test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0
[0m20:16:24.458645 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0"
[0m20:16:24.459498 [debug] [Thread-1 (]: finished collecting timing info
[0m20:16:24.459759 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0
[0m20:16:24.461264 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0"
[0m20:16:24.461958 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0"
[0m20:16:24.462157 [debug] [Thread-1 (]: On test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0: BEGIN
[0m20:16:24.462358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:24.468807 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:16:24.469243 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0"
[0m20:16:24.470156 [debug] [Thread-1 (]: On test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."rugs_usa_variant" ruv
        JOIN "postgres"."public"."rugs_usa_color_map" rucm ON rucm.color_id = ruv.pid 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid 
        /* joining on model as none of these should show. doing an inner join for this purpose to test */
        JOIN "postgres"."public"."underselling_product_specs" model on model.name = rup.name and model.actual_size = ruv.actual_size and model.shape = ruv.shape
        WHERE 
                ruv.stock_level <= COALESCE(ruv.depletion_level, 0) 
                AND ruv.depletion_level = 0 
                AND ruv.stock_level IS NULL 
                or ruv.stock_level = 0
                AND ruv.new_arrival <> 'N' 
                AND ruv.status <> 'In_stock'
            
    )
    SELECT 
        errors
    FROM test_data
    where errors > 0

      
    ) dbt_internal_test
[0m20:16:24.500980 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m20:16:24.503108 [debug] [Thread-1 (]: finished collecting timing info
[0m20:16:24.503428 [debug] [Thread-1 (]: On test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0: ROLLBACK
[0m20:16:24.503774 [debug] [Thread-1 (]: On test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0: Close
[0m20:16:24.504327 [info ] [Thread-1 (]: 12 of 12 PASS underselling_specs_test_underselling_product_specs_ .............. [[32mPASS[0m in 0.05s]
[0m20:16:24.504921 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0
[0m20:16:24.507470 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m20:16:24.507775 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:24.507993 [debug] [MainThread]: On master: BEGIN
[0m20:16:24.508211 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:16:24.514626 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m20:16:24.515007 [debug] [MainThread]: On master: COMMIT
[0m20:16:24.515252 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:24.515489 [debug] [MainThread]: On master: COMMIT
[0m20:16:24.515810 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:16:24.516051 [debug] [MainThread]: On master: Close
[0m20:16:24.516760 [info ] [MainThread]: 
[0m20:16:24.517108 [info ] [MainThread]: Finished running 12 tests in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m20:16:24.517469 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:16:24.517758 [debug] [MainThread]: Connection 'test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0' was properly closed.
[0m20:16:24.517979 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559' was properly closed.
[0m20:16:24.526241 [info ] [MainThread]: 
[0m20:16:24.526624 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:16:24.526982 [info ] [MainThread]: 
[0m20:16:24.527295 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m20:16:24.527744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99eab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99eaa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99e2920>]}


============================== 2024-07-14 20:16:35.874585 | 3faf789a-76cc-45f1-ae26-56e24bda9941 ==============================
[0m20:16:35.874884 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:16:35.880164 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m20:16:35.880632 [debug] [MainThread]: Tracking: tracking
[0m20:16:35.894494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1a230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1b430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1b550>]}
[0m20:16:35.954162 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:16:35.954641 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:16:35.961947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3faf789a-76cc-45f1-ae26-56e24bda9941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99d00d0>]}
[0m20:16:35.973145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3faf789a-76cc-45f1-ae26-56e24bda9941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae5600>]}
[0m20:16:35.973585 [info ] [MainThread]: Found 4 models, 12 tests, 2 snapshots, 0 analyses, 259 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:16:35.973954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3faf789a-76cc-45f1-ae26-56e24bda9941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae5420>]}
[0m20:16:35.976081 [info ] [MainThread]: 
[0m20:16:35.976714 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m20:16:35.979369 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m20:16:35.988163 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:16:35.988499 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:16:35.988734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:16:36.031399 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m20:16:36.031960 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:16:36.032199 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:16:36.037415 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m20:16:36.039299 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:16:36.039735 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:16:36.044719 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:36.045095 [debug] [MainThread]: On master: BEGIN
[0m20:16:36.045358 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:16:36.052345 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m20:16:36.052811 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:36.053078 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:16:36.057740 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m20:16:36.059182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3faf789a-76cc-45f1-ae26-56e24bda9941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7ff10>]}
[0m20:16:36.060439 [debug] [MainThread]: On master: ROLLBACK
[0m20:16:36.060786 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:36.061006 [debug] [MainThread]: On master: BEGIN
[0m20:16:36.061415 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:16:36.061712 [debug] [MainThread]: On master: COMMIT
[0m20:16:36.061931 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:36.062141 [debug] [MainThread]: On master: COMMIT
[0m20:16:36.062462 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:16:36.062696 [debug] [MainThread]: On master: Close
[0m20:16:36.063083 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:16:36.063422 [info ] [MainThread]: 
[0m20:16:36.067437 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m20:16:36.067604 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m20:16:36.067875 [info ] [Thread-1 (]: 1 of 12 START test below_depletion_level_tests_below_depletion_level_ .......... [RUN]
[0m20:16:36.068242 [info ] [Thread-2 (]: 2 of 12 START test new_arrival_stock_depletion_test_hot_upsell_ ................ [RUN]
[0m20:16:36.068732 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m20:16:36.069145 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m20:16:36.069473 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m20:16:36.069692 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m20:16:36.069917 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m20:16:36.070113 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m20:16:36.080785 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m20:16:36.086297 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m20:16:36.088231 [debug] [Thread-2 (]: finished collecting timing info
[0m20:16:36.088351 [debug] [Thread-1 (]: finished collecting timing info
[0m20:16:36.088560 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m20:16:36.088822 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m20:16:36.106737 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m20:16:36.108518 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m20:16:36.110948 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m20:16:36.111228 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m20:16:36.111636 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m20:16:36.111894 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m20:16:36.112145 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:16:36.112380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:36.120089 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:16:36.120510 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m20:16:36.120819 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m20:16:36.121121 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m20:16:36.121613 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m20:16:36.122040 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."rugs_usa_variant" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        /* joining on model as none of these should show. doing an inner join for this purpose to test */
        JOIN "postgres"."public"."hot_upsell" model on model.name = rup.name and model.variant = ruv.variant and model.size = rupu.size and model.shape = rupu.shape and model.type = rupu.type
        where new_arrival <> 'Y' and stock_level >= coalesce(depletion_level, 0) and rupu.stock is null
    )
    SELECT 
        errors
    FROM test_data
    where errors > 0

      
    ) dbt_internal_test
[0m20:16:36.135233 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m20:16:36.141592 [debug] [Thread-1 (]: finished collecting timing info
[0m20:16:36.142037 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m20:16:36.142469 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m20:16:36.143014 [info ] [Thread-1 (]: 1 of 12 PASS below_depletion_level_tests_below_depletion_level_ ................ [[32mPASS[0m in 0.07s]
[0m20:16:36.143753 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m20:16:36.144223 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m20:16:36.144559 [info ] [Thread-1 (]: 3 of 12 START test not_null_below_depletion_level_name ......................... [RUN]
[0m20:16:36.145063 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m20:16:36.145334 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m20:16:36.145663 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m20:16:36.152119 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m20:16:36.153505 [debug] [Thread-1 (]: finished collecting timing info
[0m20:16:36.153806 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m20:16:36.155605 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m20:16:36.156681 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m20:16:36.156926 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m20:16:36.157176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:36.165684 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:16:36.166227 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m20:16:36.166471 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m20:16:36.170336 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:16:36.171837 [debug] [Thread-1 (]: finished collecting timing info
[0m20:16:36.172164 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m20:16:36.172516 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m20:16:36.173004 [info ] [Thread-1 (]: 3 of 12 PASS not_null_below_depletion_level_name ............................... [[32mPASS[0m in 0.03s]
[0m20:16:36.173154 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.05 seconds
[0m20:16:36.173605 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m20:16:36.174828 [debug] [Thread-2 (]: finished collecting timing info
[0m20:16:36.175143 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m20:16:36.175447 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m20:16:36.175741 [info ] [Thread-1 (]: 4 of 12 START test not_null_below_depletion_level_variant ...................... [RUN]
[0m20:16:36.176114 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m20:16:36.176913 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m20:16:36.177326 [info ] [Thread-2 (]: 2 of 12 PASS new_arrival_stock_depletion_test_hot_upsell_ ...................... [[32mPASS[0m in 0.11s]
[0m20:16:36.177603 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m20:16:36.177983 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m20:16:36.178236 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m20:16:36.178517 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m20:16:36.181797 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m20:16:36.182081 [info ] [Thread-2 (]: 5 of 12 START test not_null_hot_upsell_name .................................... [RUN]
[0m20:16:36.182914 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m20:16:36.183217 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m20:16:36.183882 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m20:16:36.184014 [debug] [Thread-1 (]: finished collecting timing info
[0m20:16:36.186889 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m20:16:36.187178 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m20:16:36.189044 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m20:16:36.189407 [debug] [Thread-2 (]: finished collecting timing info
[0m20:16:36.189803 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m20:16:36.192379 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m20:16:36.193241 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m20:16:36.193587 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m20:16:36.193867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:36.194092 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m20:16:36.194539 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m20:16:36.194753 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:16:36.200344 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:16:36.200658 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m20:16:36.200750 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m20:16:36.201020 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m20:16:36.201243 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m20:16:36.201487 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m20:16:36.204973 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:16:36.206385 [debug] [Thread-2 (]: finished collecting timing info
[0m20:16:36.206669 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m20:16:36.206824 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m20:16:36.207036 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m20:16:36.208035 [debug] [Thread-1 (]: finished collecting timing info
[0m20:16:36.208598 [info ] [Thread-2 (]: 5 of 12 PASS not_null_hot_upsell_name .......................................... [[32mPASS[0m in 0.03s]
[0m20:16:36.208846 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m20:16:36.209246 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m20:16:36.209613 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m20:16:36.209851 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m20:16:36.210299 [info ] [Thread-1 (]: 4 of 12 PASS not_null_below_depletion_level_variant ............................ [[32mPASS[0m in 0.03s]
[0m20:16:36.210517 [info ] [Thread-2 (]: 6 of 12 START test not_null_hot_upsell_variant ................................. [RUN]
[0m20:16:36.210870 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m20:16:36.211308 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m20:16:36.211548 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m20:16:36.211800 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m20:16:36.212024 [info ] [Thread-1 (]: 7 of 12 START test not_null_priority_order_name ................................ [RUN]
[0m20:16:36.212241 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m20:16:36.212652 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m20:16:36.215714 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m20:16:36.216016 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m20:16:36.216615 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m20:16:36.219318 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m20:16:36.219613 [debug] [Thread-2 (]: finished collecting timing info
[0m20:16:36.219899 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m20:16:36.221446 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m20:16:36.221781 [debug] [Thread-1 (]: finished collecting timing info
[0m20:16:36.222070 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m20:16:36.222262 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m20:16:36.223561 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m20:16:36.223790 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m20:16:36.224182 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:16:36.224847 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m20:16:36.225081 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: BEGIN
[0m20:16:36.225319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:36.231032 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m20:16:36.231449 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m20:16:36.231563 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:16:36.231766 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m20:16:36.232029 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m20:16:36.232436 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_name.6c35449027"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."priority_order"
where name is null



      
    ) dbt_internal_test
[0m20:16:36.235698 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:16:36.237069 [debug] [Thread-1 (]: finished collecting timing info
[0m20:16:36.237353 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: ROLLBACK
[0m20:16:36.237652 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: Close
[0m20:16:36.238061 [info ] [Thread-1 (]: 7 of 12 PASS not_null_priority_order_name ...................................... [[32mPASS[0m in 0.03s]
[0m20:16:36.238490 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m20:16:36.238605 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m20:16:36.238947 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m20:16:36.240070 [debug] [Thread-2 (]: finished collecting timing info
[0m20:16:36.240324 [info ] [Thread-1 (]: 8 of 12 START test not_null_priority_order_profit .............................. [RUN]
[0m20:16:36.240517 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m20:16:36.240928 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m20:16:36.241202 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m20:16:36.241313 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m20:16:36.241639 [info ] [Thread-2 (]: 6 of 12 PASS not_null_hot_upsell_variant ....................................... [[32mPASS[0m in 0.03s]
[0m20:16:36.241851 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m20:16:36.242181 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m20:16:36.245245 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m20:16:36.245546 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m20:16:36.246108 [info ] [Thread-2 (]: 9 of 12 START test not_null_priority_order_variant ............................. [RUN]
[0m20:16:36.246572 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m20:16:36.246935 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m20:16:36.247030 [debug] [Thread-1 (]: finished collecting timing info
[0m20:16:36.247191 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m20:16:36.247459 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m20:16:36.250449 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m20:16:36.251975 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m20:16:36.252771 [debug] [Thread-2 (]: finished collecting timing info
[0m20:16:36.252995 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m20:16:36.253133 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m20:16:36.254480 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m20:16:36.254698 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: BEGIN
[0m20:16:36.255052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:36.255321 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m20:16:36.255821 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: BEGIN
[0m20:16:36.255990 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:16:36.261585 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:16:36.261972 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m20:16:36.262100 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m20:16:36.262308 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_profit.229518def8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select profit
from "postgres"."public"."priority_order"
where profit is null



      
    ) dbt_internal_test
[0m20:16:36.262495 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m20:16:36.262819 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."priority_order"
where variant is null



      
    ) dbt_internal_test
[0m20:16:36.267396 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:16:36.268726 [debug] [Thread-2 (]: finished collecting timing info
[0m20:16:36.268837 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m20:16:36.269056 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: ROLLBACK
[0m20:16:36.270078 [debug] [Thread-1 (]: finished collecting timing info
[0m20:16:36.270418 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: Close
[0m20:16:36.270571 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: ROLLBACK
[0m20:16:36.271065 [info ] [Thread-2 (]: 9 of 12 PASS not_null_priority_order_variant ................................... [[32mPASS[0m in 0.02s]
[0m20:16:36.271444 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: Close
[0m20:16:36.271730 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m20:16:36.272203 [info ] [Thread-1 (]: 8 of 12 PASS not_null_priority_order_profit .................................... [[32mPASS[0m in 0.03s]
[0m20:16:36.272457 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m20:16:36.272906 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m20:16:36.273180 [info ] [Thread-2 (]: 10 of 12 START test not_null_underselling_product_specs_name ................... [RUN]
[0m20:16:36.273582 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m20:16:36.273998 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m20:16:36.274268 [info ] [Thread-1 (]: 11 of 12 START test not_null_underselling_product_specs_stock_depletion_ratio .. [RUN]
[0m20:16:36.274490 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m20:16:36.274900 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m20:16:36.275139 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m20:16:36.275378 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m20:16:36.278450 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m20:16:36.278743 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m20:16:36.282537 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m20:16:36.283027 [debug] [Thread-2 (]: finished collecting timing info
[0m20:16:36.283276 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m20:16:36.285131 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m20:16:36.285233 [debug] [Thread-1 (]: finished collecting timing info
[0m20:16:36.285649 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m20:16:36.287060 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m20:16:36.287367 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m20:16:36.287676 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: BEGIN
[0m20:16:36.287853 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:16:36.288036 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m20:16:36.288480 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: BEGIN
[0m20:16:36.288715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:36.294434 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m20:16:36.294747 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:16:36.294875 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m20:16:36.295111 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m20:16:36.295277 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."underselling_product_specs"
where name is null



      
    ) dbt_internal_test
[0m20:16:36.295507 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_depletion_ratio
from "postgres"."public"."underselling_product_specs"
where stock_depletion_ratio is null



      
    ) dbt_internal_test
[0m20:16:36.318836 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.02 seconds
[0m20:16:36.319033 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m20:16:36.320351 [debug] [Thread-2 (]: finished collecting timing info
[0m20:16:36.321447 [debug] [Thread-1 (]: finished collecting timing info
[0m20:16:36.321689 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: ROLLBACK
[0m20:16:36.322251 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: ROLLBACK
[0m20:16:36.322648 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: Close
[0m20:16:36.322974 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: Close
[0m20:16:36.323279 [info ] [Thread-2 (]: 10 of 12 PASS not_null_underselling_product_specs_name ......................... [[32mPASS[0m in 0.05s]
[0m20:16:36.323700 [info ] [Thread-1 (]: 11 of 12 PASS not_null_underselling_product_specs_stock_depletion_ratio ........ [[32mPASS[0m in 0.05s]
[0m20:16:36.324132 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m20:16:36.324652 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m20:16:36.325073 [debug] [Thread-2 (]: Began running node test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0
[0m20:16:36.326029 [info ] [Thread-2 (]: 12 of 12 START test underselling_specs_test_underselling_product_specs_ ........ [RUN]
[0m20:16:36.326416 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0"
[0m20:16:36.326635 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0
[0m20:16:36.326817 [debug] [Thread-2 (]: Compiling test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0
[0m20:16:36.330952 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0"
[0m20:16:36.332643 [debug] [Thread-2 (]: finished collecting timing info
[0m20:16:36.332822 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0
[0m20:16:36.334333 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0"
[0m20:16:36.335374 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0"
[0m20:16:36.335983 [debug] [Thread-2 (]: On test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0: BEGIN
[0m20:16:36.336223 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:16:36.342613 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m20:16:36.343025 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0"
[0m20:16:36.343207 [debug] [Thread-2 (]: On test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."rugs_usa_variant" ruv
        JOIN "postgres"."public"."rugs_usa_color_map" rucm ON rucm.color_id = ruv.pid 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid 
        /* joining on model as none of these should show. doing an inner join for this purpose to test */
        JOIN "postgres"."public"."underselling_product_specs" model on model.name = rup.name and model.actual_size = ruv.actual_size and model.shape = ruv.shape
        WHERE 
                ruv.stock_level <= COALESCE(ruv.depletion_level, 0) 
                AND ruv.depletion_level = 0 
                AND ruv.stock_level IS NULL 
                or ruv.stock_level = 0
                AND ruv.new_arrival <> 'N' 
                AND ruv.status <> 'In_stock'
            
    )
    SELECT 
        errors
    FROM test_data
    where errors > 0

      
    ) dbt_internal_test
[0m20:16:36.372030 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.03 seconds
[0m20:16:36.373426 [debug] [Thread-2 (]: finished collecting timing info
[0m20:16:36.373647 [debug] [Thread-2 (]: On test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0: ROLLBACK
[0m20:16:36.373941 [debug] [Thread-2 (]: On test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0: Close
[0m20:16:36.374313 [info ] [Thread-2 (]: 12 of 12 PASS underselling_specs_test_underselling_product_specs_ .............. [[32mPASS[0m in 0.05s]
[0m20:16:36.374654 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0
[0m20:16:36.376650 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m20:16:36.376956 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:36.377173 [debug] [MainThread]: On master: BEGIN
[0m20:16:36.377389 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:16:36.383717 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m20:16:36.384144 [debug] [MainThread]: On master: COMMIT
[0m20:16:36.384367 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:36.384614 [debug] [MainThread]: On master: COMMIT
[0m20:16:36.384939 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:16:36.385181 [debug] [MainThread]: On master: Close
[0m20:16:36.385829 [info ] [MainThread]: 
[0m20:16:36.386144 [info ] [MainThread]: Finished running 12 tests in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m20:16:36.386499 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:16:36.386933 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785' was properly closed.
[0m20:16:36.387197 [debug] [MainThread]: Connection 'test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0' was properly closed.
[0m20:16:36.393929 [info ] [MainThread]: 
[0m20:16:36.394241 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:16:36.394600 [info ] [MainThread]: 
[0m20:16:36.394877 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m20:16:36.395258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1c880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff80d7b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff80cbeb0>]}


============================== 2024-07-14 20:16:49.473372 | 9a247f35-c2ff-4b4e-a4be-322bb9771905 ==============================
[0m20:16:49.473729 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:16:49.478652 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m20:16:49.479089 [debug] [MainThread]: Tracking: tracking
[0m20:16:49.494938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c15d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c14c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c17dc0>]}
[0m20:16:49.545611 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:16:49.545970 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:16:49.552041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a247f35-c2ff-4b4e-a4be-322bb9771905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99d00d0>]}
[0m20:16:49.562824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a247f35-c2ff-4b4e-a4be-322bb9771905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae1240>]}
[0m20:16:49.563324 [info ] [MainThread]: Found 4 models, 12 tests, 2 snapshots, 0 analyses, 259 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:16:49.563670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a247f35-c2ff-4b4e-a4be-322bb9771905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae1360>]}
[0m20:16:49.565889 [info ] [MainThread]: 
[0m20:16:49.566570 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m20:16:49.569299 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m20:16:49.578173 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:16:49.578547 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:16:49.578799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:16:49.623748 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.04 seconds
[0m20:16:49.625576 [debug] [ThreadPool]: On list_postgres: Close
[0m20:16:49.627676 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m20:16:49.632373 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:16:49.632652 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:16:49.632872 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:16:49.640045 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m20:16:49.640324 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:16:49.640509 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:16:49.643466 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m20:16:49.644668 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:16:49.644994 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:16:49.649021 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:49.649318 [debug] [MainThread]: On master: BEGIN
[0m20:16:49.649604 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:16:49.656090 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m20:16:49.656453 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:49.656673 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:16:49.665580 [debug] [MainThread]: SQL status: SELECT 11 in 0.01 seconds
[0m20:16:49.668034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a247f35-c2ff-4b4e-a4be-322bb9771905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c14550>]}
[0m20:16:49.668611 [debug] [MainThread]: On master: ROLLBACK
[0m20:16:49.669164 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:49.669533 [debug] [MainThread]: On master: BEGIN
[0m20:16:49.670104 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:16:49.670511 [debug] [MainThread]: On master: COMMIT
[0m20:16:49.670850 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:49.671076 [debug] [MainThread]: On master: COMMIT
[0m20:16:49.671429 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:16:49.671710 [debug] [MainThread]: On master: Close
[0m20:16:49.672162 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:16:49.672526 [info ] [MainThread]: 
[0m20:16:49.677994 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.rugs_usa_category_map
[0m20:16:49.678179 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.rugs_usa_color_map
[0m20:16:49.678607 [info ] [Thread-1 (]: 1 of 24 START seed file public.rugs_usa_category_map ........................... [RUN]
[0m20:16:49.679017 [info ] [Thread-2 (]: 2 of 24 START seed file public.rugs_usa_color_map .............................. [RUN]
[0m20:16:49.679567 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m20:16:49.680123 [debug] [Thread-2 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m20:16:49.680428 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.rugs_usa_category_map
[0m20:16:49.680678 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.rugs_usa_color_map
[0m20:16:49.680938 [debug] [Thread-1 (]: finished collecting timing info
[0m20:16:49.681173 [debug] [Thread-2 (]: finished collecting timing info
[0m20:16:49.681406 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.rugs_usa_category_map
[0m20:16:49.681627 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.rugs_usa_color_map
[0m20:16:49.961624 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m20:16:49.975710 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: BEGIN
[0m20:16:49.989683 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:16:50.066744 [debug] [Thread-2 (]: SQL status: BEGIN in 0.08 seconds
[0m20:16:50.087699 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m20:16:50.115728 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_color_map"} */
truncate table "postgres"."public"."rugs_usa_color_map"
[0m20:16:50.128275 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m20:16:50.128925 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: BEGIN
[0m20:16:50.129180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:50.135834 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.01 seconds
[0m20:16:50.142356 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:16:50.162570 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m20:16:50.185230 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_category_map"} */
truncate table "postgres"."public"."rugs_usa_category_map"
[0m20:16:50.209369 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.01 seconds
[0m20:16:57.240877 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m20:16:57.264162 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: 
          insert into "postgres"."public"."rugs_usa_color_map" ("pid", "color_id", "color_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s...
[0m20:16:57.269346 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m20:16:57.311216 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m20:16:57.529404 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.26 seconds
[0m20:16:57.587360 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.28 seconds
[0m20:17:02.827222 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m20:17:02.870260 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: 
          insert into "postgres"."public"."rugs_usa_color_map" ("pid", "color_id", "color_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s...
[0m20:17:02.967465 [debug] [Thread-2 (]: SQL status: INSERT 0 7232 in 0.08 seconds
[0m20:17:03.021136 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_color_map"
[0m20:17:03.111448 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: COMMIT
[0m20:17:03.126347 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m20:17:03.140015 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: COMMIT
[0m20:17:03.175226 [debug] [Thread-2 (]: SQL status: COMMIT in 0.01 seconds
[0m20:17:03.190270 [debug] [Thread-2 (]: finished collecting timing info
[0m20:17:03.203117 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: Close
[0m20:17:03.224840 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a247f35-c2ff-4b4e-a4be-322bb9771905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a041f0>]}
[0m20:17:03.238369 [info ] [Thread-2 (]: 2 of 24 OK loaded seed file public.rugs_usa_color_map .......................... [[32mINSERT 17232[0m in 13.54s]
[0m20:17:03.260549 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.rugs_usa_color_map
[0m20:17:03.275253 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.rugs_usa_links
[0m20:17:03.289366 [info ] [Thread-2 (]: 3 of 24 START seed file public.rugs_usa_links .................................. [RUN]
[0m20:17:03.311285 [debug] [Thread-2 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m20:17:03.325161 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.rugs_usa_links
[0m20:17:03.339084 [debug] [Thread-2 (]: finished collecting timing info
[0m20:17:03.353189 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.rugs_usa_links
[0m20:17:03.657095 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m20:17:03.670210 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: BEGIN
[0m20:17:03.684040 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:17:03.723153 [debug] [Thread-2 (]: SQL status: BEGIN in 0.04 seconds
[0m20:17:03.742986 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m20:17:03.756998 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_links"} */
truncate table "postgres"."public"."rugs_usa_links"
[0m20:17:03.789709 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.01 seconds
[0m20:17:04.548347 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m20:17:04.576935 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m20:17:04.712091 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.12 seconds
[0m20:17:08.792224 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m20:17:08.816215 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: 
          insert into "postgres"."public"."rugs_usa_links" ("base_url", "page_links", "card_links", "request_time_stamp", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s...
[0m20:17:08.973559 [debug] [Thread-2 (]: SQL status: INSERT 0 5565 in 0.14 seconds
[0m20:17:08.989563 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_links"
[0m20:17:09.045286 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: COMMIT
[0m20:17:09.056916 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m20:17:09.078161 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: COMMIT
[0m20:17:09.121426 [debug] [Thread-2 (]: SQL status: COMMIT in 0.02 seconds
[0m20:17:09.136120 [debug] [Thread-2 (]: finished collecting timing info
[0m20:17:09.156164 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: Close
[0m20:17:09.177822 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a247f35-c2ff-4b4e-a4be-322bb9771905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffe8e38c40>]}
[0m20:17:09.191281 [info ] [Thread-2 (]: 3 of 24 OK loaded seed file public.rugs_usa_links .............................. [[32mINSERT 5565[0m in 5.87s]
[0m20:17:09.211536 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.rugs_usa_links
[0m20:17:09.225055 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.rugs_usa_pads_upsell
[0m20:17:09.240412 [info ] [Thread-2 (]: 4 of 24 START seed file public.rugs_usa_pads_upsell ............................ [RUN]
[0m20:17:09.255274 [debug] [Thread-2 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:17:09.273785 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.rugs_usa_pads_upsell
[0m20:17:09.287966 [debug] [Thread-2 (]: finished collecting timing info
[0m20:17:09.302019 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.rugs_usa_pads_upsell
[0m20:17:12.325553 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m20:17:12.351173 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m20:17:12.523783 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.15 seconds
[0m20:17:18.824409 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:17:18.845945 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: BEGIN
[0m20:17:18.859960 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:17:18.918717 [debug] [Thread-2 (]: SQL status: BEGIN in 0.06 seconds
[0m20:17:18.932978 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:17:18.947003 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_pads_upsell"} */
truncate table "postgres"."public"."rugs_usa_pads_upsell"
[0m20:17:18.971837 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.01 seconds
[0m20:17:20.281073 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m20:17:20.294885 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m20:17:20.424618 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.12 seconds
[0m20:17:27.598621 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m20:17:27.630085 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m20:17:27.727305 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.08 seconds
[0m20:17:28.636793 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m20:17:28.657856 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m20:17:28.695176 [debug] [Thread-1 (]: SQL status: INSERT 0 1265 in 0.02 seconds
[0m20:17:28.709456 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_category_map"
[0m20:17:28.764582 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: COMMIT
[0m20:17:28.779028 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m20:17:28.799837 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: COMMIT
[0m20:17:28.827386 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m20:17:28.863086 [debug] [Thread-1 (]: finished collecting timing info
[0m20:17:28.885135 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: Close
[0m20:17:28.904926 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a247f35-c2ff-4b4e-a4be-322bb9771905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99d16c0>]}
[0m20:17:28.925415 [info ] [Thread-1 (]: 1 of 24 OK loaded seed file public.rugs_usa_category_map ....................... [[32mINSERT 51265[0m in 39.23s]
[0m20:17:28.946333 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.rugs_usa_category_map
[0m20:17:28.960978 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.rugs_usa_parent
[0m20:17:28.975125 [info ] [Thread-1 (]: 5 of 24 START seed file public.rugs_usa_parent ................................. [RUN]
[0m20:17:28.995981 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m20:17:29.009899 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.rugs_usa_parent
[0m20:17:29.029869 [debug] [Thread-1 (]: finished collecting timing info
[0m20:17:29.043878 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.rugs_usa_parent
[0m20:17:29.765624 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m20:17:29.793238 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: BEGIN
[0m20:17:29.821178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:29.918003 [debug] [Thread-1 (]: SQL status: BEGIN in 0.1 seconds
[0m20:17:29.936906 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m20:17:29.952796 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_parent"} */
truncate table "postgres"."public"."rugs_usa_parent"
[0m20:17:29.976896 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.01 seconds
[0m20:17:41.180651 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:17:41.201037 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m20:17:41.590640 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.38 seconds
[0m20:17:53.012370 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m20:17:53.028947 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: 
          insert into "postgres"."public"."rugs_usa_parent" ("pid", "product_type_id", "name", "url", "origin", "thickness", "material", "weave", "weave_feature", "color", "brand", "imageName", "imageType", "internalName", "category", "min_price", "max_price", "availability", "aggregate", "clearance", "long_description", "shopbyroom", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s...
[0m20:17:53.336705 [debug] [Thread-1 (]: SQL status: INSERT 0 5562 in 0.29 seconds
[0m20:17:53.360160 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_parent"
[0m20:17:53.411917 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: COMMIT
[0m20:17:53.424881 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m20:17:53.438895 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: COMMIT
[0m20:17:53.504578 [debug] [Thread-1 (]: SQL status: COMMIT in 0.04 seconds
[0m20:17:53.524312 [debug] [Thread-1 (]: finished collecting timing info
[0m20:17:53.538149 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: Close
[0m20:17:53.559272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a247f35-c2ff-4b4e-a4be-322bb9771905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae03a0>]}
[0m20:17:53.574145 [info ] [Thread-1 (]: 5 of 24 OK loaded seed file public.rugs_usa_parent ............................. [[32mINSERT 5562[0m in 24.56s]
[0m20:17:53.594983 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.rugs_usa_parent
[0m20:17:53.608955 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.rugs_usa_variant
[0m20:17:53.628937 [info ] [Thread-1 (]: 6 of 24 START seed file public.rugs_usa_variant ................................ [RUN]
[0m20:17:53.643116 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m20:17:53.656898 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.rugs_usa_variant
[0m20:17:53.670868 [debug] [Thread-1 (]: finished collecting timing info
[0m20:17:53.684838 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.rugs_usa_variant
[0m20:17:58.796857 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m20:17:58.812970 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: BEGIN
[0m20:17:58.834181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:58.880901 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m20:17:58.895211 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m20:17:58.909288 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_variant"} */
truncate table "postgres"."public"."rugs_usa_variant"
[0m20:17:58.936172 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.01 seconds
[0m20:18:02.836435 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:18:02.866300 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m20:18:03.362976 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.48 seconds
[0m20:18:28.868181 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:18:28.890430 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m20:18:29.242073 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.33 seconds
[0m20:18:46.544351 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m20:18:46.562627 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: 
          insert into "postgres"."public"."rugs_usa_variant" ("pid", "variant", "actual_size", "weave_feature", "weave_cat", "size_grp", "shipping_size", "shape", "weight", "price", "msrp", "stock_level", "depletion_level", "low_stock", "estimated_delivery_date", "this_isd_range", "status", "origin", "new_arrival", "stockMsg", "stockEddMsg", "other_stock_core", "other_stock_compass", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m20:18:47.249277 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.67 seconds
[0m20:18:51.930842 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:18:51.947437 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m20:18:52.275778 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.31 seconds
[0m20:19:14.158527 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:19:14.173426 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m20:19:14.450112 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.26 seconds
[0m20:19:30.096597 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m20:19:30.113161 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: 
          insert into "postgres"."public"."rugs_usa_variant" ("pid", "variant", "actual_size", "weave_feature", "weave_cat", "size_grp", "shipping_size", "shape", "weight", "price", "msrp", "stock_level", "depletion_level", "low_stock", "estimated_delivery_date", "this_isd_range", "status", "origin", "new_arrival", "stockMsg", "stockEddMsg", "other_stock_core", "other_stock_compass", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m20:19:30.530964 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.41 seconds
[0m20:19:35.986980 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:19:36.000950 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m20:19:36.256437 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.24 seconds
[0m20:19:57.461338 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:19:57.476676 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m20:19:57.739393 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.25 seconds
[0m20:20:13.231979 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m20:20:13.247663 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: 
          insert into "postgres"."public"."rugs_usa_variant" ("pid", "variant", "actual_size", "weave_feature", "weave_cat", "size_grp", "shipping_size", "shape", "weight", "price", "msrp", "stock_level", "depletion_level", "low_stock", "estimated_delivery_date", "this_isd_range", "status", "origin", "new_arrival", "stockMsg", "stockEddMsg", "other_stock_core", "other_stock_compass", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m20:20:13.657082 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.4 seconds
[0m20:20:19.128737 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:20:19.144804 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m20:20:19.378127 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.21 seconds
[0m20:20:40.698658 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:20:40.715996 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m20:20:41.042695 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.31 seconds
[0m20:20:50.966299 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m20:20:50.982993 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: 
          insert into "postgres"."public"."rugs_usa_variant" ("pid", "variant", "actual_size", "weave_feature", "weave_cat", "size_grp", "shipping_size", "shape", "weight", "price", "msrp", "stock_level", "depletion_level", "low_stock", "estimated_delivery_date", "this_isd_range", "status", "origin", "new_arrival", "stockMsg", "stockEddMsg", "other_stock_core", "other_stock_compass", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m20:20:51.348086 [debug] [Thread-1 (]: SQL status: INSERT 0 8800 in 0.35 seconds
[0m20:20:51.364757 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_variant"
[0m20:20:51.420331 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: COMMIT
[0m20:20:51.440024 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m20:20:51.453960 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: COMMIT
[0m20:20:51.497458 [debug] [Thread-1 (]: SQL status: COMMIT in 0.03 seconds
[0m20:20:51.518610 [debug] [Thread-1 (]: finished collecting timing info
[0m20:20:51.531903 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: Close
[0m20:20:51.555282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a247f35-c2ff-4b4e-a4be-322bb9771905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffe00a6350>]}
[0m20:20:51.568006 [info ] [Thread-1 (]: 6 of 24 OK loaded seed file public.rugs_usa_variant ............................ [[32mINSERT 38800[0m in 177.91s]
[0m20:20:51.594284 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.rugs_usa_variant
[0m20:20:51.615138 [debug] [Thread-1 (]: Began running node snapshot.jaffle_shop.availability_clearance_rugs
[0m20:20:51.629018 [info ] [Thread-1 (]: 7 of 24 START snapshot public.availability_clearance_rugs ...................... [RUN]
[0m20:20:51.643222 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.jaffle_shop.availability_clearance_rugs"
[0m20:20:51.655772 [debug] [Thread-1 (]: Began compiling node snapshot.jaffle_shop.availability_clearance_rugs
[0m20:20:51.670022 [debug] [Thread-1 (]: Compiling snapshot.jaffle_shop.availability_clearance_rugs
[0m20:20:51.689437 [debug] [Thread-1 (]: finished collecting timing info
[0m20:20:51.703934 [debug] [Thread-1 (]: Began executing node snapshot.jaffle_shop.availability_clearance_rugs
[0m20:20:51.812355 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.availability_clearance_rugs"
[0m20:20:51.826923 [debug] [Thread-1 (]: On snapshot.jaffle_shop.availability_clearance_rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.availability_clearance_rugs"} */
select * from (
            select availability, clearance from (



SELECT 
    name,
    url,
    availability,
    clearance,
    NOW() AS updated_at
FROM 
    "postgres"."public"."rugs_usa_parent"
) subq
        ) as __dbt_sbq
        where false
        limit 0
    
[0m20:20:51.847964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:51.906898 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.06 seconds
[0m20:20:51.940228 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.availability_clearance_rugs"
[0m20:20:51.960861 [debug] [Thread-1 (]: On snapshot.jaffle_shop.availability_clearance_rugs: BEGIN
[0m20:20:51.980657 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m20:20:51.995688 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.availability_clearance_rugs"
[0m20:20:52.008959 [debug] [Thread-1 (]: On snapshot.jaffle_shop.availability_clearance_rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.availability_clearance_rugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'availability_clearance_rugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:20:52.072019 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.04 seconds
[0m20:20:52.115417 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.availability_clearance_rugs"
[0m20:20:52.150044 [debug] [Thread-1 (]: On snapshot.jaffle_shop.availability_clearance_rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.availability_clearance_rugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'availability_clearance_rugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:20:52.176076 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.01 seconds
[0m20:20:52.240293 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.availability_clearance_rugs"
[0m20:20:52.256118 [debug] [Thread-1 (]: On snapshot.jaffle_shop.availability_clearance_rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.availability_clearance_rugs"} */

        

  create temporary table "availability_clearance_rugs__dbt_tmp202052217362"
  as (
    with snapshot_query as (

        



SELECT 
    name,
    url,
    availability,
    clearance,
    NOW() AS updated_at
FROM 
    "postgres"."public"."rugs_usa_parent"


    ),

    snapshotted_data as (

        select *,
            url as dbt_unique_key

        from "postgres"."public"."availability_clearance_rugs"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            url as dbt_unique_key,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            nullif(now()::timestamp without time zone, now()::timestamp without time zone) as dbt_valid_to,
            md5(coalesce(cast(url as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            url as dbt_unique_key,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."availability" != source_data."availability"
        or
        (
            ((snapshotted_data."availability" is null) and not (source_data."availability" is null))
            or
            ((not snapshotted_data."availability" is null) and (source_data."availability" is null))
        ) or snapshotted_data."clearance" != source_data."clearance"
        or
        (
            ((snapshotted_data."clearance" is null) and not (source_data."clearance" is null))
            or
            ((not snapshotted_data."clearance" is null) and (source_data."clearance" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."availability" != source_data."availability"
        or
        (
            ((snapshotted_data."availability" is null) and not (source_data."availability" is null))
            or
            ((not snapshotted_data."availability" is null) and (source_data."availability" is null))
        ) or snapshotted_data."clearance" != source_data."clearance"
        or
        (
            ((snapshotted_data."clearance" is null) and not (source_data."clearance" is null))
            or
            ((not snapshotted_data."clearance" is null) and (source_data."clearance" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );
    
[0m20:20:52.366082 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.09 seconds
[0m20:20:52.382120 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.availability_clearance_rugs"
[0m20:20:52.396053 [debug] [Thread-1 (]: On snapshot.jaffle_shop.availability_clearance_rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.availability_clearance_rugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'availability_clearance_rugs__dbt_tmp202052217362'
        
      order by ordinal_position

  
[0m20:20:52.425975 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.01 seconds
[0m20:20:52.442355 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.availability_clearance_rugs"
[0m20:20:52.462518 [debug] [Thread-1 (]: On snapshot.jaffle_shop.availability_clearance_rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.availability_clearance_rugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'availability_clearance_rugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:20:52.493055 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.01 seconds
[0m20:20:52.509095 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.availability_clearance_rugs"
[0m20:20:52.529526 [debug] [Thread-1 (]: On snapshot.jaffle_shop.availability_clearance_rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.availability_clearance_rugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'availability_clearance_rugs__dbt_tmp202052217362'
        
      order by ordinal_position

  
[0m20:20:52.553018 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.01 seconds
[0m20:20:52.569284 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.availability_clearance_rugs"
[0m20:20:52.590398 [debug] [Thread-1 (]: On snapshot.jaffle_shop.availability_clearance_rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.availability_clearance_rugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'availability_clearance_rugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:20:52.613068 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.01 seconds
[0m20:20:52.632889 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.availability_clearance_rugs"
[0m20:20:52.645741 [debug] [Thread-1 (]: On snapshot.jaffle_shop.availability_clearance_rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.availability_clearance_rugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'availability_clearance_rugs__dbt_tmp202052217362'
        
      order by ordinal_position

  
[0m20:20:52.670290 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.01 seconds
[0m20:20:52.696270 [debug] [Thread-1 (]: Writing runtime SQL for node "snapshot.jaffle_shop.availability_clearance_rugs"
[0m20:20:52.742899 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.availability_clearance_rugs"
[0m20:20:52.762939 [debug] [Thread-1 (]: On snapshot.jaffle_shop.availability_clearance_rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.availability_clearance_rugs"} */

      update "postgres"."public"."availability_clearance_rugs"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "availability_clearance_rugs__dbt_tmp202052217362" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."public"."availability_clearance_rugs".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."public"."availability_clearance_rugs".dbt_valid_to is null;

    insert into "postgres"."public"."availability_clearance_rugs" ("name", "url", "availability", "clearance", "updated_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."url",DBT_INTERNAL_SOURCE."availability",DBT_INTERNAL_SOURCE."clearance",DBT_INTERNAL_SOURCE."updated_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "availability_clearance_rugs__dbt_tmp202052217362" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:20:52.791945 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.01 seconds
[0m20:20:52.807133 [debug] [Thread-1 (]: On snapshot.jaffle_shop.availability_clearance_rugs: COMMIT
[0m20:20:52.820923 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.availability_clearance_rugs"
[0m20:20:52.833997 [debug] [Thread-1 (]: On snapshot.jaffle_shop.availability_clearance_rugs: COMMIT
[0m20:20:52.855966 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m20:20:52.879705 [debug] [Thread-1 (]: finished collecting timing info
[0m20:20:52.893590 [debug] [Thread-1 (]: On snapshot.jaffle_shop.availability_clearance_rugs: Close
[0m20:20:52.921472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a247f35-c2ff-4b4e-a4be-322bb9771905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99d3550>]}
[0m20:20:52.934602 [info ] [Thread-1 (]: 7 of 24 OK snapshotted public.availability_clearance_rugs ...................... [[32mINSERT 0 0[0m in 1.28s]
[0m20:20:52.948386 [debug] [Thread-1 (]: Finished running node snapshot.jaffle_shop.availability_clearance_rugs
[0m20:20:52.962140 [debug] [Thread-1 (]: Began running node model.jaffle_shop.below_depletion_level
[0m20:20:52.976027 [info ] [Thread-1 (]: 8 of 24 START view model public.below_depletion_level .......................... [RUN]
[0m20:20:52.997189 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.below_depletion_level"
[0m20:20:53.010989 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.below_depletion_level
[0m20:20:53.024992 [debug] [Thread-1 (]: Compiling model.jaffle_shop.below_depletion_level
[0m20:20:53.041684 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.below_depletion_level"
[0m20:20:53.100079 [debug] [Thread-1 (]: finished collecting timing info
[0m20:20:53.114051 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.below_depletion_level
[0m20:20:53.175959 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.below_depletion_level"
[0m20:20:53.222980 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m20:20:53.243016 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: BEGIN
[0m20:20:53.256970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:53.291607 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m20:20:53.312010 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m20:20:53.325981 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */

  create view "postgres"."public"."below_depletion_level__dbt_tmp" as (
    select distinct name, ruv.variant, ruv.actual_size, ruv.weave_cat, ruv.size_grp, ruv.shape, ruv.weight, ruv.stock_level, ruv.depletion_level
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where coalesce(stock_level, 0) < coalesce(depletion_level, 0)
  );
[0m20:20:53.350124 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m20:20:53.369850 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m20:20:53.383209 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level" rename to "below_depletion_level__dbt_backup"
[0m20:20:53.403892 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m20:20:53.419622 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m20:20:53.433940 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level__dbt_tmp" rename to "below_depletion_level"
[0m20:20:53.453918 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m20:20:53.470967 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m20:20:53.484963 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m20:20:53.497898 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m20:20:53.517913 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m20:20:53.550427 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m20:20:53.565062 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
drop view if exists "postgres"."public"."below_depletion_level__dbt_backup" cascade
[0m20:20:53.589034 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m20:20:53.603934 [debug] [Thread-1 (]: finished collecting timing info
[0m20:20:53.617995 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: Close
[0m20:20:53.645110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a247f35-c2ff-4b4e-a4be-322bb9771905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffe9335f30>]}
[0m20:20:53.666860 [info ] [Thread-1 (]: 8 of 24 OK created view model public.below_depletion_level ..................... [[32mCREATE VIEW[0m in 0.65s]
[0m20:20:53.688113 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.below_depletion_level
[0m20:20:53.702039 [debug] [Thread-1 (]: Began running node model.jaffle_shop.underselling_product_specs
[0m20:20:53.715023 [info ] [Thread-1 (]: 9 of 24 START view model public.underselling_product_specs ..................... [RUN]
[0m20:20:53.734942 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.underselling_product_specs"
[0m20:20:53.754922 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.underselling_product_specs
[0m20:20:53.769046 [debug] [Thread-1 (]: Compiling model.jaffle_shop.underselling_product_specs
[0m20:20:53.785799 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.underselling_product_specs"
[0m20:20:53.839016 [debug] [Thread-1 (]: finished collecting timing info
[0m20:20:53.852997 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.underselling_product_specs
[0m20:20:53.869886 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.underselling_product_specs"
[0m20:20:53.915909 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m20:20:53.928860 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: BEGIN
[0m20:20:53.948966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:53.984922 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m20:20:53.998972 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m20:20:54.012047 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */

  create view "postgres"."public"."underselling_product_specs__dbt_tmp" as (
    select distinct rup.name, rucm.color_value, ruv.actual_size, ruv.weave_cat, ruv.size_grp, ruv.shape, (ruv.stock_level - ruv.depletion_level) as stock_depletion_ratio
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_color_map" rucm on rucm.color_id = ruv.pid 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
where stock_level > coalesce(depletion_level, 0) and depletion_level <> 0 
and stock_level is not null and stock_level <> 0 and new_arrival = 'N' and status = 'In_stock'
order by stock_depletion_ratio desc limit 10
  );
[0m20:20:54.041025 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.02 seconds
[0m20:20:54.055902 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m20:20:54.068889 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
alter table "postgres"."public"."underselling_product_specs" rename to "underselling_product_specs__dbt_backup"
[0m20:20:54.089891 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m20:20:54.105634 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m20:20:54.124458 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
alter table "postgres"."public"."underselling_product_specs__dbt_tmp" rename to "underselling_product_specs"
[0m20:20:54.144998 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m20:20:54.160005 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: COMMIT
[0m20:20:54.172960 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m20:20:54.186956 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: COMMIT
[0m20:20:54.209082 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m20:20:54.231253 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m20:20:54.250993 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
drop view if exists "postgres"."public"."underselling_product_specs__dbt_backup" cascade
[0m20:20:54.269738 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:20:54.269879 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:20:54.270127 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m20:20:54.271107 [debug] [Thread-1 (]: finished collecting timing info
[0m20:20:54.355387 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: Close
[0m20:20:54.356502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a247f35-c2ff-4b4e-a4be-322bb9771905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffe9071180>]}
[0m20:20:54.357743 [info ] [Thread-1 (]: 9 of 24 OK created view model public.underselling_product_specs ................ [[32mCREATE VIEW[0m in 0.62s]
[0m20:20:54.358297 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.underselling_product_specs
[0m20:20:54.358661 [debug] [Thread-1 (]: Began running node snapshot.jaffle_shop.low_stock_indicator
[0m20:20:54.359255 [info ] [Thread-1 (]: 10 of 24 START snapshot public.low_stock_indicator ............................. [RUN]
[0m20:20:54.359799 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.jaffle_shop.low_stock_indicator"
[0m20:20:54.360085 [debug] [Thread-1 (]: Began compiling node snapshot.jaffle_shop.low_stock_indicator
[0m20:20:54.360345 [debug] [Thread-1 (]: Compiling snapshot.jaffle_shop.low_stock_indicator
[0m20:20:54.365363 [debug] [Thread-1 (]: finished collecting timing info
[0m20:20:54.365749 [debug] [Thread-1 (]: Began executing node snapshot.jaffle_shop.low_stock_indicator
[0m20:20:54.368843 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.low_stock_indicator"
[0m20:20:54.369104 [debug] [Thread-1 (]: On snapshot.jaffle_shop.low_stock_indicator: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.low_stock_indicator"} */
select * from (
            select low_stock from (



SELECT DISTINCT 
    rup.name,
    ruv.variant,
    rucm.color_value,
    ruv.weave_cat,
    ruv.size_grp,
    ruv.shape,
    ruv.weight,
    ruv.low_stock,
    CONCAT(rup.name, '_', ruv.variant, '_', rucm.color_value, '_', ruv.weave_cat, '_', ruv.size_grp, '_', ruv.shape, '_', ruv.weight) AS name_variant_color_weave_size_shape_weight,  
    NOW() AS updated_at
FROM 
    "postgres"."public"."rugs_usa_variant" ruv
JOIN 
    "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
JOIN 
    "postgres"."public"."rugs_usa_color_map" rucm ON rucm.color_id = ruv.pid
) subq
        ) as __dbt_sbq
        where false
        limit 0
    
[0m20:20:54.369322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:54.378370 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.01 seconds
[0m20:20:54.381530 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.low_stock_indicator"
[0m20:20:54.381859 [debug] [Thread-1 (]: On snapshot.jaffle_shop.low_stock_indicator: BEGIN
[0m20:20:54.382224 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:20:54.382591 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.low_stock_indicator"
[0m20:20:54.382923 [debug] [Thread-1 (]: On snapshot.jaffle_shop.low_stock_indicator: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.low_stock_indicator"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'low_stock_indicator'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:20:54.395074 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.01 seconds
[0m20:20:54.399620 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.low_stock_indicator"
[0m20:20:54.399937 [debug] [Thread-1 (]: On snapshot.jaffle_shop.low_stock_indicator: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.low_stock_indicator"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'low_stock_indicator'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:20:54.402886 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.0 seconds
[0m20:20:54.405893 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.low_stock_indicator"
[0m20:20:54.406213 [debug] [Thread-1 (]: On snapshot.jaffle_shop.low_stock_indicator: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.low_stock_indicator"} */

        

  create temporary table "low_stock_indicator__dbt_tmp202054405129"
  as (
    with snapshot_query as (

        



SELECT DISTINCT 
    rup.name,
    ruv.variant,
    rucm.color_value,
    ruv.weave_cat,
    ruv.size_grp,
    ruv.shape,
    ruv.weight,
    ruv.low_stock,
    CONCAT(rup.name, '_', ruv.variant, '_', rucm.color_value, '_', ruv.weave_cat, '_', ruv.size_grp, '_', ruv.shape, '_', ruv.weight) AS name_variant_color_weave_size_shape_weight,  
    NOW() AS updated_at
FROM 
    "postgres"."public"."rugs_usa_variant" ruv
JOIN 
    "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
JOIN 
    "postgres"."public"."rugs_usa_color_map" rucm ON rucm.color_id = ruv.pid


    ),

    snapshotted_data as (

        select *,
            name_variant_color_weave_size_shape_weight as dbt_unique_key

        from "postgres"."public"."low_stock_indicator"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            name_variant_color_weave_size_shape_weight as dbt_unique_key,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            nullif(now()::timestamp without time zone, now()::timestamp without time zone) as dbt_valid_to,
            md5(coalesce(cast(name_variant_color_weave_size_shape_weight as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            name_variant_color_weave_size_shape_weight as dbt_unique_key,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."low_stock" != source_data."low_stock"
        or
        (
            ((snapshotted_data."low_stock" is null) and not (source_data."low_stock" is null))
            or
            ((not snapshotted_data."low_stock" is null) and (source_data."low_stock" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."low_stock" != source_data."low_stock"
        or
        (
            ((snapshotted_data."low_stock" is null) and not (source_data."low_stock" is null))
            or
            ((not snapshotted_data."low_stock" is null) and (source_data."low_stock" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );
    
[0m20:20:54.460593 [debug] [Thread-2 (]: SQL status: INSERT 0 7154 in 0.19 seconds
[0m20:20:54.465203 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:20:54.472184 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: COMMIT
[0m20:20:54.472492 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m20:20:54.472710 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: COMMIT
[0m20:20:54.493007 [debug] [Thread-2 (]: SQL status: COMMIT in 0.02 seconds
[0m20:20:54.494856 [debug] [Thread-2 (]: finished collecting timing info
[0m20:20:54.495243 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: Close
[0m20:20:54.496249 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a247f35-c2ff-4b4e-a4be-322bb9771905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a152a0>]}
[0m20:20:54.496889 [info ] [Thread-2 (]: 4 of 24 OK loaded seed file public.rugs_usa_pads_upsell ........................ [[32mINSERT 97154[0m in 225.24s]
[0m20:20:54.497857 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.rugs_usa_pads_upsell
[0m20:20:54.498381 [debug] [Thread-2 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m20:20:54.499265 [info ] [Thread-2 (]: 11 of 24 START test below_depletion_level_tests_below_depletion_level_ ......... [RUN]
[0m20:20:54.499867 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m20:20:54.500156 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m20:20:54.500432 [debug] [Thread-2 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m20:20:54.511268 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m20:20:54.514873 [debug] [Thread-2 (]: finished collecting timing info
[0m20:20:54.515325 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m20:20:54.534471 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m20:20:54.539014 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m20:20:54.539820 [debug] [Thread-2 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m20:20:54.540362 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:20:54.566280 [debug] [Thread-2 (]: SQL status: BEGIN in 0.03 seconds
[0m20:20:54.567218 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m20:20:54.568891 [debug] [Thread-2 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m20:20:54.618328 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.05 seconds
[0m20:20:54.624545 [debug] [Thread-2 (]: finished collecting timing info
[0m20:20:54.625178 [debug] [Thread-2 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m20:20:54.625643 [debug] [Thread-2 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m20:20:54.626358 [info ] [Thread-2 (]: 11 of 24 PASS below_depletion_level_tests_below_depletion_level_ ............... [[32mPASS[0m in 0.13s]
[0m20:20:54.627214 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m20:20:54.627575 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m20:20:54.627930 [info ] [Thread-2 (]: 12 of 24 START test not_null_below_depletion_level_name ........................ [RUN]
[0m20:20:54.628376 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m20:20:54.628607 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m20:20:54.628841 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m20:20:54.635841 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m20:20:54.637732 [debug] [Thread-2 (]: finished collecting timing info
[0m20:20:54.637987 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m20:20:54.640066 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m20:20:54.644622 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m20:20:54.645224 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m20:20:54.645524 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:20:54.663716 [debug] [Thread-2 (]: SQL status: BEGIN in 0.02 seconds
[0m20:20:54.664688 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m20:20:54.665015 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m20:20:54.670283 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m20:20:54.672540 [debug] [Thread-2 (]: finished collecting timing info
[0m20:20:54.673131 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m20:20:54.673545 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m20:20:54.674122 [info ] [Thread-2 (]: 12 of 24 PASS not_null_below_depletion_level_name .............................. [[32mPASS[0m in 0.05s]
[0m20:20:54.674781 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m20:20:54.675122 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m20:20:54.675434 [info ] [Thread-2 (]: 13 of 24 START test not_null_below_depletion_level_variant ..................... [RUN]
[0m20:20:54.675966 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m20:20:54.676216 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m20:20:54.676454 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m20:20:54.682685 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m20:20:54.685209 [debug] [Thread-2 (]: finished collecting timing info
[0m20:20:54.685541 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m20:20:54.687528 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m20:20:54.690050 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m20:20:54.690334 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m20:20:54.690545 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:20:54.722859 [debug] [Thread-2 (]: SQL status: BEGIN in 0.03 seconds
[0m20:20:54.723330 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m20:20:54.723576 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m20:20:54.741627 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.02 seconds
[0m20:20:54.743203 [debug] [Thread-2 (]: finished collecting timing info
[0m20:20:54.743479 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m20:20:54.743883 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m20:20:54.744324 [info ] [Thread-2 (]: 13 of 24 PASS not_null_below_depletion_level_variant ........................... [[32mPASS[0m in 0.07s]
[0m20:20:54.744783 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m20:20:54.745044 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m20:20:54.745448 [info ] [Thread-2 (]: 14 of 24 START test not_null_underselling_product_specs_name ................... [RUN]
[0m20:20:54.745868 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m20:20:54.746105 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m20:20:54.746333 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m20:20:54.749593 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m20:20:54.753224 [debug] [Thread-2 (]: finished collecting timing info
[0m20:20:54.753457 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m20:20:54.755108 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m20:20:54.758304 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m20:20:54.758511 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: BEGIN
[0m20:20:54.758727 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:20:54.787503 [debug] [Thread-2 (]: SQL status: BEGIN in 0.03 seconds
[0m20:20:54.788376 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m20:20:54.789276 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."underselling_product_specs"
where name is null



      
    ) dbt_internal_test
[0m20:20:54.866284 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.08 seconds
[0m20:20:54.872003 [debug] [Thread-2 (]: finished collecting timing info
[0m20:20:54.872325 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: ROLLBACK
[0m20:20:54.872706 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: Close
[0m20:20:54.873206 [info ] [Thread-2 (]: 14 of 24 PASS not_null_underselling_product_specs_name ......................... [[32mPASS[0m in 0.13s]
[0m20:20:54.873876 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m20:20:54.874237 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m20:20:54.874586 [info ] [Thread-2 (]: 15 of 24 START test not_null_underselling_product_specs_stock_depletion_ratio .. [RUN]
[0m20:20:54.875050 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m20:20:54.875326 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m20:20:54.875758 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m20:20:54.880651 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m20:20:54.882030 [debug] [Thread-2 (]: finished collecting timing info
[0m20:20:54.882266 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m20:20:54.884073 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m20:20:54.885970 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m20:20:54.886221 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: BEGIN
[0m20:20:54.886458 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:20:54.893594 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m20:20:54.893997 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m20:20:54.894243 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_depletion_ratio
from "postgres"."public"."underselling_product_specs"
where stock_depletion_ratio is null



      
    ) dbt_internal_test
[0m20:20:54.921857 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.03 seconds
[0m20:20:54.923604 [debug] [Thread-2 (]: finished collecting timing info
[0m20:20:54.923888 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: ROLLBACK
[0m20:20:54.924220 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: Close
[0m20:20:54.924677 [info ] [Thread-2 (]: 15 of 24 PASS not_null_underselling_product_specs_stock_depletion_ratio ........ [[32mPASS[0m in 0.05s]
[0m20:20:54.925163 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m20:20:54.925447 [debug] [Thread-2 (]: Began running node test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0
[0m20:20:54.925777 [info ] [Thread-2 (]: 16 of 24 START test underselling_specs_test_underselling_product_specs_ ........ [RUN]
[0m20:20:54.926204 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0"
[0m20:20:54.926438 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0
[0m20:20:54.926681 [debug] [Thread-2 (]: Compiling test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0
[0m20:20:54.935684 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0"
[0m20:20:54.939779 [debug] [Thread-2 (]: finished collecting timing info
[0m20:20:54.940210 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0
[0m20:20:54.942849 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0"
[0m20:20:54.944721 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0"
[0m20:20:54.945122 [debug] [Thread-2 (]: On test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0: BEGIN
[0m20:20:54.945401 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:20:54.953328 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m20:20:54.954186 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0"
[0m20:20:54.954538 [debug] [Thread-2 (]: On test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."rugs_usa_variant" ruv
        JOIN "postgres"."public"."rugs_usa_color_map" rucm ON rucm.color_id = ruv.pid 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid 
        /* joining on model as none of these should show. doing an inner join for this purpose to test */
        JOIN "postgres"."public"."underselling_product_specs" model on model.name = rup.name and model.actual_size = ruv.actual_size and model.shape = ruv.shape
        WHERE 
                ruv.stock_level <= COALESCE(ruv.depletion_level, 0) 
                AND ruv.depletion_level = 0 
                AND ruv.stock_level IS NULL 
                or ruv.stock_level = 0
                AND ruv.new_arrival <> 'N' 
                AND ruv.status <> 'In_stock'
            
    )
    SELECT 
        errors
    FROM test_data
    where errors > 0

      
    ) dbt_internal_test
[0m20:20:54.998588 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.04 seconds
[0m20:20:55.000372 [debug] [Thread-2 (]: finished collecting timing info
[0m20:20:55.000744 [debug] [Thread-2 (]: On test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0: ROLLBACK
[0m20:20:55.001132 [debug] [Thread-2 (]: On test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0: Close
[0m20:20:55.001871 [info ] [Thread-2 (]: 16 of 24 PASS underselling_specs_test_underselling_product_specs_ .............. [[32mPASS[0m in 0.08s]
[0m20:20:55.005620 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0
[0m20:20:55.006205 [debug] [Thread-2 (]: Began running node model.jaffle_shop.hot_upsell
[0m20:20:55.007096 [info ] [Thread-2 (]: 17 of 24 START view model public.hot_upsell .................................... [RUN]
[0m20:20:55.007974 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.hot_upsell"
[0m20:20:55.008455 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.hot_upsell
[0m20:20:55.009010 [debug] [Thread-2 (]: Compiling model.jaffle_shop.hot_upsell
[0m20:20:55.015797 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.hot_upsell"
[0m20:20:55.017662 [debug] [Thread-2 (]: finished collecting timing info
[0m20:20:55.017995 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.hot_upsell
[0m20:20:55.022814 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.hot_upsell"
[0m20:20:55.024221 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m20:20:55.024497 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: BEGIN
[0m20:20:55.024713 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:20:55.031986 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m20:20:55.032628 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m20:20:55.032984 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */

  create view "postgres"."public"."hot_upsell__dbt_tmp" as (
    select distinct rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, (ruv.msrp - rupu.price) as profit_margin
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_pads_upsell" rupu on rupu.p_id = ruv.pid and rupu.variant = ruv.variant 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where new_arrival = 'Y' and stock_level < coalesce(depletion_level, 0) and rupu.stock is not null
order by profit_margin desc
  );
[0m20:20:55.036183 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:20:55.041459 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m20:20:55.041872 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
alter table "postgres"."public"."hot_upsell" rename to "hot_upsell__dbt_backup"
[0m20:20:55.042591 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:20:55.044744 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m20:20:55.045027 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
alter table "postgres"."public"."hot_upsell__dbt_tmp" rename to "hot_upsell"
[0m20:20:55.045664 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:20:55.047320 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: COMMIT
[0m20:20:55.047596 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m20:20:55.047802 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: COMMIT
[0m20:20:55.048541 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m20:20:55.050146 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m20:20:55.050390 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
drop view if exists "postgres"."public"."hot_upsell__dbt_backup" cascade
[0m20:20:55.051966 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:20:55.053062 [debug] [Thread-2 (]: finished collecting timing info
[0m20:20:55.053326 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: Close
[0m20:20:55.053833 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a247f35-c2ff-4b4e-a4be-322bb9771905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a00880>]}
[0m20:20:55.054359 [info ] [Thread-2 (]: 17 of 24 OK created view model public.hot_upsell ............................... [[32mCREATE VIEW[0m in 0.05s]
[0m20:20:55.054823 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.hot_upsell
[0m20:20:55.055072 [debug] [Thread-2 (]: Began running node model.jaffle_shop.priority_order
[0m20:20:55.055530 [info ] [Thread-2 (]: 18 of 24 START view model public.priority_order ................................ [RUN]
[0m20:20:55.055983 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.priority_order"
[0m20:20:55.056229 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.priority_order
[0m20:20:55.056474 [debug] [Thread-2 (]: Compiling model.jaffle_shop.priority_order
[0m20:20:55.059479 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.priority_order"
[0m20:20:55.060855 [debug] [Thread-2 (]: finished collecting timing info
[0m20:20:55.061115 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.priority_order
[0m20:20:55.064175 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.priority_order"
[0m20:20:55.065901 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m20:20:55.066157 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: BEGIN
[0m20:20:55.066386 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:20:55.075059 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m20:20:55.075509 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m20:20:55.075788 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */

  create view "postgres"."public"."priority_order__dbt_tmp" as (
    select distinct rup.name, ruv.variant, ruv.actual_size, ruv.weave_cat, (msrp - price) as profit 
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
join "postgres"."public"."below_depletion_level" bdl on bdl.name = rup.name and bdl.variant = ruv.variant
order by profit desc
  );
[0m20:20:55.081939 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m20:20:55.085195 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m20:20:55.085666 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
alter table "postgres"."public"."priority_order__dbt_tmp" rename to "priority_order"
[0m20:20:55.087030 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:20:55.088854 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: COMMIT
[0m20:20:55.089314 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m20:20:55.089588 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: COMMIT
[0m20:20:55.090666 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m20:20:55.092458 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m20:20:55.092836 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
drop view if exists "postgres"."public"."priority_order__dbt_backup" cascade
[0m20:20:55.093331 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:20:55.094626 [debug] [Thread-2 (]: finished collecting timing info
[0m20:20:55.094968 [debug] [Thread-2 (]: On model.jaffle_shop.priority_order: Close
[0m20:20:55.095591 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a247f35-c2ff-4b4e-a4be-322bb9771905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd98aa170>]}
[0m20:20:55.096197 [info ] [Thread-2 (]: 18 of 24 OK created view model public.priority_order ........................... [[32mCREATE VIEW[0m in 0.04s]
[0m20:20:55.096714 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.priority_order
[0m20:20:55.097037 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m20:20:55.097540 [info ] [Thread-2 (]: 19 of 24 START test new_arrival_stock_depletion_test_hot_upsell_ ............... [RUN]
[0m20:20:55.098086 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m20:20:55.098390 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m20:20:55.098743 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m20:20:55.103958 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m20:20:55.106026 [debug] [Thread-2 (]: finished collecting timing info
[0m20:20:55.106309 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m20:20:55.108302 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m20:20:55.109470 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m20:20:55.109770 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m20:20:55.109971 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:20:55.117177 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m20:20:55.117710 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m20:20:55.117966 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."rugs_usa_variant" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        /* joining on model as none of these should show. doing an inner join for this purpose to test */
        JOIN "postgres"."public"."hot_upsell" model on model.name = rup.name and model.variant = ruv.variant and model.size = rupu.size and model.shape = rupu.shape and model.type = rupu.type
        where new_arrival <> 'Y' and stock_level >= coalesce(depletion_level, 0) and rupu.stock is null
    )
    SELECT 
        errors
    FROM test_data
    where errors > 0

      
    ) dbt_internal_test
[0m20:20:55.186072 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.07 seconds
[0m20:20:55.187828 [debug] [Thread-2 (]: finished collecting timing info
[0m20:20:55.188155 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m20:20:55.188632 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m20:20:55.189177 [info ] [Thread-2 (]: 19 of 24 PASS new_arrival_stock_depletion_test_hot_upsell_ ..................... [[32mPASS[0m in 0.09s]
[0m20:20:55.189688 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m20:20:55.190038 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m20:20:55.190361 [info ] [Thread-2 (]: 20 of 24 START test not_null_hot_upsell_name ................................... [RUN]
[0m20:20:55.190888 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m20:20:55.191147 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m20:20:55.191380 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m20:20:55.195036 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m20:20:55.198358 [debug] [Thread-2 (]: finished collecting timing info
[0m20:20:55.198655 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m20:20:55.200600 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m20:20:55.202072 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m20:20:55.204327 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m20:20:55.204582 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:20:55.211342 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m20:20:55.211864 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m20:20:55.212128 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m20:20:55.216981 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:20:55.220204 [debug] [Thread-2 (]: finished collecting timing info
[0m20:20:55.220590 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m20:20:55.223073 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m20:20:55.223566 [info ] [Thread-2 (]: 20 of 24 PASS not_null_hot_upsell_name ......................................... [[32mPASS[0m in 0.03s]
[0m20:20:55.224049 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m20:20:55.224362 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m20:20:55.224640 [info ] [Thread-2 (]: 21 of 24 START test not_null_hot_upsell_variant ................................ [RUN]
[0m20:20:55.225089 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m20:20:55.225334 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m20:20:55.225630 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m20:20:55.228927 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m20:20:55.230340 [debug] [Thread-2 (]: finished collecting timing info
[0m20:20:55.230620 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m20:20:55.232366 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m20:20:55.234206 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m20:20:55.234423 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m20:20:55.234622 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:20:55.241985 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m20:20:55.242588 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m20:20:55.242896 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m20:20:55.251151 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m20:20:55.254248 [debug] [Thread-2 (]: finished collecting timing info
[0m20:20:55.254907 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m20:20:55.255644 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m20:20:55.256614 [info ] [Thread-2 (]: 21 of 24 PASS not_null_hot_upsell_variant ...................................... [[32mPASS[0m in 0.03s]
[0m20:20:55.257361 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m20:20:55.258061 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m20:20:55.258658 [info ] [Thread-2 (]: 22 of 24 START test not_null_priority_order_name ............................... [RUN]
[0m20:20:55.259272 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m20:20:55.259533 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m20:20:55.259919 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m20:20:55.264048 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m20:20:55.265863 [debug] [Thread-2 (]: finished collecting timing info
[0m20:20:55.266215 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m20:20:55.268363 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m20:20:55.270545 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m20:20:55.271055 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: BEGIN
[0m20:20:55.271421 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:20:55.279746 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m20:20:55.280197 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m20:20:55.280446 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_name.6c35449027"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."priority_order"
where name is null



      
    ) dbt_internal_test
[0m20:20:55.284672 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:20:55.286337 [debug] [Thread-2 (]: finished collecting timing info
[0m20:20:55.286692 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: ROLLBACK
[0m20:20:55.287089 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: Close
[0m20:20:55.287580 [info ] [Thread-2 (]: 22 of 24 PASS not_null_priority_order_name ..................................... [[32mPASS[0m in 0.03s]
[0m20:20:55.288077 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m20:20:55.288369 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m20:20:55.288701 [info ] [Thread-2 (]: 23 of 24 START test not_null_priority_order_profit ............................. [RUN]
[0m20:20:55.289138 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m20:20:55.289385 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m20:20:55.289629 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m20:20:55.293063 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m20:20:55.295571 [debug] [Thread-2 (]: finished collecting timing info
[0m20:20:55.295976 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m20:20:55.297760 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m20:20:55.299120 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m20:20:55.299535 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: BEGIN
[0m20:20:55.300240 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:20:55.307621 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m20:20:55.308411 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m20:20:55.309140 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_profit.229518def8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select profit
from "postgres"."public"."priority_order"
where profit is null



      
    ) dbt_internal_test
[0m20:20:55.319542 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m20:20:55.321600 [debug] [Thread-2 (]: finished collecting timing info
[0m20:20:55.321971 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: ROLLBACK
[0m20:20:55.322340 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: Close
[0m20:20:55.322894 [info ] [Thread-2 (]: 23 of 24 PASS not_null_priority_order_profit ................................... [[32mPASS[0m in 0.03s]
[0m20:20:55.323584 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m20:20:55.323967 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m20:20:55.324319 [info ] [Thread-2 (]: 24 of 24 START test not_null_priority_order_variant ............................ [RUN]
[0m20:20:55.324758 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m20:20:55.324985 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m20:20:55.325210 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m20:20:55.328654 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m20:20:55.329813 [debug] [Thread-2 (]: finished collecting timing info
[0m20:20:55.330055 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m20:20:55.331778 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m20:20:55.332950 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m20:20:55.333184 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: BEGIN
[0m20:20:55.333398 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:20:55.341007 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m20:20:55.341632 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m20:20:55.341922 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."priority_order"
where variant is null



      
    ) dbt_internal_test
[0m20:20:55.347364 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m20:20:55.348997 [debug] [Thread-2 (]: finished collecting timing info
[0m20:20:55.349312 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: ROLLBACK
[0m20:20:55.349690 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: Close
[0m20:20:55.350132 [info ] [Thread-2 (]: 24 of 24 PASS not_null_priority_order_variant .................................. [[32mPASS[0m in 0.03s]
[0m20:20:55.350640 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m20:20:56.158086 [debug] [Thread-1 (]: SQL status: SELECT 0 in 1.75 seconds
[0m20:20:56.164077 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.low_stock_indicator"
[0m20:20:56.164391 [debug] [Thread-1 (]: On snapshot.jaffle_shop.low_stock_indicator: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.low_stock_indicator"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'low_stock_indicator__dbt_tmp202054405129'
        
      order by ordinal_position

  
[0m20:20:56.167871 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.0 seconds
[0m20:20:56.171279 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.low_stock_indicator"
[0m20:20:56.171556 [debug] [Thread-1 (]: On snapshot.jaffle_shop.low_stock_indicator: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.low_stock_indicator"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'low_stock_indicator'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:20:56.173806 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.0 seconds
[0m20:20:56.178410 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.low_stock_indicator"
[0m20:20:56.178718 [debug] [Thread-1 (]: On snapshot.jaffle_shop.low_stock_indicator: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.low_stock_indicator"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'low_stock_indicator__dbt_tmp202054405129'
        
      order by ordinal_position

  
[0m20:20:56.180988 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.0 seconds
[0m20:20:56.183372 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.low_stock_indicator"
[0m20:20:56.183644 [debug] [Thread-1 (]: On snapshot.jaffle_shop.low_stock_indicator: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.low_stock_indicator"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'low_stock_indicator'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:20:56.185784 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.0 seconds
[0m20:20:56.188588 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.low_stock_indicator"
[0m20:20:56.188844 [debug] [Thread-1 (]: On snapshot.jaffle_shop.low_stock_indicator: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.low_stock_indicator"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'low_stock_indicator__dbt_tmp202054405129'
        
      order by ordinal_position

  
[0m20:20:56.190928 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.0 seconds
[0m20:20:56.193173 [debug] [Thread-1 (]: Writing runtime SQL for node "snapshot.jaffle_shop.low_stock_indicator"
[0m20:20:56.194801 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.low_stock_indicator"
[0m20:20:56.195017 [debug] [Thread-1 (]: On snapshot.jaffle_shop.low_stock_indicator: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.low_stock_indicator"} */

      update "postgres"."public"."low_stock_indicator"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "low_stock_indicator__dbt_tmp202054405129" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."public"."low_stock_indicator".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."public"."low_stock_indicator".dbt_valid_to is null;

    insert into "postgres"."public"."low_stock_indicator" ("name", "variant", "color_value", "weave_cat", "size_grp", "shape", "weight", "low_stock", "name_variant_color_weave_size_shape_weight", "updated_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."variant",DBT_INTERNAL_SOURCE."color_value",DBT_INTERNAL_SOURCE."weave_cat",DBT_INTERNAL_SOURCE."size_grp",DBT_INTERNAL_SOURCE."shape",DBT_INTERNAL_SOURCE."weight",DBT_INTERNAL_SOURCE."low_stock",DBT_INTERNAL_SOURCE."name_variant_color_weave_size_shape_weight",DBT_INTERNAL_SOURCE."updated_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "low_stock_indicator__dbt_tmp202054405129" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:20:56.195897 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m20:20:56.197373 [debug] [Thread-1 (]: On snapshot.jaffle_shop.low_stock_indicator: COMMIT
[0m20:20:56.197613 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.low_stock_indicator"
[0m20:20:56.197807 [debug] [Thread-1 (]: On snapshot.jaffle_shop.low_stock_indicator: COMMIT
[0m20:20:56.198425 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:20:56.199330 [debug] [Thread-1 (]: finished collecting timing info
[0m20:20:56.199592 [debug] [Thread-1 (]: On snapshot.jaffle_shop.low_stock_indicator: Close
[0m20:20:56.200476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a247f35-c2ff-4b4e-a4be-322bb9771905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffd9c72290>]}
[0m20:20:56.201209 [info ] [Thread-1 (]: 10 of 24 OK snapshotted public.low_stock_indicator ............................. [[32mINSERT 0 0[0m in 1.84s]
[0m20:20:56.202019 [debug] [Thread-1 (]: Finished running node snapshot.jaffle_shop.low_stock_indicator
[0m20:20:56.218479 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m20:20:56.219006 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:56.219177 [debug] [MainThread]: On master: BEGIN
[0m20:20:56.219324 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:20:56.229828 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m20:20:56.230351 [debug] [MainThread]: On master: COMMIT
[0m20:20:56.230572 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:56.230811 [debug] [MainThread]: On master: COMMIT
[0m20:20:56.231091 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:20:56.231348 [debug] [MainThread]: On master: Close
[0m20:20:56.233819 [info ] [MainThread]: 
[0m20:20:56.234267 [info ] [MainThread]: Finished running 6 seeds, 2 snapshots, 4 view models, 12 tests in 0 hours 4 minutes and 6.67 seconds (246.67s).
[0m20:20:56.234698 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:20:56.234873 [debug] [MainThread]: Connection 'snapshot.jaffle_shop.low_stock_indicator' was properly closed.
[0m20:20:56.235041 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3' was properly closed.
[0m20:20:56.257991 [info ] [MainThread]: 
[0m20:20:56.258390 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:20:56.258692 [info ] [MainThread]: 
[0m20:20:56.258995 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=0 SKIP=0 TOTAL=24
[0m20:20:56.259582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a03d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a02140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a01180>]}


============================== 2024-07-14 21:34:11.147485 | 338e3725-030b-445c-85bf-c717b023e78e ==============================
[0m21:34:11.148039 [info ] [MainThread]: Running with dbt=1.2.0
[0m21:34:11.184237 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:34:11.184741 [debug] [MainThread]: Tracking: tracking
[0m21:34:11.203289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c122c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c133a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c126e0>]}
[0m21:34:11.282532 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:34:11.283231 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/below_depletion_level/below_depletion_level.sql
[0m21:34:11.319011 [debug] [MainThread]: 1699: static parser successfully parsed below_depletion_level/below_depletion_level.sql
[0m21:34:11.364989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '338e3725-030b-445c-85bf-c717b023e78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bb7520>]}
[0m21:34:11.379451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '338e3725-030b-445c-85bf-c717b023e78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7f0a0>]}
[0m21:34:11.379832 [info ] [MainThread]: Found 4 models, 12 tests, 2 snapshots, 0 analyses, 259 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m21:34:11.380164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '338e3725-030b-445c-85bf-c717b023e78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7ff40>]}
[0m21:34:11.382212 [info ] [MainThread]: 
[0m21:34:11.382854 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m21:34:11.384717 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m21:34:11.392843 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m21:34:11.393160 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m21:34:11.393393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:34:11.480872 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.09 seconds
[0m21:34:11.486123 [debug] [ThreadPool]: On list_postgres: Close
[0m21:34:11.491542 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m21:34:11.498457 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m21:34:11.498952 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m21:34:11.499201 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:34:11.509437 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m21:34:11.510059 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m21:34:11.510495 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m21:34:11.517502 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.01 seconds
[0m21:34:11.518910 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m21:34:11.519294 [debug] [ThreadPool]: On list_postgres_public: Close
[0m21:34:11.523707 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:11.524036 [debug] [MainThread]: On master: BEGIN
[0m21:34:11.524247 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:34:11.531391 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m21:34:11.531719 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:11.531945 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:34:11.550369 [debug] [MainThread]: SQL status: SELECT 11 in 0.02 seconds
[0m21:34:11.552392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '338e3725-030b-445c-85bf-c717b023e78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99e24a0>]}
[0m21:34:11.552936 [debug] [MainThread]: On master: ROLLBACK
[0m21:34:11.553230 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:11.553439 [debug] [MainThread]: On master: BEGIN
[0m21:34:11.553783 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:34:11.554012 [debug] [MainThread]: On master: COMMIT
[0m21:34:11.554207 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:11.554385 [debug] [MainThread]: On master: COMMIT
[0m21:34:11.554639 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:34:11.554844 [debug] [MainThread]: On master: Close
[0m21:34:11.555293 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m21:34:11.555653 [info ] [MainThread]: 
[0m21:34:11.574505 [debug] [Thread-1 (]: Began running node model.jaffle_shop.below_depletion_level
[0m21:34:11.574717 [debug] [Thread-2 (]: Began running node model.jaffle_shop.hot_upsell
[0m21:34:11.575170 [info ] [Thread-1 (]: 1 of 4 START view model public.below_depletion_level ........................... [RUN]
[0m21:34:11.575593 [info ] [Thread-2 (]: 2 of 4 START view model public.hot_upsell ...................................... [RUN]
[0m21:34:11.576136 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.below_depletion_level"
[0m21:34:11.576700 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.hot_upsell"
[0m21:34:11.577036 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.below_depletion_level
[0m21:34:11.577278 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.hot_upsell
[0m21:34:11.577536 [debug] [Thread-1 (]: Compiling model.jaffle_shop.below_depletion_level
[0m21:34:11.577773 [debug] [Thread-2 (]: Compiling model.jaffle_shop.hot_upsell
[0m21:34:11.580664 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.below_depletion_level"
[0m21:34:11.583428 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.hot_upsell"
[0m21:34:11.586853 [debug] [Thread-2 (]: finished collecting timing info
[0m21:34:11.586978 [debug] [Thread-1 (]: finished collecting timing info
[0m21:34:11.587203 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.hot_upsell
[0m21:34:11.587426 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.below_depletion_level
[0m21:34:11.638828 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.hot_upsell"
[0m21:34:11.639184 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.below_depletion_level"
[0m21:34:11.643298 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m21:34:11.643506 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m21:34:11.643775 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: BEGIN
[0m21:34:11.644534 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: BEGIN
[0m21:34:11.645254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:34:11.645736 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:34:11.654821 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m21:34:11.655193 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m21:34:11.655370 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m21:34:11.655633 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m21:34:11.655859 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */

  create view "postgres"."public"."below_depletion_level__dbt_tmp" as (
    select distinct name, ruv.variant, ruv.actual_size, ruv.weave_cat, ruv.size_grp, ruv.shape, ruv.weight, ruv.stock_level, ruv.depletion_level
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where coalesce(stock_level, 0) < coalesce(depletion_level, 0)
order by ruv.stock_level asc;
  );
[0m21:34:11.656066 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */

  create view "postgres"."public"."hot_upsell__dbt_tmp" as (
    select distinct rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, (ruv.msrp - rupu.price) as profit_margin
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_pads_upsell" rupu on rupu.p_id = ruv.pid and rupu.variant = ruv.variant 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where new_arrival = 'Y' and stock_level < coalesce(depletion_level, 0) and rupu.stock is not null
order by profit_margin desc
  );
[0m21:34:11.656968 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 8: order by ruv.stock_level asc;
                                    ^

[0m21:34:11.660033 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: ROLLBACK
[0m21:34:11.660894 [debug] [Thread-1 (]: finished collecting timing info
[0m21:34:11.661524 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: Close
[0m21:34:11.662206 [debug] [Thread-1 (]: Database Error in model below_depletion_level (models/below_depletion_level/below_depletion_level.sql)
  syntax error at or near ";"
  LINE 8: order by ruv.stock_level asc;
                                      ^
  compiled SQL at target/run/jaffle_shop/models/below_depletion_level/below_depletion_level.sql
[0m21:34:11.663058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '338e3725-030b-445c-85bf-c717b023e78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff88e0be0>]}
[0m21:34:11.663673 [error] [Thread-1 (]: 1 of 4 ERROR creating view model public.below_depletion_level .................. [[31mERROR[0m in 0.09s]
[0m21:34:11.664619 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.below_depletion_level
[0m21:34:11.665000 [debug] [Thread-1 (]: Began running node model.jaffle_shop.underselling_product_specs
[0m21:34:11.665619 [info ] [Thread-1 (]: 3 of 4 START view model public.underselling_product_specs ...................... [RUN]
[0m21:34:11.666123 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.underselling_product_specs"
[0m21:34:11.667005 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.underselling_product_specs
[0m21:34:11.667516 [debug] [Thread-1 (]: Compiling model.jaffle_shop.underselling_product_specs
[0m21:34:11.670672 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.underselling_product_specs"
[0m21:34:11.670808 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m21:34:11.676013 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m21:34:11.676278 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
alter table "postgres"."public"."hot_upsell" rename to "hot_upsell__dbt_backup"
[0m21:34:11.676469 [debug] [Thread-1 (]: finished collecting timing info
[0m21:34:11.676839 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.underselling_product_specs
[0m21:34:11.680425 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.underselling_product_specs"
[0m21:34:11.680605 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:34:11.683138 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m21:34:11.683477 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
alter table "postgres"."public"."hot_upsell__dbt_tmp" rename to "hot_upsell"
[0m21:34:11.683958 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m21:34:11.684735 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:34:11.685073 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: BEGIN
[0m21:34:11.701396 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: COMMIT
[0m21:34:11.701577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:34:11.701888 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m21:34:11.704197 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: COMMIT
[0m21:34:11.709248 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m21:34:11.709750 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m21:34:11.710001 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */

  create view "postgres"."public"."underselling_product_specs__dbt_tmp" as (
    select distinct rup.name, rucm.color_value, ruv.actual_size, ruv.weave_cat, ruv.size_grp, ruv.shape, (ruv.stock_level - ruv.depletion_level) as stock_depletion_ratio
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_color_map" rucm on rucm.color_id = ruv.pid 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
where stock_level > coalesce(depletion_level, 0) and depletion_level <> 0 
and stock_level is not null and stock_level <> 0 and new_arrival = 'N' and status = 'In_stock'
order by stock_depletion_ratio desc limit 10
  );
[0m21:34:11.713768 [debug] [Thread-2 (]: SQL status: COMMIT in 0.01 seconds
[0m21:34:11.721504 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m21:34:11.721953 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m21:34:11.722462 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
drop view if exists "postgres"."public"."hot_upsell__dbt_backup" cascade
[0m21:34:11.725341 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m21:34:11.730241 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
alter table "postgres"."public"."underselling_product_specs" rename to "underselling_product_specs__dbt_backup"
[0m21:34:11.732829 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:34:11.735679 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m21:34:11.735833 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.01 seconds
[0m21:34:11.736165 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
alter table "postgres"."public"."underselling_product_specs__dbt_tmp" rename to "underselling_product_specs"
[0m21:34:11.737332 [debug] [Thread-2 (]: finished collecting timing info
[0m21:34:11.737976 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: Close
[0m21:34:11.738299 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:34:11.739256 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '338e3725-030b-445c-85bf-c717b023e78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a92680>]}
[0m21:34:11.741956 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: COMMIT
[0m21:34:11.742730 [info ] [Thread-2 (]: 2 of 4 OK created view model public.hot_upsell ................................. [[32mCREATE VIEW[0m in 0.16s]
[0m21:34:11.743056 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m21:34:11.743566 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.hot_upsell
[0m21:34:11.743820 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: COMMIT
[0m21:34:11.744093 [debug] [Thread-2 (]: Began running node model.jaffle_shop.priority_order
[0m21:34:11.744622 [info ] [Thread-2 (]: 4 of 4 SKIP relation public.priority_order ..................................... [[33mSKIP[0m]
[0m21:34:11.745235 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.priority_order
[0m21:34:11.745463 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:34:11.747315 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m21:34:11.747609 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
drop view if exists "postgres"."public"."underselling_product_specs__dbt_backup" cascade
[0m21:34:11.749372 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:34:11.750878 [debug] [Thread-1 (]: finished collecting timing info
[0m21:34:11.751226 [debug] [Thread-1 (]: On model.jaffle_shop.underselling_product_specs: Close
[0m21:34:11.751763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '338e3725-030b-445c-85bf-c717b023e78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff88e2c80>]}
[0m21:34:11.752163 [info ] [Thread-1 (]: 3 of 4 OK created view model public.underselling_product_specs ................. [[32mCREATE VIEW[0m in 0.09s]
[0m21:34:11.752609 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.underselling_product_specs
[0m21:34:11.754721 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m21:34:11.755031 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:11.755255 [debug] [MainThread]: On master: BEGIN
[0m21:34:11.755458 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:34:11.762822 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m21:34:11.763208 [debug] [MainThread]: On master: COMMIT
[0m21:34:11.763445 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:11.763678 [debug] [MainThread]: On master: COMMIT
[0m21:34:11.763949 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:34:11.764167 [debug] [MainThread]: On master: Close
[0m21:34:11.764878 [info ] [MainThread]: 
[0m21:34:11.765195 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m21:34:11.765536 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:34:11.765819 [debug] [MainThread]: Connection 'model.jaffle_shop.underselling_product_specs' was properly closed.
[0m21:34:11.766019 [debug] [MainThread]: Connection 'model.jaffle_shop.hot_upsell' was properly closed.
[0m21:34:11.773394 [info ] [MainThread]: 
[0m21:34:11.773744 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:34:11.774050 [info ] [MainThread]: 
[0m21:34:11.774383 [error] [MainThread]: [33mDatabase Error in model below_depletion_level (models/below_depletion_level/below_depletion_level.sql)[0m
[0m21:34:11.774797 [error] [MainThread]:   syntax error at or near ";"
[0m21:34:11.775147 [error] [MainThread]:   LINE 8: order by ruv.stock_level asc;
[0m21:34:11.775470 [error] [MainThread]:                                       ^
[0m21:34:11.775793 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/below_depletion_level/below_depletion_level.sql
[0m21:34:11.776065 [info ] [MainThread]: 
[0m21:34:11.776332 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m21:34:11.776812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba0ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba0a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba0d00>]}


============================== 2024-07-14 21:34:24.441488 | bdf40a9e-1b16-400e-bc1e-0ce18acbaef9 ==============================
[0m21:34:24.441803 [info ] [MainThread]: Running with dbt=1.2.0
[0m21:34:24.449459 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:34:24.449826 [debug] [MainThread]: Tracking: tracking
[0m21:34:24.468964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c122c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c133a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c10250>]}
[0m21:34:24.529822 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:34:24.530616 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/below_depletion_level/below_depletion_level.sql
[0m21:34:24.565542 [debug] [MainThread]: 1699: static parser successfully parsed below_depletion_level/below_depletion_level.sql
[0m21:34:24.606915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdf40a9e-1b16-400e-bc1e-0ce18acbaef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bb74c0>]}
[0m21:34:24.617620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdf40a9e-1b16-400e-bc1e-0ce18acbaef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7f0a0>]}
[0m21:34:24.618058 [info ] [MainThread]: Found 4 models, 12 tests, 2 snapshots, 0 analyses, 259 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m21:34:24.618405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdf40a9e-1b16-400e-bc1e-0ce18acbaef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7ff40>]}
[0m21:34:24.620182 [info ] [MainThread]: 
[0m21:34:24.620802 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m21:34:24.622506 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m21:34:24.630384 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m21:34:24.630708 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m21:34:24.630942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:34:24.677488 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.05 seconds
[0m21:34:24.679259 [debug] [ThreadPool]: On list_postgres: Close
[0m21:34:24.681649 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m21:34:24.686624 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m21:34:24.686878 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m21:34:24.687098 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:34:24.694492 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m21:34:24.694837 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m21:34:24.695072 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m21:34:24.698576 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m21:34:24.699879 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m21:34:24.700270 [debug] [ThreadPool]: On list_postgres_public: Close
[0m21:34:24.704453 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:24.704751 [debug] [MainThread]: On master: BEGIN
[0m21:34:24.704964 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:34:24.711330 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m21:34:24.711616 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:24.711834 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:34:24.716189 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m21:34:24.718024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdf40a9e-1b16-400e-bc1e-0ce18acbaef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99e0e50>]}
[0m21:34:24.718414 [debug] [MainThread]: On master: ROLLBACK
[0m21:34:24.718717 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:24.718942 [debug] [MainThread]: On master: BEGIN
[0m21:34:24.719305 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:34:24.719616 [debug] [MainThread]: On master: COMMIT
[0m21:34:24.719862 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:24.720118 [debug] [MainThread]: On master: COMMIT
[0m21:34:24.720404 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:34:24.720646 [debug] [MainThread]: On master: Close
[0m21:34:24.721018 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m21:34:24.721306 [info ] [MainThread]: 
[0m21:34:24.725411 [debug] [Thread-1 (]: Began running node model.jaffle_shop.below_depletion_level
[0m21:34:24.725534 [debug] [Thread-2 (]: Began running node model.jaffle_shop.hot_upsell
[0m21:34:24.725854 [info ] [Thread-1 (]: 1 of 4 START view model public.below_depletion_level ........................... [RUN]
[0m21:34:24.726180 [info ] [Thread-2 (]: 2 of 4 START view model public.hot_upsell ...................................... [RUN]
[0m21:34:24.726605 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.below_depletion_level"
[0m21:34:24.727005 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.hot_upsell"
[0m21:34:24.727219 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.below_depletion_level
[0m21:34:24.727451 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.hot_upsell
[0m21:34:24.727678 [debug] [Thread-1 (]: Compiling model.jaffle_shop.below_depletion_level
[0m21:34:24.727880 [debug] [Thread-2 (]: Compiling model.jaffle_shop.hot_upsell
[0m21:34:24.730201 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.below_depletion_level"
[0m21:34:24.732662 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.hot_upsell"
[0m21:34:24.734041 [debug] [Thread-2 (]: finished collecting timing info
[0m21:34:24.734251 [debug] [Thread-1 (]: finished collecting timing info
[0m21:34:24.734358 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.hot_upsell
[0m21:34:24.734586 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.below_depletion_level
[0m21:34:24.769895 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.hot_upsell"
[0m21:34:24.771338 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.below_depletion_level"
[0m21:34:24.773051 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m21:34:24.773203 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m21:34:24.773419 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: BEGIN
[0m21:34:24.773676 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: BEGIN
[0m21:34:24.773920 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:34:24.774165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:34:24.781307 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m21:34:24.782216 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m21:34:24.782338 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m21:34:24.782579 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */

  create view "postgres"."public"."below_depletion_level__dbt_tmp" as (
    select distinct name, ruv.variant, ruv.actual_size, ruv.weave_cat, ruv.size_grp, ruv.shape, ruv.weight, ruv.stock_level, ruv.depletion_level
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where coalesce(stock_level, 0) < coalesce(depletion_level, 0)
order by ruv.stock_level asc
  );
[0m21:34:24.782807 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m21:34:24.783424 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */

  create view "postgres"."public"."hot_upsell__dbt_tmp" as (
    select distinct rup.name, ruv.variant, rupu.size, rupu.shape, rupu.type, (ruv.msrp - rupu.price) as profit_margin
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_pads_upsell" rupu on rupu.p_id = ruv.pid and rupu.variant = ruv.variant 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid
where new_arrival = 'Y' and stock_level < coalesce(depletion_level, 0) and rupu.stock is not null
order by profit_margin desc
  );
[0m21:34:24.787921 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:34:24.793805 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m21:34:24.794025 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m21:34:24.794311 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level" rename to "below_depletion_level__dbt_backup"
[0m21:34:24.796345 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m21:34:24.796770 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
alter table "postgres"."public"."hot_upsell" rename to "hot_upsell__dbt_backup"
[0m21:34:24.797492 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:34:24.797588 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:34:24.799304 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m21:34:24.801836 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m21:34:24.802091 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
alter table "postgres"."public"."below_depletion_level__dbt_tmp" rename to "below_depletion_level"
[0m21:34:24.802298 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
alter table "postgres"."public"."hot_upsell__dbt_tmp" rename to "hot_upsell"
[0m21:34:24.802820 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:34:24.803033 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:34:24.817393 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m21:34:24.818591 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: COMMIT
[0m21:34:24.818871 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m21:34:24.819118 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m21:34:24.819356 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: COMMIT
[0m21:34:24.819595 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: COMMIT
[0m21:34:24.820756 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:34:24.820937 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m21:34:24.824635 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.below_depletion_level"
[0m21:34:24.826083 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.hot_upsell"
[0m21:34:24.826353 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.below_depletion_level"} */
drop view if exists "postgres"."public"."below_depletion_level__dbt_backup" cascade
[0m21:34:24.826567 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.hot_upsell"} */
drop view if exists "postgres"."public"."hot_upsell__dbt_backup" cascade
[0m21:34:24.828890 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:34:24.830093 [debug] [Thread-2 (]: finished collecting timing info
[0m21:34:24.830191 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:34:24.830427 [debug] [Thread-2 (]: On model.jaffle_shop.hot_upsell: Close
[0m21:34:24.831245 [debug] [Thread-1 (]: finished collecting timing info
[0m21:34:24.831740 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdf40a9e-1b16-400e-bc1e-0ce18acbaef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a92680>]}
[0m21:34:24.832445 [debug] [Thread-1 (]: On model.jaffle_shop.below_depletion_level: Close
[0m21:34:24.832849 [info ] [Thread-2 (]: 2 of 4 OK created view model public.hot_upsell ................................. [[32mCREATE VIEW[0m in 0.10s]
[0m21:34:24.833423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdf40a9e-1b16-400e-bc1e-0ce18acbaef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba1ab0>]}
[0m21:34:24.833865 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.hot_upsell
[0m21:34:24.834273 [info ] [Thread-1 (]: 1 of 4 OK created view model public.below_depletion_level ...................... [[32mCREATE VIEW[0m in 0.11s]
[0m21:34:24.834581 [debug] [Thread-2 (]: Began running node model.jaffle_shop.underselling_product_specs
[0m21:34:24.835021 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.below_depletion_level
[0m21:34:24.835287 [info ] [Thread-2 (]: 3 of 4 START view model public.underselling_product_specs ...................... [RUN]
[0m21:34:24.835812 [debug] [Thread-1 (]: Began running node model.jaffle_shop.priority_order
[0m21:34:24.836187 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.underselling_product_specs"
[0m21:34:24.836500 [info ] [Thread-1 (]: 4 of 4 START view model public.priority_order .................................. [RUN]
[0m21:34:24.836744 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.underselling_product_specs
[0m21:34:24.837147 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.priority_order"
[0m21:34:24.837346 [debug] [Thread-2 (]: Compiling model.jaffle_shop.underselling_product_specs
[0m21:34:24.837567 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.priority_order
[0m21:34:24.840287 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.underselling_product_specs"
[0m21:34:24.840611 [debug] [Thread-1 (]: Compiling model.jaffle_shop.priority_order
[0m21:34:24.843674 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.priority_order"
[0m21:34:24.844180 [debug] [Thread-2 (]: finished collecting timing info
[0m21:34:24.844651 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.underselling_product_specs
[0m21:34:24.847535 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.underselling_product_specs"
[0m21:34:24.847629 [debug] [Thread-1 (]: finished collecting timing info
[0m21:34:24.848124 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.priority_order
[0m21:34:24.850792 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.priority_order"
[0m21:34:24.850912 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m21:34:24.851519 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: BEGIN
[0m21:34:24.851727 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:34:24.851900 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m21:34:24.852311 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: BEGIN
[0m21:34:24.852963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:34:24.859144 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m21:34:24.859556 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m21:34:24.859722 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m21:34:24.859974 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m21:34:24.860238 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */

  create view "postgres"."public"."underselling_product_specs__dbt_tmp" as (
    select distinct rup.name, rucm.color_value, ruv.actual_size, ruv.weave_cat, ruv.size_grp, ruv.shape, (ruv.stock_level - ruv.depletion_level) as stock_depletion_ratio
from "postgres"."public"."rugs_usa_variant" ruv
join "postgres"."public"."rugs_usa_color_map" rucm on rucm.color_id = ruv.pid 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
where stock_level > coalesce(depletion_level, 0) and depletion_level <> 0 
and stock_level is not null and stock_level <> 0 and new_arrival = 'N' and status = 'In_stock'
order by stock_depletion_ratio desc limit 10
  );
[0m21:34:24.860461 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */

  create view "postgres"."public"."priority_order__dbt_tmp" as (
    select distinct rup.name, ruv.variant, ruv.actual_size, ruv.weave_cat, (msrp - price) as profit 
from "postgres"."public"."rugs_usa_variant" ruv 
join "postgres"."public"."rugs_usa_parent" rup on rup.pid = ruv.pid 
join "postgres"."public"."below_depletion_level" bdl on bdl.name = rup.name and bdl.variant = ruv.variant
order by profit desc
  );
[0m21:34:24.863691 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:34:24.865784 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m21:34:24.865880 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m21:34:24.866090 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
alter table "postgres"."public"."priority_order__dbt_tmp" rename to "priority_order"
[0m21:34:24.867908 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m21:34:24.868314 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
alter table "postgres"."public"."underselling_product_specs" rename to "underselling_product_specs__dbt_backup"
[0m21:34:24.868507 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:34:24.869615 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: COMMIT
[0m21:34:24.869698 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:34:24.869887 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m21:34:24.872501 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m21:34:24.872763 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: COMMIT
[0m21:34:24.872966 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
alter table "postgres"."public"."underselling_product_specs__dbt_tmp" rename to "underselling_product_specs"
[0m21:34:24.873700 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:34:24.874028 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:34:24.875044 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: COMMIT
[0m21:34:24.876445 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.priority_order"
[0m21:34:24.876697 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m21:34:24.876925 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.priority_order"} */
drop view if exists "postgres"."public"."priority_order__dbt_backup" cascade
[0m21:34:24.877204 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: COMMIT
[0m21:34:24.877806 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:34:24.877885 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m21:34:24.878714 [debug] [Thread-1 (]: finished collecting timing info
[0m21:34:24.880021 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.underselling_product_specs"
[0m21:34:24.880273 [debug] [Thread-1 (]: On model.jaffle_shop.priority_order: Close
[0m21:34:24.880487 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.underselling_product_specs"} */
drop view if exists "postgres"."public"."underselling_product_specs__dbt_backup" cascade
[0m21:34:24.880913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdf40a9e-1b16-400e-bc1e-0ce18acbaef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8976c80>]}
[0m21:34:24.881506 [info ] [Thread-1 (]: 4 of 4 OK created view model public.priority_order ............................. [[32mCREATE VIEW[0m in 0.04s]
[0m21:34:24.882001 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.priority_order
[0m21:34:24.882821 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:34:24.883766 [debug] [Thread-2 (]: finished collecting timing info
[0m21:34:24.884005 [debug] [Thread-2 (]: On model.jaffle_shop.underselling_product_specs: Close
[0m21:34:24.884387 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdf40a9e-1b16-400e-bc1e-0ce18acbaef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff896ce80>]}
[0m21:34:24.884723 [info ] [Thread-2 (]: 3 of 4 OK created view model public.underselling_product_specs ................. [[32mCREATE VIEW[0m in 0.05s]
[0m21:34:24.885122 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.underselling_product_specs
[0m21:34:24.886734 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m21:34:24.886993 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:24.887203 [debug] [MainThread]: On master: BEGIN
[0m21:34:24.887426 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:34:24.893473 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m21:34:24.893774 [debug] [MainThread]: On master: COMMIT
[0m21:34:24.893997 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:24.894190 [debug] [MainThread]: On master: COMMIT
[0m21:34:24.894456 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:34:24.894676 [debug] [MainThread]: On master: Close
[0m21:34:24.895264 [info ] [MainThread]: 
[0m21:34:24.895576 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m21:34:24.895877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:34:24.896094 [debug] [MainThread]: Connection 'model.jaffle_shop.priority_order' was properly closed.
[0m21:34:24.896286 [debug] [MainThread]: Connection 'model.jaffle_shop.underselling_product_specs' was properly closed.
[0m21:34:24.902669 [info ] [MainThread]: 
[0m21:34:24.902993 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:34:24.903371 [info ] [MainThread]: 
[0m21:34:24.903699 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m21:34:24.904118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89534f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff89534c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8952290>]}


============================== 2024-07-14 21:40:16.634376 | 3a357b34-461f-4fcd-9908-cd4b93d0a5aa ==============================
[0m21:40:16.634699 [info ] [MainThread]: Running with dbt=1.2.0
[0m21:40:16.669131 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
[0m21:40:16.669609 [debug] [MainThread]: Tracking: tracking
[0m21:40:16.685882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2afb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2b250>]}
[0m21:40:16.741304 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:40:16.741624 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:40:16.747542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a357b34-461f-4fcd-9908-cd4b93d0a5aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99d00d0>]}
[0m21:40:16.758338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a357b34-461f-4fcd-9908-cd4b93d0a5aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae15d0>]}
[0m21:40:16.758700 [info ] [MainThread]: Found 4 models, 12 tests, 2 snapshots, 0 analyses, 259 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m21:40:16.759029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a357b34-461f-4fcd-9908-cd4b93d0a5aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae13f0>]}
[0m21:40:16.760705 [info ] [MainThread]: 
[0m21:40:16.761307 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m21:40:16.763282 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m21:40:16.771216 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m21:40:16.771499 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m21:40:16.771723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:40:16.818801 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.05 seconds
[0m21:40:16.820614 [debug] [ThreadPool]: On list_postgres: Close
[0m21:40:16.823011 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m21:40:16.827873 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m21:40:16.828160 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m21:40:16.828372 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:40:16.835804 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m21:40:16.836184 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m21:40:16.836441 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m21:40:16.844611 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.01 seconds
[0m21:40:16.846235 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m21:40:16.846683 [debug] [ThreadPool]: On list_postgres_public: Close
[0m21:40:16.852723 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:16.853106 [debug] [MainThread]: On master: BEGIN
[0m21:40:16.853353 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:40:16.866882 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m21:40:16.867729 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:16.867995 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:40:16.880351 [debug] [MainThread]: SQL status: SELECT 11 in 0.01 seconds
[0m21:40:16.883861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a357b34-461f-4fcd-9908-cd4b93d0a5aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c58fd0>]}
[0m21:40:16.884377 [debug] [MainThread]: On master: ROLLBACK
[0m21:40:16.886238 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:16.886494 [debug] [MainThread]: On master: BEGIN
[0m21:40:16.886925 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:40:16.887490 [debug] [MainThread]: On master: COMMIT
[0m21:40:16.887746 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:16.887982 [debug] [MainThread]: On master: COMMIT
[0m21:40:16.888334 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:40:16.888657 [debug] [MainThread]: On master: Close
[0m21:40:16.889149 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m21:40:16.889522 [info ] [MainThread]: 
[0m21:40:16.895025 [debug] [Thread-1 (]: Began running node snapshot.jaffle_shop.availability_clearance_rugs
[0m21:40:16.895203 [debug] [Thread-2 (]: Began running node snapshot.jaffle_shop.low_stock_indicator
[0m21:40:16.895657 [info ] [Thread-1 (]: 1 of 2 START snapshot public.availability_clearance_rugs ....................... [RUN]
[0m21:40:16.896103 [info ] [Thread-2 (]: 2 of 2 START snapshot public.low_stock_indicator ............................... [RUN]
[0m21:40:16.896678 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.jaffle_shop.availability_clearance_rugs"
[0m21:40:16.897165 [debug] [Thread-2 (]: Acquiring new postgres connection "snapshot.jaffle_shop.low_stock_indicator"
[0m21:40:16.897510 [debug] [Thread-1 (]: Began compiling node snapshot.jaffle_shop.availability_clearance_rugs
[0m21:40:16.897784 [debug] [Thread-2 (]: Began compiling node snapshot.jaffle_shop.low_stock_indicator
[0m21:40:16.898054 [debug] [Thread-1 (]: Compiling snapshot.jaffle_shop.availability_clearance_rugs
[0m21:40:16.898298 [debug] [Thread-2 (]: Compiling snapshot.jaffle_shop.low_stock_indicator
[0m21:40:16.901493 [debug] [Thread-1 (]: finished collecting timing info
[0m21:40:16.904734 [debug] [Thread-2 (]: finished collecting timing info
[0m21:40:16.905137 [debug] [Thread-1 (]: Began executing node snapshot.jaffle_shop.availability_clearance_rugs
[0m21:40:16.905405 [debug] [Thread-2 (]: Began executing node snapshot.jaffle_shop.low_stock_indicator
[0m21:40:16.977016 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.availability_clearance_rugs"
[0m21:40:16.978847 [debug] [Thread-2 (]: Using postgres connection "snapshot.jaffle_shop.low_stock_indicator"
[0m21:40:16.979173 [debug] [Thread-1 (]: On snapshot.jaffle_shop.availability_clearance_rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.availability_clearance_rugs"} */
select * from (
            select availability, clearance from (



SELECT 
    name,
    url,
    availability,
    clearance,
    NOW() AS updated_at
FROM 
    "postgres"."public"."rugs_usa_parent"
) subq
        ) as __dbt_sbq
        where false
        limit 0
    
[0m21:40:16.979471 [debug] [Thread-2 (]: On snapshot.jaffle_shop.low_stock_indicator: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.low_stock_indicator"} */
select * from (
            select low_stock from (



SELECT DISTINCT 
    rup.name,
    ruv.variant,
    rucm.color_value,
    ruv.weave_cat,
    ruv.size_grp,
    ruv.shape,
    ruv.weight,
    ruv.low_stock,
    CONCAT(rup.name, '_', ruv.variant, '_', rucm.color_value, '_', ruv.weave_cat, '_', ruv.size_grp, '_', ruv.shape, '_', ruv.weight) AS name_variant_color_weave_size_shape_weight,  
    NOW() AS updated_at
FROM 
    "postgres"."public"."rugs_usa_variant" ruv
JOIN 
    "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
JOIN 
    "postgres"."public"."rugs_usa_color_map" rucm ON rucm.color_id = ruv.pid
) subq
        ) as __dbt_sbq
        where false
        limit 0
    
[0m21:40:16.979724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:40:16.979980 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:40:16.988631 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.01 seconds
[0m21:40:16.994627 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.availability_clearance_rugs"
[0m21:40:16.994759 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.01 seconds
[0m21:40:16.995005 [debug] [Thread-1 (]: On snapshot.jaffle_shop.availability_clearance_rugs: BEGIN
[0m21:40:16.997009 [debug] [Thread-2 (]: Using postgres connection "snapshot.jaffle_shop.low_stock_indicator"
[0m21:40:16.997446 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:40:16.997558 [debug] [Thread-2 (]: On snapshot.jaffle_shop.low_stock_indicator: BEGIN
[0m21:40:16.997917 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.availability_clearance_rugs"
[0m21:40:16.998287 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:40:16.998470 [debug] [Thread-1 (]: On snapshot.jaffle_shop.availability_clearance_rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.availability_clearance_rugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'availability_clearance_rugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m21:40:16.998716 [debug] [Thread-2 (]: Using postgres connection "snapshot.jaffle_shop.low_stock_indicator"
[0m21:40:16.999131 [debug] [Thread-2 (]: On snapshot.jaffle_shop.low_stock_indicator: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.low_stock_indicator"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'low_stock_indicator'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m21:40:17.020191 [debug] [Thread-2 (]: SQL status: SELECT 14 in 0.02 seconds
[0m21:40:17.027366 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.03 seconds
[0m21:40:17.027504 [debug] [Thread-2 (]: Using postgres connection "snapshot.jaffle_shop.low_stock_indicator"
[0m21:40:17.030692 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.availability_clearance_rugs"
[0m21:40:17.030966 [debug] [Thread-2 (]: On snapshot.jaffle_shop.low_stock_indicator: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.low_stock_indicator"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'low_stock_indicator'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m21:40:17.031195 [debug] [Thread-1 (]: On snapshot.jaffle_shop.availability_clearance_rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.availability_clearance_rugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'availability_clearance_rugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m21:40:17.033488 [debug] [Thread-2 (]: SQL status: SELECT 14 in 0.0 seconds
[0m21:40:17.033611 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.0 seconds
[0m21:40:17.054117 [debug] [Thread-2 (]: Using postgres connection "snapshot.jaffle_shop.low_stock_indicator"
[0m21:40:17.056275 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.availability_clearance_rugs"
[0m21:40:17.056563 [debug] [Thread-2 (]: On snapshot.jaffle_shop.low_stock_indicator: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.low_stock_indicator"} */

        

  create temporary table "low_stock_indicator__dbt_tmp214017044542"
  as (
    with snapshot_query as (

        



SELECT DISTINCT 
    rup.name,
    ruv.variant,
    rucm.color_value,
    ruv.weave_cat,
    ruv.size_grp,
    ruv.shape,
    ruv.weight,
    ruv.low_stock,
    CONCAT(rup.name, '_', ruv.variant, '_', rucm.color_value, '_', ruv.weave_cat, '_', ruv.size_grp, '_', ruv.shape, '_', ruv.weight) AS name_variant_color_weave_size_shape_weight,  
    NOW() AS updated_at
FROM 
    "postgres"."public"."rugs_usa_variant" ruv
JOIN 
    "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
JOIN 
    "postgres"."public"."rugs_usa_color_map" rucm ON rucm.color_id = ruv.pid


    ),

    snapshotted_data as (

        select *,
            name_variant_color_weave_size_shape_weight as dbt_unique_key

        from "postgres"."public"."low_stock_indicator"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            name_variant_color_weave_size_shape_weight as dbt_unique_key,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            nullif(now()::timestamp without time zone, now()::timestamp without time zone) as dbt_valid_to,
            md5(coalesce(cast(name_variant_color_weave_size_shape_weight as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            name_variant_color_weave_size_shape_weight as dbt_unique_key,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."low_stock" != source_data."low_stock"
        or
        (
            ((snapshotted_data."low_stock" is null) and not (source_data."low_stock" is null))
            or
            ((not snapshotted_data."low_stock" is null) and (source_data."low_stock" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."low_stock" != source_data."low_stock"
        or
        (
            ((snapshotted_data."low_stock" is null) and not (source_data."low_stock" is null))
            or
            ((not snapshotted_data."low_stock" is null) and (source_data."low_stock" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );
    
[0m21:40:17.056812 [debug] [Thread-1 (]: On snapshot.jaffle_shop.availability_clearance_rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.availability_clearance_rugs"} */

        

  create temporary table "availability_clearance_rugs__dbt_tmp214017055774"
  as (
    with snapshot_query as (

        



SELECT 
    name,
    url,
    availability,
    clearance,
    NOW() AS updated_at
FROM 
    "postgres"."public"."rugs_usa_parent"


    ),

    snapshotted_data as (

        select *,
            url as dbt_unique_key

        from "postgres"."public"."availability_clearance_rugs"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            url as dbt_unique_key,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            nullif(now()::timestamp without time zone, now()::timestamp without time zone) as dbt_valid_to,
            md5(coalesce(cast(url as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            url as dbt_unique_key,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."availability" != source_data."availability"
        or
        (
            ((snapshotted_data."availability" is null) and not (source_data."availability" is null))
            or
            ((not snapshotted_data."availability" is null) and (source_data."availability" is null))
        ) or snapshotted_data."clearance" != source_data."clearance"
        or
        (
            ((snapshotted_data."clearance" is null) and not (source_data."clearance" is null))
            or
            ((not snapshotted_data."clearance" is null) and (source_data."clearance" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."availability" != source_data."availability"
        or
        (
            ((snapshotted_data."availability" is null) and not (source_data."availability" is null))
            or
            ((not snapshotted_data."availability" is null) and (source_data."availability" is null))
        ) or snapshotted_data."clearance" != source_data."clearance"
        or
        (
            ((snapshotted_data."clearance" is null) and not (source_data."clearance" is null))
            or
            ((not snapshotted_data."clearance" is null) and (source_data."clearance" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );
    
[0m21:40:17.199716 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.14 seconds
[0m21:40:17.202874 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.availability_clearance_rugs"
[0m21:40:17.203147 [debug] [Thread-1 (]: On snapshot.jaffle_shop.availability_clearance_rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.availability_clearance_rugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'availability_clearance_rugs__dbt_tmp214017055774'
        
      order by ordinal_position

  
[0m21:40:17.205524 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m21:40:17.208120 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.availability_clearance_rugs"
[0m21:40:17.208379 [debug] [Thread-1 (]: On snapshot.jaffle_shop.availability_clearance_rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.availability_clearance_rugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'availability_clearance_rugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m21:40:17.210503 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.0 seconds
[0m21:40:17.212970 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.availability_clearance_rugs"
[0m21:40:17.213228 [debug] [Thread-1 (]: On snapshot.jaffle_shop.availability_clearance_rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.availability_clearance_rugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'availability_clearance_rugs__dbt_tmp214017055774'
        
      order by ordinal_position

  
[0m21:40:17.215583 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m21:40:17.218223 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.availability_clearance_rugs"
[0m21:40:17.218509 [debug] [Thread-1 (]: On snapshot.jaffle_shop.availability_clearance_rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.availability_clearance_rugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'availability_clearance_rugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m21:40:17.220801 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.0 seconds
[0m21:40:17.229931 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.availability_clearance_rugs"
[0m21:40:17.230500 [debug] [Thread-1 (]: On snapshot.jaffle_shop.availability_clearance_rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.availability_clearance_rugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'availability_clearance_rugs__dbt_tmp214017055774'
        
      order by ordinal_position

  
[0m21:40:17.233283 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m21:40:17.239952 [debug] [Thread-1 (]: Writing runtime SQL for node "snapshot.jaffle_shop.availability_clearance_rugs"
[0m21:40:17.244024 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.availability_clearance_rugs"
[0m21:40:17.244272 [debug] [Thread-1 (]: On snapshot.jaffle_shop.availability_clearance_rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.availability_clearance_rugs"} */

      update "postgres"."public"."availability_clearance_rugs"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "availability_clearance_rugs__dbt_tmp214017055774" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."public"."availability_clearance_rugs".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."public"."availability_clearance_rugs".dbt_valid_to is null;

    insert into "postgres"."public"."availability_clearance_rugs" ("name", "url", "availability", "clearance", "updated_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."url",DBT_INTERNAL_SOURCE."availability",DBT_INTERNAL_SOURCE."clearance",DBT_INTERNAL_SOURCE."updated_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "availability_clearance_rugs__dbt_tmp214017055774" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m21:40:17.247096 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m21:40:17.262733 [debug] [Thread-1 (]: On snapshot.jaffle_shop.availability_clearance_rugs: COMMIT
[0m21:40:17.263353 [debug] [Thread-1 (]: Using postgres connection "snapshot.jaffle_shop.availability_clearance_rugs"
[0m21:40:17.263635 [debug] [Thread-1 (]: On snapshot.jaffle_shop.availability_clearance_rugs: COMMIT
[0m21:40:17.272729 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m21:40:17.275880 [debug] [Thread-1 (]: finished collecting timing info
[0m21:40:17.276329 [debug] [Thread-1 (]: On snapshot.jaffle_shop.availability_clearance_rugs: Close
[0m21:40:17.277088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a357b34-461f-4fcd-9908-cd4b93d0a5aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a14790>]}
[0m21:40:17.277702 [info ] [Thread-1 (]: 1 of 2 OK snapshotted public.availability_clearance_rugs ....................... [[32mINSERT 0 0[0m in 0.38s]
[0m21:40:17.278544 [debug] [Thread-1 (]: Finished running node snapshot.jaffle_shop.availability_clearance_rugs
[0m21:40:18.782603 [debug] [Thread-2 (]: SQL status: SELECT 0 in 1.73 seconds
[0m21:40:18.790230 [debug] [Thread-2 (]: Using postgres connection "snapshot.jaffle_shop.low_stock_indicator"
[0m21:40:18.790871 [debug] [Thread-2 (]: On snapshot.jaffle_shop.low_stock_indicator: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.low_stock_indicator"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'low_stock_indicator__dbt_tmp214017044542'
        
      order by ordinal_position

  
[0m21:40:18.793601 [debug] [Thread-2 (]: SQL status: SELECT 16 in 0.0 seconds
[0m21:40:18.796370 [debug] [Thread-2 (]: Using postgres connection "snapshot.jaffle_shop.low_stock_indicator"
[0m21:40:18.796627 [debug] [Thread-2 (]: On snapshot.jaffle_shop.low_stock_indicator: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.low_stock_indicator"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'low_stock_indicator'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m21:40:18.798672 [debug] [Thread-2 (]: SQL status: SELECT 14 in 0.0 seconds
[0m21:40:18.801109 [debug] [Thread-2 (]: Using postgres connection "snapshot.jaffle_shop.low_stock_indicator"
[0m21:40:18.801406 [debug] [Thread-2 (]: On snapshot.jaffle_shop.low_stock_indicator: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.low_stock_indicator"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'low_stock_indicator__dbt_tmp214017044542'
        
      order by ordinal_position

  
[0m21:40:18.803509 [debug] [Thread-2 (]: SQL status: SELECT 16 in 0.0 seconds
[0m21:40:18.807367 [debug] [Thread-2 (]: Using postgres connection "snapshot.jaffle_shop.low_stock_indicator"
[0m21:40:18.807641 [debug] [Thread-2 (]: On snapshot.jaffle_shop.low_stock_indicator: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.low_stock_indicator"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'low_stock_indicator'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m21:40:18.809740 [debug] [Thread-2 (]: SQL status: SELECT 14 in 0.0 seconds
[0m21:40:18.812289 [debug] [Thread-2 (]: Using postgres connection "snapshot.jaffle_shop.low_stock_indicator"
[0m21:40:18.812553 [debug] [Thread-2 (]: On snapshot.jaffle_shop.low_stock_indicator: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.low_stock_indicator"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'low_stock_indicator__dbt_tmp214017044542'
        
      order by ordinal_position

  
[0m21:40:18.814607 [debug] [Thread-2 (]: SQL status: SELECT 16 in 0.0 seconds
[0m21:40:18.816665 [debug] [Thread-2 (]: Writing runtime SQL for node "snapshot.jaffle_shop.low_stock_indicator"
[0m21:40:18.818628 [debug] [Thread-2 (]: Using postgres connection "snapshot.jaffle_shop.low_stock_indicator"
[0m21:40:18.818851 [debug] [Thread-2 (]: On snapshot.jaffle_shop.low_stock_indicator: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.low_stock_indicator"} */

      update "postgres"."public"."low_stock_indicator"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "low_stock_indicator__dbt_tmp214017044542" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."public"."low_stock_indicator".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."public"."low_stock_indicator".dbt_valid_to is null;

    insert into "postgres"."public"."low_stock_indicator" ("name", "variant", "color_value", "weave_cat", "size_grp", "shape", "weight", "low_stock", "name_variant_color_weave_size_shape_weight", "updated_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."variant",DBT_INTERNAL_SOURCE."color_value",DBT_INTERNAL_SOURCE."weave_cat",DBT_INTERNAL_SOURCE."size_grp",DBT_INTERNAL_SOURCE."shape",DBT_INTERNAL_SOURCE."weight",DBT_INTERNAL_SOURCE."low_stock",DBT_INTERNAL_SOURCE."name_variant_color_weave_size_shape_weight",DBT_INTERNAL_SOURCE."updated_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "low_stock_indicator__dbt_tmp214017044542" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m21:40:18.819689 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m21:40:18.820848 [debug] [Thread-2 (]: On snapshot.jaffle_shop.low_stock_indicator: COMMIT
[0m21:40:18.821088 [debug] [Thread-2 (]: Using postgres connection "snapshot.jaffle_shop.low_stock_indicator"
[0m21:40:18.821279 [debug] [Thread-2 (]: On snapshot.jaffle_shop.low_stock_indicator: COMMIT
[0m21:40:18.822441 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m21:40:18.823441 [debug] [Thread-2 (]: finished collecting timing info
[0m21:40:18.823703 [debug] [Thread-2 (]: On snapshot.jaffle_shop.low_stock_indicator: Close
[0m21:40:18.824644 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a357b34-461f-4fcd-9908-cd4b93d0a5aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8140a30>]}
[0m21:40:18.825564 [info ] [Thread-2 (]: 2 of 2 OK snapshotted public.low_stock_indicator ............................... [[32mINSERT 0 0[0m in 1.93s]
[0m21:40:18.826493 [debug] [Thread-2 (]: Finished running node snapshot.jaffle_shop.low_stock_indicator
[0m21:40:18.831115 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m21:40:18.831907 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:18.832192 [debug] [MainThread]: On master: BEGIN
[0m21:40:18.832489 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:40:18.840466 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m21:40:18.840848 [debug] [MainThread]: On master: COMMIT
[0m21:40:18.841067 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:18.841276 [debug] [MainThread]: On master: COMMIT
[0m21:40:18.841549 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:40:18.841753 [debug] [MainThread]: On master: Close
[0m21:40:18.844425 [info ] [MainThread]: 
[0m21:40:18.844978 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 2.08 seconds (2.08s).
[0m21:40:18.845545 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:40:18.845962 [debug] [MainThread]: Connection 'snapshot.jaffle_shop.availability_clearance_rugs' was properly closed.
[0m21:40:18.846232 [debug] [MainThread]: Connection 'snapshot.jaffle_shop.low_stock_indicator' was properly closed.
[0m21:40:18.857327 [info ] [MainThread]: 
[0m21:40:18.857717 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:40:18.858063 [info ] [MainThread]: 
[0m21:40:18.858391 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:40:18.858975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a19ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a19b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a1bd90>]}


============================== 2024-07-14 21:40:32.864469 | 45b0b238-f7a2-43bc-9229-fa9dd659c350 ==============================
[0m21:40:32.864768 [info ] [MainThread]: Running with dbt=1.2.0
[0m21:40:32.869555 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m21:40:32.869893 [debug] [MainThread]: Tracking: tracking
[0m21:40:32.886722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1a230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1b430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1b550>]}
[0m21:40:32.943688 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:40:32.944081 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:40:32.950673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45b0b238-f7a2-43bc-9229-fa9dd659c350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99d00d0>]}
[0m21:40:32.961343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45b0b238-f7a2-43bc-9229-fa9dd659c350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae1600>]}
[0m21:40:32.961784 [info ] [MainThread]: Found 4 models, 12 tests, 2 snapshots, 0 analyses, 259 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m21:40:32.962130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45b0b238-f7a2-43bc-9229-fa9dd659c350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae1420>]}
[0m21:40:32.964370 [info ] [MainThread]: 
[0m21:40:32.965004 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m21:40:32.968145 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m21:40:32.977515 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m21:40:32.977925 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m21:40:32.978162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:40:33.023088 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m21:40:33.023692 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m21:40:33.023970 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m21:40:33.027896 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m21:40:33.029986 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m21:40:33.033464 [debug] [ThreadPool]: On list_postgres_public: Close
[0m21:40:33.038356 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:33.038678 [debug] [MainThread]: On master: BEGIN
[0m21:40:33.038889 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:40:33.045814 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m21:40:33.046167 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:33.046421 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:40:33.050925 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m21:40:33.052329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45b0b238-f7a2-43bc-9229-fa9dd659c350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7ff10>]}
[0m21:40:33.052766 [debug] [MainThread]: On master: ROLLBACK
[0m21:40:33.053137 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:33.053399 [debug] [MainThread]: On master: BEGIN
[0m21:40:33.053813 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:40:33.054104 [debug] [MainThread]: On master: COMMIT
[0m21:40:33.054376 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:33.054593 [debug] [MainThread]: On master: COMMIT
[0m21:40:33.054890 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:40:33.055123 [debug] [MainThread]: On master: Close
[0m21:40:33.055540 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m21:40:33.055846 [info ] [MainThread]: 
[0m21:40:33.060803 [debug] [Thread-1 (]: Began running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m21:40:33.060956 [debug] [Thread-2 (]: Began running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m21:40:33.061333 [info ] [Thread-1 (]: 1 of 12 START test below_depletion_level_tests_below_depletion_level_ .......... [RUN]
[0m21:40:33.061635 [info ] [Thread-2 (]: 2 of 12 START test new_arrival_stock_depletion_test_hot_upsell_ ................ [RUN]
[0m21:40:33.062091 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m21:40:33.062524 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m21:40:33.062825 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m21:40:33.063044 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m21:40:33.063292 [debug] [Thread-1 (]: Compiling test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m21:40:33.063501 [debug] [Thread-2 (]: Compiling test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m21:40:33.071400 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m21:40:33.075935 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m21:40:33.079486 [debug] [Thread-2 (]: finished collecting timing info
[0m21:40:33.079729 [debug] [Thread-1 (]: finished collecting timing info
[0m21:40:33.079850 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m21:40:33.080622 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m21:40:33.095876 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m21:40:33.097836 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m21:40:33.100403 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m21:40:33.100583 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m21:40:33.100805 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: BEGIN
[0m21:40:33.101044 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: BEGIN
[0m21:40:33.101282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:40:33.101521 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:40:33.108841 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m21:40:33.109058 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m21:40:33.109406 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"
[0m21:40:33.109734 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"
[0m21:40:33.109995 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."below_depletion_level"
        WHERE stock_level > depletion_level
    )
    SELECT 
        errors
    FROM test_data
    WHERE errors > 0

      
    ) dbt_internal_test
[0m21:40:33.110245 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."rugs_usa_variant" ruv
        JOIN "postgres"."public"."rugs_usa_pads_upsell" rupu ON rupu.p_id = ruv.pid AND rupu.variant = ruv.variant 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid
        /* joining on model as none of these should show. doing an inner join for this purpose to test */
        JOIN "postgres"."public"."hot_upsell" model on model.name = rup.name and model.variant = ruv.variant and model.size = rupu.size and model.shape = rupu.shape and model.type = rupu.type
        where new_arrival <> 'Y' and stock_level >= coalesce(depletion_level, 0) and rupu.stock is null
    )
    SELECT 
        errors
    FROM test_data
    where errors > 0

      
    ) dbt_internal_test
[0m21:40:33.132531 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m21:40:33.134976 [debug] [Thread-1 (]: finished collecting timing info
[0m21:40:33.135272 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: ROLLBACK
[0m21:40:33.135584 [debug] [Thread-1 (]: On test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e: Close
[0m21:40:33.136050 [info ] [Thread-1 (]: 1 of 12 PASS below_depletion_level_tests_below_depletion_level_ ................ [[32mPASS[0m in 0.07s]
[0m21:40:33.137206 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.below_depletion_level_tests_below_depletion_level_.2d7c8ddd7e
[0m21:40:33.137593 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m21:40:33.137892 [info ] [Thread-1 (]: 3 of 12 START test not_null_below_depletion_level_name ......................... [RUN]
[0m21:40:33.138359 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m21:40:33.138603 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m21:40:33.138817 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m21:40:33.144753 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m21:40:33.146594 [debug] [Thread-1 (]: finished collecting timing info
[0m21:40:33.146816 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m21:40:33.148396 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m21:40:33.149816 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m21:40:33.150012 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: BEGIN
[0m21:40:33.150238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:40:33.158168 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m21:40:33.158749 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"
[0m21:40:33.158984 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."below_depletion_level"
where name is null



      
    ) dbt_internal_test
[0m21:40:33.162188 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:40:33.163550 [debug] [Thread-1 (]: finished collecting timing info
[0m21:40:33.163804 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: ROLLBACK
[0m21:40:33.164093 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9: Close
[0m21:40:33.164510 [info ] [Thread-1 (]: 3 of 12 PASS not_null_below_depletion_level_name ............................... [[32mPASS[0m in 0.03s]
[0m21:40:33.164975 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_name.2498868aa9
[0m21:40:33.165339 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m21:40:33.165607 [info ] [Thread-1 (]: 4 of 12 START test not_null_below_depletion_level_variant ...................... [RUN]
[0m21:40:33.165993 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m21:40:33.166221 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m21:40:33.166450 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m21:40:33.169715 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m21:40:33.170784 [debug] [Thread-1 (]: finished collecting timing info
[0m21:40:33.170996 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m21:40:33.172648 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m21:40:33.173509 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m21:40:33.173718 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: BEGIN
[0m21:40:33.173924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:40:33.180915 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m21:40:33.181271 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"
[0m21:40:33.181552 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."below_depletion_level"
where variant is null



      
    ) dbt_internal_test
[0m21:40:33.187455 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m21:40:33.188908 [debug] [Thread-1 (]: finished collecting timing info
[0m21:40:33.189201 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: ROLLBACK
[0m21:40:33.189505 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1: Close
[0m21:40:33.189938 [info ] [Thread-1 (]: 4 of 12 PASS not_null_below_depletion_level_variant ............................ [[32mPASS[0m in 0.02s]
[0m21:40:33.190359 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_below_depletion_level_variant.3ae00b82a1
[0m21:40:33.190706 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m21:40:33.190968 [info ] [Thread-1 (]: 5 of 12 START test not_null_hot_upsell_name .................................... [RUN]
[0m21:40:33.191398 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m21:40:33.191624 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m21:40:33.191828 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m21:40:33.194989 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m21:40:33.196084 [debug] [Thread-1 (]: finished collecting timing info
[0m21:40:33.196316 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m21:40:33.199170 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m21:40:33.200360 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m21:40:33.200574 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: BEGIN
[0m21:40:33.200775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:40:33.207732 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m21:40:33.209147 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"
[0m21:40:33.209517 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."hot_upsell"
where name is null



      
    ) dbt_internal_test
[0m21:40:33.215701 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m21:40:33.217402 [debug] [Thread-1 (]: finished collecting timing info
[0m21:40:33.217708 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: ROLLBACK
[0m21:40:33.218039 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb: Close
[0m21:40:33.218541 [info ] [Thread-1 (]: 5 of 12 PASS not_null_hot_upsell_name .......................................... [[32mPASS[0m in 0.03s]
[0m21:40:33.219086 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_name.89a3b9e3bb
[0m21:40:33.219646 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m21:40:33.219986 [info ] [Thread-1 (]: 6 of 12 START test not_null_hot_upsell_variant ................................. [RUN]
[0m21:40:33.220459 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m21:40:33.220688 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m21:40:33.220911 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m21:40:33.224488 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m21:40:33.225626 [debug] [Thread-1 (]: finished collecting timing info
[0m21:40:33.225868 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m21:40:33.227739 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m21:40:33.229110 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m21:40:33.229356 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: BEGIN
[0m21:40:33.229576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:40:33.237165 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m21:40:33.237914 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"
[0m21:40:33.238218 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."hot_upsell"
where variant is null



      
    ) dbt_internal_test
[0m21:40:33.245719 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m21:40:33.247304 [debug] [Thread-1 (]: finished collecting timing info
[0m21:40:33.247584 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: ROLLBACK
[0m21:40:33.247888 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b: Close
[0m21:40:33.248422 [info ] [Thread-1 (]: 6 of 12 PASS not_null_hot_upsell_variant ....................................... [[32mPASS[0m in 0.03s]
[0m21:40:33.248941 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_hot_upsell_variant.9bef76264b
[0m21:40:33.249270 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m21:40:33.249628 [info ] [Thread-1 (]: 7 of 12 START test not_null_priority_order_name ................................ [RUN]
[0m21:40:33.250062 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m21:40:33.250289 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m21:40:33.250503 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m21:40:33.253604 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m21:40:33.254996 [debug] [Thread-1 (]: finished collecting timing info
[0m21:40:33.255226 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m21:40:33.256828 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m21:40:33.257896 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m21:40:33.258094 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: BEGIN
[0m21:40:33.258276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:40:33.265497 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m21:40:33.265866 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_name.6c35449027"
[0m21:40:33.266110 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_name.6c35449027"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."priority_order"
where name is null



      
    ) dbt_internal_test
[0m21:40:33.269996 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:40:33.271398 [debug] [Thread-1 (]: finished collecting timing info
[0m21:40:33.271652 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: ROLLBACK
[0m21:40:33.271951 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_name.6c35449027: Close
[0m21:40:33.272374 [info ] [Thread-1 (]: 7 of 12 PASS not_null_priority_order_name ...................................... [[32mPASS[0m in 0.02s]
[0m21:40:33.272828 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_name.6c35449027
[0m21:40:33.273127 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m21:40:33.273455 [info ] [Thread-1 (]: 8 of 12 START test not_null_priority_order_profit .............................. [RUN]
[0m21:40:33.273861 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m21:40:33.274071 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m21:40:33.274285 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m21:40:33.277528 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m21:40:33.278867 [debug] [Thread-1 (]: finished collecting timing info
[0m21:40:33.279081 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m21:40:33.280757 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m21:40:33.281708 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m21:40:33.281921 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: BEGIN
[0m21:40:33.282135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:40:33.290809 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m21:40:33.292054 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_profit.229518def8"
[0m21:40:33.292454 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_profit.229518def8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select profit
from "postgres"."public"."priority_order"
where profit is null



      
    ) dbt_internal_test
[0m21:40:33.299204 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m21:40:33.300956 [debug] [Thread-1 (]: finished collecting timing info
[0m21:40:33.301285 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: ROLLBACK
[0m21:40:33.301627 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_profit.229518def8: Close
[0m21:40:33.302087 [info ] [Thread-1 (]: 8 of 12 PASS not_null_priority_order_profit .................................... [[32mPASS[0m in 0.03s]
[0m21:40:33.302532 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_profit.229518def8
[0m21:40:33.303004 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m21:40:33.303410 [info ] [Thread-1 (]: 9 of 12 START test not_null_priority_order_variant ............................. [RUN]
[0m21:40:33.303886 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m21:40:33.304136 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m21:40:33.304354 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m21:40:33.308174 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m21:40:33.309400 [debug] [Thread-1 (]: finished collecting timing info
[0m21:40:33.309627 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m21:40:33.311211 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m21:40:33.312270 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m21:40:33.312473 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: BEGIN
[0m21:40:33.312668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:40:33.319382 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m21:40:33.319747 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"
[0m21:40:33.319975 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select variant
from "postgres"."public"."priority_order"
where variant is null



      
    ) dbt_internal_test
[0m21:40:33.326670 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m21:40:33.328215 [debug] [Thread-1 (]: finished collecting timing info
[0m21:40:33.328515 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: ROLLBACK
[0m21:40:33.328846 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3: Close
[0m21:40:33.329386 [info ] [Thread-1 (]: 9 of 12 PASS not_null_priority_order_variant ................................... [[32mPASS[0m in 0.03s]
[0m21:40:33.330082 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_priority_order_variant.3cc63d91c3
[0m21:40:33.330638 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m21:40:33.330961 [info ] [Thread-1 (]: 10 of 12 START test not_null_underselling_product_specs_name ................... [RUN]
[0m21:40:33.331570 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m21:40:33.331835 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m21:40:33.332031 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m21:40:33.335776 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m21:40:33.337494 [debug] [Thread-1 (]: finished collecting timing info
[0m21:40:33.337801 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m21:40:33.340857 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m21:40:33.342162 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m21:40:33.342413 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: BEGIN
[0m21:40:33.342631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:40:33.350035 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m21:40:33.350462 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"
[0m21:40:33.350692 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "postgres"."public"."underselling_product_specs"
where name is null



      
    ) dbt_internal_test
[0m21:40:33.371929 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.26 seconds
[0m21:40:33.373822 [debug] [Thread-2 (]: finished collecting timing info
[0m21:40:33.374119 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: ROLLBACK
[0m21:40:33.374447 [debug] [Thread-2 (]: On test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38: Close
[0m21:40:33.374910 [info ] [Thread-2 (]: 2 of 12 PASS new_arrival_stock_depletion_test_hot_upsell_ ...................... [[32mPASS[0m in 0.31s]
[0m21:40:33.375383 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.new_arrival_stock_depletion_test_hot_upsell_.48ecb5ca38
[0m21:40:33.375841 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m21:40:33.376149 [info ] [Thread-2 (]: 11 of 12 START test not_null_underselling_product_specs_stock_depletion_ratio .. [RUN]
[0m21:40:33.376665 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m21:40:33.376785 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m21:40:33.377015 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m21:40:33.378351 [debug] [Thread-1 (]: finished collecting timing info
[0m21:40:33.378632 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m21:40:33.378899 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: ROLLBACK
[0m21:40:33.382127 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m21:40:33.382535 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559: Close
[0m21:40:33.383530 [info ] [Thread-1 (]: 10 of 12 PASS not_null_underselling_product_specs_name ......................... [[32mPASS[0m in 0.05s]
[0m21:40:33.383929 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_underselling_product_specs_name.e7e6dfd559
[0m21:40:33.384210 [debug] [Thread-2 (]: finished collecting timing info
[0m21:40:33.384367 [debug] [Thread-1 (]: Began running node test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0
[0m21:40:33.384650 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m21:40:33.384886 [info ] [Thread-1 (]: 12 of 12 START test underselling_specs_test_underselling_product_specs_ ........ [RUN]
[0m21:40:33.386493 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m21:40:33.386950 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0"
[0m21:40:33.387694 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0
[0m21:40:33.387921 [debug] [Thread-1 (]: Compiling test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0
[0m21:40:33.388123 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m21:40:33.392106 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0"
[0m21:40:33.392393 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: BEGIN
[0m21:40:33.393275 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:40:33.393938 [debug] [Thread-1 (]: finished collecting timing info
[0m21:40:33.394481 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0
[0m21:40:33.396480 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0"
[0m21:40:33.397461 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0"
[0m21:40:33.397743 [debug] [Thread-1 (]: On test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0: BEGIN
[0m21:40:33.397984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:40:33.400192 [debug] [Thread-2 (]: SQL status: BEGIN in 0.01 seconds
[0m21:40:33.400610 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"
[0m21:40:33.400824 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_depletion_ratio
from "postgres"."public"."underselling_product_specs"
where stock_depletion_ratio is null



      
    ) dbt_internal_test
[0m21:40:33.405225 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m21:40:33.406561 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0"
[0m21:40:33.407086 [debug] [Thread-1 (]: On test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    WITH test_data AS (
        SELECT count(*) as errors
        FROM "postgres"."public"."rugs_usa_variant" ruv
        JOIN "postgres"."public"."rugs_usa_color_map" rucm ON rucm.color_id = ruv.pid 
        JOIN "postgres"."public"."rugs_usa_parent" rup ON rup.pid = ruv.pid 
        /* joining on model as none of these should show. doing an inner join for this purpose to test */
        JOIN "postgres"."public"."underselling_product_specs" model on model.name = rup.name and model.actual_size = ruv.actual_size and model.shape = ruv.shape
        WHERE 
                ruv.stock_level <= COALESCE(ruv.depletion_level, 0) 
                AND ruv.depletion_level = 0 
                AND ruv.stock_level IS NULL 
                or ruv.stock_level = 0
                AND ruv.new_arrival <> 'N' 
                AND ruv.status <> 'In_stock'
            
    )
    SELECT 
        errors
    FROM test_data
    where errors > 0

      
    ) dbt_internal_test
[0m21:40:33.425832 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.02 seconds
[0m21:40:33.428345 [debug] [Thread-2 (]: finished collecting timing info
[0m21:40:33.428656 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: ROLLBACK
[0m21:40:33.428997 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785: Close
[0m21:40:33.429597 [info ] [Thread-2 (]: 11 of 12 PASS not_null_underselling_product_specs_stock_depletion_ratio ........ [[32mPASS[0m in 0.05s]
[0m21:40:33.430247 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785
[0m21:40:33.439377 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m21:40:33.440854 [debug] [Thread-1 (]: finished collecting timing info
[0m21:40:33.441139 [debug] [Thread-1 (]: On test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0: ROLLBACK
[0m21:40:33.441506 [debug] [Thread-1 (]: On test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0: Close
[0m21:40:33.442003 [info ] [Thread-1 (]: 12 of 12 PASS underselling_specs_test_underselling_product_specs_ .............. [[32mPASS[0m in 0.06s]
[0m21:40:33.442454 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0
[0m21:40:33.445089 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m21:40:33.445414 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:33.445635 [debug] [MainThread]: On master: BEGIN
[0m21:40:33.445873 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:40:33.452616 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m21:40:33.452983 [debug] [MainThread]: On master: COMMIT
[0m21:40:33.453210 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:33.453480 [debug] [MainThread]: On master: COMMIT
[0m21:40:33.453771 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:40:33.454000 [debug] [MainThread]: On master: Close
[0m21:40:33.454801 [info ] [MainThread]: 
[0m21:40:33.455146 [info ] [MainThread]: Finished running 12 tests in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m21:40:33.455487 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:40:33.455744 [debug] [MainThread]: Connection 'test.jaffle_shop.underselling_specs_test_underselling_product_specs_.79b954e5c0' was properly closed.
[0m21:40:33.455962 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_underselling_product_specs_stock_depletion_ratio.579ee53785' was properly closed.
[0m21:40:33.463747 [info ] [MainThread]: 
[0m21:40:33.464127 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:40:33.464554 [info ] [MainThread]: 
[0m21:40:33.464846 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m21:40:33.465292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9babfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff80d8460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff80c2350>]}
